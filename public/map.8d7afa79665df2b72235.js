/*! For license information please see map.8d7afa79665df2b72235.js.LICENSE.txt */
(self.webpackChunkna_map=self.webpackChunkna_map||[]).push([[842],{5646:(t,e,i)=>{i.r(e),i.d(e,{NAMap:()=>cw});var a=i(3838),s=i(3466),n=i(9937),r=i(8457),o=i(2855),l=i(393),h=i(9949),c=i(3389),d=i(4194),u=i(29),p=i(1460),w=i(1198);function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function m(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function f(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,b(t,e,"get"))}function g(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,b(t,e,"set"),i),i}function b(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var y=new WeakMap,k=new WeakMap,M=new WeakMap,W=new WeakMap,_=new WeakMap;class S{constructor(t,e){m(this,y,{writable:!0,value:12}),m(this,k,{writable:!0,value:10}),v(this,"showPB",void 0),m(this,M,{writable:!0,value:void 0}),m(this,W,{writable:!0,value:{}}),m(this,_,{writable:!0,value:{}}),v(this,"_ports",void 0),v(this,"_showId",void 0),v(this,"_showValues",void 0),v(this,"_showCookie",void 0),v(this,"_showRadios",void 0),v(this,"_isDataLoaded",void 0),v(this,"_pbZonesDefault",void 0),v(this,"_defencesFiltered",void 0),v(this,"_pbZonesFiltered",void 0),v(this,"_raidZonesFiltered",void 0),v(this,"_g",void 0),this._ports=t,g(this,M,(0,p.Oy)(e)),this._showId="show-zones",this._showValues=["pb-all","pb-single","raid-all","raid-single","off"],this._showCookie=new c.Z({id:this._showId,values:this._showValues}),this._showRadios=new d.Z(this._showId,this._showValues),this.showPB=this._getShowPBSetting(),this._isDataLoaded=!1,this._setupSvg(),this._setupListener()}_setupSvg(){this._g=(0,a.Z)("#map").insert("g","#ports").attr("class","pb")}async _loadData(){this._pbZonesDefault=(await i.e(268).then(i.t.bind(i,5912,19))).default}_setupListener(){var t;null===(t=document.querySelector(`#${this._showId}`))||void 0===t||t.addEventListener("change",(()=>{this._showPBZonesSelected()}))}_getShowPBSetting(){const t=this._showCookie.get();return this._showRadios.set(t),t}_refreshPBZones(){this.refresh(),this._ports.portNamesUpdate()}_showPBZonesSelected(){this.showPB=this._showRadios.get(),this._showCookie.set(this.showPB),this._refreshPBZones()}_update(){this._g.selectAll("g.pb-zones").data(this._pbZonesFiltered,(t=>String(t.id))).join((t=>{const e=t.append("g").attr("class","pb-zones text-tiny");return e.append("path").attr("class","stroke-primary-light").attr("d",(t=>(0,w.GZ)(t.joinCircle[0],t.joinCircle[1],28)+(0,w.GZ)(t.joinCircle[0],t.joinCircle[1],14))),e.append("path").attr("class","fill-primary-dark").attr("d",(t=>t.pbCircles.map((t=>(0,w.GZ)(t[0],t[1],3.5))).join(""))),e.append("text").attr("class","svg-text-center fill-white lnum").attr("x",(t=>t.pbCircles.map((t=>t[0])).join(","))).attr("y",(t=>t.pbCircles.map((t=>t[1])).join(","))).text((t=>t.pbCircles.map(((t,e)=>String.fromCodePoint(65+e))).join(""))),"PVP"===f(this,M)&&(e.append("path").attr("class","fill-primary-light").attr("d",(t=>t.spawnPoints.map((t=>(0,w.GZ)(t[0],t[1],3.5))).join(""))),e.append("text").attr("class","svg-text-center fill-text lnum").attr("x",(t=>t.spawnPoints.map((t=>t[0])).join(","))).attr("y",(t=>t.spawnPoints.map((t=>t[1])).join(","))).text((t=>t.spawnPoints.map(((t,e)=>String.fromCodePoint(88+e))).join("")))),e}));this._g.selectAll("g.defence").data(this._defencesFiltered,(t=>String(t.id))).join((t=>{const e=t.append("g").attr("class","defence svg-text-center fill-white text-tiny");return e.selectAll("path.tower-range").data((t=>t.towers)).join((t=>t.append("path").attr("class","tower-range background-primary-light").attr("d",(t=>(0,w.GZ)(t[0],t[1],f(this,k)))))),e.selectAll("path.fort-range").data((t=>t.forts)).join((t=>t.append("path").attr("class","fort-range background-red").attr("d",(t=>(0,w.GZ)(t[0],t[1],f(this,y)))))),e.append("path").attr("class","fort fill-red").attr("d",(t=>t.forts.map((t=>(0,w.yb)(t[0],t[1],3))).join(""))),e.append("text").attr("class","svg-text-center fill-white lnum").attr("x",(t=>t.forts.map((t=>t[0])).join(","))).attr("y",(t=>t.forts.map((t=>t[1])).join(","))).text((t=>t.forts.map(((t,e)=>`${e+1}`)).join(""))),e.append("path").attr("class","tower fill-dark").attr("d",(t=>t.towers.map((t=>(0,w.GZ)(t[0],t[1],1.5))).join(""))),e.append("text").attr("class","svg-text-center fill-white lnum").attr("x",(t=>t.towers.map((t=>t[0])).join(","))).attr("y",(t=>t.towers.map((t=>t[1])).join(","))).text((t=>t.towers.map(((t,e)=>`${e+1}`)).join(""))),e})),this._g.selectAll("g.raid-zones").data(this._raidZonesFiltered,(t=>String(t.id))).join((t=>{const e=t.append("g").attr("class","raid-zones text-tiny");return e.append("path").attr("class","stroke-primary-light").attr("d",(t=>(0,w.GZ)(t.joinCircle[0],t.joinCircle[1],35))),e.append("path").attr("class","fill-primary-dark").attr("d",(t=>t.raidCircles.map((t=>(0,w.GZ)(t[0],t[1],4.5))).join(""))),e.append("text").attr("class","svg-text-center fill-white lnum").attr("x",(t=>t.raidCircles.map((t=>t[0])).join(","))).attr("y",(t=>t.raidCircles.map((t=>t[1])).join(","))).text((t=>t.raidCircles.map(((t,e)=>String.fromCodePoint(65+e))).join(""))),e.append("path").attr("class","fill-primary-light").attr("d",(t=>t.raidPoints.map((t=>(0,w.GZ)(t[0],t[1],1.5))).join(""))),e.append("text").attr("class","svg-text-center fill-text lnum").attr("x",(t=>t.raidPoints.map((t=>t[0])).join(","))).attr("y",(t=>t.raidPoints.map((t=>t[1])).join(","))).text((t=>t.raidPoints.map(((t,e)=>String.fromCodePoint(49+e))).join(""))),e}))}_isPortIn(t){return"pb-all"===this.showPB||"raid-all"===this.showPB||("pb-single"===this.showPB||"raid-single"===this.showPB)&&Number(t.id)===this._ports.currentPort.id}async _setData(){"pbZone"===this._ports.zoomLevel&&"off"!==this.showPB?(this._isDataLoaded||(await this._loadData(),this._isDataLoaded=!0),this._filterVisible()):(this._defencesFiltered=[],this._pbZonesFiltered=[],this._raidZonesFiltered=[])}_filterVisible(){const t=this._pbZonesDefault.filter((t=>t.position[0]>=f(this,W)[0]&&t.position[0]<=f(this,_)[0]&&t.position[1]>=f(this,W)[1]&&t.position[1]<=f(this,_)[1])).filter((t=>this._isPortIn(t)));this._defencesFiltered=t.map((t=>({id:t.id,forts:t.forts,towers:t.towers}))),"pb-all"===this.showPB||"pb-single"===this.showPB?(this._pbZonesFiltered=t.map((t=>({id:t.id,pbCircles:t.pbCircles,joinCircle:t.joinCircle,spawnPoints:t.spawnPoints}))),this._raidZonesFiltered=[]):(this._pbZonesFiltered=[],this._raidZonesFiltered=t.map((t=>({id:t.id,joinCircle:t.joinCircle,raidCircles:t.raidCircles,raidPoints:t.raidPoints}))))}setBounds(t){g(this,W,t[0]),g(this,_,t[1])}async refresh(){await this._setData(),this._update()}}var T=i(9022),x=i(8398),$=i(8776),P=i(577),C=i(8973);const D=[{name:"Abaco",centroid:[4500,1953],angle:0},{name:"Andros",centroid:[3870,2350],angle:0},{name:"Apalache",centroid:[2800,1330],angle:0},{name:"Bacalar",centroid:[2050,3646],angle:0},{name:"Baracoa",centroid:[4750,3320],angle:25},{name:"Basse-Terre",centroid:[7540,4450],angle:0},{name:"Belize",centroid:[1900,4300],angle:0},{name:"Benedenwinds",centroid:[6187,5340],angle:0},{name:"Bermuda",centroid:[7550,210],angle:0},{name:"Bovenwinds",centroid:[7280,4180],angle:350},{name:"Campeche",centroid:[980,3791],angle:0},{name:"Cap-Français",centroid:[5270,3480],angle:0},{name:"Caracas",centroid:[6430,5750],angle:0},{name:"Cartagena",centroid:[4450,6024],angle:0},{name:"Caymans",centroid:[3116,3811],angle:0},{name:"Cayos del Golfo",centroid:[1240,3120],angle:0},{name:"Comayaqua",centroid:[1920,4500],angle:0},{name:"Cornwall",centroid:[4100,3845],angle:0},{name:"Costa de los Calos",centroid:[2850,1928],angle:0},{name:"Costa del Fuego",centroid:[3700,1670],angle:70},{name:"Costa Rica",centroid:[3140,5920],angle:0},{name:"Crooked",centroid:[4925,2950],angle:0},{name:"Ciudad de Cuba",centroid:[4500,3495],angle:0},{name:"Cumaná",centroid:[7280,5770],angle:0},{name:"Dominica",centroid:[7640,4602],angle:0},{name:"Exuma",centroid:[4700,2560],angle:0},{name:"Filipina",centroid:[2850,3100],angle:340},{name:"Florida Occidental",centroid:[2172,1200],angle:0},{name:"Georgia",centroid:[3670,747],angle:0},{name:"Golfo de Maracaibo",centroid:[5635,5601],angle:0},{name:"Grand Bahama",centroid:[3950,1850],angle:320},{name:"Grande-Terre",centroid:[8e3,4400],angle:35},{name:"Gustavia",centroid:[7720,3990],angle:0},{name:"Inagua",centroid:[4970,3220],angle:0},{name:"Isla de Pinos",centroid:[3150,3300],angle:0},{name:"Kidd’s Island",centroid:[5950,1120],angle:0},{name:"La Habana",centroid:[2850,2800],angle:340},{name:"La Vega",centroid:[5830,3530],angle:20},{name:"Lago de Maracaibo",centroid:[5550,6040],angle:0},{name:"Leeward Islands",centroid:[7850,4150],angle:0},{name:"Les Cayes",centroid:[5145,4050],angle:0},{name:"Los Llanos",centroid:[3640,2770],angle:30},{name:"Los Martires",centroid:[3300,2360],angle:0},{name:"Louisiane",centroid:[1420,1480],angle:0},{name:"Margarita",centroid:[7150,5584],angle:0},{name:"Martinique",centroid:[7700,4783],angle:0},{name:"Mérida",centroid:[1858,3140],angle:0},{name:"New Providence",centroid:[4500,2330],angle:0},{name:"North Carolina",centroid:[4580,150],angle:0},{name:"North Mosquito",centroid:[2420,4480],angle:0},{name:"Nuevitas del Principe",centroid:[4350,3050],angle:35},{name:"Nuevo Santander",centroid:[450,2594],angle:0},{name:"Orinoco",centroid:[7620,6e3],angle:0},{name:"Ponce",centroid:[6720,4040],angle:0},{name:"Port-au-Prince",centroid:[5e3,3800],angle:0},{name:"Portobelo",centroid:[3825,5990],angle:0},{name:"Providencia",centroid:[3436,5033],angle:0},{name:"Quatro Villas",centroid:[3780,3100],angle:35},{name:"Royal Mosquito",centroid:[3130,4840],angle:0},{name:"Sainte-Lucie",centroid:[7720,4959],angle:0},{name:"San Juan",centroid:[6760,3800],angle:0},{name:"Santa Marta",centroid:[5150,5500],angle:340},{name:"Santo Domingo",centroid:[5880,4e3],angle:350},{name:"South Carolina",centroid:[4200,416],angle:0},{name:"South Cays",centroid:[4170,4361],angle:0},{name:"South Mosquito",centroid:[3080,5540],angle:0},{name:"Surrey",centroid:[4350,4100],angle:0},{name:"Texas",centroid:[750,1454],angle:0},{name:"Timucua",centroid:[3620,1220],angle:0},{name:"Trinidad",centroid:[7880,5660],angle:350},{name:"Turks and Caicos",centroid:[5515,3145],angle:0},{name:"Vera Cruz",centroid:[520,3779],angle:0},{name:"Vestindiske Øer",centroid:[7090,4030],angle:350},{name:"Virgin Islands",centroid:[7220,3840],angle:350},{name:"Windward Isles",centroid:[7800,5244],angle:0}],E={x:h.zb/2,y:h.zb/2},I=D.sort(((t,e)=>{const i={x:t.centroid[0],y:t.centroid[1]},a={x:e.centroid[0],y:e.centroid[1]};return(0,l.UI)(E,i)-(0,l.UI)(E,a)})),L=(0,C.Z)().range(T.q4).domain(I.map((t=>t.name))),N=[{name:"Atlantic Coast",centroid:[4200,970],angle:0},{name:"Atlantic",centroid:[6401,684],angle:0},{name:"Bahamas",centroid:[5100,2400],angle:0},{name:"Central America",centroid:[3e3,5100],angle:0},{name:"Central Antilles",centroid:[6900,4500],angle:0},{name:"East Cuba",centroid:[4454,3400],angle:20},{name:"Gulf",centroid:[1602,2328],angle:0},{name:"Hispaniola",centroid:[5477,4200],angle:0},{name:"Jamaica",centroid:[3500,3985],angle:0},{name:"Lower Antilles",centroid:[7100,5173],angle:0},{name:"Puerto Rico",centroid:[6900,3750],angle:0},{name:"South America",centroid:[6400,6100],angle:0},{name:"Upper Antilles",centroid:[6850,4250],angle:0},{name:"West Cuba",centroid:[3700,3e3],angle:20},{name:"Yucatan",centroid:[1462,3550],angle:0}],Z=[{name:"Hispaniola",coordinates:[4900,3635],radius:150,shallow:!1},{name:"Nassau",coordinates:[4360,2350],radius:108,shallow:!0},{name:"Tumbado",coordinates:[2400,3050],radius:150,shallow:!1},{name:"Léogane",coordinates:[5130,3770],radius:90,shallow:!1,shipClass:{min:7,max:4}},{name:"Tortuga",coordinates:[5435,3420],radius:100,shallow:!1,shipClass:{min:7,max:5}},{name:"Antilles",coordinates:[7555,4470],radius:140,shallow:!1},{name:"Nassau",coordinates:[4360,2350],radius:108,shallow:!0},{name:"La Mona",coordinates:[6180,4100],radius:170,shallow:!1,shipClass:{min:7,max:4}}];function j(t,e){A(t,e),e.add(t)}function z(t,e,i){A(t,e),e.set(t,i)}function A(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function F(t,e,i){return function(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}(t,e),i}function B(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,q(t,e,"get"))}function R(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,q(t,e,"set"),i),i}function q(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function O(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var V=new WeakMap,H=new WeakMap,G=new WeakMap,K=new WeakMap,Y=new WeakMap,U=new WeakMap,J=new WeakMap,Q=new WeakMap,X=new WeakMap,tt=new WeakMap,et=new WeakMap,it=new WeakMap,at=new WeakMap,st=new WeakMap,nt=new WeakMap,rt=new WeakMap,ot=new WeakMap,lt=new WeakMap,ht=new WeakMap,ct=new WeakMap,dt=new WeakMap,ut=new WeakMap,pt=new WeakSet,wt=new WeakSet,vt=new WeakSet,mt=new WeakSet,ft=new WeakSet;class gt{constructor(t){j(this,ft),j(this,mt),j(this,vt),j(this,wt),j(this,pt),z(this,V,{writable:!0,value:{}}),z(this,H,{writable:!0,value:{}}),z(this,G,{writable:!0,value:{}}),z(this,K,{writable:!0,value:{}}),z(this,Y,{writable:!0,value:{}}),z(this,U,{writable:!0,value:{}}),z(this,J,{writable:!0,value:0}),z(this,Q,{writable:!0,value:0}),z(this,X,{writable:!0,value:0}),z(this,tt,{writable:!0,value:0}),z(this,et,{writable:!0,value:0}),z(this,it,{writable:!0,value:0}),z(this,at,{writable:!0,value:[]}),z(this,st,{writable:!0,value:{}}),z(this,nt,{writable:!0,value:{}}),z(this,rt,{writable:!0,value:1}),z(this,ot,{writable:!0,value:""}),z(this,lt,{writable:!0,value:0}),z(this,ht,{writable:!0,value:1e5}),z(this,ct,{writable:!0,value:4*l.L9}),z(this,dt,{writable:!0,value:l.L9}),z(this,ut,{writable:!0,value:30}),O(this,pt,bt).call(this),O(this,wt,yt).call(this,t)}update(t,e,i,a){R(this,rt,t),R(this,at,e),R(this,ot,i),R(this,lt,a),O(this,ft,St).call(this)}}function bt(){R(this,U,(0,a.Z)("#ports").append("g").attr("data-ui-component","port-circles"))}function yt(t){R(this,st,(0,n.Z)()),R(this,V,(0,n.Z)().domain([0,1])),R(this,H,(0,n.Z)().domain([0,1]).range([T.Q0,T.gc]).interpolate(P.Z)),R(this,it,(0,x.Z)(t,(t=>t.taxIncome))??0),R(this,X,(0,$.Z)(t,(t=>t.taxIncome))??0),R(this,Y,(0,n.Z)().domain([B(this,it),B(this,X)]).range([T.Q0,T.fy]).interpolate(P.Z)),R(this,tt,(0,x.Z)(t,(t=>t.netIncome))??0),R(this,J,(0,$.Z)(t,(t=>t.netIncome))??0),R(this,G,(0,n.Z)().domain([B(this,tt),0,B(this,J)]).range([T.gc,T.Q0,T.fy]).interpolate(P.Z)),R(this,et,(0,x.Z)(t,(t=>t.portPoints))??0),R(this,Q,(0,$.Z)(t,(t=>t.portPoints))??0),R(this,K,(0,n.Z)().domain([B(this,et),B(this,Q)]).range([T.Q0,T.fy]).interpolate(P.Z)),R(this,nt,(0,n.Z)().range([l.w7,l.w7>>2,l.w7>>5]).domain([Math.log2(h.rO),Math.log2(h.DK)-1,Math.log2(h.u1)]))}function kt(t){let e="";return t.id===B(this,lt)?e="here":t.sellInTradePort&&t.buyInTradePort?e="both":t.sellInTradePort?e="pos":t.buyInTradePort&&(e="neg"),e}function Mt(t){let e="";return t.cooldownTime?e="cooldown":"NT"===t.attackerNation&&(e="raider"),e}function Wt(t){let e="";return t.ownPort?e="pos":t.enemyPort&&(e="neg"),e}function _t(){const t=B(this,nt).call(this,Math.log2(B(this,rt))),e=(0,l.qY)(t*B(this,dt)),i=(0,l.qY)(t*B(this,ct));let a=B(this,at),s=()=>"",n=()=>0,r=()=>"";switch(B(this,ot)){case"tax":a=B(this,at).filter((t=>t.capturable&&t.taxIncome>B(this,ht))),B(this,st).domain([B(this,it),B(this,X)]).range([e,i]),s=()=>"bubble",r=t=>B(this,Y).call(this,t.taxIncome)??"",n=t=>B(this,st).call(this,t.taxIncome)??0;break;case"net":a=B(this,at).filter((t=>t.capturable&&Math.abs(t.netIncome)>B(this,ht))),B(this,st).domain([B(this,tt),B(this,J)]).range([e,i]),s=()=>"bubble",r=t=>B(this,G).call(this,t.netIncome)??"",n=t=>B(this,st).call(this,Math.abs(t.netIncome))??0;break;case"points":a=B(this,at).filter((t=>t.capturable&&t.portPoints>B(this,ut))),B(this,st).domain([B(this,et),B(this,Q)]).range([e,i/2]),s=()=>"bubble",r=t=>B(this,K).call(this,t.portPoints)??"",n=t=>B(this,st).call(this,t.portPoints)??0;break;case"position":s=()=>"bubble here",n=t=>t.distance??0;break;case"attack":a=B(this,at).filter((t=>t.attackHostility||t.cooldownTime)),B(this,V).range([e,i/1.5]),s=t=>`bubble ${F(gt,gt,Mt).call(gt,t)}`,r=t=>"NT"===t.attackerNation?"":B(this,H).call(this,t.attackHostility??0)??"",n=t=>B(this,V).call(this,t.attackHostility??(t.cooldownTime?.2:0))??0;break;default:switch(B(this,ot)){case"county":s=t=>t.capturable?t.countyCapital?"bubble capital":"bubble non-capital":"bubble not-capturable",r=t=>t.capturable?L(t.county):"",n=t=>t.capturable?i/2:i/3;break;case"tradePorts":s=t=>`bubble ${O(this,vt,kt).call(this,t)}`,n=t=>t.id===B(this,lt)?i:i/2;break;case"frontline":s=t=>`bubble ${F(gt,gt,Wt).call(gt,t)}`,n=t=>t.ownPort?i/3:i/2,a=a.filter((t=>t.enemyPort??t.ownPort));break;case"currentGood":s=t=>"bubble "+(t.isSource?"pos":"neg"),n=()=>i/2;break;case"off":a=[]}}return{data:a,cssClass:s,r:n,fill:r}}function St(){const{data:t,cssClass:e,r:i,fill:a}=O(this,mt,_t).call(this);B(this,U).selectAll("circle").data(t,(t=>String(t.id))).join((t=>t.append("circle").attr("cx",(t=>t.coordinates[0])).attr("cy",(t=>t.coordinates[1])))).attr("class",(t=>e(t))).attr("r",(t=>i(t))).attr("fill",(t=>a(t)))}function Tt(t,e){$t(t,e),e.add(t)}function xt(t,e,i){$t(t,e),e.set(t,i)}function $t(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pt(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Dt(t,e,"get"))}function Ct(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Dt(t,e,"set"),i),i}function Dt(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function Et(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var It=new WeakMap,Lt=new WeakMap,Nt=new WeakSet,Zt=new WeakSet;class jt{constructor(){Tt(this,Zt),Tt(this,Nt),xt(this,It,{writable:!0,value:D}),xt(this,Lt,{writable:!0,value:{}}),Et(this,Nt,zt).call(this)}update(t,e,i,a){"portLabel"===t?(Et(this,Zt,At).call(this,e,i,a),Pt(this,Lt).classed("d-none",!1)):Pt(this,Lt).classed("d-none",!0)}}function zt(){Ct(this,Lt,(0,a.Z)("#ports").append("g").attr("data-ui-component","county").attr("class","sub-title"))}function At(t,e,i){const a=Pt(this,It).filter((i=>i.centroid[0]>=t[0]&&i.centroid[0]<=e[0]&&i.centroid[1]>=t[1]&&i.centroid[1]<=e[1]));Pt(this,Lt).selectAll("text").data(a,(t=>t.name)).join((t=>t.append("text").attr("class","svg-text-center").attr("transform",(t=>`translate(${t.centroid[0]},${t.centroid[1]})rotate(${t.angle})`)).text((t=>t.name))),(t=>t.attr("fill",(t=>"county"===i?L(t.name):""))))}var Ft=i(2157);function Bt(t,e){qt(t,e),e.add(t)}function Rt(t,e,i){qt(t,e),e.set(t,i)}function qt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(t,e,i){return function(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}(t,e),i}function Vt(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Kt(t,e,"get"))}function Ht(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function Gt(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Kt(t,e,"set"),i),i}function Kt(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Yt=new WeakMap,Ut=new WeakMap,Jt=new WeakSet,Qt=new WeakSet,Xt=new WeakSet,te=new WeakSet,ee=new WeakSet,ie=new WeakSet,ae=new WeakSet,se=new WeakSet,ne=new WeakSet;class re{constructor(){Bt(this,ne),Bt(this,se),Bt(this,ae),Bt(this,ie),Bt(this,ee),Bt(this,te),Bt(this,Xt),Bt(this,Qt),Bt(this,Jt),Rt(this,Yt,{writable:!0,value:48}),Rt(this,Ut,{writable:!0,value:void 0}),Gt(this,Ut,document.querySelector("#na-svg defs")),Ht(this,ne,me).call(this)}}function oe(t){const e=document.createElementNS("http://www.w3.org/2000/svg","pattern");return e.id=t,e.setAttribute("width","133%"),e.setAttribute("height","100%"),e.setAttribute("viewBox",`6 6 ${Vt(this,Yt)} ${.75*Vt(this,Yt)}`),e}function le(t){const e=document.createElementNS("http://www.w3.org/2000/svg","image");return e.setAttribute("width",String(Vt(this,Yt))),e.setAttribute("height",String(Vt(this,Yt))),e.setAttribute("href",T.eM[t].replace('"',"").replace('"',"")),e}function he(t){const e=document.createElementNS("http://www.w3.org/2000/svg","circle");return e.setAttribute("cx",String(Vt(this,Yt)/2)),e.setAttribute("cy",String(Vt(this,Yt)/2)),e.setAttribute("r","16"),e.setAttribute("class",t),e}function ce(){return Ht(this,Xt,he).call(this,"circle-highlight-yellow")}function de(){return Ht(this,Xt,he).call(this,"circle-highlight")}function ue(){const t=document.createElementNS("http://www.w3.org/2000/svg","rect");return t.setAttribute("height","480"),t.setAttribute("width","640"),t.setAttribute("fill",T.Om),t.setAttribute("fill-opacity","0.7"),t}function pe(t,e){const i=e.cloneNode(!0);i.id=`${t}r`,i.append(Ht(this,ee,de).call(this)),Vt(this,Ut).append(i)}function we(t,e){const i=e.cloneNode(!0);i.id=`${t}c`,i.append(Ht(this,te,ce).call(this)),Vt(this,Ut).append(i)}function ve(t,e){const i=e.cloneNode(!0),a=i.cloneNode(!0);i.id=`${t}a`,i.append(Ot(re,re,ue).call(re)),Vt(this,Ut).append(i),a.id=`${t}ra`,a.append(Ht(this,ee,de).call(this)),Vt(this,Ut).append(a)}function me(){for(const t of Ft.nU.map((t=>t.short))){const e=Ht(this,Jt,oe).call(this,t);e.append(Ht(this,Qt,le).call(this,t));const i=Vt(this,Ut).appendChild(e);"FT"!==t&&Ht(this,ie,pe).call(this,t,i),"NT"!==t&&"FT"!==t&&(Ht(this,ae,we).call(this,t,i),Ht(this,se,ve).call(this,t,i))}}var fe=i(7484),ge=i.n(fe),be=(i(9517),i(285)),ye=i.n(be),ke=i(4110),Me=i.n(ke),We=i(178),_e=i.n(We),Se=i(7846);function Te(t,e){$e(t,e),e.add(t)}function xe(t,e,i){$e(t,e),e.set(t,i)}function $e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Ee(t,e,"get"))}function Ce(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function De(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Ee(t,e,"set"),i),i}function Ee(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}ge().extend(ye()),ge().extend(Me()),ge().extend(_e()),ge().locale("en-gb");var Ie=new WeakMap,Le=new WeakMap,Ne=new WeakMap,Ze=new WeakSet,je=new WeakSet,ze=new WeakSet;class Ae{constructor(t){Te(this,ze),Te(this,je),Te(this,Ze),xe(this,Ie,{writable:!0,value:{}}),xe(this,Le,{writable:!0,value:void 0}),xe(this,Ne,{writable:!0,value:l.jo}),De(this,Le,t),Ce(this,Ze,Fe).call(this),Ce(this,ze,Re).call(this)}update(t){"pbZone"===t?Pe(this,Ie).classed("d-none",!0):Pe(this,Ie).classed("d-none",!1)}}function Fe(){De(this,Ie,(0,a.Z)("#ports").append("g").attr("data-ui-component","patrol-zone").attr("class","fill-yellow-dark"))}function Be(){const t=ge().utc("2021-01-17").hour(h.WF);let e=ge().utc().diff(t,"day");return"eu2"===Pe(this,Le)&&(e+=4),e%=Z.length,Z[e]}function Re(){const t=Ce(this,je,Be).call(this),e=1.6*t.radius,i=Math.round(t.radius/1.3),a=Math.round(Pe(this,Ne)*t.radius/100);Pe(this,Ie).append("circle").attr("class","background-yellow").attr("cx",t.coordinates[0]).attr("cy",t.coordinates[1]).attr("r",t.radius),Pe(this,Ie).append("image").attr("height",e).attr("width",e).attr("x",t.coordinates[0]).attr("y",t.coordinates[1]).attr("transform",`translate(${Math.floor(-e/2)},${Math.floor(-e/1.6)})`).attr("xlink:href",Se).attr("alt","Patrol zone"),Pe(this,Ie).append("text").attr("class","svg-text-center").attr("x",t.coordinates[0]).attr("y",t.coordinates[1]).attr("dy",i).attr("font-size",Math.round(1.6*a)).text(t.name),Pe(this,Ie).append("text").attr("class","svg-text-center").attr("x",t.coordinates[0]).attr("y",t.coordinates[1]).attr("dy",i-1.6*a).attr("font-size",a).html(t.shallow?"Shallow water ships":(t.shipClass?`${(0,l.hg)(t.shipClass.min)} to ${(0,l.hg)(t.shipClass.max)} rate`:"All")+" ships")}var qe=i(3824),Oe=i.n(qe),Ve=i(4848),He=i(5619),Ge=i(6400),Ke=i(7015),Ye=i(5923);function Ue(t,e){Qe(t,e),e.add(t)}function Je(t,e,i){Qe(t,e),e.set(t,i)}function Qe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xe(t,e,i){return function(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}(t,e),i}function ti(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,ai(t,e,"get"))}function ei(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function ii(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,ai(t,e,"set"),i),i}function ai(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}ge().extend(ye()),ge().extend(Me()),ge().extend(_e()),ge().locale("en-gb");const si=He.Z.bind(Ge.h);var ni=new WeakMap,ri=new WeakMap,oi=new WeakMap,li=new WeakMap,hi=new WeakMap,ci=new WeakMap,di=new WeakMap,ui=new WeakMap,pi=new WeakSet,wi=new WeakSet,vi=new WeakSet,mi=new WeakSet,fi=new WeakSet,gi=new WeakSet,bi=new WeakMap,yi=new WeakSet,ki=new WeakSet,Mi=new WeakSet,Wi=new WeakSet,_i=new WeakSet;class Si{constructor(t){Ue(this,_i),Ue(this,Wi),Ue(this,Mi),Ue(this,ki),Ue(this,yi),Ue(this,gi),Ue(this,fi),Ue(this,mi),Ue(this,vi),Ue(this,wi),Ue(this,pi),Je(this,ni,{writable:!0,value:{}}),Je(this,ri,{writable:!0,value:{}}),Je(this,oi,{writable:!0,value:""}),Je(this,li,{writable:!0,value:{}}),Je(this,hi,{writable:!0,value:void 0}),Je(this,ci,{writable:!0,value:{}}),Je(this,di,{writable:!0,value:{}}),Je(this,ui,{writable:!0,value:void 0}),Je(this,bi,{writable:!0,value:(t,e,i)=>{var a;const s="buy"===i?"alert-success":"alert-danger",n="buy"===i?`Buy here and sell in ${e}`:`Buy in ${e} and sell here`;return void 0===(null===(a=t.profit)||void 0===a?void 0:a[0])?si``:si`<div class="alert ${s} mt-2 mb-2 text-start" role="alert">
                  <div class="alert-heading"><span class="caps">${n}</span> (net value in reales)</div>
                  <p class="my-1"><em>By profit per item</em>: ${t.profit}</p>
                  <p class="my-1"><em>By profit per ton</em>: ${t.profitPerTon}</p>
              </div>`}}),ii(this,ui,t),ei(this,pi,xi).call(this),ei(this,wi,$i).call(this)}set showTrades(t){ii(this,li,t)}getTradeItem(t){return ti(this,ci).get(t)}get tradePort(){return ti(this,di)}set tradePort(t){ii(this,di,t)}async loadData(){const t=await(0,T.qP)(`${ti(this,ui)}-items.json`);ii(this,ci,new Map(t.map((t=>[t.id,t]))))}update(t,e,i){ii(this,oi,e);const a=ti(this,ri).call(this,Math.log2(t));ti(this,ni).selectAll("circle").data(i,(t=>String(t.id))).join((t=>t.append("circle").attr("fill",(t=>`url(#${t.nation}${Xe(Si,Si,Ti).call(Si,t)})`)).attr("cx",(t=>t.coordinates[0])).attr("cy",(t=>t.coordinates[1])).on("click",((t,e)=>{ei(this,_i,Ai).call(this,t,e)})).on("mouseleave",(()=>{ei(this,Wi,zi).call(this)})))).attr("r",a)}}function Ti(t){return("FT"===t.nation||"NT"===t.nation||t.capturable?"":"c")+(t.countyCapital&&t.capturable?"r":"")+(t.availableForAll&&"NT"!==t.nation?"a":"")}function xi(){ii(this,ni,(0,a.Z)("#ports").append("g").attr("data-ui-component","port-icons").attr("class","click-circle"))}function $i(){ii(this,ri,(0,n.Z)().range([l.w7,l.w7>>2,l.w7>>5]).domain([Math.log2(h.rO),Math.log2(h.DK)-1,Math.log2(h.u1)]))}function Pi(t){return(null==t?void 0:t.map((t=>{var e;return(null===(e=ti(this,ci).get(t))||void 0===e?void 0:e.name)??""})).sort(Ft.I4).join(", "))??""}function Ci(t,e){return e.profit.profit-t.profit.profit}function Di(t,e){return e.profit.profitPerTon-t.profit.profitPerTon}function Ei(t){var e;return si`${null==t||null===(e=t.sort(Xe(Si,Si,Ci)))||void 0===e?void 0:e.map(((e,i)=>si`<span style="white-space: nowrap;">${e.name} (${(0,Ke.RK)(e.profit.profit)})</span
                        >${i===t.length-1?si``:si`, `}`))}`}function Ii(t){var e;return si`${null==t||null===(e=t.sort(Xe(Si,Si,Di)))||void 0===e?void 0:e.map(((e,i)=>si`<span style="white-space: nowrap;"
                            >${e.name} (${(0,Ke.RK)(e.profit.profitPerTon)})</span
                        >${i===t.length-1?si``:si`, `}`))}`}function Li(t){var e;const i=ge().utc(t.portBattle),a=ge().utc(t.portBattle).local(),s=i===a?"":` (${a.format("H.mm")} local)`,n=ge().utc(t.cooldownTime),r=ge().utc(t.cooldownTime).local(),o=n===r?"":` (${r.format("H.mm")} local)`,l=(0,T.eA)(t.portBattleStartTime),h=i.isAfter(ge().utc())?"s":"ed",c=t.portBattle?si`<span
                      class="flag-icon-${t.attackerNation} flag-icon-small me-1"
                      role="img"
                      title="${(null===(e=(0,Ft.$i)((null==t?void 0:t.attackerNation)??""))||void 0===e?void 0:e.sortName)??""}"
                  ></span
                  >${(0,Ye.HL)(t.attackerClan)} attack${t.portBattle?si`${h} ${i.fromNow()} at ${i.format("H.mm")}${s}`:si`s: ${(0,Ke.sR)(t.attackHostility??0)} hostility`}`:si``,d={name:t.name,icon:t.nation,availableForAll:t.availableForAll,shallow:t.shallow,county:""===t.county?"":t.county,region:""===t.region?"":t.region,countyCapital:t.countyCapital,capital:!t.capturable&&"FT"!==t.nation,capturer:t.capturer?(0,Ye.HL)(t.capturer):si``,captureTime:t.captured?`${(0,Ft.fm)(ge().utc(t.captured).fromNow())}`:"",attack:t.attackHostility?c:si``,isNPCAttacker:"NT"===t.attackerNation,pbTimeRange:t.capturable?l:"",brLimit:(0,Ke.yI)(t.brLimit),portPoints:t.capturable?(0,Ke.yI)(t.portPoints):"",taxIncome:(0,Ke.RK)(t.taxIncome),portTax:(0,Ke.sR)(t.portTax),netIncome:(0,Ke.RK)(t.netIncome),tradingCompany:t.tradingCompany,laborHoursDiscount:t.laborHoursDiscount,dropsTrading:ei(this,vi,Pi).call(this,t.dropsTrading),consumesTrading:ei(this,vi,Pi).call(this,t.consumesTrading),producesNonTrading:ei(this,vi,Pi).call(this,t.producesNonTrading),dropsNonTrading:ei(this,vi,Pi).call(this,t.dropsNonTrading),tradePortName:this.tradePort.name,goodsToSellInTradePort:{profit:ei(this,mi,Ei).call(this,t.goodsToSellInTradePort),profitPerTon:ei(this,fi,Ii).call(this,t.goodsToSellInTradePort)},goodsToBuyInTradePort:{profit:ei(this,mi,Ei).call(this,t.goodsToBuyInTradePort),profitPerTon:ei(this,fi,Ii).call(this,t.goodsToBuyInTradePort)}};return d.dropsTrading.length>0&&d.dropsNonTrading.length>0&&(d.dropsNonTrading+=" ‒ "),t.cooldownTime&&(d.cooldownTime=si`${n.fromNow()} at <em>approximately</em> ${n.format("H.mm")}${o}`),d}function Ni(t){const e=t.capital?"flag-icon-border-middle":t.countyCapital?"flag-icon-border-light":"";return si`
            <div class="d-flex justify-content-between mb-4">
                <div class="d-flex">
                    <i class="flag-icon-${t.icon} flag-icon-large ${e}" role="img" />

                    <div class="text-start align-self-center compress mx-3">
                        <div class="large mb-1">${t.name}</div>
                        <div class="caps">${t.county}</div>
                        <div class="caps">${t.region}</div>
                    </div>
                </div>

                <div class="d-flex flex-column justify-content-end align-self-center">
                    <div class="ms-auto">
                        ${t.portPoints?si`<span class="x-large text-lighter">${t.portPoints}</span>`:si``}
                    </div>
                    <div class="ms-auto">
                        ${t.laborHoursDiscount?si`<i
                                  class="icon icon-light icon-labour me-1"
                                  role="img"
                                  aria-label="Labour hour discount level ${t.laborHoursDiscount}"
                              ></i>`:si``}
                        ${t.tradingCompany?si`<i
                                  class="icon icon-light icon-trading me-1"
                                  role="img"
                                  aria-label="Trading company level ${t.tradingCompany}"
                              ></i>`:si``}
                        ${t.availableForAll?si`<i
                                  class="icon icon-light icon-open me-1"
                                  role="img"
                                  aria-label="Accessible to all"
                              ></i>`:si``}
                        ${t.shallow?si`<i class="icon icon-light icon-shallow" role="img" aria-label="Shallow"></i>`:si`<i class="icon icon-light icon-deep" role="img" aria-label="Deep"></i>`}
                    </div>
                </div>
            </div>

            ${void 0===t.attack?si`${t.cooldownTime?si`<div class="alert alert-success mt-2" role="alert">
                            Port battle cooldown ends ${t.cooldownTime}
                        </div>`:si``}`:si`<div class="alert mt-2 ${t.isNPCAttacker?"alert-warning":"alert-danger"}" role="alert">
                      ${t.attack}
                  </div>`}

            <div class="d-flex text-start mb-2 compress">
                ${t.capital||"FT"===t.icon?si`<div>${t.portTax}<br /><span class="des top-0">Tax rate</span></div>`:si`
                          <div class="me-3">
                              ${t.pbTimeRange}<br />
                              <span class="des top-0">Battle timer</span>
                          </div>
                          <div class="me-3">
                              ${t.brLimit}<br />
                              <span class="des top-0">Rating</span>
                          </div>
                          ${t.capturer?si`<div class="me-3">
                                        ${t.capturer}<br />
                                        <span class="des top-0">Capturer</span>
                                    </div>
                                    <div class="me-5">
                                        ${t.captureTime}<br />
                                        <span class="des top-0">Capture</span>
                                    </div>`:si``}

                          <div class="ms-auto me-3">
                              ${t.taxIncome} (${t.portTax})<br />
                              <span class="des top-0">Tax income</span>
                          </div>
                          <div>
                              ${t.netIncome}<br />
                              <span class="des top-0">Net income</span>
                          </div>
                      `}
            </div>

            ${"tradePorts"===ti(this,oi)?si`${ti(this,bi).call(this,t.goodsToSellInTradePort,t.tradePortName,"buy")}${ti(this,bi).call(this,t.goodsToBuyInTradePort,t.tradePortName,"sell")}`:si` ${t.producesNonTrading.length>0?si`<p class="mb-2">
                            <span class="caps">Produces—</span
                            ><span class="non-trading">${t.producesNonTrading}</span>
                        </p>`:si``}
                  ${t.dropsTrading.length>0||t.dropsNonTrading.length>0?si`<p class="mb-2">
                            <span class="caps">Drops—</span>
                            ${t.dropsNonTrading?si`<span class="non-trading">${t.dropsNonTrading}</span>`:si``}
                            ${t.dropsTrading}
                        </p> `:si``}
                  ${t.consumesTrading.length>0?si`<p class="mb-2"><span class="caps">Consumes—</span>${t.consumesTrading}</p>`:si``}`}
        `}function Zi(t){var e;return(null===(e=ti(this,ci).get(t))||void 0===e?void 0:e.name)??""}function ji(t){let e="";const i=t.inventory.filter((t=>t.buyQuantity>0&&t.buyPrice>0)).sort(((t,e)=>ei(this,ki,Zi).call(this,t.id).localeCompare(ei(this,ki,Zi).call(this,e.id)))).map((t=>`${(0,Ke.yI)(t.buyQuantity)} ${ei(this,ki,Zi).call(this,t.id)} @ ${(0,Ke.Pj)(t.buyPrice)}`)).join("<br>"),a=t.inventory.filter((t=>t.sellQuantity>0&&t.sellPrice>0)).sort(((t,e)=>ei(this,ki,Zi).call(this,t.id).localeCompare(ei(this,ki,Zi).call(this,e.id)))).map((t=>`${(0,Ke.yI)(t.sellQuantity)} ${ei(this,ki,Zi).call(this,t.id)} @ ${(0,Ke.Pj)(t.sellPrice)}`)).join("<br>");return e+=`<h5 class="caps">${t.name} <span class="small">${t.nation}</span></h5>`,i.length>0&&(e+="<h6>Buy</h6>",e+=i),i.length>0&&a.length>0&&(e+="<p></p>"),a.length>0&&(e+="<h6>Sell</h6>",e+=a),e}function zi(){void 0!==ti(this,hi)&&(ti(this,hi).dispose(),ii(this,hi,void 0))}function Ai(t,e){const i=t.currentTarget;ei(this,Wi,zi).call(this),ii(this,hi,new(Oe())(i,{html:!0,placement:"auto",trigger:"manual",title:(0,Ve.ZP)(ei(this,yi,Ni).call(this,ei(this,gi,Li).call(this,e))),sanitize:!1})),ti(this,hi).show(),ti(this,li).show&&("inventory"!==ti(this,li).list.listType&&(ti(this,li).list.listType="inventory"),ti(this,li).update(ei(this,Mi,ji).call(this,e)))}function Fi(t,e){Ri(t,e),e.add(t)}function Bi(t,e,i){Ri(t,e),e.set(t,i)}function Ri(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qi(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Vi(t,e,"set"),i),i}function Oi(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Vi(t,e,"get"))}function Vi(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function Hi(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var Gi=new WeakMap,Ki=new WeakMap,Yi=new WeakMap,Ui=new WeakMap,Ji=new WeakMap,Qi=new WeakMap,Xi=new WeakSet,ta=new WeakSet,ea=new WeakSet,ia=new WeakSet,aa=new WeakSet,sa=new WeakSet;class na{constructor(){Fi(this,sa),Fi(this,aa),Fi(this,ia),Fi(this,ea),Fi(this,ta),Fi(this,Xi),Bi(this,Gi,{writable:!0,value:{id:366,coord:{x:4396,y:2494}}}),Bi(this,Ki,{writable:!0,value:{}}),Bi(this,Yi,{writable:!0,value:{}}),Bi(this,Ui,{writable:!0,value:1}),Bi(this,Ji,{writable:!0,value:void 0}),Bi(this,Qi,{writable:!0,value:"all"}),Hi(this,Xi,ra).call(this),Hi(this,ta,oa).call(this)}get currentPort(){return Oi(this,Gi)}set currentPort(t){qi(this,Gi,t)}update(t,e,i){qi(this,Ji,t),qi(this,Ui,e),"initial"===Oi(this,Ji)?Oi(this,Ki).classed("d-none",!0):Hi(this,sa,da).call(this,i)}}function ra(){qi(this,Ki,(0,a.Z)("#ports").append("g").attr("data-ui-component","port-names").attr("class","fill-white"))}function oa(){qi(this,Yi,(0,n.Z)().range([l.w7,l.w7>>2,l.w7>>5]).domain([Math.log2(h.rO),Math.log2(h.DK)-1,Math.log2(h.u1)]))}function la(t,e){return"pbZone"===Oi(this,Ji)&&("all"===Oi(this,Qi)||"single"===Oi(this,Qi)&&t.id===this.currentPort.id)?t.coordinates[0]+Math.round(1.3*e*Math.cos((0,l.Ht)(t.angle))):t.coordinates[0]}function ha(t,e,i){const a=e+1.2*i;if("pbZone"!==Oi(this,Ji))return t.coordinates[1]+a;const s=t.angle>90&&t.angle<270?i:0;return"all"===Oi(this,Qi)||"single"===Oi(this,Qi)&&t.id===this.currentPort.id?t.coordinates[1]+Math.round(1.3*e*Math.sin((0,l.Ht)(t.angle)))+s:t.coordinates[1]+a}function ca(t){return"pbZone"===Oi(this,Ji)&&("all"===Oi(this,Qi)||"single"===Oi(this,Qi)&&t.id===this.currentPort.id)?t.angle>0&&t.angle<l.tz?"start":"end":"middle"}function da(t){const e=Oi(this,Yi).call(this,Math.log2(Oi(this,Ui))),i=Oi(this,Yi).call(this,Math.log2(Oi(this,Ui)));Oi(this,Ki).selectAll("text").data(t,(t=>String(t.id))).join((t=>t.append("text").text((t=>t.name)))).attr("x",(t=>Hi(this,ea,la).call(this,t,e))).attr("y",(t=>Hi(this,ia,ha).call(this,t,e,i))).style("text-anchor",(t=>Hi(this,aa,ca).call(this,t))).style("dominant-baseline","auto"),Oi(this,Ki).attr("font-size",`${i}px`).classed("d-none",!1)}function ua(t,e){wa(t,e),e.add(t)}function pa(t,e,i){wa(t,e),e.set(t,i)}function wa(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function va(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,fa(t,e,"get"))}function ma(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,fa(t,e,"set"),i),i}function fa(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function ga(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var ba=new WeakMap,ya=new WeakMap,ka=new WeakSet,Ma=new WeakSet;class Wa{constructor(){ua(this,Ma),ua(this,ka),pa(this,ba,{writable:!0,value:{}}),pa(this,ya,{writable:!0,value:N}),ga(this,ka,_a).call(this)}update(t,e,i){"initial"===t?(ga(this,Ma,Sa).call(this,e,i),va(this,ba).classed("d-none",!1)):va(this,ba).classed("d-none",!0)}}function _a(){ma(this,ba,(0,a.Z)("#ports").append("g").attr("data-ui-component","region").attr("class","title"))}function Sa(t,e){const i=va(this,ya).filter((i=>i.centroid[0]>=t[0]&&i.centroid[0]<=e[0]&&i.centroid[1]>=t[1]&&i.centroid[1]<=e[1]));va(this,ba).selectAll("text").data(i,(t=>t.name)).join((t=>t.append("text").attr("class","svg-text-center").attr("transform",(t=>`translate(${t.centroid[0]},${t.centroid[1]})rotate(${t.angle})`)).text((t=>t.name))))}var Ta=i(2255);function xa(t,e,i){$a(t,e),e.set(t,i)}function $a(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pa(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Da(t,e,"get"))}function Ca(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Da(t,e,"set"),i),i}function Da(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Ea=new WeakMap,Ia=new WeakMap,La=new WeakMap,Na=new WeakMap,Za=new WeakMap,ja=new WeakMap,za=new WeakMap,Aa=new WeakSet;class Fa{constructor(){var t,e;$a(t=this,e=Aa),e.add(t),xa(this,Ea,{writable:!0,value:{}}),xa(this,Ia,{writable:!0,value:{}}),xa(this,La,{writable:!0,value:{}}),xa(this,Na,{writable:!0,value:{}}),xa(this,Za,{writable:!0,value:{}}),xa(this,ja,{writable:!0,value:{}}),xa(this,za,{writable:!0,value:{}}),function(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}(this,Aa,Ba).call(this)}update(t){const e=Object.keys(t).length;let i=0,a=0;e&&(i=(0,Ta.Z)(t,(t=>t.taxIncome)),a=(0,Ta.Z)(t,(t=>t.netIncome))),Pa(this,ja).text(`${e}`),Pa(this,za).html(`${(0,Ke.Dw)(i)}`),Pa(this,Za).html(`${(0,Ke.Dw)(a)}`)}show(){Pa(this,Ea).classed("hidden",!1)}}function Ba(){Ca(this,Ea,(0,a.Z)("main #summary-column").append("div").attr("id","port-summary").attr("class","port-summary shadow port-summary-no-wind")),Ca(this,La,Pa(this,Ea).append("div").attr("class","block")),Ca(this,ja,Pa(this,La).append("div")),Pa(this,La).append("div").attr("class","overlay-des").html("selected<br>ports"),Ca(this,Na,Pa(this,Ea).append("div").attr("class","block")),Ca(this,za,Pa(this,Na).append("div")),Pa(this,Na).append("div").attr("class","overlay-des").html("tax<br>income"),Ca(this,Ia,Pa(this,Ea).append("div").attr("class","block")),Ca(this,Za,Pa(this,Ia).append("div")),Pa(this,Ia).append("div").attr("class","overlay-des").html("net<br>income")}function Ra(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function qa(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Va(t,e,"get"))}function Oa(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Va(t,e,"set"),i),i}function Va(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Ha=new WeakMap,Ga=new WeakMap,Ka=new WeakMap,Ya=new WeakMap,Ua=new WeakMap,Ja=new WeakMap,Qa=new WeakMap,Xa=new WeakMap,ts=new WeakMap,es=new WeakMap,is=new WeakMap,as=new WeakMap,ss=new WeakMap,ns=new WeakMap,rs=new WeakMap,os=new WeakMap,ls=new WeakMap,hs=new WeakMap,cs=new WeakMap,ds=new WeakMap,us=new WeakMap,ps=new WeakMap,ws=new WeakMap;class vs{constructor(t){var e,i,a;this.map=t,Ra(this,Ha,{writable:!0,value:void 0}),Ra(this,Ga,{writable:!0,value:{}}),Ra(this,Ka,{writable:!0,value:{}}),Ra(this,Ya,{writable:!0,value:void 0}),Ra(this,Ua,{writable:!0,value:void 0}),Ra(this,Ja,{writable:!0,value:{}}),Ra(this,Qa,{writable:!0,value:void 0}),Ra(this,Xa,{writable:!0,value:void 0}),Ra(this,ts,{writable:!0,value:void 0}),Ra(this,es,{writable:!0,value:void 0}),Ra(this,is,{writable:!0,value:0}),Ra(this,as,{writable:!0,value:!1}),Ra(this,ss,{writable:!0,value:""}),Ra(this,ns,{writable:!0,value:!1}),Ra(this,rs,{writable:!0,value:void 0}),Ra(this,os,{writable:!0,value:{}}),Ra(this,ls,{writable:!0,value:"initial"}),a=void 0,(i="portIcons")in(e=this)?Object.defineProperty(e,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[i]=a,Ra(this,hs,{writable:!0,value:"show-radius"}),Ra(this,cs,{writable:!0,value:void 0}),Ra(this,ds,{writable:!0,value:void 0}),Ra(this,us,{writable:!0,value:void 0}),Ra(this,ps,{writable:!0,value:void 0}),Ra(this,ws,{writable:!0,value:void 0}),Oa(this,ws,this.map.serverName),Oa(this,is,h.VJ),Oa(this,ds,this.map.f11),Oa(this,us,["attack","county","points","position","tax","net","off"]),Oa(this,cs,new c.Z({id:qa(this,hs),values:qa(this,us)})),Oa(this,ps,new d.Z(qa(this,hs),qa(this,us))),this.showRadius=this._getShowRadiusSetting()}async init(){await this._loadAndSetupData()}async _setupData(t){Oa(this,Qa,t.ports.map((e=>{const i=t.server.find((t=>t.id===e.id))??{},a=t.pb.find((t=>t.id===e.id))??{};return{...e,...i,...a}}))),Oa(this,Ja,qa(this,Qa)),this._setupListener(),this._setupSvg(),Oa(this,rs,new Fa),Oa(this,Ua,new gt(qa(this,Qa))),this.portIcons=new Si(qa(this,ws)),await this.portIcons.loadData(),Oa(this,ts,new na),Oa(this,Ha,new jt),Oa(this,es,new Wa),Oa(this,Ya,new Ae(qa(this,ws))),new re}async _loadData(){const t=[{fileName:`${qa(this,ws)}-ports.json`,name:"server"},{fileName:`${qa(this,ws)}-pb.json`,name:"pb"}],e={};return e.ports=(await i.e(462).then(i.t.bind(i,9131,19))).default,await(0,T.EZ)(t,e),e}async _loadAndSetupData(){const t=await this._loadData();await this._setupData(t)}_setupListener(){var t;null===(t=document.querySelector("#show-radius"))||void 0===t||t.addEventListener("change",(()=>{this._showRadiusSelected()}))}_getShowRadiusSetting(){let t=qa(this,cs).get();return"position"===t&&([t]=qa(this,us),qa(this,cs).set(t)),qa(this,ps).set(t),t}_showRadiusSelected(){this.showRadius=qa(this,ps).get(),qa(this,cs).set(this.showRadius),this.update()}_setupSvg(){Oa(this,Ga,(0,a.Z)("#map").insert("g","g.f11").attr("data-ui-component","ports").attr("id","ports"))}portNamesUpdate(){qa(this,ts).update(this.zoomLevel,qa(this,is),qa(this,Xa))}update(t){Oa(this,is,t??qa(this,is)),this._filterVisible(),this.portIcons.update(qa(this,is),this.showRadius,qa(this,Xa)),qa(this,Ua).update(qa(this,is),qa(this,Xa),this.showRadius,this.portIcons.tradePort.id),this.portNamesUpdate(),qa(this,Ha).update(this.zoomLevel,qa(this,Ka),qa(this,os),this.showRadius),qa(this,es).update(this.zoomLevel,qa(this,Ka),qa(this,os)),qa(this,Ya).update(this.zoomLevel),qa(this,rs).update(qa(this,Ja))}_filterVisible(){"position"===this.showRadius?Oa(this,Xa,qa(this,Ja)):Oa(this,Xa,qa(this,Ja).filter((t=>t.coordinates[0]>=qa(this,Ka)[0]&&t.coordinates[0]<=qa(this,os)[0]&&t.coordinates[1]>=qa(this,Ka)[1]&&t.coordinates[1]<=qa(this,os)[1])))}setBounds(t){Oa(this,Ka,t[0]),Oa(this,os,t[1])}setShowRadiusSetting(t=qa(this,us)[0]){this.showRadius=t,qa(this,ps).set(this.showRadius),qa(this,cs).set(this.showRadius)}clearMap(t){qa(this,rs).show(),Oa(this,Ja,qa(this,Qa)),this.setShowRadiusSetting(),this.update(t)}get currentPort(){return qa(this,ts).currentPort}set currentPort(t){qa(this,ts).currentPort=t}get portData(){return qa(this,Ja)}set portData(t){Oa(this,Ja,t)}get portDataDefault(){return qa(this,Qa)}get showRadius(){return qa(this,ss)}set showRadius(t){Oa(this,ss,t)}get showTradePortPartners(){return qa(this,as)}set showTradePortPartners(t){Oa(this,ns,t)}get zoomLevel(){return qa(this,ls)}set zoomLevel(t){Oa(this,ls,t)}}var ms=i(5162),fs=i(9875),gs=i(7281),bs=i(9843),ys=i(2938),ks=i(9492);function Ms(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function Ws(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Ss(t,e,"get"))}function _s(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Ss(t,e,"set"),i),i}function Ss(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Ts=new WeakMap,xs=new WeakMap,$s=new WeakMap,Ps=new WeakMap;class Cs extends bs.Z{constructor(t){super(t,"sm","Set"),Ms(this,Ts,{writable:!0,value:"ship-journey"}),Ms(this,xs,{writable:!0,value:{}}),Ms(this,$s,{writable:!0,value:{}}),Ms(this,Ps,{writable:!0,value:{}})}async init(){this._injectModal();const{select:t,shipNameAndSpeed:e}=await(0,ks.hY)();_s(this,xs,t),_s(this,$s,e)}_injectModal(){const t=super.bodySel;_s(this,Ps,new ys.Z(t,this.baseId));const e=t.select("form"),i=`${Ws(this,Ts)}-select`,a=e.append("div").attr("class","mt-3").append("div").attr("class","d-flex flex-column");a.append("label").attr("for",i).text("Ship (optional)"),a.append("select").attr("name",i).attr("id",i)}getWind(){return Ws(this,Ps).getWind()??0}_getShipId(){return Number(Ws(this,xs).getValues())}getShipName(){var t;const e=this._getShipId();return null===(t=Ws(this,$s).get(e))||void 0===t?void 0:t.name}getSpeedDegrees(){var t;const e=this._getShipId();return null===(t=Ws(this,$s).get(e))||void 0===t?void 0:t.speedDegrees}}function Ds(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function Es(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Ls(t,e,"get"))}function Is(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Ls(t,e,"set"),i),i}function Ls(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Ns=new WeakMap,Zs=new WeakMap,js=new WeakMap,zs=new WeakMap,As=new WeakMap,Fs=new WeakMap;class Bs{constructor(t){Ds(this,Ns,{writable:!0,value:{}}),Ds(this,Zs,{writable:!0,value:{}}),Ds(this,js,{writable:!0,value:{}}),Ds(this,zs,{writable:!0,value:{}}),Ds(this,As,{writable:!0,value:{}}),Ds(this,Fs,{writable:!0,value:void 0}),Is(this,Fs,t),this._setupSummary()}_setupSummary(){Is(this,Ns,(0,a.Z)("main #summary-column").append("div").attr("id","journey-summary").attr("class","journey-summary shadow-lg d-none")),Is(this,Zs,Es(this,Ns).append("div").attr("class","block small")),Is(this,js,Es(this,Zs).append("div")),Es(this,Zs).append("div").attr("class","overlay-des").text("ship"),Is(this,As,Es(this,Ns).append("div").attr("class","block small")),Is(this,zs,Es(this,As).append("div")),Es(this,As).append("div").attr("class","overlay-des").text("wind"),Es(this,Ns).append("div").attr("class","block").append("button").attr("id",Es(this,Fs)).attr("class","btn btn-outline-primary btn-sm").attr("role","button").text("Clear last leg")}_displaySummary(t){Es(this,Ns).classed("d-none",!t),(0,a.Z)("#port-summary").classed("d-none",t)}_printSummaryShip(t){Es(this,js).text(t)}_printSummaryWind(t){Es(this,zs).html(`From ${(0,w.Iy)(t)}`)}show(){this._displaySummary(!0)}hide(){this._displaySummary(!1)}setPosition(t,e){Es(this,Ns).style("top",`${t}px`).style("right",`${e}px`)}print({startWindDegrees:t,shipName:e}){this._printSummaryWind(t),this._printSummaryShip(e)}}var Rs=i(8250),qs=i(7),Os=i(7422);function Vs(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function Hs(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Ks(t,e,"set"),i),i}function Gs(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Ks(t,e,"get"))}function Ks(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Ys=new WeakMap,Us=new WeakMap,Js=new WeakMap,Qs=new WeakMap,Xs=new WeakMap,tn=new WeakMap,en=new WeakMap,an=new WeakMap,sn=new WeakMap,nn=new WeakMap;class rn{constructor(t,e,i){Vs(this,Ys,{writable:!0,value:0}),Vs(this,Us,{writable:!0,value:10}),Vs(this,Js,{writable:!0,value:void 0}),Vs(this,Qs,{writable:!0,value:void 0}),Vs(this,Xs,{writable:!0,value:20}),Vs(this,tn,{writable:!0,value:void 0}),Vs(this,en,{writable:!0,value:6}),Vs(this,an,{writable:!0,value:1.3*Gs(this,Xs)}),Vs(this,sn,{writable:!0,value:r.CR.translate(Gs(this,Xs),Gs(this,Xs))}),Vs(this,nn,{writable:!0,value:void 0}),Hs(this,Qs,t),Hs(this,nn,e),Hs(this,Js,i),Hs(this,tn,1.4*Gs(this,Js))}_correctTextBox(t,e,i){const s=(0,a.Z)(i),n=s.select("text"),r=t.label.split("|");n.text("").attr("dy",0).attr("transform",Gs(this,sn).toString()).style("font-size",`${Gs(this,Js)}px`);for(const[t,e]of r.entries()){const i=n.append("tspan").html(e);t>0&&i.attr("x",0).attr("dy",Gs(this,tn))}const o=n.node().getBBox(),l=t.label?o.width+2*Gs(this,an):0,h=t.label?o.height+Gs(this,an):0;s.select("rect").attr("width",l).attr("height",h).attr("class","svg-shadow");const c=s.select("circle").attr("r",0===e||e===Gs(this,Ys)?4*Gs(this,Us):Gs(this,Us)).attr("class","click-circle svg-shadow "+(0===e||e===Gs(this,Ys)?"drag-hidden":"drag-circle"));s.append((()=>c.remove().node()))}_correctJourney(){Gs(this,Qs).selectAll("#journey g.labels g.label").each(((t,e,i)=>{this._correctTextBox(t,e,i[e])})),Gs(this,nn)&&Gs(this,nn).style("stroke-width",`${Gs(this,en)}px`)}print(t){const e=(0,Rs.Z)().padding(Gs(this,Xs)).value((t=>{const e=t.label.split("|"),i=e.reduce(((t,e,i,a)=>a[t].length>e.length?t:i),0);return e[i]})),i=(0,qs.Z)(),a=(0,Os.Z)(i).size(((t,e,i)=>{const a=t.label.split("|").length,s=i[e].querySelectorAll("text")[0].getBBox();return[s.width+2*Gs(this,Xs),s.height*a+2*Gs(this,Xs)]})).position((t=>t.position)).component(e);Gs(this,Qs).datum(t).call(a),Hs(this,Ys,t.length-1),this._correctJourney()}}function on(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function ln(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,cn(t,e,"get"))}function hn(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,cn(t,e,"set"),i),i}function cn(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var dn=new WeakMap,un=new WeakMap,pn=new WeakMap,wn=new WeakMap,vn=new WeakMap,mn=new WeakMap,fn=new WeakMap,gn=new WeakMap,bn=new WeakMap,yn=new WeakMap,kn=new WeakMap,Mn=new WeakMap,Wn=new WeakMap,_n=new WeakMap,Sn=new WeakMap,Tn=new WeakMap,xn=new WeakMap,$n=new WeakMap,Pn=new WeakMap,Cn=new WeakMap,Dn=new WeakMap,En=new WeakMap,In=new WeakMap,Ln=new WeakMap,Nn=new WeakMap,Zn=new WeakMap,jn=new WeakMap;class zn{constructor(t){on(this,dn,{writable:!0,value:{}}),on(this,un,{writable:!0,value:{}}),on(this,pn,{writable:!0,value:{}}),on(this,wn,{writable:!0,value:{}}),on(this,vn,{writable:!0,value:{}}),on(this,mn,{writable:!0,value:{}}),on(this,fn,{writable:!0,value:{}}),on(this,gn,{writable:!0,value:void 0}),on(this,bn,{writable:!0,value:void 0}),on(this,yn,{writable:!0,value:void 0}),on(this,kn,{writable:!0,value:"journey-arrow"}),on(this,Mn,{writable:!0,value:5}),on(this,Wn,{writable:!0,value:void 0}),on(this,_n,{writable:!0,value:"Make journey"}),on(this,Sn,{writable:!0,value:void 0}),on(this,Tn,{writable:!0,value:90}),on(this,xn,{writable:!0,value:"None"}),on(this,$n,{writable:!0,value:19}),on(this,Pn,{writable:!0,value:0}),on(this,Cn,{writable:!0,value:T.er/60}),on(this,Dn,{writable:!0,value:15}),on(this,En,{writable:!0,value:void 0}),on(this,In,{writable:!0,value:void 0}),on(this,Ln,{writable:!0,value:void 0}),on(this,Nn,{writable:!0,value:2}),on(this,Zn,{writable:!0,value:2}),on(this,jn,{writable:!0,value:void 0}),hn(this,Wn,(0,T.MF)(ln(this,_n))),hn(this,Ln,`menu-${ln(this,Wn)}`),hn(this,Sn,`compass-${ln(this,Wn)}`),hn(this,En,`button-delete-leg-${ln(this,Wn)}`),hn(this,In,(0,gs.Z)().x((t=>t[0])).y((t=>t[1]))),hn(this,jn,(0,n.Z)().domain((0,ms.Z)(0,l.QF,ln(this,Dn)))),this._setupDrag(),this._setupSvg(),this._initJourneyData(),hn(this,gn,new rn(ln(this,mn),ln(this,vn),t)),hn(this,yn,new Bs(ln(this,En))),this._setupListener()}static _getHumanisedDuration(t){const e=Math.floor(t/60),i=Math.round(t%60);let a="in ";if(t<1)a+="less than a minute";else{const t=0===e?"":(0,T.gY)(e,"hour");a+=t+(""===t?"":" ")+(0===i?"":(0,T.gY)(i,"minute"))}return a}_setupDrag(){const t=t=>{this._removeLabels(),(0,a.Z)(t).classed("drag-active",!0)},e=(t,e,i)=>{const s=i.position[0]+Number(e.dx),n=i.position[1]+Number(e.dy);0===i.index&&ln(this,dn).attr("x",s).attr("y",n),(0,a.Z)(t).attr("cx",e.x).attr("cy",e.y),i.position=[s,n],this._printLines()},i=t=>{(0,a.Z)(t).classed("drag-active",!1),this._printWholeJourney()};hn(this,un,(0,fs.Z)().on("start",(function(){t(this)})).on("drag",(function(t,i){e(this,t,i)})).on("end",(function(){i(this)})))}_setupSvg(){const t=ln(this,Mn),e=2*ln(this,Mn);hn(this,pn,(0,a.Z)("#ports").append("g").attr("id","journey").attr("class","svg-background-dark")),hn(this,vn,ln(this,pn).append("path")),hn(this,mn,ln(this,pn).append("g").attr("class","labels")),(0,a.Z)("#na-svg defs").append("marker").attr("id",ln(this,kn)).attr("viewBox",`0 -${t} ${e} ${e}`).attr("refX",t).attr("refY",0).attr("markerWidth",t).attr("markerHeight",t).attr("orient","auto").append("path").attr("class","fill-contrast-light").attr("d",`M0,-${t}L${e},0L0,${t}`)}_initJourneyData(){hn(this,fn,{shipName:ln(this,xn),startWindDegrees:ln(this,Pn),currentWindDegrees:ln(this,Pn),totalDistance:0,totalMinutes:0,segments:[{position:[0,0],label:""}]})}_resetJourneyData(){var t;ln(this,fn).startWindDegrees=(null===(t=ln(this,bn))||void 0===t?void 0:t.getWind())??ln(this,Pn),ln(this,fn).currentWindDegrees=ln(this,fn).startWindDegrees,ln(this,fn).totalDistance=0,ln(this,fn).totalMinutes=0}async _menuClicked(){(0,o.KS)("Menu",ln(this,_n)),ln(this,bn)?ln(this,bn).show():(hn(this,bn,new Cs(ln(this,_n))),await ln(this,bn).init(),ln(this,bn).getModalNode().addEventListener("hidden.bs.modal",(()=>{this._useUserInput()})))}_setupListener(){document.querySelector(`#${ln(this,Ln)}`).addEventListener("click",(()=>{this._menuClicked()})),document.querySelector(`#${ln(this,En)}`).addEventListener("click",(()=>{this._deleteLastLeg()}))}_useUserInput(){this._setShipName(),this._printWholeJourney(),this._printSummary()}_printCompass(){const t=ln(this,fn).segments[0].position[0],e=ln(this,fn).segments[0].position[1];hn(this,dn,ln(this,pn).insert("svg","path").attr("id",ln(this,Sn)).attr("class","fill-background-colour").attr("x",t).attr("y",e)),hn(this,wn,ln(this,dn).append("g")),(0,w.$G)({element:ln(this,wn),radius:ln(this,Tn)})}_removeCompass(){ln(this,dn).remove()}_getSpeedAtDegrees(t){return Math.max(ln(this,jn).call(this,t)??0,ln(this,Nn))}_calculateDistanceForSection(t,e){const i=(l.QF-t+e)%l.QF;return this._getSpeedAtDegrees(i)*ln(this,Zn)*l.nX}_setShipSpeed(){var t;const e=(null===(t=ln(this,bn))||void 0===t?void 0:t.getSpeedDegrees())??Array.from({length:24},(()=>ln(this,$n)/2));ln(this,jn).range(e)}_calculateMinutesForSegment(t,e,i){let a=i,s=e,n=0;for(this._setShipSpeed();a>0;){const e=this._calculateDistanceForSection(t,s);a>e?(a-=e,n+=1):(n+=a/e,a=0),s=(l.QF+s-ln(this,Cn))%l.QF}return ln(this,fn).currentWindDegrees=s,n}_setShipName(){const t=ln(this,bn).getShipName();ln(this,fn).shipName=t||ln(this,xn)}_removeLabels(){const t=ln(this,pn).selectAll("#journey g.label");t.select("text").remove(),t.select("rect").remove()}_printSummary(){ln(this,yn).print(ln(this,fn))}_printLines(){ln(this,vn)&&ln(this,vn).datum(ln(this,fn).segments.length>1?ln(this,fn).segments.map((t=>t.position)):[[0,0]]).attr("marker-end","url(#journey-arrow)").attr("class","svg-shadow").attr("d",ln(this,In))}_getTextDirection(t,e,i){return`${(0,w.Iy)(t,!0)} ⁖ F11: ${(0,Ke.Hu)((0,l.IK)(i.x,i.y))} / ${(0,Ke.Hu)((0,l.pw)(i.x,i.y))}`}_getTextDistance(t,e,i){let a=`${Math.round(t)} k ${zn._getHumanisedDuration(e)}`;return i&&(a+=`⁖ total ${Math.round(ln(this,fn).totalDistance)} k ${zn._getHumanisedDuration(ln(this,fn).totalMinutes)}`),a}_calculateSegmentLabel(t){const e={x:ln(this,fn).segments[t].position[0],y:ln(this,fn).segments[t].position[1]},i={x:ln(this,fn).segments[t-1].position[0],y:ln(this,fn).segments[t-1].position[1]},a=(0,w.Fq)(e,i),s=(0,l.Sp)(e,i),n=(0,l.tT)(a),r=this._calculateMinutesForSegment(a,ln(this,fn).currentWindDegrees,1e3*s);ln(this,fn).totalDistance+=s,ln(this,fn).totalMinutes+=r;const o=this._getTextDirection(n,a,e),h=this._getTextDistance(s,r,t>1);ln(this,fn).segments[t].label=`${o}|${h}`}_setSegmentLabels(t){if(t)this._calculateSegmentLabel(ln(this,fn).segments.length-1);else for(const[t]of ln(this,fn).segments.entries())t<ln(this,fn).segments.length-1&&this._calculateSegmentLabel(t+1)}_print(t){this._printLines(),this._setSegmentLabels(t),ln(this,gn).print(ln(this,fn).segments),ln(this,pn).selectAll("#journey g.labels g.label circle").call(ln(this,un))}_printAdditionalSegment(){this._print(!0)}_printWholeJourney(){this._resetJourneyData(),this._print(!1)}_deleteLastLeg(){ln(this,fn).segments.pop(),ln(this,fn).segments.length>0?this._printWholeJourney():(ln(this,yn).hide(),ln(this,pn).selectAll("#journey g.labels g.label").remove(),ln(this,vn).remove(),this._removeCompass(),this._initJourneyData())}_initJourney(){ln(this,yn).show(),this._printSummary(),this._printCompass()}setSummaryPosition(t,e){ln(this,yn).setPosition(t,e)}plotCourse(t,e){ln(this,fn).segments[0].position[0]>0?(ln(this,fn).segments.push({position:[t,e],label:"",index:ln(this,fn).segments.length}),this._printAdditionalSegment()):(ln(this,fn).segments[0]={position:[t,e],label:"",index:0},this._initJourney())}}var An=i(9157),Fn=i(6411),Bn=i(1739),Rn=i(9488);function qn(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function On(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Hn(t,e,"get"))}function Vn(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Hn(t,e,"set"),i),i}function Hn(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}ge().extend(ye());var Gn=new WeakMap,Kn=new WeakMap,Yn=new WeakMap,Un=new WeakMap,Jn=new WeakMap,Qn=new WeakMap,Xn=new WeakMap,tr=new WeakMap,er=new WeakMap,ir=new WeakMap,ar=new WeakMap,sr=new WeakMap,nr=new WeakMap,rr=new WeakMap,or=new WeakMap,lr=new WeakMap,hr=new WeakMap,cr=new WeakMap,dr=new WeakMap,ur=new WeakMap,pr=new WeakMap,wr=new WeakMap,vr=new WeakMap,mr=new WeakMap,fr=new WeakMap,gr=new WeakMap,br=new WeakMap,yr=new WeakMap,kr=new WeakMap,Mr=new WeakMap,Wr=new WeakMap,_r=new WeakMap,Sr=new WeakMap,Tr=new WeakMap,xr=new WeakMap,$r=new WeakMap;class Pr{constructor(t,e,i){this.map=t,this.serverId=e,this.coord=i,qn(this,Gn,{writable:!0,value:void 0}),qn(this,Kn,{writable:!0,value:void 0}),qn(this,Yn,{writable:!0,value:"Power map"}),qn(this,Un,{writable:!0,value:void 0}),qn(this,Jn,{writable:!0,value:0}),qn(this,Qn,{writable:!0,value:{}}),qn(this,Xn,{writable:!0,value:{}}),qn(this,tr,{writable:!0,value:0}),qn(this,er,{writable:!0,value:-1}),qn(this,ir,{writable:!0,value:0}),qn(this,ar,{writable:!0,value:0}),qn(this,sr,{writable:!0,value:{}}),qn(this,nr,{writable:!0,value:0}),qn(this,rr,{writable:!0,value:{}}),qn(this,or,{writable:!0,value:{}}),qn(this,lr,{writable:!0,value:{}}),qn(this,hr,{writable:!0,value:0}),qn(this,cr,{writable:!0,value:0}),qn(this,dr,{writable:!0,value:{}}),qn(this,ur,{writable:!0,value:{}}),qn(this,pr,{writable:!0,value:0}),qn(this,wr,{writable:!0,value:new Map}),qn(this,vr,{writable:!0,value:[]}),qn(this,mr,{writable:!0,value:{}}),qn(this,fr,{writable:!0,value:{}}),qn(this,gr,{writable:!0,value:{}}),qn(this,br,{writable:!0,value:{}}),qn(this,yr,{writable:!0,value:0}),qn(this,kr,{writable:!0,value:!1}),qn(this,Mr,{writable:!0,value:{}}),qn(this,Wr,{writable:!0,value:void 0}),qn(this,_r,{writable:!0,value:void 0}),qn(this,Sr,{writable:!0,value:void 0}),qn(this,Tr,{writable:!0,value:200}),qn(this,xr,{writable:!0,value:200}),qn(this,$r,{writable:!0,value:2}),Vn(this,Gn,e),Vn(this,Wr,t),Vn(this,Kn,`show-${(0,T.MF)(On(this,Yn))}`),Vn(this,Un,`menu-${On(this,Kn)}`),Vn(this,Sr,i),Vn(this,_r,(0,C.Z)().domain(Ft.nU.map((t=>t.id))).range(Ft.nU.map((t=>t.colours[0])))),this._setupListener()}_setupData(t){Vn(this,gr,t.power),Vn(this,tr,On(this,gr).length-1),Vn(this,ur,(0,a.Z)("g#map"))}async _loadData(){const t=[{fileName:`${this.serverId}-power.json`,name:"power"}],e={};return Vn(this,fr,(await i.e(462).then(i.t.bind(i,9131,19))).default),await(0,T.EZ)(t,e),e}async _loadAndSetupData(){const t=await this._loadData();this._setupData(t)}async _menuClicked(){(0,o.KS)("Tools",On(this,Yn)),await this._loadAndSetupData(),(0,T.dM)(),this._mapElementsOff(),this._initialMapZoom(),this._initVoronoi(),this._initCanvas(),this._drawPowerMap()}_setupListener(){var t;null===(t=document.querySelector(`#${On(this,Un)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_showMapElements(t){On(this,ur).classed("d-none",!t),(0,a.Z)("main div.overlay").classed("d-none",!t)}_mapElementsOff(){this._showMapElements(!1)}_mapElementsOn(){this._showMapElements(!0)}_drawEnd(){(0,T.V4)(),this._mapElementsOn()}async _setPattern(){const t=Object.values(T.eM);try{const e=await(0,Rn.Z)(t);for(const[t,i]of e.entries())On(this,vr)[t]=On(this,Qn).createPattern(i,"repeat")}catch(t){console.error("One or more images have failed to load :("),console.error(t.errored),console.info("But these loaded fine:"),console.info(t.loaded)}}_drawDate(t){const e=ge()(t).format("D MMMM YYYY");On(this,Xn).text(e)}_drawMap(t,e,i){for(const[t,e]of i.entries())On(this,Qn).beginPath(),On(this,Mr).renderCell(t,On(this,Qn)),On(this,Qn).fillStyle=On(this,vr)[e]??"#000",On(this,Qn).fill();this._drawDate(e)}async _drawLoop(){let t,e;for(;!On(this,kr)&&On(this,er)<On(this,tr);){Vn(this,er,On(this,er)+1),this._setRangeValue(),t=On(this,gr)[On(this,er)][0],e=On(this,gr)[On(this,er)][1];const i=(0,Bn.HT)((a=>{this._drawMap(On(this,er),t,e),(a>On(this,xr)||On(this,kr))&&i.stop()}));this._drawNationLegend(e),await(0,Ft._v)(1.1*On(this,xr))}this._drawEnd()}_drawPowerMap(){this._drawLoop()}_initVoronoi(){const t=new Set([96,112,150,179,214,231,286,343,366]),e=On(this,fr).filter((e=>!t.has(e.id))).map((t=>t.coordinates)),i=Fn.Z.from(e);Vn(this,pr,(0,$.Z)(e,(t=>t[1]))??On(this,Sr).max);const a=[On(this,Sr).min,On(this,Sr).min,On(this,Sr).max,On(this,pr)];Vn(this,Mr,i.voronoi(a))}_initLegend(t){Vn(this,sr,(0,a.Z)("#na-map div").append("div").style("position","relative").style("width",`${t.width}px`).style("top",`-${t.top}px`).style("left",`${t.left}px`).attr("class","d-flex flex-column")),this._initController(),this._initNationLegend(t)}_initNationLegend(t){Vn(this,hr,Math.floor(40*l.L9)),Vn(this,cr,Math.floor(l.L9)),Vn(this,ir,Math.floor(5*l.L9));const{width:e}=t,i=75+2*On(this,ir),a=Ft.nU.length*i-2*On(this,ir);Vn(this,yr,Math.ceil(a/e)),Vn(this,Jn,Math.ceil(Ft.nU.length/On(this,yr))),Vn(this,ar,Math.ceil(e/On(this,Jn)-2*On(this,ir)));const s=On(this,sr).append("div");Vn(this,lr,s.append("div")),Vn(this,or,s.append("div"))}_getTopPosition(t){let e=-1===t?-On(this,hr):Math.floor(t/On(this,Jn))*(10*On(this,cr)+On(this,hr));return e+=16+On(this,nr),`${e}px`}_getLeftPosition(t){return`${-1===t?-On(this,ar):Math.floor(t%On(this,Jn)*(On(this,ir)+On(this,ar)))}px`}_resetOldIndex(){Vn(this,wr,new Map)}_drawNationLegend(t){const e=(0,An.Q3)(t,(t=>t.length),(t=>t)).sort(((t,e)=>e[1]-t[1]||t[0]-e[0])),i=t.length;On(this,lr).selectAll("svg.legend").data(e,((t,e)=>String(e).padStart(2,"0")+String(t[0]).padStart(2,"0"))).join((t=>{const e=t.append("svg").attr("class","legend").attr("width",On(this,ar)).attr("height",On(this,hr)+On(this,cr)).style("position","absolute").style("top",(t=>this._getTopPosition(On(this,wr).get(t[0])??-1))).style("left",(t=>this._getLeftPosition(On(this,wr).get(t[0])??-1))).transition().duration(On(this,xr)).style("top",((t,e)=>this._getTopPosition(e))).style("left",((t,e)=>this._getLeftPosition(e))).selection();return e.append("rect").attr("class","nation-header").attr("width",On(this,ar)).attr("height",Math.floor(On(this,hr)/2)).style("fill",(t=>On(this,_r).call(this,t[0]))),e.append("text").attr("class","nation-name").attr("x",Math.floor(On(this,ir)/2)).attr("y","25%").html((t=>{var e;return`${null===(e=(0,Ft.dx)(t[0]))||void 0===e?void 0:e.sortName}`})).style("fill",(t=>(0,Ye.IF)(On(this,_r).call(this,t[0])))),e.append("rect").attr("class","opacity-low").attr("y",Math.floor(On(this,hr)/2+On(this,cr))).attr("width","100%").attr("height",Math.floor(On(this,hr)/2)).style("fill",(t=>On(this,_r).call(this,t[0]))),e.append("rect").attr("class","value").attr("y",Math.floor(On(this,hr)/2+On(this,cr))).attr("height",Math.floor(On(this,hr)/2)).attr("width",(t=>On(this,ar)*(t[1]/i))).style("fill",(t=>On(this,_r).call(this,t[0]))),e.append("text").attr("class","value").attr("x",On(this,ar)-On(this,ir)).attr("y","75%").style("text-anchor","end").html((t=>(0,Ke.Dw)(t[1],!0))),e}),(t=>(t.select("rect.value").attr("width",(t=>On(this,ar)*(t[1]/i))).style("fill",(t=>On(this,_r).call(this,t[0]))),t.select("text.value").html((t=>(0,Ke.Dw)(t[1],!0))),t))),On(this,or).selectAll("svg.index").data(e,((t,e)=>e)).join((t=>{const e=t.append("svg").attr("class","index").attr("width",On(this,ar)).attr("height",On(this,hr)+On(this,cr)).style("position","absolute").style("top",((t,e)=>this._getTopPosition(e))).style("left",((t,e)=>this._getLeftPosition(e)));return e.append("text").attr("x",On(this,ar)/2).attr("y",(On(this,hr)+On(this,cr))/2).attr("fill",T.L$).attr("opacity",0).attr("text-anchor","middle").attr("dominant-baseline","mathematical").attr("font-variant","normal").attr("font-size",`${On(this,hr)}px`).text(((t,e)=>e+1)).transition().duration(On(this,xr)).attr("opacity",.3).selection(),e}),(t=>t),(t=>t.attr("opacity",.3).transition().duration(On(this,xr)).attr("opacity",0).remove().selection())),this._resetOldIndex();for(const[t,i]of e.entries())On(this,wr).set(i[0],t)}_getRangeValue(){return On(this,br).property("value")}_setRangeValue(){On(this,br).property("value",On(this,er))}_updateRangeValue(t=!1){Vn(this,er,Number.parseFloat(this._getRangeValue())),this._updateController(t)}_initRange(t){const e=`range-${On(this,Kn)}`,i=t.append("div").attr("class","row col-md-7 mb-0");Vn(this,br,i.append("div").attr("class","col-md-5").append("input").attr("id",e).attr("type","range").attr("class","form-range px-md-2").attr("style","height:100%").attr("min","0").attr("max",String(On(this,tr)))),i.append("div").attr("class","col-md-1"),Vn(this,Xn,i.append("label").attr("for",e).attr("class","col-md-6 col-form-label").attr("style","font-size:120%").attr("title","Date").text("Start"));let a=!1;On(this,br).on("change",(()=>{this._updateRangeValue()})).on("mousedown",(()=>{a=!0,Vn(this,kr,!0),this._togglePlayButton()})).on("mousemove",(()=>{a&&this._updateRangeValue(!0)})).on("mouseup",(()=>{a=!1}))}_getYear(t){return ge()(On(this,gr)[t][0]).year()}_togglePlayButton(){On(this,mr).classed("icon-pause",!On(this,kr)).classed("icon-play",On(this,kr))}_initialMapZoom(){On(this,Wr).zoomAndPan(On(this,Sr).max/2,On(this,Sr).max/2,!0)}_updateController(t=!1){const e=On(this,gr)[On(this,er)][0],i=On(this,gr)[On(this,er)][1];this._setRangeValue(),this._drawDate(e),this._adjustControllerHeight(),Vn(this,kr,!0),this._togglePlayButton(),t||(this._resetOldIndex(),this._drawMap(On(this,er),e,i),this._drawNationLegend(i))}_initButtons(t){const e=`menu-${On(this,Kn)}`,i=(t,i)=>s.append("button").attr("type","button").attr("id",`${e}-${t}`).attr("class","btn btn-default icon-button p-0").attr("title",i).append("i").attr("class",`icon icon-large icon-${t}`),a=t.append("div").attr("class","btn-toolbar col-md-4").attr("role","toolbar");let s=a.append("div").attr("class","btn-group").attr("role","group");const n=i("start","Start"),r=i("back","Year back");s=a.append("div").attr("class","btn-group").attr("role","group"),Vn(this,mr,i("pause","Pause")),s=a.append("div").attr("class","btn-group me-3").attr("role","group");const o=i("forward","Year forward"),l=i("end","End");n.on("click",(()=>{Vn(this,er,0),this._updateController()})),r.on("click",(()=>{let t=On(this,er);const e=this._getYear(t);let i=e;for(;t>0&&i===e;t--)i=this._getYear(t);Vn(this,er,t+1),this._updateController()})),On(this,mr).on("click",(()=>{Vn(this,kr,!On(this,kr)),this._togglePlayButton(),On(this,kr)||this._drawLoop()})),o.on("click",(()=>{let t=On(this,er);const e=this._getYear(t);let i=e;for(;t<On(this,tr)&&i===e;t++)i=this._getYear(t);Vn(this,er,t-1),this._updateController()})),l.on("click",(()=>{Vn(this,er,On(this,tr)),this._updateController()})),s=a.append("div").attr("class","btn-group").attr("role","group");const h=i("slower","Slower"),c=i("normal","Normal speed"),d=i("faster","Faster");h.on("click",(()=>{Vn(this,xr,On(this,xr)*On(this,$r))})),c.on("click",(()=>{Vn(this,xr,On(this,Tr))})),d.on("click",(()=>{Vn(this,xr,Math.max(10,On(this,xr)/On(this,$r)))})),s=t.append("div").attr("class","btn-group col-md-1").attr("role","group");i("close","Close").on("click",(()=>{this._drawEnd(),On(this,dr).remove(),this._initialMapZoom()}))}_adjustControllerHeight(){Vn(this,nr,(0,T.Uy)(On(this,rr))),On(this,sr).selectAll("svg.legend").style("top",((t,e)=>this._getTopPosition(e))),On(this,sr).selectAll("svg.index").style("top",((t,e)=>this._getTopPosition(e)))}_initController(){const t=On(this,sr).append("div").style("background-color",T.L$).attr("class","p-2");Vn(this,rr,t.node());const e=t.append("form").append("div").attr("class","row input-group align-items-center"),i=new ResizeObserver((()=>{this._adjustControllerHeight()}));this._initRange(e),this._initButtons(e),Vn(this,nr,(0,T.Uy)(On(this,rr))),i.observe(On(this,rr))}_getTopAlignedTransform(t){var e;const{a:i,e:a}=(null===(e=t.transform.baseVal.consolidate())||void 0===e?void 0:e.matrix)||{};return i&&a?r.CR.scale(i).translate(a/i,0):{}}async _initCanvas(){const t=(0,a.Z)("#na-map svg g.map-tiles"),e=this._getTopAlignedTransform(On(this,ur).node()),i=this._getTopAlignedTransform(t.node());On(this,ur).attr("transform",e.toString()),t.attr("transform",i.toString());const s=(0,a.Z)("#na-map svg"),n=s.style("height"),r=s.style("width");Vn(this,dr,(0,a.Z)("#na-map").append("div").style("position","relative").style("top",`-${n}`).style("height","100%").style("opacity",.7));const o=On(this,dr).append("canvas").node();o.style.height=n,o.style.width=r,o.height=Math.floor(2*Number.parseFloat(n)),o.width=Math.floor(2*Number.parseFloat(r)),Vn(this,Qn,(0,T.kU)(o)),On(this,Qn).translate(2*e.x,2*e.y),On(this,Qn).scale(2*e.k,2*e.k);const l=(0,T.mx)(t.node()),h={top:Math.floor(this.map.height-On(this,pr)*e.k+e.y),left:e.x,width:l};this._initLegend(h),await this._setPattern()}}var Cr=i(6607),Dr=i.n(Cr);function Er(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function Ir(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Nr(t,e,"get"))}function Lr(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Nr(t,e,"set"),i),i}function Nr(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Zr=new WeakMap,jr=new WeakMap,zr=new WeakMap;class Ar{constructor(t){Er(this,Zr,{writable:!0,value:{}}),Er(this,jr,{writable:!0,value:void 0}),Er(this,zr,{writable:!0,value:"port-select-pb-time"}),Lr(this,jr,t),this._setupSelect(),this._setupListener()}_getOptions(){return`${[...new Set(Ir(this,jr).portData.filter((t=>t.capturable)).map((t=>t.portBattleStartTime)).sort(((t,e)=>t-e)))].map((t=>`<option value="${t}">${(0,T.Db)(t)}</option>`)).join("")}`}_setupSelect(){Lr(this,Zr,new u.Z(Ir(this,zr),void 0,{dropupAuto:!1,liveSearch:!1,virtualScroll:!0},this._getOptions()))}_selected(){const t=String(Ir(this,Zr).getValues());Ir(this,jr).portData=Ir(this,jr).portDataDefault.filter((e=>e.capturable&&e.portBattleStartTime===Number(t))),Ir(this,jr).showRadius="",Ir(this,jr).update()}_setupListener(){Ir(this,Zr).select$.on("change",(async()=>{(0,o.KS)("Menu",Ir(this,zr)),this._selected()}))}}function Fr(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function Br(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,qr(t,e,"get"))}function Rr(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,qr(t,e,"set"),i),i}function qr(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Or=new WeakMap,Vr=new WeakMap,Hr=new WeakMap,Gr=new WeakMap;class Kr{constructor(t){Fr(this,Or,{writable:!0,value:"Show goods’ relations"}),Fr(this,Vr,{writable:!0,value:void 0}),Fr(this,Hr,{writable:!0,value:void 0}),Fr(this,Gr,{writable:!0,value:{}}),Rr(this,Hr,t),Rr(this,Vr,`port-select-${(0,T.MF)(Br(this,Or))}`),this._setupSelect(),this._setupListener()}_getOptions(){const t=new Map,e=["consumesTrading","dropsTrading","dropsNonTrading","producesNonTrading"];for(const a of Br(this,Hr).portDataDefault)for(const s of e){const e=a[s];if(e)for(const a of e){var i;t.set(a,(null===(i=Br(this,Hr).portIcons.getTradeItem(a))||void 0===i?void 0:i.name)??"")}}return`${[...t].sort(((t,e)=>t[1].localeCompare(e[1]))).map((t=>`<option value="${t[0]}">${t[1]}</option>`)).join("")}`}_setupSelect(){Rr(this,Gr,new u.Z(Br(this,Vr),void 0,{},""))}_setupListener(){Br(this,Gr).select$.one("show.bs.select",(()=>{Br(this,Gr).setOptions(this._getOptions()),Br(this,Gr).reset()})),Br(this,Gr).select$.on("change",(()=>{(0,o.KS)("Menu",Br(this,Or)),u.Z.resetAllExcept([Br(this,Gr).select$]),this._selectSelected()}))}_selectSelected(){const t=Number(Br(this,Gr).getValues()),e=JSON.parse(JSON.stringify(Br(this,Hr).portDataDefault.filter((e=>{var i,a,s;return(null===(i=e.dropsTrading)||void 0===i?void 0:i.includes(t))||(null===(a=e.dropsNonTrading)||void 0===a?void 0:a.includes(t))||(null===(s=e.producesNonTrading)||void 0===s?void 0:s.includes(t))})))).map((t=>(t.isSource=!0,t))),i=JSON.parse(JSON.stringify(Br(this,Hr).portDataDefault.filter((e=>{var i;return null===(i=e.consumesTrading)||void 0===i?void 0:i.includes(t)})))).map((t=>(t.isSource=!1,t)));Br(this,Hr).setShowRadiusSetting("off"),Br(this,Hr).portData=[...e,...i],Br(this,Hr).showRadius="currentGood",Br(this,Hr).update()}}function Yr(t,e,i){Ur(t,e),e.set(t,i)}function Ur(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jr(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function Qr(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,to(t,e,"get"))}function Xr(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,to(t,e,"set"),i),i}function to(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var eo=new WeakMap,io=new WeakMap,ao=new WeakMap,so=new WeakMap,no=new WeakMap,ro=new WeakMap,oo=new WeakMap,lo=new WeakMap,ho=new WeakSet;class co{constructor(t){var e,i;Ur(e=this,i=ho),i.add(e),Yr(this,eo,{writable:!0,value:"Show trade relations"}),Yr(this,io,{writable:!0,value:void 0}),Yr(this,ao,{writable:!0,value:new Map}),Yr(this,so,{writable:!0,value:{}}),Yr(this,no,{writable:!0,value:{}}),Yr(this,ro,{writable:!0,value:void 0}),Yr(this,oo,{writable:!0,value:void 0}),Yr(this,lo,{writable:!0,value:new Ft.y0}),Xr(this,oo,t),Xr(this,ro,Qr(this,oo).portData.length),Xr(this,io,`port-select-${(0,T.MF)(Qr(this,eo))}`),this._setupSelect(),this._setupListener()}_getOptions(){return`${Qr(this,oo).portDataDefault.map((t=>({id:t.id,coord:[t.coordinates[0],t.coordinates[1]],name:t.name,nation:t.nation}))).sort((0,Ft.MR)(["name"])).map((t=>`<option data-icon="flag-icon-${t.nation} flag-icon-small" value="${t.coord.toString()}/${t.id}">${t.name}</option>`)).join("")}`}_setupSelect(){Xr(this,so,new u.Z(Qr(this,io),void 0,{},""))}_setupListener(){Qr(this,so).select$.one("show.bs.select",(()=>{Qr(this,so).setOptions(this._getOptions()),Qr(this,so).reset()})),Qr(this,so).select$.one("change",(async()=>{await this._loadData()})),Qr(this,so).select$.on("change",(()=>{(0,o.KS)("Menu",Qr(this,eo)),u.Z.resetAllExcept([Qr(this,so).select$]),this._selectSelected()}))}async _loadData(){const t=(await i.e(971).then(i.t.bind(i,6720,19))).default;Xr(this,ao,new Map(t.map((([t,e,i])=>[t*Qr(this,ro)+e,i]))))}_setTradePortPartners(){Xr(this,no,Qr(this,oo).portDataDefault.find((t=>t.id===Qr(this,oo).portIcons.tradePort.id))??{}),Qr(this,no).id&&this._setTradeRelations()}_getSailingDistance(t,e){return t<e?Qr(this,ao).get(t*Qr(this,ro)+e)??0:Qr(this,ao).get(e*Qr(this,ro)+t)??0}_getBuyPrice(t){var e;return(null===(e=Qr(this,oo).portIcons.getTradeItem(t))||void 0===e?void 0:e.buyPrice)??0}_getSellPrice(t){var e;return(null===(e=Qr(this,oo).portIcons.getTradeItem(t))||void 0===e?void 0:e.sellPrice)??0}_getWeight(t){var e;return(null===(e=Qr(this,oo).portIcons.getTradeItem(t))||void 0===e?void 0:e.weight)??0}_getDistanceFactor(t){var e;return(null===(e=Qr(this,oo).portIcons.getTradeItem(t))||void 0===e?void 0:e.distanceFactor)??0}_getPortTax(t){var e;return(null===(e=Qr(this,oo).portDataDefault.find((e=>e.id===t)))||void 0===e?void 0:e.portTax)??0}_getCoordinates(t){const e=Qr(this,oo).portDataDefault.find((e=>e.id===t));return{x:(null==e?void 0:e.coordinates[0])??0,y:(null==e?void 0:e.coordinates[1])??0}}_getPlanarDistance(t,e){const i=this._getCoordinates(t),a=this._getCoordinates(e);return(0,l.Sp)(i,a)}_findClosestSourcePort(t,e){let i=Number.POSITIVE_INFINITY;const a=new Set(Qr(this,oo).portDataDefault.filter((t=>{var i,a;return(null===(i=t.dropsTrading)||void 0===i?void 0:i.includes(e))??(null===(a=t.dropsNonTrading)||void 0===a?void 0:a.includes(e))})).map((t=>t.id)));for(const e of a)i=Math.min(i,this._getPlanarDistance(e,t.id));return i}_calculateSellProfit(t,e,i){const a=this._findClosestSourcePort(e,i),s=this._getPortTax(t.id),n=this._getPortTax(e.id);let r=this._getBuyPrice(i),o=this._getSellPrice(i)+a*r*this._getDistanceFactor(i)/1050;r*=1+s,o/=1+n;const l=Math.round(o-r);return{profit:l,profitPerTon:Math.round(l/this._getWeight(i))}}_getProfit(t,e,i){const a=[e.id,i];return Qr(this,lo).has(a)||Qr(this,lo).set(a,this._calculateSellProfit(t,e,i)),Qr(this,lo).get(a)}_getGoodsToBuyInTradePort(t){var e,i;const a=new Set(null===(e=Qr(this,no).dropsTrading)||void 0===e?void 0:e.map((t=>t)))??[];return(null===(i=t.consumesTrading)||void 0===i?void 0:i.filter((t=>a.has(t))).map((e=>{var i;return{name:(null===(i=Qr(this,oo).portIcons.getTradeItem(e))||void 0===i?void 0:i.name)??"",profit:this._getProfit(Qr(this,no),t,e)}})))??[]}_getGoodsToSellInTradePort(t){var e,i;const a=new Set(null===(e=Qr(this,no).consumesTrading)||void 0===e?void 0:e.map((t=>t)))??[];return(null===(i=t.dropsTrading)||void 0===i?void 0:i.filter((t=>a.has(t))).map((e=>{var i;return{name:(null===(i=Qr(this,oo).portIcons.getTradeItem(e))||void 0===i?void 0:i.name)??"",profit:this._getProfit(t,Qr(this,no),e)}})))??[]}_setTradeRelations(){Qr(this,lo).clear(),Qr(this,oo).portData=Qr(this,oo).portDataDefault.map((t=>(t.sailingDistanceToTradePort=this._getSailingDistance(t.id,Qr(this,no).id),t.goodsToBuyInTradePort=this._getGoodsToBuyInTradePort(t),t.buyInTradePort=t.goodsToBuyInTradePort.length>0,t.goodsToSellInTradePort=this._getGoodsToSellInTradePort(t),t.sellInTradePort=t.goodsToSellInTradePort.length>0,t))).filter((t=>t.id===Qr(this,oo).portIcons.tradePort.id||t.sellInTradePort||t.buyInTradePort))}_selectSelected(){const t=String(Qr(this,so).getValues()),[e,i]=t.split("/"),[a,s]=e.split(",");Qr(this,oo).currentPort={id:Number(i),coord:{x:Number(a),y:Number(s)}},Qr(this,oo).portIcons.tradePort={id:Number(i),name:Jr(this,ho,uo).call(this,Number(i))},this._setTradePortPartners(),Qr(this,oo).showRadius="tradePorts",Qr(this,oo).map.goToPort(),Qr(this,oo).update()}}function uo(t){var e;return(null===(e=Qr(this,oo).portDataDefault.find((e=>e.id===t)))||void 0===e?void 0:e.name)??""}function po(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function wo(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,mo(t,e,"get"))}function vo(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,mo(t,e,"set"),i),i}function mo(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var fo=new WeakMap,go=new WeakMap,bo=new WeakMap,yo=new WeakMap,ko=new WeakMap,Mo=new WeakMap;class Wo{constructor(t){var e,i,a;po(this,fo,{writable:!0,value:{}}),po(this,go,{writable:!0,value:{}}),po(this,bo,{writable:!0,value:{}}),po(this,yo,{writable:!0,value:void 0}),po(this,ko,{writable:!0,value:"port-select-clan"}),po(this,Mo,{writable:!0,value:"port-select-nation"}),a=(t=!0)=>`${Ft.nU.filter((e=>!(!t&&("FT"===e.short||"NT"===e.short)))).sort((0,Ft.MR)(["name"])).map((t=>`<option data-icon="flag-icon-${t.short} flag-icon-small" value="${t.short}">${t.name}</option>`)).join("")}`,(i="_getNationOptions")in(e=this)?Object.defineProperty(e,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[i]=a,vo(this,yo,t),this._setupSelects(),this._setupListener()}_capsOn(){wo(this,go).classList.add("caps")}_capsOff(){wo(this,go).classList.remove("caps")}_setupNationSelect(){const t=this._getNationOptions(!0);vo(this,bo,new u.Z(wo(this,Mo),void 0,{dropupAuto:!1,liveSearch:!1,virtualScroll:!0},t))}_getClanOptions(){const t=new Set;for(const e of wo(this,yo).portData.filter((t=>t.capturer)))t.add(e.capturer);return t.size>0?`${[...t].sort(Ft.I4).map((t=>`<option value="${t}" class="caps">${t}</option>`)).join("")}`:""}_setupClanSelect(){var t,e;const i=this._getClanOptions();vo(this,fo,new u.Z(wo(this,ko),void 0,{dropupAuto:!1,liveSearch:!1,virtualScroll:!0},i)),vo(this,go,null===(t=wo(this,fo).select$.get(0))||void 0===t||null===(e=t.parentNode)||void 0===e?void 0:e.querySelector("button"))}_setupSelects(){this._setupNationSelect(),this._setupClanSelect()}_clanSelected(){const t=String(wo(this,fo).getValues());this._capsOn(),t&&(wo(this,yo).portData=wo(this,yo).portDataDefault.filter((e=>e.capturer===t))),wo(this,yo).showRadius="",wo(this,yo).update()}_clanRefresh(){const t=this._getClanOptions();this._capsOff(),wo(this,fo).setOptions(t),wo(this,fo).reset(),""===t?wo(this,fo).disable():wo(this,fo).enable()}_nationSelected(){const t=String(wo(this,bo).getValues());(0,Ft.mP)(t)&&(wo(this,yo).portData=wo(this,yo).portDataDefault.filter((e=>e.nation===t)),wo(this,yo).showRadius="",wo(this,yo).update())}_setupListener(){wo(this,fo).select$.on("change",(async()=>{(0,o.KS)("Menu",wo(this,Mo)),u.Z.resetAllExcept([wo(this,fo).select$,wo(this,bo).select$]),this._clanSelected()})),wo(this,bo).select$.on("change",(async()=>{(0,o.KS)("Menu",wo(this,ko)),u.Z.resetAllExcept([wo(this,fo).select$,wo(this,bo).select$]),this._nationSelected(),this._clanRefresh()}))}refreshSelect(){wo(this,bo).reset(),this._clanRefresh()}}function _o(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function So(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,xo(t,e,"get"))}function To(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,xo(t,e,"set"),i),i}function xo(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}ge().extend(ye()),ge().extend(Dr()),ge().extend(_e()),ge().locale("en-gb");var $o=new WeakMap,Po=new WeakMap;class Co{constructor(t){_o(this,$o,{writable:!0,value:void 0}),_o(this,Po,{writable:!0,value:void 0}),To(this,Po,t),new co(t),new Kr(t),To(this,$o,new Wo(t)),new Ar(t),this._setupListener()}_setupListener(){var t,e,i,a,s,n,r,o;null===(t=document.querySelector("#menu-prop-deep"))||void 0===t||t.addEventListener("click",(()=>{u.Z.resetAll(),this._depthSelected("deep")})),null===(e=document.querySelector("#menu-prop-shallow"))||void 0===e||e.addEventListener("click",(()=>{u.Z.resetAll(),this._depthSelected("shallow")})),null===(i=document.querySelector("#menu-prop-all"))||void 0===i||i.addEventListener("click",(()=>{u.Z.resetAll(),this._allSelected()})),null===(a=document.querySelector("#menu-prop-non-capturable"))||void 0===a||a.addEventListener("click",(()=>{u.Z.resetAll(),this._nonCapSelected()})),null===(s=document.querySelector("#menu-prop-today"))||void 0===s||s.addEventListener("click",(()=>{u.Z.resetAll(),this._capturedToday()})),null===(n=document.querySelector("#menu-prop-yesterday"))||void 0===n||n.addEventListener("click",(()=>{u.Z.resetAll(),this._capturedYesterday()})),null===(r=document.querySelector("#menu-prop-this-week"))||void 0===r||r.addEventListener("click",(()=>{u.Z.resetAll(),this._capturedThisWeek()})),null===(o=document.querySelector("#menu-prop-last-week"))||void 0===o||o.addEventListener("click",(()=>{u.Z.resetAll(),this._capturedLastWeek()})),(0,T.ye)("selectPortNavbar")}_depthSelected(t){const e=So(this,Po).portDataDefault.filter((e=>"shallow"===t?e.shallow:!e.shallow));So(this,Po).portData=e,So(this,Po).showRadius="",So(this,Po).update()}_allSelected(){const t=So(this,Po).portDataDefault.filter((t=>t.availableForAll));So(this,Po).portData=t,So(this,Po).showRadius="",So(this,Po).update()}_nonCapSelected(){const t=So(this,Po).portDataDefault.filter((t=>!t.capturable));So(this,Po).portData=t,So(this,Po).showRadius="",So(this,Po).update()}_filterCaptured(t,e){const i=So(this,Po).portDataDefault.filter((i=>ge()(i.captured,"YYYY-MM-DD HH:mm").isBetween(t,e,"hour","(]")));So(this,Po).portData=i,So(this,Po).showRadius="",So(this,Po).update()}_capturedToday(){const t=ge().utc();let e=ge()().utc().hour(h.WF).minute(0);t.hour()<e.hour()&&(e=e.subtract(1,"day")),this._filterCaptured(e,ge().utc(e).add(1,"day"))}_capturedYesterday(){const t=ge().utc();let e=ge()().utc().hour(h.WF).minute(0).subtract(1,"day");t.hour()<e.hour()&&(e=e.subtract(1,"day")),this._filterCaptured(e,ge().utc(e).add(1,"day"))}_capturedThisWeek(){const t=ge()().utc().startOf("week"),e=t.utc().hour(h.WF),i=ge()(t).utc().add(7,"day").hour(h.WF);this._filterCaptured(e,i)}_capturedLastWeek(){const t=ge()().utc().startOf("week"),e=ge()(t).utc().subtract(7,"day").hour(h.WF),i=t.utc().hour(h.WF);this._filterCaptured(e,i)}clearMap(){So(this,$o).refreshSelect()}}function Do(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function Eo(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Lo(t,e,"get"))}function Io(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Lo(t,e,"set"),i),i}function Lo(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var No=new WeakMap,Zo=new WeakMap,jo=new WeakMap,zo=new WeakMap,Ao=new WeakMap,Fo=new WeakMap,Bo=new WeakMap,Ro=new WeakMap;class qo extends bs.Z{constructor(t){super(t,"sm"),Do(this,No,{writable:!0,value:void 0}),Do(this,Zo,{writable:!0,value:void 0}),Do(this,jo,{writable:!0,value:void 0}),Do(this,zo,{writable:!0,value:void 0}),Do(this,Ao,{writable:!0,value:void 0}),Do(this,Fo,{writable:!0,value:{}}),Do(this,Bo,{writable:!0,value:void 0}),Do(this,Ro,{writable:!0,value:void 0}),Io(this,Zo,`${this.baseId}-form`),Io(this,zo,`${this.baseId}-input-x`),Io(this,Ao,`${this.baseId}-input-y`),Io(this,No,`${this.baseId}-copy-coord`),Io(this,jo,`${this.baseId}-submit`),this._init()}_init(){var t,e;this._injectModal(),Io(this,Bo,document.querySelector(`#${Eo(this,zo)}`)),Io(this,Ro,document.querySelector(`#${Eo(this,Ao)}`)),null===(t=document.querySelector(`#${this.id}`))||void 0===t||t.addEventListener("keydown",(t=>{"KeyC"===t.key&&t.ctrlKey&&this._copyCoordClicked(t)})),null===(e=document.querySelector(`#${Eo(this,No)}`))||void 0===e||e.addEventListener("click",(t=>{this._copyCoordClicked(t)}))}_injectModal(){const t=super.bodySel;super.removeFooter();const e=t.append("form").attr("id",Eo(this,Zo)).attr("role","form");Io(this,Fo,e.node());const i=e.append("div").attr("class","form-floating");i.append("input").attr("class","form-control").attr("id",Eo(this,zo)).attr("type","number").attr("required","").attr("placeholder","X coordinate in k").attr("min","-819").attr("max","819").attr("step","1").attr("tabindex","1"),i.append("label").attr("for",Eo(this,zo)).text("X coordinate in k");const a=e.append("div").attr("class","form-floating");a.append("input").attr("class","form-control").attr("id",Eo(this,Ao)).attr("type","number").attr("required","").attr("placeholder","Z coordinate in k").attr("step","1").attr("min","-819").attr("max","819").attr("tabindex","2"),a.append("label").attr("for",Eo(this,Ao)).text("Z coordinate in k"),e.append("div").attr("class","form-text mt-1 mb-3").html("In k units (divide by 1,000).<br>Example: <em>43</em> for value of <em>43,162.5</em>.");const s=e.append("div").classed("float-end",!0).attr("role","group");s.append("button").classed("btn btn-outline-secondary icon-outline-button",!0).attr("id",Eo(this,No)).attr("title","Copy to clipboard (ctrl-c)").attr("type","button").append("i").classed("icon icon-copy",!0),s.append("button").attr("class","btn").attr("id",Eo(this,jo)).attr("title","Go to").attr("type","submit").text("Go to")}_getInputValue(t){return null!=t&&t.value?Number(t.value):Number.POSITIVE_INFINITY}getXCoord(){return this._getInputValue(Eo(this,Bo))}getZCoord(){return this._getInputValue(Eo(this,Ro))}_copyCoordClicked(t){(0,o.KS)("Menu","Copy F11 coordinates"),t.preventDefault();const e=this.getXCoord(),i=this.getZCoord();(0,w.A1)(e,i,super.getModalNode())}showModal(){var t,e;super.show(),null===(t=Eo(this,Bo))||void 0===t||t.focus(),null===(e=Eo(this,Bo))||void 0===e||e.select()}get formSel(){return Eo(this,Fo)}}function Oo(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function Vo(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Go(t,e,"get"))}function Ho(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Go(t,e,"set"),i),i}function Go(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}ge().extend(ye()),ge().extend(_e());var Ko=new WeakMap,Yo=new WeakMap,Uo=new WeakMap,Jo=new WeakMap,Qo=new WeakMap,Xo=new WeakMap,tl=new WeakMap;class el{constructor(t,e){Oo(this,Ko,{writable:!0,value:void 0}),Oo(this,Yo,{writable:!0,value:"Go to F11"}),Oo(this,Uo,{writable:!0,value:void 0}),Oo(this,Jo,{writable:!0,value:void 0}),Oo(this,Qo,{writable:!0,value:void 0}),Oo(this,Xo,{writable:!0,value:{}}),Oo(this,tl,{writable:!0,value:void 0}),Ho(this,Jo,t),Ho(this,Uo,e),Ho(this,Ko,(0,T.MF)(Vo(this,Yo))),Ho(this,Qo,`menu-${Vo(this,Ko)}`),this._setupSvg(),this._setupListener()}_setupSvg(){Ho(this,Xo,(0,a.Z)("#map").append("g").attr("data-ui-component","f11"))}_menuClicked(){(0,o.KS)("Menu",Vo(this,Yo)),Vo(this,tl)?Vo(this,tl).showModal():(Ho(this,tl,new qo(Vo(this,Yo))),Vo(this,tl).formSel.addEventListener("submit",(t=>{Vo(this,tl).hide(),t.preventDefault(),this._useUserInput()})))}_setupListener(){var t;null===(t=document.querySelector(`#${Vo(this,Qo)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()})),window.addEventListener("keydown",(t=>{"F11"===t.code&&t.shiftKey&&this._menuClicked()}))}_useUserInput(){const t=-1e3*Vo(this,tl).getXCoord(),e=-1e3*Vo(this,tl).getZCoord();Number.isFinite(t)&&Number.isFinite(e)&&this._goToF11(t,e)}_printF11Coord(t,e,i,a){var s,n;let r=10;const o=Vo(this,Xo).append("g").attr("transform",`translate(${t},${e})`).attr("class","svg-background-dark fill-primary-light"),l=o.append("rect"),h=o.append("rect");o.append("circle").attr("r",r),r*=1.6;const c=o.append("text").attr("dx",-r+"px").attr("dy",-r/2-2+"px").attr("class","text-end").text((0,Ke.Hu)(i)),d=o.append("text").attr("dx",-r+"px").attr("dy",r/2+2+"px").attr("class","text-end").text((0,Ke.Hu)(a)),u=(null===(s=c.node())||void 0===s?void 0:s.getBBox())??{},p=(null===(n=d.node())||void 0===n?void 0:n.getBBox())??{},w=ge()().utc(),v=ge()(),m=o.append("text").attr("dx",`${r}px`).attr("dy",-r/2-2+"px").attr("class","f11-time").text(w.format("H.mm")),f=o.append("text").attr("dx",`${r}px`).attr("dy",r/2+2+"px").attr("class","f11-time").text(`(${v.format("H.mm")} local)`),g=m.node().getBBox()??{},b=f.node().getBBox()??{},y=u&&p?1.2*Math.round(u.height+p.height):0,k=u&&p?Math.round(Math.max(u.width,p.width)+5):0,M=1.2*Math.round(g.height+b.height),W=g&&b?Math.round(Math.max(g.width,b.width)+5):0,_=Math.max(y,M);l.attr("x",-k-r).attr("y",-_/2).attr("height",_).attr("width",k+r),h.attr("x",0).attr("y",-_/2).attr("height",_).attr("width",W+r)}_goToF11(t,e){const i=Math.floor((0,l._i)(t,e)),a=Math.floor((0,l.UY)(t,e));(0,l.vX)(i,Vo(this,Uo).min,Vo(this,Uo).max,!0)&&(0,l.vX)(a,Vo(this,Uo).min,Vo(this,Uo).max,!0)&&(this._printF11Coord(i,a,t,e),Vo(this,Jo).zoomAndPan(i,a))}goToF11FromParam(t){const e=-1e3*Number(t.get("x")),i=-1e3*Number(t.get("z"));Number.isFinite(e)&&Number.isFinite(i)&&((0,o.KS)("Menu","Paste F11 coordinates"),this._goToF11(e,i))}printCoord(t,e){const i=(0,l.IK)(t,e),a=(0,l.pw)(t,e);this._printF11Coord(t,e,i,a)}clearMap(){Vo(this,Xo).selectAll("*").remove()}}const il="trade-details",al=`${il}-head`,sl=t=>{t.classed("d-none",!1)},nl=t=>{t.classed("d-none",!0)},rl=t=>`<div><div>${t}</div>`,ol=t=>`<div class="des">${t}</div></div>`,ll=t=>`<div class="block-block"><span>${t}</span>`,hl=t=>`trade-${t.source.id}-${t.good}-${t.target.id}`,cl=t=>t.profitTotal/t.distance,dl=t=>0===t.weightPerItem?t.profitTotal:Math.round(t.profitTotal/(t.weightPerItem*t.quantity));function ul(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pl(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function wl(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,vl(t,e,"set"),i),i}function vl(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var ml=new WeakMap,fl=new WeakSet;class gl{constructor(t){var e,i;ul(e=this,i=fl),i.add(e),function(t,e,i){ul(t,e),e.set(t,i)}(this,ml,{writable:!0,value:void 0}),wl(this,ml,t)}set(t){const e=pl(this,fl,bl).call(this);e&&(e.checked=t)}get(){const t=pl(this,fl,bl).call(this);return!!t&&t.checked}}function bl(){return document.querySelector(`#${t=this,e=ml,function(t,e){return e.get?e.get.call(t):e.value}(t,vl(t,e,"get"))}`)??void 0;var t,e}function yl(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function kl(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Wl(t,e,"get"))}function Ml(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Wl(t,e,"set"),i),i}function Wl(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var _l=new WeakMap,Sl=new WeakMap,Tl=new WeakMap,xl=new WeakMap,$l=new WeakMap,Pl=new WeakMap;class Cl{constructor(t,e){yl(this,_l,{writable:!0,value:"Show good availability"}),yl(this,Sl,{writable:!0,value:void 0}),yl(this,Tl,{writable:!0,value:{}}),yl(this,xl,{writable:!0,value:!1}),yl(this,$l,{writable:!0,value:void 0}),yl(this,Pl,{writable:!0,value:void 0}),Ml(this,Pl,t),Ml(this,$l,e),Ml(this,Sl,`port-select-${(0,T.MF)(kl(this,_l))}`),this._setupSelect(),this._setupListener()}show(t){const e=kl(this,Tl).select$.get(0)??{};t?(e.classList.remove("d-none"),e.parentNode.classList.remove("d-none"),kl(this,Tl).setOptions(this._getOptions()),kl(this,Tl).reset()):(e.classList.add("d-none"),e.parentNode.classList.add("d-none"))}_getOptions(){const t=new Map;for(const i of kl(this,Pl).portDataDefault)if(i.inventory)for(const a of i.inventory){var e;t.set(a.id,(null===(e=kl(this,Pl).portIcons.getTradeItem(a.id))||void 0===e?void 0:e.name)??"")}return`${[...t].sort(((t,e)=>t[1].localeCompare(e[1]))).map((t=>`<option value="${t[0]}">${t[1]}</option>`)).join("")}`}_setupSelect(){const t={dropupAuto:!1,liveSearch:!0,title:kl(this,_l),virtualScroll:!0};Ml(this,Tl,new u.Z(kl(this,Sl),void 0,t,""))}_setupListener(){kl(this,Tl).select$.on("change",(()=>{(0,o.KS)("Menu",kl(this,_l)),u.Z.resetAllExcept([kl(this,Tl).select$]),this._selectSelected()}))}_getPortList(t,e,i){var a;let s="";if(s+=`<h5>${(null===(a=kl(this,Pl).portIcons.getTradeItem(t))||void 0===a?void 0:a.name)??""}</h5>`,e.size>0){s+="<h6>Buy</h6>";for(const[,t]of e)s+=`${t.name} <span class="flag-icon-${t.nation} flag-icon-small me-1" role="img"></span>: ${(0,Ke.yI)(t.good.buyQuantity)} @ ${(0,Ke.Pj)(t.good.buyPrice)}<br>`}if(e&&i&&(s+="<p></p>"),i.size>0){s+="<h6>Sell</h6>";for(const[,t]of i)s+=`${t.name} <span class="flag-icon-${t.nation} flag-icon-small me-1" role="img"></span>: ${(0,Ke.yI)(t.good.sellQuantity)} @ ${(0,Ke.Pj)(t.good.sellPrice)}<br>`}return s}_selectSelected(){const t=Number(kl(this,Tl).getValues()),e=new Map,i=new Map;Ml(this,xl,!0);const a=kl(this,Pl).portDataDefault.filter((e=>e.inventory.some((e=>e.id===t)))).sort((0,Ft.MR)(["name"])).map((a=>{const s=a.inventory.find((e=>e.id===t));return s&&(a.sellInTradePort=s.buyQuantity>0,a.sellInTradePort&&e.set(a.name,{name:a.name,nation:a.nation,good:s}),a.buyInTradePort=s.sellQuantity>0,a.buyInTradePort&&i.set(a.name,{name:a.name,nation:a.nation,good:s})),a}));kl(this,Pl).setShowRadiusSetting("off"),kl(this,Pl).portData=a,kl(this,Pl).showRadius="tradePorts","portList"!==kl(this,$l).list.listType&&(kl(this,$l).list.listType="portList"),kl(this,$l).update(this._getPortList(t,e,i)),kl(this,Pl).update()}get isInventorySelected(){return kl(this,xl)}reset(){kl(this,Tl).reset(),Ml(this,xl,!1)}}var Dl=i(9089),El=i(7808);function Il(t,e){Nl(t,e),e.add(t)}function Ll(t,e,i){Nl(t,e),e.set(t,i)}function Nl(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zl(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,zl(t,e,"get"))}function jl(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,zl(t,e,"set"),i),i}function zl(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function Al(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var Fl=new WeakMap,Bl=new WeakMap,Rl=new WeakMap,ql=new WeakMap,Ol=new WeakMap,Vl=new WeakMap,Hl=new WeakSet,Gl=new WeakSet,Kl=new WeakSet,Yl=new WeakSet,Ul=new WeakSet,Jl=new WeakSet,Ql=new WeakSet,Xl=new WeakSet,th=new WeakSet;class eh{constructor(){Il(this,th),Il(this,Xl),Il(this,Ql),Il(this,Jl),Il(this,Ul),Il(this,Yl),Il(this,Kl),Il(this,Gl),Il(this,Hl),Ll(this,Fl,{writable:!0,value:18}),Ll(this,Bl,{writable:!0,value:18}),Ll(this,Rl,{writable:!0,value:{}}),Ll(this,ql,{writable:!0,value:h.VJ}),Ll(this,Ol,{writable:!0,value:void 0}),Ll(this,Vl,{writable:!0,value:{}}),Al(this,Hl,ih).call(this)}set tradeData(t){jl(this,Vl,t)}update(t,e){jl(this,ql,e),Al(this,Ul,rh).call(this,void 0),Al(this,th,ch).call(this,t)}}function ih(){jl(this,Rl,(0,a.Z)("#map").insert("g","g.pb").attr("class","trades")),(0,a.Z)("#na-svg defs").append("marker").attr("id","trade-arrow").attr("refX",Zl(this,Fl)).attr("refY",Zl(this,Bl)/2).attr("markerWidth",20).attr("markerHeight",20).attr("markerUnits","userSpaceOnUse").attr("orient","auto-start-reverse").append("path").attr("d",`M0,0L0,${Zl(this,Bl)}L${Zl(this,Fl)},${Zl(this,Bl)/2}z`).attr("class","trade-arrow-head")}function ah(t){const e=t.weightPerItem*t.quantity,i=t.target.grossPrice-t.source.grossPrice,a=cl(t),s=dl(t);let n="";return n+=ll("Trade"),n+=rl(`${(0,Ke.yI)(t.quantity)} ${Zl(this,Vl).getItemName(t.good)}`)+ol("good"),n+=rl(`${(0,Ke.Pj)(t.source.grossPrice)}`)+ol("gross buy price"),n+=rl(`${(0,Ke.Pj)(t.target.grossPrice)}`)+ol("gross sell price"),n+=rl(`${(0,Ke.Dw)(e)} ${1===e?"ton":"tons"}`)+ol("weight"),n+="</div>",n+=ll("Profit"),n+=rl(`${(0,Ke.Pj)(t.profitTotal)}`)+ol("total"),n+=rl(`${(0,Ke.Pj)(i)}`)+ol("profit/item"),n+=rl(`${(0,Ke.Pj)(a)}`)+ol("profit/distance"),n+=rl(`${(0,Ke.Pj)(s)}`)+ol("profit/weight"),n+="</div>",n+=ll("Route"),n+=rl(`${Zl(this,Vl).getPortName(t.source.id)} <span class="flag-icon-${Zl(this,Vl).getPortNation(t.source.id)} flag-icon-small me-1" role="img"></span>`)+ol(`from ${Zl(this,Vl).getPortDepth(t.source.id)}`),n+=rl(`${Zl(this,Vl).getPortName(t.target.id)} <span class="flag-icon-${Zl(this,Vl).getPortNation(t.target.id)} flag-icon-small me-1" role="img"></span>`)+ol(`to ${Zl(this,Vl).getPortDepth(t.source.id)}`),n+=rl(`${(0,Ke.Dw)(t.distance)}`)+ol("distance"),n+="</div>",n}function sh(t,e){return Zl(this,Vl).data.filter((i=>i.source.id===t&&i.target.id===e||i.source.id===e&&i.target.id===t)).map((t=>t.profit??0))}function nh(t,e){jl(this,Ol,t.currentTarget),new(Oe())(Zl(this,Ol),{html:!0,placement:"auto",template:'<div class="tooltip" role="tooltip"><div class="tooltip-block tooltip-inner tooltip-inner-small"></div></div>',trigger:"manual",title:Al(this,Gl,ah).call(this,e),sanitize:!1}).show()}function rh(t){const e=t?t.currentTarget:Zl(this,Ol),i=Oe().getInstance(e);i&&i.dispose(),jl(this,Ol,void 0)}function oh(t){return{x:Zl(this,Vl).getPortXCoord(t),y:Zl(this,Vl).getPortYCoord(t)}}function lh(t,e){const i=Al(this,Jl,oh).call(this,e.source.id),a=Al(this,Jl,oh).call(this,e.target.id),s=t?i.x:a.x,n=t?i.y:a.y,r=t?a.x:i.x,o=t?a.y:i.y;let l=Math.sqrt((r-s)**2+(o-n)**2);const h=t?0:1,c=Al(this,Kl,sh).call(this,e.source.id,e.target.id);if(c.length>1){const t=(0,El.x)().domain(c).range([1,c.length]);l/=1+1/c.length*(t(e.profit??0)??-1)}return l=Math.round(l),`M${s},${n}A${l},${l} 0,0,${h} ${r},${o}`}function hh(t){return Zl(this,Vl).getPortXCoord(t.source.id)<Zl(this,Vl).getPortXCoord(t.target.id)}function ch(t){const e=t?[]:Zl(this,Vl).data.slice(0,30),i=(0,Dl.Z)(e,(t=>t.profit??0)),a=(0,n.Z)().range([5/Zl(this,ql),15/Zl(this,ql)]).domain(i);Zl(this,Rl).selectAll(".trade-link").data(e,(t=>hl(t))).join((t=>t.append("path").attr("class","trade-link").attr("marker-start",(t=>Al(this,Xl,hh).call(this,t)?"":"url(#trade-arrow)")).attr("marker-end",(t=>Al(this,Xl,hh).call(this,t)?"url(#trade-arrow)":"")).attr("id",(t=>hl(t))).on("click",((t,e)=>{Al(this,Yl,nh).call(this,t,e)})).on("mouseleave",(t=>{Al(this,Ul,rh).call(this,t)})))).attr("d",(t=>Al(this,Ql,lh).call(this,Al(this,Xl,hh).call(this,t),t))).attr("stroke-width",(t=>`${a(t.profit??0)??0}px`))}i(3863);function dh(t,e){ph(t,e),e.add(t)}function uh(t,e,i){ph(t,e),e.set(t,i)}function ph(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wh(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,mh(t,e,"set"),i),i}function vh(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,mh(t,e,"get"))}function mh(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function fh(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var gh=new WeakMap,bh=new WeakMap,yh=new WeakMap,kh=new WeakMap,Mh=new WeakMap,Wh=new WeakMap,_h=new WeakSet,Sh=new WeakSet,Th=new WeakSet,xh=new WeakSet,$h=new WeakSet;class Ph{constructor(){dh(this,$h),dh(this,xh),dh(this,Th),dh(this,Sh),dh(this,_h),uh(this,gh,{writable:!0,value:`${il}-card`}),uh(this,bh,{writable:!0,value:{}}),uh(this,yh,{writable:!0,value:"tradeList"}),uh(this,kh,{writable:!0,value:{}}),uh(this,Mh,{writable:!0,value:{}}),uh(this,Wh,{writable:!0,value:{}}),fh(this,_h,Ch).call(this)}get listType(){return vh(this,yh)}set listType(t){switch(wh(this,yh,t),vh(this,yh)){case"inventory":case"portList":vh(this,Wh).emptyLinkDataFiltered(),nl(vh(this,Mh)),vh(this,bh).remove(),wh(this,bh,vh(this,kh).append("div").attr("class","small p-2"));break;default:vh(this,Wh).resetData(),sl(vh(this,Mh)),vh(this,bh).remove(),wh(this,bh,vh(this,kh).append("div").attr("class","trade-list small"))}}get tradeDetailsDiv(){return vh(this,kh)}set tradeData(t){wh(this,Wh,t)}update(t,e){switch(vh(this,yh)){case"inventory":fh(this,Sh,Dh).call(this,e);break;case"portList":fh(this,Th,Eh).call(this,e);break;default:fh(this,$h,Lh).call(this,t)}}}function Ch(){wh(this,kh,(0,a.Z)("main #summary-column").append("div").attr("id",il).attr("class","trade-details")),wh(this,Mh,vh(this,kh).append("div").attr("id",al).attr("class","px-2")),vh(this,Mh).append("button").attr("type","button").attr("class","btn btn-small btn-outline-light my-2").attr("data-bs-toggle","collapse").attr("data-bs-target",`#${vh(this,gh)}`).attr("aria-expanded","false").text("Info"),vh(this,Mh).append("div").attr("id",vh(this,gh)).attr("class","collapse").append("div").attr("class","card card-body small mx-n2 px-2").text("Trade data is static (snapshot taken during maintenance). Therefore, price and/or quantity may not be available anymore. Data is limited as buy and sell prices at a certain port are only known when this port has this good in its inventory or a buy/sell contract. Better sell ports may be found using the in-game trader tool."),wh(this,bh,vh(this,kh).append("div").attr("class","trade-list small"))}function Dh(t){vh(this,bh).html(t??"")}function Eh(t){vh(this,bh).html(t??"")}function Ih(t){const e=t.weightPerItem*t.quantity;let i="";return i+=rl(`${(0,Ke.yI)(t.quantity)} ${vh(this,Wh).getItemName(t.good)}`)+ol("trade"),i+=rl(`${(0,Ke.Pj)(t.profit??0)}`)+ol(vh(this,Wh).profitText),i+=rl(`${(0,Ke.Dw)(e)} ${1===e?"ton":"tons"}`)+ol("weight"),i+=rl(`${vh(this,Wh).getPortName(t.source.id)} <span class="flag-icon-${vh(this,Wh).getPortNation(t.source.id)} flag-icon-small me-1" role="img"></span>`)+ol(`from ${vh(this,Wh).getPortDepth(t.source.id)}`),i+=rl(`${vh(this,Wh).getPortName(t.target.id)} <span class="flag-icon-${vh(this,Wh).getPortNation(t.target.id)} flag-icon-small me-1" role="img"></span>`)+ol(`to ${vh(this,Wh).getPortDepth(t.target.id)}`),i+=rl(`${(0,Ke.Dw)(t.distance)}`)+ol("sail distance"),i}function Lh(t){const e=t?[]:vh(this,Wh).data.slice(0,30);let i;vh(this,bh).selectAll("div.block").data(e,(t=>hl(t))).join((t=>t.append("div").attr("class","block px-2").on("mouseenter",(function(t,e){((t,e,s)=>{(0,a.Z)(t).classed("opacity-75",!0),i=(0,a.Z)(`path#${hl(s)}`).attr("class","highlight"),i.dispatch("click")})(this,0,e)})).on("mouseleave",(function(){var t;t=this,(0,a.Z)(t).classed("opacity-75",!1),i.classed("highlight",!1),i.dispatch("mouseleave")})))).html((t=>fh(this,xh,Ih).call(this,t)))}function Nh(t,e){jh(t,e),e.add(t)}function Zh(t,e,i){jh(t,e),e.set(t,i)}function jh(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zh(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function Ah(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Bh(t,e,"set"),i),i}function Fh(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Bh(t,e,"get"))}function Bh(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Rh=new WeakMap,qh=new WeakMap,Oh=new WeakMap,Vh=new WeakMap,Hh=new WeakMap,Gh=new WeakMap,Kh=new WeakMap,Yh=new WeakMap,Uh=new WeakMap,Jh=new WeakMap,Qh=new WeakMap,Xh=new WeakMap,tc=new WeakMap,ec=new WeakMap,ic=new WeakMap,ac=new WeakMap,sc=new WeakMap,nc=new WeakMap,rc=new WeakSet,oc=new WeakSet,lc=new WeakSet,hc=new WeakSet,cc=new WeakSet,dc=new WeakSet,uc=new WeakSet,pc=new WeakSet,wc=new WeakSet,vc=new WeakSet;class mc{constructor(t){Nh(this,vc),Nh(this,wc),Nh(this,pc),Nh(this,uc),Nh(this,dc),Nh(this,cc),Nh(this,hc),Nh(this,lc),Nh(this,oc),Nh(this,rc),Zh(this,Rh,{writable:!0,value:[]}),Zh(this,qh,{writable:!0,value:[]}),Zh(this,Oh,{writable:!0,value:[0,0]}),Zh(this,Vh,{writable:!0,value:new Map}),Zh(this,Hh,{writable:!0,value:[]}),Zh(this,Gh,{writable:!0,value:new Set}),Zh(this,Kh,{writable:!0,value:new Set}),Zh(this,Yh,{writable:!0,value:""}),Zh(this,Uh,{writable:!0,value:void 0}),Zh(this,Jh,{writable:!0,value:{}}),Zh(this,Qh,{writable:!0,value:void 0}),Zh(this,Xh,{writable:!0,value:new Map}),Zh(this,tc,{writable:!0,value:[h.zb,h.zb]}),Zh(this,ec,{writable:!0,value:"show-trades"}),Zh(this,ic,{writable:!0,value:void 0}),Zh(this,ac,{writable:!0,value:`${Fh(this,ec)}-profit`}),Zh(this,sc,{writable:!0,value:["weight","distance","total"]}),Zh(this,nc,{writable:!0,value:void 0}),Ah(this,Qh,t),Ah(this,ic,new c.Z({id:Fh(this,ac),values:Fh(this,sc)})),Ah(this,nc,new d.Z(Fh(this,ac),Fh(this,sc))),zh(this,oc,gc).call(this),zh(this,lc,bc).call(this),Ah(this,Uh,zh(this,hc,yc).call(this))}static getOptions(){return`${Ft.nU.map((t=>`<option data-icon="flag-icon-${t.short} flag-icon-small" value="${t.short}" selected></option>`)).join("")}`}get data(){return Fh(this,qh)}get profitId(){return Fh(this,ac)}get profitText(){return Fh(this,Yh)}get selectNation$(){return Fh(this,Jh).select$}getItemName(t){return Fh(this,Xh).get(t)??""}getPortName(t){var e;return(null===(e=Fh(this,Vh).get(t))||void 0===e?void 0:e.name)??""}getPortNation(t){var e;return(null===(e=Fh(this,Vh).get(t))||void 0===e?void 0:e.nation)??""}getPortDepth(t){return zh(this,rc,fc).call(this,t)?"(shallow)":"(deep)"}getPortXCoord(t){var e;return(null===(e=Fh(this,Vh).get(t))||void 0===e?void 0:e.x)??0}getPortYCoord(t){var e;return(null===(e=Fh(this,Vh).get(t))||void 0===e?void 0:e.y)??0}profitValueSelected(){Ah(this,Uh,Fh(this,nc).get()),Fh(this,ic).set(Fh(this,Uh)),zh(this,uc,Wc).call(this)}async loadAndSetupData(){await zh(this,cc,kc).call(this),zh(this,dc,Mc).call(this)}filterTradesByVisiblePorts(){Ah(this,qh,Fh(this,qh).filter((t=>Fh(this,Kh).has(t.source.id)||Fh(this,Kh).has(t.target.id))))}reset(){Fh(this,Jh).selectAll()}resetFilter(){this.resetData(),zh(this,wc,Sc).call(this),zh(this,pc,_c).call(this),this.filterTradesByVisiblePorts(),zh(this,uc,Wc).call(this)}emptyLinkDataFiltered(){Ah(this,qh,[])}resetData(){Ah(this,qh,Fh(this,Rh))}setBounds(t){Ah(this,Oh,t[0]),Ah(this,tc,t[1]),zh(this,vc,Tc).call(this)}}function fc(t){var e;return(null===(e=Fh(this,Vh).get(t))||void 0===e?void 0:e.isShallow)??!0}function gc(){const t=(0,a.Z)(`#${al}`).append("div").attr("id",Fh(this,ac)).attr("class","align-self-center radio-group pb-1");t.append("legend").attr("class","col-form-label pt-1 pb-0").text("Sort net profit by");for(const e of Fh(this,sc)){const i=`${Fh(this,ac)}-${e.replace(/ /g,"")}`,a=t.append("div").attr("class","custom-control custom-radio custom-control-inline");a.append("input").attr("id",i).attr("name",Fh(this,ac)).attr("type","radio").attr("class","custom-control-input").attr("value",e),a.append("label").attr("for",i).attr("class","custom-control-label").text(e)}}function bc(){const t={actionsBox:!0,countSelectedText:t=>`${t===Ft.nU.length?"All":String(t)} nations`,selectedTextFormat:"count > 1",title:"Select nations",width:"fit"};Ah(this,Jh,new u.Z(Fh(this,ec),al,t,mc.getOptions(),!0)),Fh(this,Jh).selectAll()}function yc(){const t=Fh(this,ic).get();switch(Fh(this,nc).set(t),t){case"weight":Ah(this,Yh,"profit/weight");break;case"distance":Ah(this,Yh,"profit/distance");break;case"total":Ah(this,Yh,"total");break;default:throw new Error("Wrong profit value")}return t}async function kc(){const t=await(0,T.qP)(`${Fh(this,Qh)}-pb.json`),e=(await i.e(462).then(i.t.bind(i,9131,19))).default;Ah(this,Hh,e.map((e=>{const i=t.find((t=>t.id===e.id));return{...e,...i}}))),Ah(this,Rh,await(0,T.qP)(`${Fh(this,Qh)}-trades.json`));const a=await(0,T.qP)(`${Fh(this,Qh)}-items.json`);Ah(this,Xh,new Map(a.map((t=>[t.id,t.name]))))}function Mc(){Ah(this,Vh,new Map(Fh(this,Hh).map((t=>[t.id,{name:t.name,nation:t.nation,isShallow:t.shallow,x:t.coordinates[0],y:t.coordinates[1]}])))),zh(this,vc,Tc).call(this),this.resetFilter()}function Wc(){Ah(this,qh,Fh(this,qh).map((t=>{switch(Fh(this,Uh)){case"weight":t.profit=dl(t);break;case"distance":t.profit=cl(t);break;case"total":t.profit=t.profitTotal;break;default:throw new Error(`Wrong profit value ${Fh(this,Uh)}`)}return t})).sort(((t,e)=>(e.profit??0)-(t.profit??0))))}function _c(){Ah(this,qh,Fh(this,qh).filter((t=>Fh(this,Gh).has(t.source.id)&&Fh(this,Gh).has(t.target.id))))}function Sc(){const t=new Set(Fh(this,Jh).getValues()??[]);Ah(this,Gh,new Set(Fh(this,Hh).filter((e=>t.has(e.nation))).map((t=>t.id))))}function Tc(){Ah(this,Kh,new Set(Fh(this,Hh).filter((t=>t.coordinates[0]>=Fh(this,Oh)[0]&&t.coordinates[0]<=Fh(this,tc)[0]&&t.coordinates[1]>=Fh(this,Oh)[1]&&t.coordinates[1]<=Fh(this,tc)[1])).map((t=>t.id))))}function xc(t,e){Cc(t,e),e.add(t)}function $c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Pc(t,e,i){Cc(t,e),e.set(t,i)}function Cc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dc(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function Ec(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Lc(t,e,"get"))}function Ic(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Lc(t,e,"set"),i),i}function Lc(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Nc=new WeakMap,Zc=new WeakMap,jc=new WeakMap,zc=new WeakMap,Ac=new WeakMap,Fc=new WeakMap,Bc=new WeakMap,Rc=new WeakMap,qc=new WeakMap,Oc=new WeakMap,Vc=new WeakMap,Hc=new WeakSet,Gc=new WeakSet,Kc=new WeakSet,Yc=new WeakSet,Uc=new WeakSet,Jc=new WeakSet;class Qc{constructor(t,e){xc(this,Jc),xc(this,Uc),xc(this,Yc),xc(this,Kc),xc(this,Gc),xc(this,Hc),Pc(this,Nc,{writable:!0,value:{}}),Pc(this,Zc,{writable:!0,value:void 0}),Pc(this,jc,{writable:!0,value:!1}),Pc(this,zc,{writable:!0,value:void 0}),Pc(this,Ac,{writable:!0,value:1}),Pc(this,Fc,{writable:!0,value:void 0}),Pc(this,Bc,{writable:!0,value:{}}),$c(this,"list",{}),Pc(this,Rc,{writable:!0,value:void 0}),Pc(this,qc,{writable:!0,value:"show-trades"}),Pc(this,Oc,{writable:!0,value:[String(!1),String(!0)]}),Pc(this,Vc,{writable:!0,value:void 0}),$c(this,"show",void 0),Ic(this,zc,t),Ic(this,Fc,e),Ic(this,Rc,new c.Z({id:Ec(this,qc),values:Ec(this,Oc)})),Ic(this,Vc,new gl(Ec(this,qc))),Dc(this,Hc,Xc).call(this),this.show=Dc(this,Gc,td).call(this)}async init(){this.show&&!Ec(this,jc)&&(await Dc(this,Yc,id).call(this),Ic(this,jc,!0))}update(t){Ec(this,Zc)&&(this.list.update(Ec(this,Zc).isInventorySelected,t),Ec(this,Nc).update(Ec(this,Zc).isInventorySelected,Ec(this,Ac)))}transform(t){Ic(this,Ac,t.k),this.show&&this.update()}clearMap(){this.show&&(this.list.listType="tradeList",Ec(this,Zc)&&Ec(this,Zc).reset(),Ec(this,Bc).reset(),this.update())}setBounds(t){this.show&&Ec(this,Bc).setBounds(t)}}function Xc(){var t;null===(t=document.querySelector(`#${Ec(this,qc)}`))||void 0===t||t.addEventListener("click",(async()=>{Dc(this,Uc,ad).call(this)}))}function td(){const t="true"===Ec(this,Rc).get();return Ec(this,Vc).set(t),t}function ed(){var t;null===(t=document.querySelector(`#${Ec(this,Bc).profitId}`))||void 0===t||t.addEventListener("change",(()=>{Dc(this,Jc,sd).call(this)})),Ec(this,Bc).selectNation$.on("change",(()=>{Ec(this,Bc).resetFilter(),this.update()}))}async function id(){this.list=new Ph,Ic(this,Nc,new eh),Ic(this,Bc,new mc(Ec(this,Fc))),Ic(this,Zc,new Cl(Ec(this,zc),this)),Dc(this,Kc,ed).call(this),await Ec(this,Bc).loadAndSetupData(),Ec(this,Zc).show(this.show),this.list.tradeData=Ec(this,Bc),Ec(this,Nc).tradeData=Ec(this,Bc)}async function ad(){var t;this.show=Ec(this,Vc).get(),Ec(this,Rc).set(String(this.show)),await this.init(),null===(t=Ec(this,Zc))||void 0===t||t.show(this.show),this.show?(sl(this.list.tradeDetailsDiv),Ec(this,Bc).reset()):(nl(this.list.tradeDetailsDiv),Ec(this,Bc).emptyLinkDataFiltered()),this.update()}function sd(){Ec(this,Bc).profitValueSelected(),this.update()}const nd=t=>t*t,rd=t=>Math.sqrt(nd(t.x)+nd(t.y)+nd(t.z)),od=(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,ld=(t,e)=>({x:t.x-e.x,y:t.y-e.y,z:t.z-e.z}),hd=(t,e)=>({x:t.x+e.x,y:t.y+e.y,z:t.z+e.z}),cd=(t,e)=>({x:t.x/e,y:t.y/e,z:t.z/e}),dd=(t,e)=>({x:t.x*e,y:t.y*e,z:t.z*e});var ud=i(5311);function pd(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function wd(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,md(t,e,"get"))}function vd(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,md(t,e,"set"),i),i}function md(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var fd=new WeakMap,gd=new WeakMap,bd=new WeakMap,yd=new WeakMap,kd=new WeakMap,Md=new WeakMap,Wd=new WeakMap;class _d extends bs.Z{constructor(t,e){super(t,"md","Set"),pd(this,fd,{writable:!0,value:void 0}),pd(this,gd,{writable:!0,value:3}),pd(this,bd,{writable:!0,value:void 0}),pd(this,yd,{writable:!0,value:[]}),pd(this,kd,{writable:!0,value:[]}),pd(this,Md,{writable:!0,value:[]}),pd(this,Wd,{writable:!0,value:[]}),vd(this,bd,e),vd(this,fd,Array.from({length:wd(this,gd)},((t,e)=>e))),this._init()}_init(){for(const t of wd(this,fd))wd(this,Md)[t]=`${super.baseId}-${t}-select`,wd(this,yd)[t]=`${super.baseId}-${t}-input`;this._injectModal(),this._setupSelects()}_injectModal(){const t=super.bodySel,e=t.append("form"),i=e.append("datalist").attr("id","defaultDistances");for(const t of[5,10,15,20,30,50,100,200])i.append("option").attr("value",t);for(const t of wd(this,fd)){const i=e.append("div").attr("class","row mb-4");i.append("div").attr("class","col-md-6").append("label").attr("class","col-form-label").append("select").attr("name",wd(this,Md)[t]).attr("id",wd(this,Md)[t]).attr("class","selectpicker");const a=i.append("div").attr("class","col-md-6 form-floating"),s=a.append("input").attr("id",wd(this,yd)[t]).attr("name",wd(this,yd)[t]).attr("type","number").attr("class","form-control").attr("placeholder","Distance in k").attr("step",1).attr("list","defaultDistances").attr("min",0).attr("max",1e3);a.append("label").attr("for",wd(this,yd)[t]).attr("class","ps-4").text("Distance in k"),wd(this,kd)[t]=s.node()}t.append("div").attr("class","form-text mt-3").text("Distances from in-game trader tool.")}_setupSelects(){const t=`${wd(this,bd).map((t=>({id:t.id,name:t.name,nation:t.nation}))).sort((0,Ft.MR)(["name"])).map((t=>`<option data-subtext="${t.nation}">${t.name}</option>`)).join("")}`;for(const e of wd(this,fd))wd(this,Wd)[e]=document.querySelector(`#${wd(this,Md)[e]}`),wd(this,Wd)[e]&&(wd(this,Wd)[e].insertAdjacentHTML("beforeend",t),ud(wd(this,Wd)[e]).selectpicker({dropupAuto:!1,liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",title:"Select port",virtualScroll:!0}))}get ids(){return wd(this,fd)}get numberOfInputs(){return wd(this,gd)}getPort(t){const e=wd(this,Wd)[t];return e.selectedIndex?e.options[e.selectedIndex].text:""}getDistance(t){return Number(wd(this,kd)[t].value)}}var Sd=i(2776),Td=i.n(Sd);function xd(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function $d(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Cd(t,e,"get"))}function Pd(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Cd(t,e,"set"),i),i}function Cd(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Dd=new WeakMap,Ed=new WeakMap,Id=new WeakMap,Ld=new WeakMap,Nd=new WeakMap;class Zd{constructor(t,e){xd(this,Dd,{writable:!0,value:void 0}),xd(this,Ed,{writable:!0,value:void 0}),xd(this,Id,{writable:!0,value:1e4}),xd(this,Ld,{writable:!0,value:{}}),xd(this,Nd,{writable:!0,value:{}}),Pd(this,Dd,t),Pd(this,Ed,e),Pd(this,Nd,(0,a.Z)("#toast-column")),this._set(),this._show()}_set(){Pd(this,Ld,$d(this,Nd).append("div").attr("class","toast").attr("role","alert").attr("aria-live","assertive").attr("aria-atomic","true"));const t=$d(this,Ld).append("div").attr("class","toast-header");t.append("img").attr("class","rounded me-2").attr("height","48px").attr("width","48px").attr("src",T.vU).attr("alt","logo"),t.append("em").attr("class","me-auto").html($d(this,Dd)),t.append("button").attr("type","button").attr("class","btn-close").attr("data-bs-dismiss","toast").attr("aria-label","Close"),$d(this,Ld).append("div").attr("class","toast-body").html($d(this,Ed))}_show(){const t=$d(this,Ld).node();new(Td())(t,{delay:$d(this,Id)}).show()}}function jd(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function zd(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Fd(t,e,"get"))}function Ad(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Fd(t,e,"set"),i),i}function Fd(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Bd=new WeakMap,Rd=new WeakMap,qd=new WeakMap,Od=new WeakMap,Vd=new WeakMap,Hd=new WeakMap;class Gd{constructor(t){jd(this,Bd,{writable:!0,value:void 0}),jd(this,Rd,{writable:!0,value:"Get position"}),jd(this,qd,{writable:!0,value:void 0}),jd(this,Od,{writable:!0,value:1.04}),jd(this,Vd,{writable:!0,value:void 0}),jd(this,Hd,{writable:!0,value:void 0}),Ad(this,Hd,t),Ad(this,Bd,(0,T.MF)(zd(this,Rd))),Ad(this,qd,`menu-${zd(this,Bd)}`),this._setupListener()}_menuClicked(){(0,o.KS)("Menu",zd(this,Rd)),zd(this,Vd)?zd(this,Vd).show():(Ad(this,Vd,new _d(zd(this,Rd),zd(this,Hd).portDataDefault)),zd(this,Vd).getModalNode().addEventListener("hidden.bs.modal",(()=>{this._useUserInput()})))}_setupListener(){var t;null===(t=document.querySelector(`#${zd(this,qd)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_showAndGoToPosition(){const t=zd(this,Hd).portData.map((t=>({x:t.coordinates[0],y:t.coordinates[1],z:0,r:t.distance??0}))),e=((t,e,i,a=!1)=>{const s=cd(ld(e,t),rd(ld(e,t))),n=od(s,ld(i,t));let r=ld(ld(i,t),dd(s,n));const o=cd(r,rd(r)),l=((t,e)=>({x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}))(s,o),h=rd(ld(e,t)),c=od(o,ld(i,t)),d=(nd(t.r)-nd(e.r)+nd(h))/(2*h),u=(nd(t.r)-nd(i.r)+nd(n)+nd(c))/(2*c)-n/c*d;let p=nd(t.r)-nd(d)-nd(u);Math.abs(p)<1e-10&&(p=0);const w=Math.sqrt(p);if(Number.isNaN(w))return;r=hd(t,hd(dd(s,d),dd(o,u)));const v=hd(r,dd(l,w)),m=ld(r,dd(l,w));return 0===w||a?r:[v,m]})(t[0],t[1],t[2],!0);if(e){e.x=Math.round(e.x),e.y=Math.round(e.y),zd(this,Hd).map.f11.printCoord(e.x,e.y),zd(this,Hd).map.zoomAndPan(e.x,e.y);const t=Math.round((0,l.IK)(e.x,e.y)/-1e3),i=Math.round((0,l.pw)(e.x,e.y)/-1e3);(0,w.A1)(t,i,zd(this,Vd).getModalNode()),new Zd(zd(this,Rd),"Coordinates copied to clipboard.")}else new Zd(zd(this,Rd),"No intersection found.")}_useUserInput(){const t=new Map;for(const e of zd(this,Vd).ids){const i=zd(this,Vd).getPort(e),a=zd(this,Vd).getDistance(e);a&&""!==i&&t.set(i,a*zd(this,Od)*T.ZE)}t.size===zd(this,Vd).numberOfInputs?(zd(this,Hd).setShowRadiusSetting("position"),zd(this,Hd).portData=zd(this,Hd).portDataDefault.filter((e=>t.has(e.name))).map((e=>(e.distance=t.get(e.name),e))),zd(this,Hd).update(),this._showAndGoToPosition()):new Zd(zd(this,Rd),"Not enough data.")}}function Kd(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function Yd(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Jd(t,e,"get"))}function Ud(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Jd(t,e,"set"),i),i}function Jd(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var Qd=new WeakMap,Xd=new WeakMap,tu=new WeakMap;class eu extends bs.Z{constructor(t){super(t,"sm","Set"),Kd(this,Qd,{writable:!0,value:void 0}),Kd(this,Xd,{writable:!0,value:void 0}),Kd(this,tu,{writable:!0,value:{}}),Ud(this,Qd,`input-group-${this.baseId}`),Ud(this,Xd,`input-${this.baseId}`),this._init()}_init(){this._injectModal()}_injectModal(){const t=super.bodySel;Ud(this,tu,new ys.Z(t,this.baseId))}getTime(){return document.querySelector(`#${Yd(this,Xd)}`).value.trim()}getWind(){return Yd(this,tu).getWind()}}function iu(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function au(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,nu(t,e,"get"))}function su(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,nu(t,e,"set"),i),i}function nu(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}ge().extend(_e());var ru=new WeakMap,ou=new WeakMap,lu=new WeakMap;class hu{constructor(t){iu(this,ru,{writable:!0,value:void 0}),iu(this,ou,{writable:!0,value:void 0}),iu(this,lu,{writable:!0,value:void 0}),su(this,ru,t),su(this,lu,new c.Z({id:`${au(this,ru)}-degrees`,expire:this._getExpire()})),su(this,ou,new c.Z({id:`${au(this,ru)}-time`}))}_getExpire(){return(0,Ft.Vk)()}_getNow(){return ge()().utc().unix()}get(){const t=au(this,lu).get(),e=au(this,ou).get();if(t&&e){const i=Number(t),a=Number(e),s=Math.round(this._getNow()-a);return 360+Math.floor(i-T.er*s)%360}return this.remove(),Number.NaN}set(t){au(this,lu).set(String(t)),au(this,ou).set(String(this._getNow()))}remove(){au(this,lu).remove(),au(this,ou).remove()}}function cu(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function du(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,pu(t,e,"get"))}function uu(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,pu(t,e,"set"),i),i}function pu(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var wu=new WeakMap,vu=new WeakMap,mu=new WeakMap,fu=new WeakMap,gu=new WeakMap,bu=new WeakMap,yu=new WeakMap,ku=new WeakMap,Mu=new WeakMap,Wu=new WeakMap,_u=new WeakMap,Su=new WeakMap,Tu=new WeakMap,xu=new WeakMap,$u=new WeakMap,Pu=new WeakMap,Cu=new WeakMap,Du=new WeakMap,Eu=new WeakMap,Iu=new WeakMap,Lu=new WeakMap;class Nu{constructor(){cu(this,wu,{writable:!0,value:void 0}),cu(this,vu,{writable:!0,value:void 0}),cu(this,mu,{writable:!0,value:{}}),cu(this,fu,{writable:!0,value:void 0}),cu(this,gu,{writable:!0,value:(0,a.Z)("#port-summary")}),cu(this,bu,{writable:!0,value:void 0}),cu(this,yu,{writable:!0,value:"In-game wind"}),cu(this,ku,{writable:!0,value:void 0}),cu(this,Mu,{writable:!0,value:void 0}),cu(this,Wu,{writable:!0,value:void 0}),cu(this,_u,{writable:!0,value:void 0}),cu(this,Su,{writable:!0,value:void 0}),cu(this,Tu,{writable:!0,value:void 0}),cu(this,xu,{writable:!0,value:void 0}),cu(this,$u,{writable:!0,value:void 0}),cu(this,Pu,{writable:!0,value:"wind-arrow"}),cu(this,Cu,{writable:!0,value:4}),cu(this,Du,{writable:!0,value:void 0}),cu(this,Eu,{writable:!0,value:void 0}),cu(this,Iu,{writable:!0,value:void 0}),cu(this,Lu,{writable:!0,value:void 0}),uu(this,bu,(0,T.MF)(du(this,yu))),uu(this,Lu,`menu-${du(this,bu)}`),uu(this,Iu,(0,gs.Z)().x((t=>t[0])).y((t=>t[1]))),uu(this,Eu,40),uu(this,Du,new hu(du(this,bu))),uu(this,Mu,du(this,Du).get()),this._setupArrow(),this._setupListener(),Number.isNaN(du(this,Mu))?new Zd("Hint","Get the wind direction:<br>Use <em>In-game wind</em> under <em>Map tools</em>."):this._initShowCurrentWind()}_menuClicked(){(0,o.KS)("Menu",du(this,yu)),du(this,vu)?du(this,vu).show():(uu(this,vu,new eu(du(this,yu))),du(this,vu).getModalNode().addEventListener("hidden.bs.modal",(()=>{this._useUserInput()})))}_setupArrow(){const t=du(this,Cu),e=2*du(this,Cu);(0,a.Z)("#na-svg defs").append("marker").attr("id",du(this,Pu)).attr("viewBox",`0 -${t} ${e} ${e}`).attr("refX",t).attr("refY",0).attr("markerWidth",t).attr("markerHeight",t).attr("orient","auto").append("path").attr("class","fill-contrast-text").attr("d",`M0,-${t}L${e},0L0,${t}`)}_setupListener(){var t;null===(t=document.querySelector(`#${du(this,Lu)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_windChange(){uu(this,Mu,360+(du(this,Mu)-T.er*du(this,Eu))%360),this._updateWindDirection()}_useUserInput(){uu(this,Mu,du(this,vu).getWind()),du(this,fu)?this._updateWindDirection():this._initShowCurrentWind()}_toggle(t){du(this,gu).classed("port-summary-no-wind",!t).classed("port-summary-wind",t)}_show(){this._toggle(!0)}_hide(){this._toggle(!1)}_setupSvg(){this._show(),uu(this,wu,du(this,gu).insert("div",":first-child").attr("id",du(this,bu)).attr("class","block p-0 pe-2")),uu(this,mu,du(this,wu).append("svg").attr("class","small svg-background-light stroke-thick"))}_initShowCurrentWind(){this._setupSvg(),this._initPrintCompassRose(),this._updateWindDirection(),uu(this,_u,window.setInterval((()=>{this._windChange()}),1e3*du(this,Eu)))}_updateWindDirection(){const t=(0,l.Ht)(du(this,Mu)),e=du(this,Su)*Math.cos(t),i=du(this,Su)*Math.sin(t),a=[[Math.round(du(this,xu)+e),Math.round(du(this,$u)+i)],[Math.round(du(this,xu)-e),Math.round(du(this,$u)-i)]];du(this,fu)&&(du(this,fu).datum(a).attr("d",du(this,Iu)),du(this,Du).set(du(this,Mu)))}_getHeight(){const t=document.querySelector("#port-summary .block");if(t){const{height:e,top:i}=t.getBoundingClientRect(),a=Number.parseFloat(window.getComputedStyle(t).getPropertyValue("padding-top")),s=Number.parseFloat(window.getComputedStyle(t).getPropertyValue("padding-bottom"));return Math.floor(e-i-a-s)}return 0}_initPrintCompassRose(){uu(this,Wu,this._getHeight()),uu(this,$u,du(this,Wu)/2),uu(this,Tu,du(this,Wu)),uu(this,xu,du(this,Tu)/2),uu(this,ku,Math.min(du(this,Wu),du(this,Tu))/2),uu(this,Su,.6*du(this,ku)),du(this,mu).attr("height",du(this,Wu)).attr("width",du(this,Tu));const t=du(this,mu).append("svg").attr("ui-component","compass").attr("class","fill-background-light").attr("x",du(this,xu)).attr("y",du(this,$u));(0,w.ec)({element:t,radius:du(this,ku)}),uu(this,fu,du(this,mu).append("path").attr("class","svg-stroke-thick").attr("marker-end","url(#wind-arrow)"))}clearMap(){window.clearInterval(du(this,_u)),this._hide(),du(this,wu)&&du(this,wu).remove(),uu(this,fu,void 0),du(this,Du).remove()}}function Zu(t,e){ju(t,e),e.add(t)}function ju(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zu(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Fu(t,e,"get"))}function Au(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Fu(t,e,"set"),i),i}function Fu(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function Bu(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var Ru=new WeakMap,qu=new WeakSet,Ou=new WeakSet,Vu=new WeakSet;class Hu{constructor(){var t,e,i;Zu(this,Vu),Zu(this,Ou),Zu(this,qu),i={writable:!0,value:void 0},ju(t=this,e=Ru),e.set(t,i),Bu(this,qu,Gu).call(this)}}function Gu(){var t;null===(t=document.querySelector("#about"))||void 0===t||t.addEventListener("click",(()=>{Bu(this,Vu,Yu).call(this)}))}function Ku(){Au(this,Ru,new bs.Z(`${T.xw} <span class="text-primary small">v${T.f4}</span>`,"lg"));zu(this,Ru).bodySel.html(`<p>${T.FB} Please check the <a href="https://forum.game-labs.net/topic/23980-yet-another-map-naval-action-map/">Game-Labs forum post</a> for further details. Feedback is very welcome.</p>\n                    <p>Designed by iB aka Felix Victor, <em>Bastards</em> clan ${(0,w.Mo)("(BASTD)")}</a>.</p>\n                    <div class="alert alert-secondary" role="alert"><h5 class="alert-heading">Did you know?</h5><p class="mb-0">My clan mate, Aquillas, wrote a most comprehensive <a href="https://drive.google.com/file/d/1PGysQwYg6aCQKq1dJQWtlc443IdO_drG/view">user guide</a>.</p></div>`)}function Yu(){zu(this,Ru)?zu(this,Ru).show():Bu(this,Ou,Ku).call(this)}var Uu=i(3743);function Ju(t,e,i){Qu(t,e),e.set(t,i)}function Qu(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xu(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,ep(t,e,"get"))}function tp(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,ep(t,e,"set"),i),i}function ep(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var ip=new WeakMap,ap=new WeakMap,sp=new WeakMap,np=new WeakMap,rp=new WeakMap,op=new WeakMap,lp=new WeakSet;class hp{constructor(t,e){var i,a;Qu(i=this,a=lp),a.add(i),Ju(this,ip,{writable:!0,value:0}),Ju(this,ap,{writable:!0,value:new Map}),Ju(this,sp,{writable:!0,value:{}}),Ju(this,np,{writable:!0,value:{}}),Ju(this,rp,{writable:!0,value:{}}),Ju(this,op,{writable:!0,value:void 0}),tp(this,op,(0,Uu.Z)().extent([[0,0],[t,e]]).tileSize(h.i9))}get mapTileTransform(){return Xu(this,np)}setupSvg(){const t=(0,a.Z)("#na-map svg");tp(this,sp,t.insert("g","#map").attr("class","map-tiles")),tp(this,rp,Xu(this,sp).selectAll("image"))}drawMap(t){const e=t.k<=h.DK?0:Math.log2(h.DK)-Math.log2(t.k);Xu(this,op).zoomDelta(e);const i=Xu(this,op).call(this,t);tp(this,np,r.CR.scale(i.scale).translate(i.translate[0],i.translate[1])),Xu(this,sp).attr("transform",Xu(this,np).toString());const a=i.map((([t,e,i])=>[`${i}/${e}/${t}`,[t,e]]));if(t.k!==Xu(this,ip))tp(this,ip,t.k),Xu(this,rp).selectAll("image").remove(),tp(this,ap,new Map(a));else{const t=new Map([...a,...Xu(this,ap)]);tp(this,ap,t)}(function(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i})(this,lp,cp).call(this,Xu(this,ap))}}function cp(t){tp(this,rp,Xu(this,rp).data([...t].sort(),(([t])=>t)).join((t=>t.append("image").attr("xlink:href",(([t])=>`images/map/${t}.webp`)).attr("x",(([,[t]])=>t)).attr("y",(([,[,t]])=>t)).attr("width",1).attr("height",1))))}function dp(t,e){wp(t,e),e.add(t)}function up(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function pp(t,e,i){wp(t,e),e.set(t,i)}function wp(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vp(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function mp(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,gp(t,e,"get"))}function fp(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,gp(t,e,"set"),i),i}function gp(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var bp=new WeakMap,yp=new WeakMap,kp=new WeakMap,Mp=new WeakMap,Wp=new WeakMap,_p=new WeakMap,Sp=new WeakMap,Tp=new WeakMap,xp=new WeakMap,$p=new WeakMap,Pp=new WeakMap,Cp=new WeakMap,Dp=new WeakMap,Ep=new WeakMap,Ip=new WeakMap,Lp=new WeakMap,Np=new WeakMap,Zp=new WeakMap,jp=new WeakMap,zp=new WeakMap,Ap=new WeakSet,Fp=new WeakSet,Bp=new WeakSet,Rp=new WeakSet,qp=new WeakSet,Op=new WeakSet,Vp=new WeakSet,Hp=new WeakSet,Gp=new WeakSet,Kp=new WeakSet,Yp=new WeakSet,Up=new WeakSet,Jp=new WeakSet,Qp=new WeakSet,Xp=new WeakSet,tw=new WeakSet,ew=new WeakSet,iw=new WeakSet,aw=new WeakSet,sw=new WeakSet,nw=new WeakSet,rw=new WeakSet,ow=new WeakSet,lw=new WeakSet,hw=new WeakSet;class cw{constructor(t,e){dp(this,hw),dp(this,lw),dp(this,ow),dp(this,rw),dp(this,nw),dp(this,sw),dp(this,aw),dp(this,iw),dp(this,ew),dp(this,tw),dp(this,Xp),dp(this,Qp),dp(this,Jp),dp(this,Up),dp(this,Yp),dp(this,Kp),dp(this,Gp),dp(this,Hp),dp(this,Vp),dp(this,Op),dp(this,qp),dp(this,Rp),dp(this,Bp),dp(this,Fp),dp(this,Ap),pp(this,bp,{writable:!0,value:0}),pp(this,yp,{writable:!0,value:void 0}),pp(this,kp,{writable:!0,value:[[0,0],[h.zb,h.zb]]}),pp(this,Mp,{writable:!0,value:void 0}),pp(this,Wp,{writable:!0,value:{}}),pp(this,_p,{writable:!0,value:void 0}),pp(this,Sp,{writable:!0,value:void 0}),pp(this,Tp,{writable:!0,value:void 0}),pp(this,xp,{writable:!0,value:void 0}),pp(this,$p,{writable:!0,value:void 0}),pp(this,Pp,{writable:!0,value:0}),pp(this,Cp,{writable:!0,value:void 0}),pp(this,Dp,{writable:!0,value:{}}),pp(this,Ep,{writable:!0,value:void 0}),pp(this,Ip,{writable:!0,value:(0,n.Z)().domain([0,h.zb])}),up(this,"coord",void 0),up(this,"f11",void 0),up(this,"height",0),pp(this,Lp,{writable:!0,value:void 0}),pp(this,Np,{writable:!0,value:void 0}),pp(this,Zp,{writable:!0,value:void 0}),pp(this,jp,{writable:!0,value:void 0}),pp(this,zp,{writable:!0,value:void 0}),up(this,"rem",l.jo),up(this,"serverName",void 0),up(this,"showTrades",void 0),up(this,"width",0),this.serverName=t,fp(this,zp,e),this.coord={min:0,max:h.zb},fp(this,Np,"double-click-action"),fp(this,jp,["compass","f11"]),fp(this,Lp,new c.Z({id:mp(this,Np),values:mp(this,jp)})),fp(this,Zp,new d.Z(mp(this,Np),mp(this,jp))),fp(this,yp,vp(this,Ap,dw).call(this)),vp(this,rw,Dw).call(this),fp(this,$p,new hp(this.width,this.height)),vp(this,qp,vw).call(this),vp(this,Op,mw).call(this)}async MapInit(){await vp(this,Fp,uw).call(this)}get zoomLevel(){return mp(this,Ep)}set zoomLevel(t){fp(this,Ep,t),mp(this,Tp).zoomLevel=t}getDimensions(){return document.querySelectorAll(".overlay")[0].getBoundingClientRect()}zoomAndPan(t,e,i=!1){const a=i?(0,l.XH)(Math.min(this.width,this.height)):h.mE;mp(this,Ip).range([a/2,-a/2]);const s=mp(this,Ip).call(this,t)+this.width/2,n=mp(this,Ip).call(this,e)+this.height/2;vp(this,lw,Iw).call(this,s,n,a)}goToPort(){0===mp(this,Tp).currentPort.id?vp(this,hw,Lw).call(this):this.zoomAndPan(mp(this,Tp).currentPort.coord.x,mp(this,Tp).currentPort.coord.y)}}function dw(){const t=mp(this,Lp).get();return mp(this,Zp).set(t),t}async function uw(){fp(this,Tp,new vs(this)),await mp(this,Tp).init(),fp(this,_p,new S(mp(this,Tp),this.serverName)),fp(this,Sp,new Co(mp(this,Tp))),this.showTrades=new Qc(mp(this,Tp),this.serverName),await this.showTrades.init(),mp(this,Tp).portIcons.showTrades=this.showTrades,this.f11=new el(this,this.coord),vp(this,aw,$w).call(this),fp(this,Mp,new zn(this.rem)),fp(this,Cp,new Nu),new Gd(mp(this,Tp)),new Pr(this,this.serverName,this.coord),new Hu}function pw(){vp(this,rw,Dw).call(this),vp(this,hw,Lw).call(this),vp(this,ow,Ew).call(this)}function ww(){window.clearTimeout(mp(this,Pp)),fp(this,Pp,window.setTimeout((()=>{vp(this,Bp,pw).call(this)}),250))}function vw(){fp(this,xp,(0,a.Z)("#na-map").append("svg").attr("id","na-svg").attr("class","fill-empty stroke-empty bg-map").attr("width",this.width).attr("height",this.height)),mp(this,xp).append("defs"),fp(this,Wp,mp(this,xp).append("g").attr("id","map")),mp(this,$p).setupSvg()}function mw(){var t,e,i,a,s;null===(t=document.querySelector("#propertyDropdown"))||void 0===t||t.addEventListener("click",(()=>{(0,o.KS)("Menu","Select port on property")})),null===(e=document.querySelector("#settingsDropdown"))||void 0===e||e.addEventListener("click",(()=>{(0,o.KS)("Menu","Settings")})),null===(i=document.querySelector("#menu-download-pb-calc"))||void 0===i||i.addEventListener("click",(()=>{(0,o.KS)("Tools","Download pb calculator")})),null===(a=document.querySelector("#reset"))||void 0===a||a.addEventListener("click",(()=>{vp(this,Hp,gw).call(this)})),null===(s=document.querySelector("#double-click-action"))||void 0===s||s.addEventListener("change",(()=>{vp(this,Vp,fw).call(this)})),window.addEventListener("resize",(()=>{vp(this,Rp,ww).call(this)}))}function fw(){fp(this,yp,mp(this,Zp).get()),mp(this,Lp).set(mp(this,yp)),vp(this,Hp,gw).call(this)}function gw(){u.Z.resetAll(),this.f11.clearMap(),mp(this,Tp).clearMap(),mp(this,Sp).clearMap(),this.showTrades.clearMap(),mp(this,Cp).clearMap()}function bw(t){const[e,i]=(0,s.Z)(t,mp(this,Wp).node());"f11"===mp(this,yp)?this.f11.printCoord(e,i):mp(this,Mp).plotCourse(e,i),this.zoomAndPan(e,i)}function yw(t){const e=t.k;e!==mp(this,bp)&&(fp(this,bp,e),mp(this,bp)>h.V8?"pbZone"!==this.zoomLevel&&(this.zoomLevel="pbZone"):mp(this,bp)>h.OZ?"portLabel"!==this.zoomLevel&&(this.zoomLevel="portLabel"):"initial"!==this.zoomLevel&&(this.zoomLevel="initial")),mp(this,_p).refresh(),mp(this,Tp).update(mp(this,bp))}function kw(t){const e=mp(this,$p).mapTileTransform,i=2**(Math.log2(t.k)-Math.log2(h.zb)),a=e.x,s=e.y;return r.CR.translate(a,s).scale(i)}function Mw(t,e,i=!0){var a;const s=mp(this,Wp).node(),n=null===(a=s.ownerSVGElement)||void 0===a?void 0:a.createSVGPoint();if(n){n.x=t,n.y=e;const a=s.getCTM();if(a)return i?n.matrixTransform(a):n.matrixTransform(a.inverse())}return{x:0,y:0}}function Ww(t,e){const{x:i,y:a}=vp(this,Up,Mw).call(this,t,e,!1);return[i,a]}function _w(){return[vp(this,Qp,Ww).call(this,0,0).map((t=>Math.max(0,t))),vp(this,Qp,Ww).call(this,this.width,this.height).map((t=>Math.min(t,h.zb)))]}function Sw(t){const{transform:e}=t;mp(this,$p).drawMap(e);const i=vp(this,Yp,kw).call(this,e);this.showTrades.transform(i),mp(this,Wp).attr("transform",i.toString()),fp(this,kp,vp(this,Xp,_w).call(this)),mp(this,Tp).setBounds(mp(this,kp)),mp(this,_p).setBounds(mp(this,kp)),this.showTrades.setBounds(mp(this,kp)),vp(this,Kp,yw).call(this,e)}function Tw(){fp(this,Dp,(0,r.sP)().extent([[0,0],[this.width,this.height]]).scaleExtent([h.rO,h.u1]).wheelDelta((t=>-Math.sign(t.deltaY))).on("zoom",(t=>{vp(this,tw,Sw).call(this,t)}))),mp(this,xp).call(mp(this,Dp)).on("dblclick.zoom",(()=>({}))).on("click",(()=>({}))).on("dblclick",(t=>{vp(this,Gp,bw).call(this,t)}))}function xw(){mp(this,zp).has("x")&&mp(this,zp).has("z")&&this.f11.goToF11FromParam(mp(this,zp))}function $w(){var t;this.zoomLevel="initial",vp(this,ew,Tw).call(this),vp(this,Bp,pw).call(this),vp(this,iw,xw).call(this),null===(t=document.querySelector("#navbar-left"))||void 0===t||t.classList.remove("d-none")}function Pw(){const{width:t}=this.getDimensions();return Math.floor(t)}function Cw(){const{top:t}=this.getDimensions(),e=document.documentElement.clientHeight-this.rem;return Math.floor(e-t)}function Dw(){this.width=vp(this,sw,Pw).call(this),this.height=vp(this,nw,Cw).call(this)}function Ew(){var t;null===(t=document.querySelector("#summary-column"))||void 0===t||t.setAttribute("style",`height:${this.height}px`)}function Iw(t,e,i){const a=r.CR.translate(t,e).scale(i);mp(this,xp).call(mp(this,Dp).transform,a)}function Lw(){vp(this,lw,Iw).call(this,this.width/2,this.height/2,h.WW)}},2938:(t,e,i)=>{i.d(e,{Z:()=>v});i(3223);var a=i(1198),s=i(393),n=i(5311);function r(t,e,i){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,i)}function o(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,h(t,e,"get"))}function l(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,h(t,e,"set"),i),i}function h(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var c=new WeakMap,d=new WeakMap,u=new WeakMap,p=new WeakMap,w=new WeakMap;class v{constructor(t,e){r(this,c,{writable:!0,value:void 0}),r(this,d,{writable:!0,value:void 0}),r(this,u,{writable:!0,value:void 0}),r(this,p,{writable:!0,value:{}}),r(this,w,{writable:!0,value:{}}),l(this,p,t),l(this,c,e),l(this,d,`form-${o(this,c)}`),l(this,u,`slider-${o(this,c)}`),this._inject(),l(this,w,n(`#${o(this,u)}`)),this._setup()}_setup(){window.sliderTooltip=t=>`${(0,a.nD)(String(t.value))}<br>${String(t.value)}°`,o(this,w).roundSlider({sliderType:"default",handleSize:"+1",startAngle:90,width:20,radius:110,min:0,max:359,step:360/s.Tm.length,editableTooltip:!1,tooltipFormat:"sliderTooltip",create(){this.control.css("display","block")}})}_inject(){const t=o(this,p).append("form").attr("id",o(this,d)).append("div").attr("class","text-center");t.append("label").attr("for",o(this,u)).text("Current in-game wind"),t.append("div").attr("id",o(this,u)).attr("class","rslider d-inline-block")}_getInputValue(){return o(this,w).roundSlider("getValue")}getWind(){const t=(0,s.tT)(this._getInputValue());let e;return e=Number.isNaN(Number(t))?(0,s.Ri)(t):Number(t),e}}},7846:t=>{t.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' height='300' width='300' viewBox='0 0 512 512'%3e%3cpath fill='%23292109' fill-opacity='.7' d='m438 411.3-37.6-37.6c.1-.2.1-.2.1-.4 9.7-20.8 6.2-46.3-11-63.5L363 336.3l-80.5-80.5 96.6-96.6c24-24 37.5-56.6 37.5-90.5L256 229.3 95.4 68.7c0 34 13.5 66.5 37.5 90.5l96.6 96.6-80.5 80.5-26.5-26.5c-17.2 17.2-20.7 42.7-11 63.5.1.2.1.2.1.4L74 411.3c-7.3 7.3-7.3 19.2 0 26.5 7.3 7.3 19.2 7.3 26.5 0l37.6-37.6c.2.1.2.1.4.1 20.8 9.7 46.3 6.2 63.5-11l-26.5-26.5 80.5-80.5 80.5 80.5-26.5 26.6c17.2 17.2 42.7 20.7 63.5 11 .1-.1.2-.1.4-.1l37.6 37.6c7.3 7.3 19.2 7.3 26.5 0 7.3-7.4 7.3-19.3 0-26.6z'/%3e%3c/svg%3e"}}]);