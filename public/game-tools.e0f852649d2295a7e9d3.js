/*! For license information please see game-tools.e0f852649d2295a7e9d3.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{143:function(t,e,n){n.r(e),n.d(e,"init",(function(){return g}));var a=n(318),s=n.n(a),i=n(37),o=n(19),c=n(254),r=n(257),d=n(343),l=n(344),u=n(346),h=n(347),b=n(348),_=n(349),p=n(354),m=n(355),f=n(356),v=n(357);const g=(t,e)=>{const n=new c.a("ship-compare");(()=>{if(e.has("cmp")&&e.has("v")){const t=e.get("v");t&&s.a.lte(t,o.d)&&(Object(i.b)("Menu","Paste ship compare"),n.initFromClipboard(e))}})();new r.a("wood"),new v.a,new d.a,new l.a,new u.a,new h.a,new b.a,new _.a,new p.a(t),new m.a,new f.a}},343:function(t,e,n){(function(t){n.d(e,"a",(function(){return l}));n(24),n(144),n(147);var a=n(138),s=(n(154),n(37)),i=n(19),o=n(38),c=n(146),r=n(151);function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class l{constructor(){d(this,"_baseName",void 0),d(this,"_baseId",void 0),d(this,"_buttonId",void 0),d(this,"_modalId",void 0),d(this,"_buildingData",void 0),this._baseName="List buildings",this._baseId="building-list",this._buttonId="button-".concat(this._baseId),this._modalId="modal-".concat(this._baseId),this._buildingData=[],this._setupListener()}async _loadAndSetupData(){try{this._buildingData=(await n.e(2).then(n.t.bind(null,360,3))).default}catch(t){Object(o.e)(t)}}_setupListener(){let t=!0;document.querySelector("#".concat(this._buttonId)).addEventListener("click",async e=>{t&&(t=!1,await this._loadAndSetupData()),Object(s.b)("Tools",this._baseName),this._buildingListSelected()})}_injectModal(){Object(i.u)({id:this._modalId,title:this._baseName});const t="".concat(this._baseId,"-select"),e=Object(a.a)("#".concat(this._modalId," .modal-body"));e.append("label").attr("for",t),e.append("select").attr("name",t).attr("id",t),e.append("div").attr("id","".concat(this._baseId)).attr("class","container-fluid")}_getOptions(){return"".concat(this._buildingData.sort(Object(r.b)(["name"])).map(t=>'<option value="'.concat(t.name,'">').concat(t.name,"</option>;")).join(""))}_setupSelect(){const e=t("#".concat(this._baseId,"-select")),n=this._getOptions();e.append(n)}_setupSelectListener(){const e=t("#".concat(this._baseId,"-select"));e.addClass("selectpicker").on("change",t=>this._buildingSelected(t)).selectpicker({noneSelectedText:"Select building"}),e.val("default").selectpicker("refresh")}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_buildingListSelected(){document.querySelector("#".concat(this._modalId))||this._initModal(),t("#".concat(this._modalId)).modal("show")}_getBuildingData(t){return this._buildingData.filter(e=>e.name===t)[0]}_getProductText(t){let e="";return t.result&&(t.result.length>1?(e+='<table class="table table-sm"><tbody>',e+="<tr><td>".concat(t.result.map(t=>t.name).join("</td></tr><tr><td>"),"</td></tr>"),e+="</tbody></table>"):(e+='<h5 class="card-title">'.concat(t.result[0].name,"</h5>"),t.result[0].price&&(e+='<table class="table table-sm card-table"><tbody>',e+="<tr><td>".concat(Object(i.n)(t.result[0].price)," per unit</td></tr>"),t.batch&&(e+="<tr><td>".concat(t.batch.labour," labour hour").concat(t.batch.labour>1?"s":""," per unit</td></tr>")),e+="</tbody></table>"))),e}_getRequirementText(t){let e="";if(e+='<table class="table table-sm card-table"><thead>',t.levels[0].materials.length>0){e+="<tr><th>Level</th><th>Level build materials</th><th>Build price (reals)</th></tr>",e+="</thead><tbody>";for(const n of t.levels){const a=t.levels.indexOf(n);e+="<tr><td>".concat(a+1,'</td><td class="text-left">'),e+=n.materials.map(t=>"".concat(Object(c.d)(t.amount)," ").concat(t.item)).join("<br>"),e+="</td>",e+="<td>".concat(Object(c.d)(n.price),"</td>"),e+="</tr>"}}else{e+="<tr><th>Level</th><th>Production</th><th>Labour cost (%)</th><th>Storage</th><th>Build price (reals)</th></tr>",e+="</thead><tbody>";for(const n of t.levels){const a=t.levels.indexOf(n);e+="<tr><td>".concat(a+1,"</td><td>").concat(Object(c.d)(n.production),"</td><td>").concat(Object(c.d)(-100*n.labourDiscount),"</td><td>").concat(Object(c.d)(n.maxStorage),"</td><td>").concat(Object(c.d)(n.price),"</td></tr>")}}return e+="</tbody></table>",e}_getText(t){const e=this._getBuildingData(t);let n='<div class="row no-gutters card-deck">';return n+='<div class="card col-5"><div class="card-header">Product</div>',n+='<div class="card-body product">',n+=this._getProductText(e),n+="</div></div>",n+='<div class="card col-7"><div class="card-header">Requirements</div>',n+='<div class="card-body px-0 requirements">',n+=this._getRequirementText(e),n+="</div></div>",n+="</div>",n}_buildingSelected(e){const n=String(t(e.currentTarget).find(":selected").val());Object(a.a)("#".concat(this._baseId," div")).remove(),Object(a.a)("#".concat(this._baseId)).append("div").classed("buildings mt-4",!0),Object(a.a)("#".concat(this._baseId," div")).html(this._getText(n))}}}).call(this,n(49))},344:function(t,e,n){(function(t){n.d(e,"a",(function(){return M}));n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(24),n(144),n(345),n(147);var a=n(20),s=n(260),i=n(56),o=n.n(i),c=n(37),r=n(38),d=n(19),l=n(146);function u(){const t=I(['\n            <button type="button" class="btn btn-secondary" data-dismiss="modal">\n                Close\n            </button>\n        ']);return u=function(){return t},t}function h(){const t=I(['\n                            <div\n                                class="tab-pane fade','"\n                                id="tab-content-',"-",'"\n                                role="tabpanel"\n                                aria-labelledby="tab-',"-",'"\n                            >\n                                <div id="','-list">\n                                    ',"\n                                </div>\n                            </div>\n                        "]);return h=function(){return t},t}function b(){const t=I(['\n                            <li class="nav-item">\n                                <a\n                                    class="nav-link','"\n                                    id="tab-',"-",'"\n                                    data-toggle="tab"\n                                    href="#tab-content-',"-",'"\n                                    role="tab"\n                                    aria-controls="home"\n                                    aria-selected="true"\n                                    >',"</a\n                                >\n                            </li>\n                        "]);return b=function(){return t},t}function _(){const t=I(['\n            <ul class="nav nav-pills" role="tablist">\n                ','\n            </ul>\n            <div class="tab-content pt-2">\n                ',"\n            </div>\n        "]);return _=function(){return t},t}function p(){const t=I(["\n                                <tr>\n                                    ","","\n                                </tr>\n                            "]);return p=function(){return t},t}function m(){const t=I(['\n            <table id="table-',"-",'-list" class="table table-sm small tablesort na-table">\n                <thead>\n                    <tr class="thead-group">\n                        <th scope="col" class="border-bottom-0"></th>\n                        ','\n                    </tr>\n                    <tr data-sort-method="thead">\n                        <th scope="col" class="text-right border-top-0" data-sort-default>Lb</th>\n                        ',"\n                    </tr>\n                </thead>\n                <tbody>\n                    ","\n                </tbody>\n            </table>\n        "]);return m=function(){return t},t}function f(){const t=I(['\n                            <td class="text-right" data-sort="','">\n                                ',"\n                            </td>\n                        "]);return f=function(){return t},t}function v(){const t=I([""]);return v=function(){return t},t}function g(){const t=I(["\n            ","\n        "]);return g=function(){return t},t}function j(){const t=I(['\n                <td class="text-right" data-sort="',"",'">\n                    ',"\n                </td>\n            "]);return j=function(){return t},t}function O(){const t=I([""," <em>","</em>"]);return O=function(){return t},t}function S(){const t=I(['<th class="text-right">',"</th>"]);return S=function(){return t},t}function y(){const t=I(["\n            ","\n        "]);return y=function(){return t},t}function w(){const t=I(['\n            <th scope="col" class="text-center" colspan="','">\n                ',"\n            </th>\n        "]);return w=function(){return t},t}function I(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function L(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function D(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class M{constructor(){D(this,"_cannonData",{}),D(this,"_baseName",void 0),D(this,"_baseId",void 0),D(this,"_buttonId",void 0),D(this,"_modalId",void 0),D(this,"_groups",void 0),this._groups=new Map,this._baseName="List cannons",this._baseId="cannon-list",this._buttonId="button-".concat(this._baseId),this._modalId="modal-".concat(this._baseId),this._setupListener()}async _loadAndSetupData(){try{const t=(await n.e(3).then(n.t.bind(null,361,3))).default;this._setupData(t)}catch(t){Object(r.e)(t)}}_setupData(t){for(const e of t.long)for(const[t,n]of Object.entries(e))"name"!==t&&this._groups.set(t,{values:n,count:Object.entries(n).length});const e=["name","damage","penetration","dispersion","traverse","generic"];for(const n of r.a)this._cannonData[n]=t[n].map(t=>Object.keys(t).sort((t,n)=>e.indexOf(t)-e.indexOf(n)).reduce((e,n)=>(e[n]=t[n],e),{}));this._groups=new Map(L(this._groups.entries()).sort((t,n)=>e.indexOf(t[0])-e.indexOf(n[0])))}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#".concat(this._buttonId)))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(c.b)("Tools",this._baseName),this._cannonListSelected()})}_getList(t){return Object(a.d)(m(),this._baseId,t,Object(s.a)(this._groups,(t,e)=>e,t=>(t=>Object(a.d)(w(),t[1].count,Object(r.b)(t[0])))(t)),Object(s.a)(this._groups,(t,e)=>e,t=>(t=>Object(a.d)(y(),Object.entries(t[1].values).map(t=>Object(a.d)(S(),Object(r.b)(t[0])))))(t)),Object(s.a)(this._cannonData[t],t=>t.name,t=>Object(a.d)(p(),(t=>{let e=t;const n=t.split(" "),s="c".concat(n[0].padStart(3,"0")),i=n[1]?n[1][1]:"0";return n.length>1&&(e=Object(a.d)(O(),n[0],n[1])),Object(a.d)(j(),s,i,e)})(t.name),(t=>Object(a.d)(g(),Object.entries(t).map(t=>"name"===t[0]?Object(a.d)(v()):Object.entries(t[1]).map(t=>{var e;return Object(a.d)(f(),null!==(e=t[1].value)&&void 0!==e?e:0,t[1]?Object(l.c)(t[1].value,t[1].digits):"")}))))(t))))}_getModalBody(){return Object(a.d)(_(),Object(s.a)(Object.keys(this._cannonData),t=>t,(t,e)=>Object(a.d)(b(),0===e?" active":"",this._baseId,t,this._baseId,t,Object(r.b)(t))),Object(s.a)(Object.keys(this._cannonData),t=>t,(t,e)=>Object(a.d)(h(),0===e?" show active":"",this._baseId,t,this._baseId,t,t,this._getList(t))))}_getModalFooter(){return Object(a.d)(u())}_injectModal(){Object(a.f)(Object(d.v)({id:this._modalId,title:this._baseName,body:this._getModalBody.bind(this),footer:this._getModalFooter}),document.querySelector("#modal-section"));for(const t of Object.keys(this._cannonData)){const e=document.querySelector("#table-".concat(this._baseId,"-").concat(t,"-list"));if(e){new o.a(e)}}}_initModal(){Object(d.t)(),this._injectModal()}_cannonListSelected(){document.querySelector("#".concat(this._modalId))||this._initModal(),t("#".concat(this._modalId)).modal("show")}}}).call(this,n(49))},346:function(t,e,n){(function(t){n.d(e,"a",(function(){return b}));n(24),n(144),n(147),n(194);var a=n(138),s=n(37),i=n(38),o=n(19),c=n(146),r=n(151),d=n(153);function l(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class b{constructor(){h(this,"_baseName",void 0),h(this,"_baseId",void 0),h(this,"_buttonId",void 0),h(this,"_modalId",void 0),h(this,"_moduleData",{}),h(this,"_ingredientData",{}),this._baseName="List recipe ingredients",this._baseId="ingredient-list",this._buttonId="button-".concat(this._baseId),this._modalId="modal-".concat(this._baseId),this._setupListener()}async _loadAndSetupData(){try{this._moduleData=(await n.e(6).then(n.t.bind(null,207,3))).default,this._ingredientData=(await n.e(11).then(n.t.bind(null,264,3))).default.ingredient}catch(t){Object(i.e)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#".concat(this._buttonId)))||void 0===t||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(s.b)("Tools",this._baseName),this._ingredientListSelected()})}_injectModal(){Object(o.u)({id:this._modalId,title:this._baseName});Object(a.a)("#".concat(this._modalId," .modal-body")).append("div").attr("id","".concat(this._baseId)).attr("class","container-fluid")}_initModal(){this._injectModal(),this._injectList()}_ingredientListSelected(){document.querySelector("#".concat(this._modalId))||this._initModal(),t("#".concat(this._modalId)).modal("show")}_getProperties(t){let e="",n="",a="";for(const e of this._moduleData){const s=e[1].sort(Object(r.b)(["name"])).filter(e=>e.name===t);for(const t of s)n=e[0],a="<tr><td>".concat(t.properties.map(t=>{const e=t.isPercentage?Object(c.l)(t.amount/100):Object(c.k)(t.amount);return"".concat(t.modifier," ").concat(e)}).join("</td></tr><tr><td>"),"</td></tr>")}return e="<h6 class='text-muted text-left'>".concat(n,"</h6>"),e+="<table class='table table-sm'><tbody>".concat(a,"</tbody></table>"),a?e:""}_getRows(){return this._ingredientData.map(t=>"<tr><td>".concat(t.name,"</td><td>").concat(t.recipeNames.map(t=>{const e=this._getProperties(t);return e?'<a data-toggle="tooltip" title="'.concat(e,'">').concat(t,"</a>"):t}).join("<br>"),"</td></tr>"))}_getText(){const t=this._getRows(),e=Object(d.a)(t,2);let n="";for(const t of l(new Array(e.length).keys()))n+='<div class="col-md-'.concat(Math.floor(12/e.length),'">'),n+='<table class="table table-sm na-table"><thead>',n+="<tr><th>Ingredient</th><th>Recipes</th></tr></thead><tbody>",n+=e[t].join(""),n+="</tbody></table></div>";return n}_injectList(){Object(a.a)("#".concat(this._baseId," div")).remove(),Object(a.a)("#".concat(this._baseId)).append("div").classed("row",!0),Object(a.a)("#".concat(this._baseId," div")).html(this._getText()),t('[data-toggle="tooltip"]').tooltip({html:!0,placement:"auto",sanitize:!1})}}}).call(this,n(49))},347:function(t,e,n){(function(t){n.d(e,"a",(function(){return P}));n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(53),n(24),n(144),n(147),n(154);var a=n(20),s=n(260),i=n(37),o=n(38),c=n(19),r=n(146),d=n(151);function l(){const t=A(['\n            <div class="mt-4">\n                ',"\n            </div>\n        "]);return l=function(){return t},t}function u(){const t=A(["",""]);return u=function(){return t},t}function h(){const t=A([" <h5>Group chance: ","</h5>\n                    ",""]);return h=function(){return t},t}function b(){const t=A(["\n            <p>Weight "," tons<br />Lifetime "," hours</p>\n            ","\n        "]);return b=function(){return t},t}function _(){const t=A(["",""]);return _=function(){return t},t}function p(){const t=A([' <td class="text-right">\n                                              ',"\n                                          </td>"]);return p=function(){return t},t}function m(){const t=A(["\n                                <tr>\n                                    <td>","</td>\n                                    ",'\n                                    <td class="text-right">\n                                        ',"\n                                    </td>\n                                </tr>\n                            "]);return m=function(){return t},t}function f(){const t=A(['<th scope="col" class="text-right">Chance (0 − 100)</th>']);return f=function(){return t},t}function v(){const t=A(['\n            <table class="table table-sm small na-table no-sort">\n                <thead>\n                    <tr>\n                        <th scope="col">Item</th>\n                        ','\n                        <th scope="col" class="text-right">Amount</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ',"\n                </tbody>\n            </table>\n        "]);return v=function(){return t},t}function g(){const t=A(['\n            <button type="button" class="btn btn-secondary" data-dismiss="modal">\n                Close\n            </button>\n        ']);return g=function(){return t},t}function j(){const t=A(['\n                        <label>\n                            <select id="','" class="selectpicker">\n                                ',"\n                            </select>\n                        </label>\n                    "]);return j=function(){return t},t}function O(){const t=A(["\n            ",'\n            <div id="','"></div>\n        ']);return O=function(){return t},t}function S(){const t=A([""]);return S=function(){return t},t}function y(){const t=A(['<option value="','">',"</option>"]);return y=function(){return t},t}function w(){const t=A(["\n            ",";\n        "]);return w=function(){return t},t}function I(t){return function(t){if(Array.isArray(t))return L(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return L(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function x(){const t=A(['<option value="','">',"</option>"]);return x=function(){return t},t}function D(){const t=A(["\n            ","\n        "]);return D=function(){return t},t}function M(){const t=A(['<option value="','">',"</option>"]);return M=function(){return t},t}function k(){const t=A(["\n            ","\n        "]);return k=function(){return t},t}function A(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function T(t,e){var n=e.get(t);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(t):n.value}function C(t,e,n){var a=e.get(t);if(!a)throw new TypeError("attempted to set private field on non-instance");if(a.set)a.set.call(t,n);else{if(!a.writable)throw new TypeError("attempted to set read only private field");a.value=n}return n}class P{constructor(){N.set(this,{writable:!0,value:void 0}),q.set(this,{writable:!0,value:void 0}),B.set(this,{writable:!0,value:void 0}),W.set(this,{writable:!0,value:void 0}),E.set(this,{writable:!0,value:["loot","chests","items"]}),R.set(this,{writable:!0,value:void 0}),z.set(this,{writable:!0,value:{}}),F.set(this,{writable:!0,value:{}}),H.set(this,{writable:!0,value:0}),U.set(this,{writable:!0,value:void 0}),G.set(this,{writable:!0,value:void 0}),$.set(this,{writable:!0,value:void 0}),J.set(this,{writable:!0,value:void 0}),C(this,N,"List loot and chests"),C(this,q,"loot-list"),C(this,B,"button-".concat(T(this,q))),C(this,W,"modal-".concat(T(this,q)));for(const t of T(this,E))T(this,z)[t]="".concat(T(this,q),"-").concat(t,"-select");C(this,R,""),this._setupListener()}static _printAmount(t){return t.min===t.max?Object(r.d)(t.min):"".concat(Object(r.d)(t.min)," to ").concat(Object(r.d)(t.max))}static _printChance(t){return Object(r.d)(100*(1-t))}async _loadAndSetupData(){try{const t=(await n.e(5).then(n.t.bind(null,362,3))).default;C(this,$,t.loot),C(this,J,t.chests)}catch(t){Object(o.e)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#".concat(T(this,B))))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(i.b)("Tools",T(this,N)),this._sourceListSelected()})}_getLootOptions(){return Object(a.d)(k(),Object(s.a)(T(this,$).sort(Object(d.b)(["name"])),t=>t.id,t=>Object(a.d)(M(),t.id,t.name)))}_getChestsOptions(){return Object(a.d)(D(),Object(s.a)(T(this,J).sort(Object(d.b)(["name"])),t=>t.id,t=>Object(a.d)(x(),t.id,t.name)))}_getItemsOptions(){const t=new Map,e=(e,n,a)=>{const s=new Map([[e.id,{id:e.id,name:e.name,chance:a,amount:n.amount}]]);t.set(n.id,{name:n.name,sources:t.has(n.id)?new Map([].concat(I(t.get(n.id).sources),I(s))):s})};for(const t of T(this,$)){const{items:n}=t;for(const a of n)e(t,a,a.chance)}for(const t of T(this,J))for(const n of t.itemGroup){const{items:a}=n;for(const s of a)e(t,s,n.chance)}return C(this,G,new Map(I(t.entries()).sort((t,e)=>t[1].name.localeCompare(e[1].name)))),Object(a.d)(w(),Object(s.a)(T(this,G),(t,e)=>e,t=>Object(a.d)(y(),t[0],t[1].name)))}_getOptions(t){return"items"===t?this._getItemsOptions():"chests"===t?this._getChestsOptions():"loot"===t?this._getLootOptions():Object(a.d)(S())}_getModalBody(){return Object(a.d)(O(),Object(s.a)(T(this,E),t=>t,t=>Object(a.d)(j(),T(this,z)[t],this._getOptions(t))),T(this,q))}_getModalFooter(){return Object(a.d)(g())}_injectModal(){Object(a.f)(Object(c.v)({id:T(this,W),title:T(this,N),size:"modal-md",body:this._getModalBody.bind(this),footer:this._getModalFooter}),document.querySelector("#modal-section"))}_setupSelectListeners(){for(const t of T(this,E))T(this,F)[t].on("change",()=>{C(this,R,t),this._itemSelected()}).selectpicker({dropupAuto:!1,liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",title:"Select ".concat(t),virtualScroll:!0})}_initModal(){this._injectModal(),C(this,U,document.querySelector("#".concat(T(this,q))));for(const e of T(this,E))T(this,F)[e]=t("#".concat(T(this,z)[e]));this._setupSelectListeners()}_sourceListSelected(){document.querySelector("#".concat(T(this,W)))||this._initModal(),t("#".concat(T(this,W))).modal("show")}_getLootItemsText(t,e=!0){return Object(a.d)(v(),e?Object(a.d)(f()):"",Object(s.a)(t,t=>t.id,t=>Object(a.d)(m(),t.name,e?Object(a.d)(p(),P._printChance(t.chance)):"",P._printAmount(t.amount))))}_getSourceText(){const t=I(T(this,G).get(T(this,H)).sources).map(t=>t[1]).sort(Object(d.b)(["chance","name"]));return Object(a.d)(_(),this._getLootItemsText(t))}_getChestsText(){const t=T(this,J).find(t=>t.id===T(this,H));return Object(a.d)(b(),Object(r.d)(t.weight),Object(r.d)(t.lifetime),Object(s.a)(t.itemGroup,t=>t,t=>Object(a.d)(h(),P._printChance(t.chance),this._getLootItemsText(t.items.sort(Object(d.b)(["name"])),!1))))}_getLootText(){const t=T(this,$).find(t=>t.id===T(this,H)).items.sort(Object(d.b)(["chance","name"]));return Object(a.d)(u(),this._getLootItemsText(t))}_getText(){return"items"===T(this,R)?this._getSourceText():"chests"===T(this,R)?this._getChestsText():this._getLootText()}_getTable(){return Object(a.d)(l(),this._getText())}_resetOtherSelects(){const t=T(this,E).filter(t=>t!==T(this,R));for(const e of t)T(this,F)[e].val("default").selectpicker("refresh")}_itemSelected(){const t=T(this,F)[T(this,R)].find(":selected");C(this,H,Number(t.val())),this._resetOtherSelects(),Object(a.f)(this._getTable(),T(this,U))}}var N=new WeakMap,q=new WeakMap,B=new WeakMap,W=new WeakMap,E=new WeakMap,R=new WeakMap,z=new WeakMap,F=new WeakMap,H=new WeakMap,U=new WeakMap,G=new WeakMap,$=new WeakMap,J=new WeakMap}).call(this,n(49))},348:function(t,e,n){(function(t){n.d(e,"a",(function(){return _}));n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(24),n(144),n(147),n(154);var a=n(138),s=n(37),i=n(38),o=n(19),c=n(146),r=n(50),d=n(151),l=n(153);function u(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class _{constructor(){b(this,"_baseName",void 0),b(this,"_baseId",void 0),b(this,"_buttonId",void 0),b(this,"_modalId",void 0),b(this,"_moduleData",{}),this._baseName="List modules",this._baseId="module-list",this._buttonId="button-".concat(this._baseId),this._modalId="modal-".concat(this._baseId),this._setupListener()}async _loadAndSetupData(){try{this._moduleData=(await n.e(6).then(n.t.bind(null,207,3))).default}catch(t){Object(i.e)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#".concat(this._buttonId)))||void 0===t||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(s.b)("Tools",this._baseName),this._moduleListSelected()})}_injectModal(){Object(o.u)({id:this._modalId,title:this._baseName});const t="".concat(this._baseId,"-select"),e=Object(a.a)("#".concat(this._modalId," .modal-body"));e.append("label").attr("for",t),e.append("select").attr("name",t).attr("id",t),e.append("div").attr("id","".concat(this._baseId)).attr("class","container-fluid")}_getOptions(){return"".concat(this._moduleData.map(t=>'<option value="'.concat(t[0],'"">').concat(t[0],"</option>;")).join(""))}_setupSelect(){const e=t("#".concat(this._baseId,"-select")),n=this._getOptions();e.append(n)}_setupSelectListener(){t("#".concat(this._baseId,"-select")).addClass("selectpicker").on("change",t=>this._moduleSelected(t)).selectpicker({noneSelectedText:"Select module category"}).val("default").selectpicker("refresh")}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_moduleListSelected(){document.querySelector("#".concat(this._modalId))||this._initModal(),t("#".concat(this._modalId)).modal("show")}_getRows(t){const e=new Map([["L","".concat(Object(r.p)(1)," – ").concat(Object(r.p)(3))],["M","".concat(Object(r.p)(4)," – ").concat(Object(r.p)(5))],["S","".concat(Object(r.p)(6)," – ").concat(Object(r.p)(7))]]),n=t=>"U"===t?"":"".concat(e.get(t));let a="";const s=[];for(const e of this._moduleData)e[0]===t&&e[1].sort(Object(d.b)(["name"])).forEach((t,i)=>{const o=n=>n<e[1].length&&t.name===e[1][n].name&&JSON.stringify(t.properties)===JSON.stringify(e[1][n].properties);a=n(t.moduleLevel),o(i+1)&&(e[1][i+1].hasSamePropertiesAsPrevious=!0,a+="<br>".concat(n(e[1][i+1].moduleLevel))),o(i+2)&&(e[1][i+2].hasSamePropertiesAsPrevious=!0,a=""),void 0!==t.hasSamePropertiesAsPrevious&&t.hasSamePropertiesAsPrevious||s.push('<tr><td><span class="name">'.concat(t.name,"<br>").concat(a,"</span></td><td>").concat(t.properties.map(t=>{let e;return e=t.isPercentage?Object(c.l)(t.amount/100):t.amount<1&&t.amount>0?Object(c.f)(t.amount):Object(c.k)(t.amount),"".concat(t.modifier," ").concat(e)}).join("<br>"),"</td></tr>"))});return s}_getText(t){const e=this._getRows(t),n=Object(l.a)(e,3);let a="";for(const t of u(new Array(n.length).keys()))a+='<div class="col-md-'.concat(Math.floor(12/n.length),'">'),a+='<table class="table table-sm small na-table"><thead>',a+="<tr><th>Module</th><th>Modifier</th></tr></thead><tbody>",a+=n[t].join(""),a+="</tbody></table></div>";return a}_moduleSelected(e){const n=t(e.currentTarget).find(":selected").val();Object(a.a)("#".concat(this._baseId," div")).remove(),Object(a.a)("#".concat(this._baseId)).append("div").classed("row mt-4",!0),Object(a.a)("#".concat(this._baseId," div")).html(this._getText(n))}}}).call(this,n(49))},349:function(t,e,n){(function(t){n.d(e,"a",(function(){return O}));n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(24),n(144),n(147),n(154);var a=n(350),s=n(217),i=n(196),o=n(215),c=n(234),r=n(192),d=n(236),l=n(158),u=n(138),h=n(395),b=n(353),_=n(388),p=n(389),m=n(368),f=n(37),v=n(38),g=n(19);function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class O{constructor(){j(this,"_baseName",void 0),j(this,"_baseId",void 0),j(this,"_buttonId",void 0),j(this,"_modalId",void 0),j(this,"_ownershipData",{}),j(this,"_nationData",{}),j(this,"_colourScale",void 0),j(this,"_mainDiv",void 0),j(this,"_div",void 0),j(this,"_svg",void 0),this._baseName="Port ownership",this._baseId="ownership-list",this._buttonId="button-".concat(this._baseId),this._modalId="modal-".concat(this._baseId),this._colourScale=Object(r.a)().range(g.h),this._setupListener()}static getHeight(){return Math.floor(.75*top.innerHeight)}_getWidth(){var t;return null!==(t=Math.floor(this._mainDiv.node().offsetWidth))&&void 0!==t?t:0}async _loadAndSetupData(){try{this._nationData=(await n.e(7).then(n.t.bind(null,363,3))).default,this._ownershipData=(await n.e(8).then(n.t.bind(null,364,3))).default}catch(t){Object(v.e)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#".concat(this._buttonId)))||void 0===t||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(f.b)("Tools",this._baseName),this._ownershipListSelected()})}_injectModal(){Object(g.u)({id:this._modalId,title:this._baseName});const t="".concat(this._baseId,"-select"),e=Object(u.a)("#".concat(this._modalId," .modal-body"));e.append("label").append("select").attr("name",t).attr("id",t),this._mainDiv=e.append("div").attr("id","".concat(this._baseId)),this._div=this._mainDiv.append("div"),this._svg=this._mainDiv.append("svg").attr("class","area")}_getOptions(){return"".concat(this._ownershipData.map(t=>'<option value="'.concat(t.region,'">').concat(t.region,"</option>;")).join(""))}_setupSelect(){const e=t("#".concat(this._baseId,"-select")),n=this._getOptions();e.append(n)}_setupSelectListener(){t("#".concat(this._baseId,"-select")).addClass("selectpicker").on("change",t=>this._regionSelected(t)).selectpicker({noneSelectedText:"Select region"}).val("default").selectpicker("refresh")}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_ownershipListSelected(){let e=!1;document.querySelector("#".concat(this._modalId))||(e=!0,this._initModal()),t("#".concat(this._modalId)).on("shown.bs.modal",()=>{e&&(this._injectArea(),e=!1)}).modal("show")}_injectArea(){const t=this._getWidth(),e=Math.min(1e3,O.getHeight()),n=32,r=32,u=32,m=v.d.filter(t=>9!==t.id).map(t=>t.short),f=this._nationData;f.keys=m;const j=Object(h.a)().offset(b.a).keys(m)(f);this._svg.attr("width",t).attr("height",e),(()=>{const c=(()=>{const a=Object(l.a)().domain(Object(s.a)(f,t=>new Date(t.date))).range([u,t-n]),c=Object(l.a)().domain([Object(i.a)(j[0],t=>t[0]),Object(o.a)(j[j.length-1],t=>t[1])]).range([e-r,0]);return Object(_.a)().x(t=>a(new Date(t.data.date))).y0(t=>c(t[0])).y1(t=>c(t[1])).curve(p.a)})(),d=new Map(v.d.map(t=>[t.short,t.name]));this._colourScale.domain(m),this._svg.selectAll("path").data(j).join(t=>t.append("path").attr("fill",t=>this._colourScale(t.key)).attr("stroke",t=>this._colourScale(t.key)).attr("d",c)),this._svg.selectAll(".area-label").data(j).join(t=>t.append("text").attr("class","area-label").text(t=>d.get(t.key)).attr("fill",t=>Object(g.m)(this._colourScale(t.key))).attr("transform",Object(a.areaLabel)(c)))})(),this._svg.append("g").call(a=>{const i=Object(d.b)().domain(Object(s.a)(f,t=>new Date(t.date))).range([u,t-n]);a.attr("transform","translate(0,".concat(e-r,")")).call(Object(c.a)(i).ticks(t/80).tickSizeOuter(0)),a.attr("font-size",".8rem").attr("font-family","")})}_injectChart(t){Object(m.a)().data(t).enableAnimations(!1).timeFormat("%-d %B %Y").zQualitative(!0).zColorScale(this._colourScale).width(this._getWidth())(this._div.node())}_regionSelected(e){const n=t(e.currentTarget).find(":selected").val();this._div.selectAll("*").remove();const a=this._ownershipData.filter(t=>t.region===n).map(t=>t.data)[0];this._injectChart(a)}}}).call(this,n(49))},354:function(t,e,n){(function(t){n.d(e,"a",(function(){return p}));n(51),n(24),n(144),n(147),n(154);var a=n(138),s=n(233),i=n(159),o=n(37),c=n(146),r=n(50),d=n(38),l=n(19),u=n(151);function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const b=n(104),_=(t,e,n)=>"".concat(Object(r.p)(e)," – ").concat(Object(r.p)(n));class p{constructor(t){h(this,"_serverType",void 0),h(this,"_baseName",void 0),h(this,"_baseId",void 0),h(this,"_buttonId",void 0),h(this,"_modalId",void 0),h(this,"_moduleData",{}),h(this,"_recipeData",{}),this._serverType=b.find(e=>e.id===t).type,this._baseName="List admiralty items and recipes",this._baseId="recipe-list",this._buttonId="button-".concat(this._baseId),this._modalId="modal-".concat(this._baseId),this._setupListener()}async _loadAndSetupData(){try{this._moduleData=(await n.e(6).then(n.t.bind(null,207,3))).default,this._recipeData=(await n.e(11).then(n.t.bind(null,264,3))).default.recipe}catch(t){Object(d.e)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#".concat(this._buttonId)))||void 0===t||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(o.b)("Tools",this._baseName),this._recipeListSelected()})}_injectModal(){Object(l.u)({id:this._modalId,title:this._baseName});const t="".concat(this._baseId,"-select"),e=Object(a.a)("#".concat(this._modalId," .modal-body"));e.append("select").attr("name",t).attr("id",t),e.append("label").attr("for",t).attr("class","text-muted pl-2").text("Items listed here may not be available in the game (yet)."),e.append("div").attr("id","".concat(this._baseId)).attr("class","container-fluid")}_getOptions(){return Object(s.b)().key(t=>t.craftGroup).sortKeys(i.a).sortValues(Object(u.b)(["name"])).entries(this._recipeData.filter(t=>"Any"===t.serverType||t.serverType===this._serverType)).map(t=>'<optgroup label="'.concat(t.key,'">').concat(t.values.map(t=>'<option value="'.concat(t.id,'">').concat(t.name.replace(/(\d)-(\d)(st|rd|th)/,_))).join("</option>"))).join("</optgroup>")}_setupSelect(){const e=t("#".concat(this._baseId,"-select")),n=this._getOptions();e.append(n)}_setupSelectListener(){t("#".concat(this._baseId,"-select")).addClass("selectpicker").on("change",t=>this._recipeSelected(t)).selectpicker({dropupAuto:!1,liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",title:"Select item",virtualScroll:!0})}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_recipeListSelected(){document.querySelector("#".concat(this._modalId))||this._initModal(),t("#".concat(this._modalId)).modal("show")}_getRecipeData(t){return this._recipeData.find(e=>e.id===t)}_getRequirementText(t){let e='<table class="table table-sm card-table"><tbody>';return t.labourPrice&&(e+="<tr><td>".concat(t.labourPrice," labour hours</td></tr>")),t.goldPrice&&(e+="<tr><td>".concat(Object(l.n)(t.goldPrice),"</td></tr>")),t.itemRequirements.length>0&&(e+="<tr><td>".concat(t.itemRequirements.map(t=>"".concat(t.amount," ").concat(t.name)).join("</td></tr><tr><td>"),"</td></tr>")),e+="</tbody></table>",e}_getPropertiesText(t){let e="",n="",a="";for(const e of this._moduleData){const s=e[1].filter(e=>e.id===t.result.id);for(const t of s)[n]=e,a="<tr><td>".concat(t.properties.map(t=>{const e=t.isPercentage?Object(c.l)(t.amount/100):t.amount;return"".concat(t.modifier," ").concat(e)}).join("</td></tr><tr><td>"),"</td></tr>")}return a?(e+='<h6 class="card-subtitle mb-2 text-muted">'.concat(n,"</h6>"),e+='<table class="table table-sm card-table na-table"><tbody>'.concat(a,"</tbody></table>")):e+="<p>".concat(Object(c.d)(t.result.amount)," ").concat(t.result.name,"</p>"),e}_getText(t){const e=this._getRecipeData(t);let n='<div class="row no-gutters card-deck">';return n+='<div class="card col-6"><div class="card-header">Item</div>',n+='<div class="card-body">',n+=this._getRequirementText(e),n+="</div></div>",n+='<div class="card col-6"><div class="card-header">Result</div>',n+='<div class="card-body">',n+=this._getPropertiesText(e),n+="</div></div>",n+="</div></div>",n}_recipeSelected(e){const n=Number(t(e.currentTarget).find(":selected").val());Object(a.a)("#".concat(this._baseId," div")).remove(),Object(a.a)("#".concat(this._baseId)).append("div").classed("mt-4",!0),Object(a.a)("#".concat(this._baseId," div")).html(this._getText(n))}}}).call(this,n(49))},355:function(t,e,n){(function(t){n.d(e,"a",(function(){return g}));n(144),n(147);var a=n(138),s=n(20),i=n(56),o=n.n(i),c=n(37),r=n(38),d=n(19),l=n(146),u=n(151);function h(){const t=f(['\n            <table id="table-','" class="table table-sm small tablesort na-table">\n                '," ","\n            </table>\n        "]);return h=function(){return t},t}function b(){const t=f(['<td class="','" data-sort="','">\n                                    ',"\n                                </td>"]);return b=function(){return t},t}function _(){const t=f(["<tr>\n                        ","\n                    </tr>"]);return _=function(){return t},t}function p(){const t=f(["\n            <tbody>\n                ","\n            </tbody>\n        "]);return p=function(){return t},t}function m(){const t=f(['\n            <thead>\n                <tr class="thead-group">\n                    <th scope="col" class="border-bottom-0"></th>\n                    <th scope="col" class="border-bottom-0"></th>\n                    <th scope="col" class="text-right border-bottom-0"></th>\n                    <th scope="col" class="text-right border-bottom-0"></th>\n                    <th scope="col" class="text-right border-bottom-0"></th>\n                    <th scope="col" class="text-center" colspan="2">Speed</th>\n                    <th scope="col" class="text-right border-bottom-0"></th>\n                    <th scope="col" class="text-center" colspan="2">Chasers</th>\n                    <th scope="col" class="text-right border-bottom-0"></th>\n                </tr>\n\n                <tr data-sort-method="thead">\n                    <th scope="col" class="text-right border-top-0">Class</th>\n                    <th scope="col" class="border-top-0">Name</th>\n                    <th scope="col" class="text-right border-top-0">Guns</th>\n                    <th scope="col" class="text-right border-top-0">Battle rating</th>\n                    <th scope="col" class="text-right border-top-0">Crew</th>\n                    <th scope="col" class="text-right">Maximum</th>\n                    <th scope="col" class="text-right">Turn</th>\n                    <th scope="col" class="text-right border-top-0">Broadside</th>\n                    <th scope="col" class="text-right border-top-0">Bow</th>\n                    <th scope="col" class="text-right">Stern</th>\n                    <th scope="col" class="text-right border-top-0">Sides</th>\n                </tr>\n            </thead>\n        ']);return m=function(){return t},t}function f(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class g{constructor(){v(this,"_baseName",void 0),v(this,"_baseId",void 0),v(this,"_buttonId",void 0),v(this,"_modalId",void 0),v(this,"_shipListData",{}),v(this,"_mainDiv",void 0),this._baseName="List ships",this._baseId="ship-list",this._buttonId="button-".concat(this._baseId),this._modalId="modal-".concat(this._baseId),this._setupListener()}async _loadAndSetupData(){try{const t=(await n.e(13).then(n.t.bind(null,263,3))).default.sort(Object(u.b)(["class","-battleRating","name"]));this._shipListData=t.map(t=>({class:[t.class,t.class],name:[t.name,Object(d.e)(t.name)],guns:[t.guns.total,t.guns.total],battleRating:[t.battleRating,Object(l.d)(t.battleRating)],crew:[t.crew.max,Object(l.d)(t.crew.max)],maxSpeed:[t.ship.maxSpeed,Object(l.c)(t.ship.maxSpeed)],turnSpeed:[t.rudder.turnSpeed,Object(l.c)(t.rudder.turnSpeed)],broadside:[t.guns.broadside.cannons,Object(l.d)(t.guns.broadside.cannons)],bowChaser:[t.guns.gunsPerDeck[4].amount,t.guns.gunsPerDeck[4]?String(t.guns.gunsPerDeck[4].amount):""],sternChaser:[t.guns.gunsPerDeck[5].amount,t.guns.gunsPerDeck[5]?String(t.guns.gunsPerDeck[5].amount):""],sides:[t.sides.armour,"".concat(Object(l.d)(t.sides.armour)," (").concat(t.sides.thickness,")")]}))}catch(t){Object(r.e)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#".concat(this._buttonId)))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(c.b)("Tools",this._baseName),this._shipListSelected()})}_injectModal(){Object(d.u)({id:this._modalId,title:this._baseName,size:"modal-lg"}),this._mainDiv=Object(a.a)("#".concat(this._modalId," .modal-body")).append("div").attr("id","".concat(this._baseId))}_initModal(){Object(d.t)(),this._injectModal(),this._injectList()}_shipListSelected(){document.querySelector("#".concat(this._modalId))||this._initModal(),t("#".concat(this._modalId)).modal("show")}_getHead(){return Object(s.d)(m())}_getBody(){return Object(s.d)(p(),this._shipListData.map(t=>Object(s.d)(_(),Object.entries(t).map(t=>Object(s.d)(b(),"name"===t[0]?"":"text-right",t[1][0],t[1][1])))))}_getList(){return Object(s.d)(h(),this._baseId,this._getHead(),this._getBody())}_injectList(){Object(s.f)(this._getList(),this._mainDiv.node());const t=document.querySelector("#table-".concat(this._baseId));new o.a(t)}}}).call(this,n(49))},356:function(t,e,n){(function(t){n.d(e,"a",(function(){return u}));n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(24),n(144),n(147),n(154);var a=n(138),s=n(37),i=n(146),o=n(19),c=n(38),r=n(151);function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const l=["Resources","Extra","Materials"];class u{constructor(){d(this,"_baseName",void 0),d(this,"_baseId",void 0),d(this,"_buttonId",void 0),d(this,"_modalId",void 0),d(this,"_init",!0),d(this,"_blueprintData",{}),d(this,"_woodData",{}),d(this,"_extractionCosts",{}),d(this,"_craftingCosts",{}),d(this,"_blueprint",void 0),d(this,"_woodOptions",{}),d(this,"_defaultWood",void 0),d(this,"_woodsSelected",{}),d(this,"_blueprintList",void 0),d(this,"_currentBlueprint",{}),d(this,"_tables",{}),this._baseName="List ship blueprint",this._baseId="ship-blueprint-list",this._buttonId="button-".concat(this._baseId),this._modalId="modal-".concat(this._baseId),this._defaultWood={frame:"Fir",trim:"Crew Space"},this._setupListener()}async _loadAndSetupData(){try{this._blueprintData=(await n.e(12).then(n.t.bind(null,365,3))).default,this._woodData=(await n.e(14).then(n.t.bind(null,232,3))).default;const t=(await n.e(12).then(n.t.bind(null,366,3))).default;this._extractionCosts=new Map(t.standard.map(t=>[t.name,{real:t.real,labour:t.labour}])),this._craftingCosts=new Map(t.seasoned.map(t=>[t.name,{real:t.real,labour:t.labour,doubloon:t.doubloon,tool:t.tool}]))}catch(t){Object(c.e)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#".concat(this._buttonId)))||void 0===t||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(s.b)("Tools",this._baseName),this._listSelected()})}_injectModal(){Object(o.u)({id:this._modalId,title:this._baseName,size:"modal-lg"});const t="".concat(this._baseId,"-ship-select"),e=Object(a.a)("#".concat(this._modalId," .modal-body"));let n=e.append("div").classed("row no-gutters mb-2",!0);n.append("label").attr("for",t),n.append("select").attr("name",t).attr("id",t),n=e.append("div").classed("row no-gutters",!0);for(const t of c.h){const e="".concat(this._baseId,"-").concat(t,"-select");n.append("label").attr("for",e),n.append("select").attr("name",e).attr("id",e).classed("pr-2",!0)}this._blueprintList=e.append("div").attr("id","".concat(this._baseId)).classed("blueprint mt-4",!0)}_getShipOptions(){return"".concat(this._blueprintData.sort(Object(r.b)(["name"])).map(t=>'<option value="'.concat(t.name,'">').concat(t.name,"</option>;")).join(""))}_setupShipSelect(){const e=t("#".concat(this._baseId,"-ship-select")),n=this._getShipOptions();e.append(n)}_setupWoodOptions(){const t=this._woodData.frame.sort(Object(r.b)(["name"])),e=this._woodData.trim.filter(t=>"Light"!==t.name).sort(Object(r.b)(["name"]));this._woodOptions={frame:t.map(t=>'<option value="'.concat(t.name,'">').concat(t.name,"</option>")).join(""),trim:e.map(t=>'<option value="'.concat(t.name,'">').concat(t.name,"</option>")).join("")}}_setupWoodSelect(t,e){this._setupWoodOptions(),this._woodsSelected[t]=this._defaultWood[t],e.append(this._woodOptions[t]),e.attr("disabled","disabled")}_setupSelects(){this._setupShipSelect();for(const e of c.h){const n=t("#".concat(this._baseId,"-").concat(e,"-select"));this._setupWoodSelect(e,n)}}_setupShipSelectListener(){t("#".concat(this._baseId,"-ship-select")).addClass("selectpicker").on("change",t=>this._blueprintSelected(t)).selectpicker({noneSelectedText:"Select blueprint",width:"fit"}).val("default").selectpicker("refresh")}_setupWoodSelectListener(t,e){e.addClass("selectpicker").on("change",()=>this._woodSelected(t,e)).selectpicker({noneSelectedText:"Select ".concat(t),width:"fit"}).val("default").selectpicker("refresh")}_setupSelectListener(){this._setupShipSelectListener();for(const e of c.h){const n=t("#".concat(this._baseId,"-").concat(e,"-select"));this._setupWoodSelectListener(e,n)}}_initModal(){this._injectModal(),this._setupSelects(),this._setupSelectListener()}_setWoodSelect(e){t("#".concat(this._baseId,"-").concat(e,"-select")).removeAttr("disabled").val(this._defaultWood[e]).selectpicker("refresh")}_woodSelected(t,e){this._woodsSelected[t]=e.val(),this._updateText()}_listSelected(){document.querySelector("#".concat(this._modalId))||this._initModal(),t("#".concat(this._modalId)).modal("show")}_updateTable(t,e){t.select("tbody").selectAll("tr").data(e).join(t=>t.append("tr")).selectAll("td").data(t=>t).join(t=>t.append("td")).html(t=>t)}_updateText(){let t=this._currentBlueprint.resources.map(t=>[t.name,t.amount]),e=!1,n=!1,a=0,s=0;if("Crew Space"===this._woodsSelected.trim){const e=this._currentBlueprint.wood.find(t=>"Crew Space"===t.name).amount,n=t.findIndex(t=>"Hemp"===t[0]);t[n][1]=t[n][1]+e}else if(s=this._currentBlueprint.wood.find(t=>"Planking"===t.name).amount,this._woodsSelected.trim===this._woodsSelected.frame)a+=s;else{const e=t.findIndex(t=>t[0]===this._woodsSelected.trim);e>=0?t[e][1]=t[e][1]+s:(n=!0,t.push([this._woodsSelected.trim,s]))}a+=this._currentBlueprint.wood.find(t=>"Frame"===t.name).amount;const o=t.findIndex(t=>t[0]===this._woodsSelected.frame);if(o>=0?t[o][1]=t[o][1]+a:(e=!0,t.push([this._woodsSelected.frame,a])),e&&n){const e=t.length-1;[t[e],t[e-1]]=[t[e-1],t[e]]}let c=[];this._currentBlueprint.doubloons&&c.push(["Doubloons",this._currentBlueprint.doubloons]),c.push(["Provisions",this._currentBlueprint.provisions]),this._currentBlueprint.permit&&c.push(["Permit",this._currentBlueprint.permit]),c.push(["Craft level",this._currentBlueprint.craftLevel],["Shipyard level",this._currentBlueprint.shipyardLevel],["Labour hours",this._currentBlueprint.labourHours],["Craft experience",this._currentBlueprint.craftXP]);const r=[];let d=0,l=0;const u=t=>this._extractionCosts.get(t[0]).real*t[1],h=t=>this._extractionCosts.get(t[0]).labour*t[1],b=t=>{for(const e of t.filter(t=>this._extractionCosts.has(t[0])))d+=u(e),l+=h(e)};b(t),b(c),d&&r.push(["Reals",Object(i.d)(d)],["Labour hours",Object(i.d)(l)]);let _=0,p=0,m=0,f=0;this._craftingCosts.has(this._woodsSelected.trim)&&(_+=this._craftingCosts.get(this._woodsSelected.trim).real*s,p+=this._craftingCosts.get(this._woodsSelected.trim).labour*s,m+=this._craftingCosts.get(this._woodsSelected.trim).doubloon*s,f+=this._craftingCosts.get(this._woodsSelected.trim).tool*s),this._craftingCosts.has(this._woodsSelected.frame)&&(_+=this._craftingCosts.get(this._woodsSelected.frame).real*a,p+=this._craftingCosts.get(this._woodsSelected.frame).labour*a,m+=this._craftingCosts.get(this._woodsSelected.frame).doubloon*a,f+=this._craftingCosts.get(this._woodsSelected.frame).tool*a),_&&r.push(["(S) reals",Object(i.d)(_)],["(S) labour hours",Object(i.d)(p)],["(S) doubloons",Object(i.d)(m)],["(S) tools",Object(i.d)(f)]),t=t.map(t=>[t[0],Object(i.d)(t[1])]),c=c.map(t=>[t[0],Object(i.d)(t[1])]),this._updateTable(this._tables.Resources,t),this._updateTable(this._tables.Extra,c),this._updateTable(this._tables.Materials,r)}_blueprintSelected(e){if(this._init){this._init=!1;for(const t of c.h)this._setWoodSelect(t);const t=this._blueprintList.append("div").classed("card-deck",!0),e=e=>{const n=t.append("div").classed("card",!0);n.append("div").classed("card-header",!0).text(e);const a=n.append("div").classed("card-body",!0);this._tables[e]=a.append("table").classed("table table-sm card-table",!0),this._tables[e].append("thead"),this._tables[e].append("tbody")};for(const t of l)e(t)}this._blueprint=t(e.currentTarget).find(":selected").val(),this._currentBlueprint=this._getBlueprintData(this._blueprint),this._updateText()}_getBlueprintData(t){return this._blueprintData.find(e=>e.name===t)}}}).call(this,n(49))},357:function(t,e,n){(function(t){n.d(e,"a",(function(){return y}));n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(185),n(186),n(187),n(24),n(144),n(147);var a=n(138),s=n(56),i=n.n(s),o=n(37),c=n(38),r=n(19),d=n(146),l=n(151),u=n(20);function h(){const t=g(['\n            <table id="table-',"-",'-list" class="table table-sm small tablesort na-table">\n                '," ","\n            </table>\n        "]);return h=function(){return t},t}function b(){const t=g([' <td class="text-right" data-sort="','">\n                                        ',"\n                                    </td>"]);return b=function(){return t},t}function _(){const t=g(["\n                            <tr>\n                                <td>","</td>\n\n                                ","\n                            </tr>\n                        "]);return _=function(){return t},t}function p(){const t=g(["<tbody>\n                ","\n            </tbody>"]);return p=function(){return t},t}function m(){const t=g(['<th class="text-right">\n                            ',"\n                        </th>"]);return m=function(){return t},t}function f(){const t=g([" <thead>\n                <tr>\n                    <th data-sort-default>Wood</th>\n                    ","\n                </tr>\n            </thead>"]);return f=function(){return t},t}function v(){const t=g(["","<br />"," ",""]);return v=function(){return t},t}function g(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function j(t){return function(t){if(Array.isArray(t))return O(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class y{constructor(){S(this,"_baseName",void 0),S(this,"_baseId",void 0),S(this,"_buttonId",void 0),S(this,"_modalId",void 0),S(this,"_woodData",{}),S(this,"_div",void 0),this._baseName="List woods",this._baseId="wood-list",this._buttonId="button-".concat(this._baseId),this._modalId="modal-".concat(this._baseId),this._setupListener()}async _loadAndSetupData(){try{this._woodData=(await n.e(14).then(n.t.bind(null,232,3))).default}catch(t){Object(c.e)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#".concat(this._buttonId)))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(o.b)("Tools",this._baseName),this._woodListSelected()})}_injectModal(){Object(r.u)({id:this._modalId,title:this._baseName,size:"modal-xl"});const t=Object(a.a)("#".concat(this._modalId," .modal-body"));this._div={};for(const e of c.h)t.append("h5").text(Object(c.b)("".concat(e,"s"))),this._div[e]=t.append("div").attr("id","".concat(e,"-list"))}_initModal(){Object(r.t)(),this._injectModal();for(const t of c.h)this._injectList(t)}_woodListSelected(){document.querySelector("#".concat(this._modalId))||this._initModal(),t("#".concat(this._modalId)).modal("show")}_getModifiers(t){const e=new Set;return this._woodData[t].forEach(t=>{t.properties.forEach(t=>{"Ship material"!==t.modifier&&"Boarding morale"!==t.modifier&&e.add(t.modifier)})}),j(e).sort(l.a)}_getList(t){const e=this._getModifiers(t);return Object(u.d)(h(),this._baseId,t,Object(u.d)(f(),e.map(t=>Object(u.d)(m(),(t=>{const e=t.split(" ",2),n=t.slice(e.join(" ").length);return Object(u.d)(v(),e[0],e[1],n)})(t)))),(t=>Object(u.d)(p(),this._woodData[t].map(t=>Object(u.d)(_(),t.name,e.map(e=>{const n=t.properties.filter(t=>t.modifier===e).map(t=>t.amount)[0];return Object(u.d)(b(),null!=n?n:0,n?Object(d.c)(n):"")})))))(t))}_injectList(t){Object(u.f)(this._getList(t),this._div[t].node());const e=document.querySelector("#table-".concat(this._baseId,"-").concat(t,"-list"));new i.a(e)}}}).call(this,n(49))}}]);