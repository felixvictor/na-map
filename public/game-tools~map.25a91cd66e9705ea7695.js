(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{iSiJ:function(e,t,a){"use strict";(function(e){a.d(t,"a",function(){return k});a("iPZ8"),a("kypl"),a("pCzD"),a("hi3g"),a("C4nn"),a("lYjL"),a("IlJM"),a("SJSz"),a("4owi"),a("/YXa"),a("8cZI"),a("lmye"),a("WB5j"),a("aOEW"),a("RsBt"),a("D/wG"),a("1Qwx"),a("fp7Y"),a("ZEAQ"),a("JBxO"),a("9UJh"),a("RsMT"),a("WoWj"),a("y89P"),a("aZFp"),a("MTDe"),a("3dw1"),a("U00V"),a("9DLp");var s=a("lpOn"),i=a("ED/D"),r=a("SYoz"),n=a("BfWa"),o=a("yw3p"),p=a("wbYc"),c=a("nUlG"),h=a("aBO9"),d=a("f4w0"),u=a("Av7d"),m=a("0lY5"),l=a("pFgi");function f(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function g(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function b(e,t,a){return t&&g(e.prototype,t),a&&g(e,a),e}var D=2*Math.PI/24,v=u.J/u.K,w=function(){function e(e,t){this._id=e,this._shipData=t,this._ticksSpeed=[12,8,4,0],this._ticksSpeedLabels=["12 knots","8 knots","4 knots","0 knots"],this._select="#ship-compare-"+this._id,this._setupSvg(),this._g=Object(c.f)(this._select).select("g"),this._setCompass()}var t=e.prototype;return t._setupSvg=function(){var e=Object(c.f)(this.select);Object(c.f)(this.select+" svg").remove(),e.append("svg").attr("width",this.shipData.svgWidth).attr("height",this.shipData.svgHeight).attr("data-ui-component","sailing-profile").attr("fill","none").append("g").attr("transform","translate("+this.shipData.svgWidth/2+", "+this.shipData.svgHeight/2+")"),Object(c.f)(this.select+" div").remove(),e.append("div").attr("class","block-small")},t._setCompass=function(){var e=this,t=new Array(12);t.fill(1,0);var a=Object(h.f)().sort(null).value(1)(t),s=Object(h.a)().outerRadius(this.shipData.radiusScaleAbsolute(12)).innerRadius(this.shipData.innerRadius);this.g.selectAll(".compass-arc").data(a).join(function(e){return e.append("path").attr("class","compass-arc").attr("d",s)}),this.g.selectAll(".speed-circle").data(this._ticksSpeed).join(function(t){return t.append("circle").attr("class","speed-circle").attr("r",function(t){return e.shipData.radiusScaleAbsolute(t)})}),this.g.append("line").attr("x1",0).attr("y1",-160).attr("x2",0).attr("y2",-79).attr("class","wind-arrow").attr("marker-end","url(#course-arrow)")},e.pd=function(e){var t='<span class="badge badge-white">'+e[0]+" / ";return e[1]?t+=""+e[1]:t+="–",t+=" lb</span>"},e.getCannonsPerDeck=function(t,a){for(var s=a[0]+" "+e.pd(t[0]),i="",r=1;r<4;r+=1)a[r]?s=a[r]+" "+e.pd(t[r])+" <br>"+s:i+="<br>";return[s,i]},e.getText=function(e){var t=0;function a(e){return'<div class="row row-small '+((t+=1)%2?"row-light":"")+'"><div class="col-3">'+e+"</div>"}function s(t,a,s){void 0===s&&(s=6);var i="",r="";if("cannonsPerDeck"===t){var n=e[t];i=n[0],r="<br>"+(r=n[1])}else i=""===t?"":e[t];return'<div class="col-'+s+'">'+i+'<br><span class="des">'+a+"</span>"+r+"</div>"}var i="";return i+=a(e.shipRating),i+='<div class="col-9"><div class="row no-gutters">',i+=s("battleRating","Battle rating"),i+=s("guns","Cannons"),i+=s("upgradeXP","Knowledge XP"),i+=s("waterlineHeight","Water line"),i+="</div></div></div>",i+=a(e.decks),i+='<div class="col-9"><div class="row no-gutters">',i+=s("cannonsPerDeck","Gun decks"),i+=s("firezoneHorizontalWidth","Firezone horizontal width"),i+="</div></div></div>",i+=a("Broadside (lb)"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("cannonBroadside","Cannons"),i+=s("carroBroadside","Carronades"),i+="</div></div></div>",i+=a("Chasers"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("gunsFront","Bow"),i+=s("gunsBack","Stern"),i+="</div></div></div>",i+=a("Speed"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("maxSpeed","Maximum"),i+=s("",""),i+=s("acceleration","Acceleration"),i+=s("deceleration","Deceleration"),i+=s("maxTurningSpeed","Turn speed"),i+=s("halfturnTime","Rudder half time"),i+="</div></div></div>",i+=a('Armour <span class="badge badge-white">Thickness</span>'),i+='<div class="col-9"><div class="row no-gutters">',i+=s("sideArmor","Sides"),i+=s("structure","Hull"),i+=s("frontArmor","Bow"),i+=s("backArmor","Stern"),i+=s("pump","Pump"),i+=s("rudder","Rudder"),i+="</div></div></div>",i+=a('Masts <span class="badge badge-white">Thickness</span>'),i+='<div class="col-9"><div class="row no-gutters">',i+=s("sails","Sails"),i+=s("mastBottomArmor","Bottom"),i+=s("mastMiddleArmor","Middle"),i+=s("mastTopArmor","Top"),i+="</div></div></div>",i+=a("Crew"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("minCrew","Minimum",4),i+=s("sailingCrew","Sailing",4),i+=s("maxCrew","Maximum",4),i+="</div></div></div>",i+=a("Resistance"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("fireResistance","Fire",4),i+=s("leakResistance","Leak",4),i+=s("splinterResistance","Splinter",4),i+="</div></div></div>",i+=a('Repairs needed <span class="badge badge-white">Set of 5</span>'),i+='<div class="col-9"><div class="row no-gutters">',i+=s("hullRepairsNeeded","Hull",4),i+=s("rigRepairsNeeded","Rig",4),i+=s("rumRepairsNeeded","Rum",4),i+="</div></div></div>",i+=a("Repair"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("hullRepairAmount","Hull %",4),i+=s("rigRepairAmount","Rig %",4),i+=s("repairTime","Time (sec)",4),i+="</div></div></div>",i+=a("Hold"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("maxWeight","Tons"),i+=s("holdSize","Cargo slots"),i+="</div></div></div>",i+="</div>"},b(e,[{key:"id",get:function(){return this._id}},{key:"shipData",get:function(){return this._shipData}},{key:"select",get:function(){return this._select}},{key:"g",get:function(){return this._g}}]),e}(),C=function(t){function a(e,a,s){var i;return(i=t.call(this,e,s)||this)._shipData=a,i._shipCompareData=s,i._setBackground(),i._setBackgroundGradient(),i._drawProfile(),i._printText(),i}_(a,t);var i=a.prototype;return i._setBackground=function(){var e=this,t=Object(h.a)().outerRadius(function(t){return e.shipCompareData.radiusScaleAbsolute(t)+2}).innerRadius(function(t){return e.shipCompareData.radiusScaleAbsolute(t)+1}).startAngle(-Math.PI/2).endAngle(Math.PI/2);this.g.selectAll(".speed-textpath").data(this._ticksSpeed).join(function(e){return e.append("path").attr("class","speed-textpath").attr("d",t).attr("id",function(e,t){return"tick"+t})}),this.g.selectAll(".speed-text").data(this._ticksSpeed).join(function(t){return t.append("text").attr("class","speed-text").append("textPath").attr("href",function(e,t){return"#tick"+t}).text(function(t,a){return e._ticksSpeedLabels[a]}).attr("startOffset","10%")})},i._setBackgroundGradient=function(){var e=this,t=Object(p.scaleLinear)().domain([this.shipData.speed.min,this.shipData.speed.max]).range([0,this.shipCompareData.svgWidth]),a=t.domain();a[2]=a[1]-a[0];for(var i=[],r=0;r<30;r+=1)i.push(r*a[2]/29+a[0]);this.g.append("defs").append("radialGradient").attr("id","gradient").attr("cx",.5).attr("cy",.25).attr("r",.5).selectAll("stop").data(Object(s.a)(30)).join(function(a){return a.append("stop").attr("offset",function(a,s){return t(i[s])/e.shipCompareData.svgWidth}).attr("stop-color",function(t,a){return e.shipCompareData.colorScale(i[a])})})},i._drawProfile=function(){var e=this,t=Object(h.f)().sort(null).value(1)(this.shipData.speedDegrees),a=h.d,s=Object(h.g)().angle(function(e,t){return t*D}).radius(function(t){return e.shipCompareData.radiusScaleAbsolute(t.data)}).curve(a);this.g.append("path").attr("class","base-profile").attr("d",s(t)),this.g.selectAll(".speed-markers").data(t).join(function(t){return t.append("circle").attr("class","speed-markers").attr("r",5).attr("cy",function(t,a){return Math.cos(a*D)*-e.shipCompareData.radiusScaleAbsolute(t.data)}).attr("cx",function(t,a){return Math.sin(a*D)*e.shipCompareData.radiusScaleAbsolute(t.data)}).attr("fill",function(t){return e.shipCompareData.colorScale(t.data)}).append("title").text(function(e){return Math.round(10*e.data)/10+" knots"})})},i._printText=function(){var t=w.getCannonsPerDeck(this.shipData.deckClassLimit,this.shipData.gunsPerDeck),a=Math.round(this.shipData.sides.armour*this.shipData.repairAmount.armour/u.z),s=Math.round(this.shipData.sails.armour*this.shipData.repairAmount.sails/u.I),i=Math.round(this.shipData.crew.max*v),r={shipRating:Object(m.B)(this.shipData.class)+" rate",battleRating:this.shipData.battleRating,guns:this.shipData.guns,decks:this.shipData.decks+" deck"+(this.shipData.decks>1?"s":""),additionalRow:this.shipData.decks<4?"<br> ":"",cannonsPerDeck:t,cannonBroadside:Object(m.s)(this.shipData.broadside.cannons),carroBroadside:Object(m.s)(this.shipData.broadside.carronades),gunsFront:this.shipData.gunsPerDeck[4],limitFront:this.shipData.deckClassLimit[4],gunsBack:this.shipData.gunsPerDeck[5],limitBack:this.shipData.deckClassLimit[5],firezoneHorizontalWidth:this.shipData.ship.firezoneHorizontalWidth,waterlineHeight:Object(m.p)(this.shipData.ship.waterlineHeight),maxSpeed:Object(m.p)(this.shipData.speed.max,3),acceleration:Object(m.p)(this.shipData.ship.acceleration),deceleration:Object(m.p)(this.shipData.ship.deceleration),maxTurningSpeed:Object(m.p)(this.shipData.rudder.turnSpeed),halfturnTime:Object(m.p)(this.shipData.rudder.halfturnTime),sideArmor:Object(m.s)(this.shipData.sides.armour)+' <span class="badge badge-white">'+Object(m.s)(this.shipData.sides.thickness)+"</span>",frontArmor:Object(m.s)(this.shipData.bow.armour)+' <span class="badge badge-white">'+Object(m.s)(this.shipData.bow.thickness)+"</span>",pump:Object(m.s)(this.shipData.pump.armour),sails:Object(m.s)(this.shipData.sails.armour),structure:Object(m.s)(this.shipData.structure.armour),backArmor:Object(m.s)(this.shipData.stern.armour)+' <span class="badge badge-white">'+Object(m.s)(this.shipData.stern.thickness)+"</span>",rudder:Object(m.s)(this.shipData.rudder.armour)+' <span class="badge badge-white">'+Object(m.s)(this.shipData.rudder.thickness)+"</span>",minCrew:Object(m.s)(this.shipData.crew.min),maxCrew:Object(m.s)(this.shipData.crew.max),sailingCrew:Object(m.s)(this.shipData.crew.sailing||0),maxWeight:Object(m.s)(this.shipData.maxWeight),holdSize:Object(m.s)(this.shipData.holdSize),upgradeXP:Object(m.s)(this.shipData.upgradeXP),sternRepair:""+Object(m.s)(this.shipData.repairTime.stern),bowRepair:""+Object(m.s)(this.shipData.repairTime.bow),hullRepairAmount:""+Object(m.s)(100*(this.shipData.repairAmount.armour+this.shipData.repairAmount.armourPerk)),rigRepairAmount:""+Object(m.s)(100*(this.shipData.repairAmount.sails+this.shipData.repairAmount.sailsPerk)),repairTime:""+Object(m.s)(this.shipData.repairTime.sides),hullRepairsNeeded:Object(m.s)(a)+' <span class="badge badge-white">'+Object(m.s)(5*a)+"</span>",rigRepairsNeeded:Object(m.s)(s)+' <span class="badge badge-white">'+Object(m.s)(5*s)+"</span>",rumRepairsNeeded:Object(m.s)(i)+' <span class="badge badge-white">'+Object(m.s)(5*i)+"</span>",fireResistance:Object(m.u)(this.shipData.resistance.fire,0),leakResistance:Object(m.u)(this.shipData.resistance.leaks,0),splinterResistance:Object(m.u)(this.shipData.resistance.splinter,0),mastBottomArmor:Object(m.s)(this.shipData.mast.bottomArmour)+' <span class="badge badge-white">'+Object(m.s)(this.shipData.mast.bottomThickness)+"</span>",mastMiddleArmor:Object(m.s)(this.shipData.mast.middleArmour)+' <span class="badge badge-white">'+Object(m.s)(this.shipData.mast.middleThickness)+"</span>",mastTopArmor:Object(m.s)(this.shipData.mast.topArmour)+' <span class="badge badge-white">'+Object(m.s)(this.shipData.mast.topThickness)+"</span>"};r.gunsFront?r.gunsFront+=" "+w.pd(r.limitFront):r.gunsFront="–",r.gunsBack?r.gunsBack+=" "+w.pd(r.limitBack):r.gunsBack="–",e(""+this.select).find("div").append(w.getText(r))},b(a,[{key:"shipData",get:function(){return this._shipData}},{key:"shipCompareData",get:function(){return this._shipCompareData}}]),a}(w),S=function(t){function a(e,a,s,i){var r;return(r=t.call(this,e,i)||this)._shipBaseData=a,r._shipCompareData=s,r._shipCompare=i,r._drawDifferenceProfile(),r._injectTextComparison(),r}_(a,t);var s=a.prototype;return s._drawDifferenceProfile=function(){var e=this,t=Object(h.f)().sort(null).value(1),a=t(this.shipCompareData.speedDegrees),s=t(this.shipBaseData.speedDegrees),i=h.d,r=Object(h.g)().angle(function(e,t){return t*D}).radius(function(t){return e.shipCompare.radiusScaleAbsolute(t.data)}).curve(i),n=this.shipCompareData.speedDegrees.map(function(t,a){return Object(m.J)(t-e.shipBaseData.speedDegrees[a])}),c=this._shipCompare._minSpeed,d=this._shipCompare._maxSpeed,l=Object(p.scaleLinear)().domain([c,-1,-.1,0,.1,1,d]).range([u.k,u.j,u.l,"#fff",u.h,u.f,u.g]).interpolate(o.c);this.g.append("path").attr("class","base-profile").attr("d",r(s)),this.g.append("path").attr("class","comp-profile").attr("d",r(a)),this.g.selectAll(".speed-markers").data(a).join(function(t){return t.append("circle").attr("class","speed-markers").attr("r",5).attr("cy",function(t,a){return Math.cos(a*D)*-e.shipCompare.radiusScaleAbsolute(t.data)}).attr("cx",function(t,a){return Math.sin(a*D)*e.shipCompare.radiusScaleAbsolute(t.data)}).attr("fill",function(e,t){return l(n[t])}).append("title").text(function(e){return Math.round(10*e.data)/10+" knots"})})},s._injectTextComparison=function(){function t(e,t,a,s){void 0===a&&(a=0),void 0===s&&(s=!1);var i=parseFloat((e-t).toFixed(a));return s&&(i*=100),i<0?'<span class="badge badge-danger">'+Object(m.p)(Math.abs(i))+"</span>":i>0?'<span class="badge badge-success">'+Object(m.p)(i)+"</span>":""}var a=Math.round(this.shipBaseData.sides.armour*this.shipBaseData.repairAmount.armour/u.z),s=Math.round(this.shipBaseData.sails.armour*this.shipBaseData.repairAmount.sails/u.I),i=Math.round(this.shipBaseData.crew.max*v),r=Math.round(this.shipCompareData.sides.armour*this.shipCompareData.repairAmount.armour/u.z),n=Math.round(this.shipCompareData.sails.armour*this.shipCompareData.repairAmount.sails/u.I),o=Math.round(this.shipCompareData.crew.max*v),p={shipRating:Object(m.B)(this.shipCompareData.class)+" rate",battleRating:this.shipCompareData.battleRating+" "+t(this.shipCompareData.battleRating,this.shipBaseData.battleRating),guns:this.shipCompareData.guns+" "+t(this.shipCompareData.guns,this.shipBaseData.guns),decks:this.shipCompareData.decks+" deck"+(this.shipCompareData.decks>1?"s":"")+" "+t(this.shipCompareData.decks,this.shipBaseData.decks),additionalRow:this.shipCompareData.decks<4?"<br> ":"",cannonsPerDeck:w.getCannonsPerDeck(this.shipCompareData.deckClassLimit,this.shipCompareData.gunsPerDeck),cannonBroadside:this.shipCompareData.broadside.cannons+" "+t(this.shipCompareData.broadside.cannons,this.shipBaseData.broadside.cannons),carroBroadside:this.shipCompareData.broadside.carronades+" "+t(this.shipCompareData.broadside.carronades,this.shipBaseData.broadside.carronades),gunsFront:this.shipCompareData.gunsPerDeck[4],limitFront:this.shipCompareData.deckClassLimit[4],gunsBack:this.shipCompareData.gunsPerDeck[5],limitBack:this.shipCompareData.deckClassLimit[5],minSpeed:Object(m.p)(this.shipCompareData.speed.min)+" "+t(this.shipCompareData.speed.min,this.shipBaseData.speed.min,2),maxSpeed:Object(m.p)(this.shipCompareData.speed.max,3)+" "+t(this.shipCompareData.speed.max,this.shipBaseData.speed.max,2),maxTurningSpeed:Object(m.p)(this.shipCompareData.rudder.turnSpeed)+" "+t(this.shipCompareData.rudder.turnSpeed,this.shipBaseData.rudder.turnSpeed,2),firezoneHorizontalWidth:this.shipCompareData.ship.firezoneHorizontalWidth+" "+t(this.shipCompareData.ship.firezoneHorizontalWidth,this.shipBaseData.ship.firezoneHorizontalWidth),waterlineHeight:Object(m.p)(this.shipCompareData.ship.waterlineHeight)+" "+t(this.shipCompareData.ship.waterlineHeight,this.shipBaseData.ship.waterlineHeight,2),acceleration:Object(m.p)(this.shipCompareData.ship.acceleration)+" "+t(this.shipCompareData.ship.acceleration,this.shipBaseData.ship.acceleration,2),deceleration:Object(m.p)(this.shipCompareData.ship.deceleration)+" "+t(this.shipCompareData.ship.deceleration,this.shipBaseData.ship.deceleration,2),halfturnTime:Object(m.p)(this.shipCompareData.rudder.halfturnTime)+" "+t(this.shipCompareData.rudder.halfturnTime,this.shipBaseData.rudder.halfturnTime),sideArmor:Object(m.s)(this.shipCompareData.sides.armour)+" "+t(this.shipCompareData.sides.armour,this.shipBaseData.sides.armour)+' <span class="badge badge-white">'+Object(m.s)(this.shipCompareData.sides.thickness)+"</span>"+t(this.shipCompareData.sides.thickness,this.shipBaseData.sides.thickness),frontArmor:Object(m.s)(this.shipCompareData.bow.armour)+" "+t(this.shipCompareData.bow.armour,this.shipBaseData.bow.armour)+' <span class="badge badge-white">'+Object(m.s)(this.shipCompareData.bow.thickness)+"</span>"+t(this.shipCompareData.bow.thickness,this.shipBaseData.bow.thickness),backArmor:Object(m.s)(this.shipCompareData.stern.armour)+" "+t(this.shipCompareData.stern.armour,this.shipBaseData.stern.armour)+' <span class="badge badge-white">'+Object(m.s)(this.shipCompareData.stern.thickness)+"</span>"+t(this.shipCompareData.stern.thickness,this.shipBaseData.stern.thickness),pump:Object(m.s)(this.shipCompareData.pump.armour)+" "+t(this.shipCompareData.pump.armour,this.shipBaseData.pump.armour),sails:Object(m.s)(this.shipCompareData.sails.armour)+" "+t(this.shipCompareData.sails.armour,this.shipBaseData.sails.armour),structure:Object(m.s)(this.shipCompareData.structure.armour)+" "+t(this.shipCompareData.structure.armour,this.shipBaseData.structure.armour),rudder:Object(m.s)(this.shipCompareData.rudder.armour)+" "+t(this.shipCompareData.rudder.armour,this.shipBaseData.rudder.armour)+' <span class="badge badge-white">'+Object(m.s)(this.shipCompareData.rudder.thickness)+"</span>"+t(this.shipCompareData.rudder.thickness,this.shipBaseData.rudder.thickness),minCrew:Object(m.s)(this.shipCompareData.crew.min)+" "+t(this.shipCompareData.crew.min,this.shipBaseData.crew.min),maxCrew:Object(m.s)(this.shipCompareData.crew.max)+" "+t(this.shipCompareData.crew.max,this.shipBaseData.crew.max),sailingCrew:Object(m.s)(this.shipCompareData.crew.sailing)+" "+t(this.shipCompareData.crew.sailing,this.shipBaseData.crew.sailing),maxWeight:Object(m.s)(this.shipCompareData.maxWeight)+" "+t(this.shipCompareData.maxWeight,this.shipBaseData.maxWeight),holdSize:Object(m.s)(this.shipCompareData.holdSize)+" "+t(this.shipCompareData.holdSize,this.shipBaseData.holdSize),upgradeXP:Object(m.s)(this.shipCompareData.upgradeXP)+" "+t(this.shipCompareData.upgradeXP,this.shipBaseData.upgradeXP),hullRepairAmount:Object(m.s)(100*(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk))+" "+t(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk,this.shipBaseData.repairAmount.armour+this.shipBaseData.repairAmount.armourPerk,3,!0),rigRepairAmount:Object(m.s)(100*(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk))+" "+t(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk,this.shipBaseData.repairAmount.sails+this.shipBaseData.repairAmount.sailsPerk,3,!0),repairTime:Object(m.s)(this.shipCompareData.repairTime.sides)+" "+t(this.shipBaseData.repairTime.sides,this.shipCompareData.repairTime.sides),hullRepairsNeeded:Object(m.s)(r)+" "+t(r,a)+' <span class="badge badge-white">'+Object(m.s)(5*r)+"</span>",rigRepairsNeeded:Object(m.s)(n)+" "+t(n,s)+' <span class="badge badge-white">'+Object(m.s)(5*n)+"</span>",rumRepairsNeeded:Object(m.s)(o)+" "+t(o,i)+' <span class="badge badge-white">'+Object(m.s)(5*o)+"</span>",fireResistance:Object(m.u)(this.shipCompareData.resistance.fire,0)+" "+t(this.shipCompareData.resistance.fire,this.shipBaseData.resistance.fire,2,!0),leakResistance:Object(m.u)(this.shipCompareData.resistance.leaks,0)+" "+t(this.shipCompareData.resistance.leaks,this.shipBaseData.resistance.leaks,2,!0),splinterResistance:Object(m.u)(this.shipCompareData.resistance.splinter,0)+" "+t(this.shipCompareData.resistance.splinter,this.shipBaseData.resistance.splinter,2,!0),mastBottomArmor:Object(m.s)(this.shipCompareData.mast.bottomArmour)+" "+t(this.shipCompareData.mast.bottomArmour,this.shipBaseData.mast.bottomArmour)+' <span class="badge badge-white">'+Object(m.s)(this.shipCompareData.mast.bottomThickness)+"</span>"+t(this.shipCompareData.mast.bottomThickness,this.shipBaseData.mast.bottomThickness),mastMiddleArmor:Object(m.s)(this.shipCompareData.mast.middleArmour)+" "+t(this.shipCompareData.mast.middleArmour,this.shipBaseData.mast.middleArmour)+' <span class="badge badge-white">'+Object(m.s)(this.shipCompareData.mast.middleThickness)+"</span>"+t(this.shipCompareData.mast.middleThickness,this.shipBaseData.mast.middleThickness),mastTopArmor:Object(m.s)(this.shipCompareData.mast.topArmour)+" "+t(this.shipCompareData.mast.topArmour,this.shipBaseData.mast.topArmour)+' <span class="badge badge-white">'+Object(m.s)(this.shipCompareData.mast.topThickness)+"</span>"+t(this.shipCompareData.mast.topThickness,this.shipBaseData.mast.topThickness)};p.gunsFront?p.gunsFront+=" "+w.pd(p.limitFront):p.gunsFront="–",p.gunsBack?p.gunsBack+=" "+w.pd(p.limitBack):p.gunsBack="–",e(""+this.select).find("div").append(w.getText(p))},b(a,[{key:"shipBaseData",get:function(){return this._shipBaseData}},{key:"shipCompareData",get:function(){return this._shipCompareData}},{key:"shipCompare",get:function(){return this._shipCompare}}]),a}(w),k=function(){function t(e){var t=e.shipData,a=e.woodData,s=e.moduleData,r=e.id,n=void 0===r?"ship-compare":r;this._shipData=t,this._moduleDataDefault=s,this._baseId=n,this._baseName="Compare ships",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._moduleId=this._baseId+"-module",this._copyButtonId="button-copy-"+this._baseId,this._shipIds=[],this._selectedUpgradeIdsPerType=[],this._selectedUpgradeIdsList=[],this._selectShip$={},this._selectWood$={},this._selectModule$={},this._modal$=null,"ship-compare"===this._baseId?this._columnsCompare=["C1","C2"]:this._columnsCompare=[],this._columns=this._columnsCompare.slice(),this._columns.unshift("Base"),this._selectedShips={Base:{},C1:{},C2:{}},this._woodChanges=new Map([["Acceleration",["ship.acceleration"]],["Armor thickness",["sides.thickness","bow.thickness","stern.thickness"]],["Armour strength",["bow.armour","sides.armour","stern.armour"]],["Splinter resistance",["resistance.splinter"]],["Crew",["crew.max"]],["Fire resistance",["resistance.fire"]],["Hull strength",["structure.armour"]],["Leak resistance",["resistance.leaks"]],["Mast thickness",["mast.bottomThickness","mast.middleThickness","mast.topThickness"]],["Rudder speed",["rudder.halfturnTime"]],["Max speed",["speed.max"]],["Turn rate",["rudder.turnSpeed"]]]),this._moduleChanges=new Map([["Acceleration",["ship.acceleration"]],["Armor thickness",["sides.thickness","bow.thickness","stern.thickness"]],["Armour repair amount (perk)",["repairAmount.armourPerk"]],["Armour repair amount",["repairAmount.armour"]],["Armour strength",["bow.armour","sides.armour","stern.armour"]],["Back armour thickness",["stern.thickness"]],["Splinter resistance",["resistance.splinter"]],["Crew",["crew.max"]],["Fire resistance",["resistance.fire"]],["Front armour thickness",["bow.thickness"]],["Hold weight",["maxWeight"]],["Hull strength",["structure.armour"]],["Leak resistance",["resistance.leaks"]],["Mast health",["mast.bottomArmour","mast.middleArmour","mast.topArmour"]],["Mast thickness",["mast.bottomThickness","mast.middleThickness","mast.topThickness"]],["Rudder health",["rudder.armour"]],["Rudder repair time",["repairTime.rudder"]],["Rudder speed",["rudder.halfturnTime"]],["Sail repair amount (perk)",["repairAmount.sailsPerk"]],["Sail repair amount",["repairAmount.sails"]],["Sail repair time",["repairTime.sails"]],["Sailing crew",["crew.sailing"]],["Max speed",["speed.max"]],["Side armour repair time",["repairTime.sides"]],["Speed decrease",["ship.deceleration"]],["Turn rate",["rudder.turnSpeed"]],["Water pump health",["pump.armour"]],["Water repair time",["repairTime.pump"]]]),this._moduleCaps=new Map([["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],cap:{amount:.3,isPercentage:!0}}],["Armour strength",{properties:["bow.armour","sides.armour","stern.armour"],cap:{amount:.3,isPercentage:!0}}],["Back armour thickness",{properties:["stern.thickness"],cap:{amount:.3,isPercentage:!0}}],["Front armour thickness",{properties:["bow.thickness"],cap:{amount:.3,isPercentage:!0}}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],cap:{amount:.3,isPercentage:!0}}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],cap:{amount:.3,isPercentage:!0}}],["Max speed",{properties:["speed.max"],cap:{amount:15.5,isPercentage:!1}}],["Turn rate",{properties:["rudder.turnSpeed"],cap:{amount:.25,isPercentage:!0}}]]);var c=1.2*Object(i.a)(this._shipData,function(e){return e.speed.min}),h=this._moduleCaps.get("Max speed").cap.amount;this._minSpeed=c,this._maxSpeed=h,this._colorScale=Object(p.scaleLinear)().domain([this._minSpeed,0,8,12,this._maxSpeed]).range([u.j,"#fff",u.h,u.f,u.g]).interpolate(o.c),"ship-journey"===this._baseId?this._woodId="wood-journey":this._woodId="wood-ship",this._woodCompare=new l.a(a,this._woodId),"ship-journey"===this._baseId?(this._initData(),this._initSelects()):this._setupListener()}var a=t.prototype;return a._setupListener=function(){var t=this;e("#"+this._buttonId).on("click",function(e){Object(d.b)("Tools",t._baseName),e.stopPropagation(),t._shipCompareSelected()})},a._setGraphicsParameters=function(){this.svgWidth=parseInt(e("#"+this._modalId+" .column-base").width(),10),this.svgHeight=this.svgWidth,this.outerRadius=Math.floor(Math.min(this.svgWidth,this.svgHeight)/2),this.innerRadius=Math.floor(.3*this.outerRadius),this.radiusScaleAbsolute=Object(p.scaleLinear)().domain([this.minSpeed,0,this.maxSpeed]).range([10,this.innerRadius,this.outerRadius])},a._shipCompareSelected=function(){var t=this;this._modal$||(this._initModal(),this._modal$=e("#"+this._modalId),this._modal$.on("keydown",function(e){"KeyC"===e.code&&e.ctrlKey&&t._copyDataClicked(e)}),document.getElementById(this._copyButtonId).addEventListener("click",function(e){t._copyDataClicked(e)})),this._modal$.modal("show"),this._setGraphicsParameters()},a._getShipAndWoodIds=function(){var e=this,t=[];return this._columns.forEach(function(a){void 0!==e._shipIds[a]&&(t.push(e._shipIds[a]),["frame","trim"].forEach(function(s){t.push(Number(e._selectWood$[a][s].val()))}))}),t},a._copyDataClicked=function(e){var t=this;Object(d.b)("Menu","Copy ship compare"),e.preventDefault();var a=this._getShipAndWoodIds();if(a.length){var s=new URL(window.location);s.searchParams.set("v",encodeURIComponent(u.d)),s.searchParams.set("cmp",u.x.encode(a)),this._columns.forEach(function(e,a){t._selectedUpgradeIdsPerType[e]&&f(t._moduleTypes).forEach(function(i,r){var n=t._selectedUpgradeIdsPerType[e][i];if(n&&n.length){var o=""+a+r;s.searchParams.set(o,u.x.encode(n))}})}),Object(m.h)(s.href)}},a._setupShipData=function(){this.shipSelectData=Object(n.b)().key(function(e){return e.class}).sortKeys(r.a).entries(this._shipData.map(function(e){return{id:e.id,name:e.name,class:e.class,battleRating:e.battleRating,guns:e.guns}}).sort(Object(m.K)(["name"])))},a._setupModuleData=function(){var e=this;this._moduleProperties=new Map(this._moduleDataDefault.flatMap(function(t){return t[1].filter(function(t){return t.properties.some(function(t){return e._moduleChanges.has(t.modifier)})}).map(function(e){return[e.id,e]})})),this._moduleTypes=new Set(f(this._moduleProperties).map(function(e){return e[1].type.replace(/\s–\s[a-zA-Z\/\s]+/,"")}))},a._injectModal=function(){var e=this;Object(u.D)(this._modalId,this._baseName);var t=Object(c.f)("#"+this._modalId+" .modal-body").append("div").attr("class","container-fluid").append("div").attr("class","row");this._columns.forEach(function(a){var s=t.append("div").attr("class","col-md-4 ml-auto pt-2 "+("Base"===a?"column-base":"column-comp")),i=e._getShipSelectId(a);s.append("label").append("select").attr("name",i).attr("id",i).attr("class","selectpicker"),["frame","trim"].forEach(function(t){var i=e._getWoodSelectId(t,a);s.append("label").append("select").attr("name",i).attr("id",i).attr("class","selectpicker")}),e._moduleTypes.forEach(function(t){var i=e._getModuleSelectId(t,a);s.append("label").append("select").attr("name",i).attr("id",i).property("multiple",!0).attr("class","selectpicker")}),s.append("div").attr("id",e._baseId+"-"+a).attr("class","Base"===a?"ship-base":"ship-compare")}),Object(c.f)("#"+this._modalId+" .modal-footer").insert("button","button").classed("btn btn-outline-secondary",!0).attr("id",this._copyButtonId).attr("title","Copy to clipboard (ctrl-c)").attr("type","button").append("i").classed("far fa-copy",!0)},a._initData=function(){this._setupShipData(),this._setupModuleData(),this.woodCompare._setupData()},a._initSelects=function(){var t=this;this._columns.forEach(function(a){t._selectWood$[a]={},t._setupShipSelect(a),["frame","trim"].forEach(function(s){t._selectWood$[a][s]=e("#"+t._getWoodSelectId(s,a)),t.woodCompare._setupWoodSelects(a,s,t._selectWood$[a][s])}),t._setupSelectListener(a)})},a._initModal=function(){this._initData(),this._injectModal(),this._initSelects()},a._getShipOptions=function(){return this.shipSelectData.map(function(e){return'<optgroup label="'+Object(m.B)(e.key,!1)+' rate">'+e.values.map(function(e){return'<option data-subtext="'+e.battleRating+'" value="'+e.id+'">'+e.name+" ("+e.guns+")"}).join("</option>")}).join("</optgroup>")},a._setupShipSelect=function(t){this._selectShip$[t]=e("#"+this._getShipSelectId(t));var a=this._getShipOptions();this._selectShip$[t].append(a),"Base"!==t&&this._selectShip$[t].attr("disabled","disabled")},a._getUpgradesOptions=function(e,t){var a=Object(n.b)().key(function(e){return e[1].type.replace(/[a-zA-Z\s]+\s–\s/,"")}).sortKeys(r.a).entries(f(this._moduleProperties).filter(function(a){return a[1].type.replace(/\s–\s[a-zA-Z\/\s]+/,"")===e&&("U"===a[1].moduleLevel||a[1].moduleLevel===((s=t)<=3?"L":s<=5?"M":"S"));var s}));return a.length>1?a.map(function(t){return'<optgroup label="'+t.key+'" data-max-options="'+(e.startsWith("Ship trim")?1:5)+'">'+t.values.map(function(e){return'<option value="'+e[0]+'">'+e[1].name}).join("</option>")}).join("</optgroup>"):a.map(function(e){return""+e.values.map(function(e){return'<option value="'+e[0]+'">'+e[1].name}).join("</option>")})},a._fillModuleSelect=function(e,t){var a=this,s=this._getUpgradesOptions(t,a._shipData.find(function(t){return t.id===a._shipIds[e]}).class);this._selectModule$[e][t].find("option").remove(),this._selectModule$[e][t].append(s)},a._resetModuleSelects=function(e){var t=this;this._moduleTypes.forEach(function(a){t._fillModuleSelect(e,a),t._selectModule$[e][a].selectpicker("refresh")})},a._setupModulesSelect=function(t){var a=this;this._selectModule$[t]||(this._selectModule$[t]={},this._moduleTypes.forEach(function(s){a._selectModule$[t][s]=e("#"+a._getModuleSelectId(s,t)),a._selectModule$[t][s].on("changed.bs.select",function(){a._modulesSelected(t),a._refreshShips(t)}).on("show.bs.select",function(){a._selectModule$[t][s].parent().find("button.bs-select-all").remove()}).selectpicker({actionsBox:!0,countSelectedText:function(e){return e+" "+s.toLowerCase()+"s selected"},deselectAllText:"Clear",maxOptions:s.startsWith("Ship trim")?6:5,selectedTextFormat:"count > 1",title:""+s,width:"150px"})})),this._resetModuleSelects(t)},a._getShipData=function(e){var t=this,a=this._shipData.find(function(a){return a.id===t._shipIds[e]}),s=a;return s.repairAmount={},s.repairAmount.armour=u.y,s.repairAmount.armourPerk=0,s.repairAmount.sails=u.H,s.repairAmount.sailsPerk=0,s.repairTime.sides=u.G,s.repairTime.default=u.G,s=this._addWoodData(a,e),s=this._addModulesData(a,s,e)},a._addWoodData=function(e,t){var a=this,s=function(e,t){return e?e+t:t},i=function(e,t){return e?e*(1+t):t},r=JSON.parse(JSON.stringify(e));if(r.resistance={},r.resistance.fire=0,r.resistance.leaks=0,r.resistance.splinter=0,void 0!==this.woodCompare._instances[t]){var n="_woodData";"Base"!==t&&(n="_compareData");var o=new Map;["frame","trim"].forEach(function(e){a.woodCompare._instances[t][n][e].properties.forEach(function(e){if(a._woodChanges.has(e.modifier)){var t=e.isPercentage?0:e.amount,s=e.isPercentage?e.amount:0;o.has(e.modifier)&&(t+=o.get(e.modifier).absolute,s+=o.get(e.modifier).percentage),o.set(e.modifier,{absolute:t,percentage:s})}})}),o.forEach(function(e,t){a._woodChanges.get(t).forEach(function(e){var a=e.split(".");if(o.get(t).absolute){var n=o.get(t).absolute;a.length>1?r[a[0]][a[1]]=s(r[a[0]][a[1]],n):r[a[0]]=s(r[a[0]],n)}if(o.get(t).percentage){var p=o.get(t).percentage/100;a.length>1?r[a[0]][a[1]]=i(r[a[0]][a[1]],p):r[a[0]]=i(r[a[0]],p)}})}),r.speedDegrees=r.speedDegrees.map(function(e){var t=1+o.get("Max speed").percentage/100;return Math.max(Math.min(e*t,a._maxSpeed),a._minSpeed)})}return r},a._addModulesData=function(e,t,a){var s=this,i=JSON.parse(JSON.stringify(t)),r=new Map;return this._selectedUpgradeIdsList[a]?(s._selectedUpgradeIdsList[a].forEach(function(e){s._moduleProperties.get(e).properties.forEach(function(e){if(s._moduleChanges.has(e.modifier)){var t=e.isPercentage?0:e.amount,a=e.isPercentage?e.amount:0;r.has(e.modifier)&&(t+=r.get(e.modifier).absolute,a+=r.get(e.modifier).percentage),r.set(e.modifier,{absolute:t,percentage:a})}})}),r.forEach(function(e,t){s._moduleChanges.get(t)&&s._moduleChanges.get(t).forEach(function(e){!function(e,t){var a=function(e,t){return e?e+t:t},s=function(e,t){return e?e*(1+t):t},n=t.split(".");if(r.get(e).absolute){var o=r.get(e).absolute;n.length>1?i[n[0]][n[1]]=a(i[n[0]][n[1]],o):i[n[0]]=a(i[n[0]],o)}if(r.get(e).percentage){var p=r.get(e).percentage/100;n.length>1?i[n[0]][n[1]]=s(i[n[0]][n[1]],p):i[n[0]]=s(i[n[0]],p)}}(t,e)})}),r.forEach(function(t,a){if(s._moduleCaps.has(a)){var r=s._moduleCaps.get(a).cap;s._moduleCaps.get(a).properties.forEach(function(t){var a=t.split(".");a.length>1?i[a[0]][a[1]]&&(i[a[0]][a[1]]=Math.min(i[a[0]][a[1]],r.isPercentage?e[a[0]][a[1]]*(1+r.amount):r.amount)):i[a[0]]&&(i[a[0]]=Math.min(i[a[0]],r.isPercentage?e[a[0]]*(1+r.amount):r.amount))})}}),r.has("Max speed")&&(i.speedDegrees=i.speedDegrees.map(function(e){var t=1+r.get("Max speed").percentage/100,a=e>0?e*t:e/t;return Math.max(Math.min(a,s._maxSpeed),s._minSpeed)})),i):i},a._refreshShips=function(e){var t=this;"ship-journey"!==this._baseId&&this._modulesSelected(e);var a=this._getShipData(e);"ship-journey"===this._baseId?this._singleShipData=a:"Base"===e?(this._setSelectedShip(e,new C(e,a,this)),this._columnsCompare.forEach(function(e){t._selectShip$[e].removeAttr("disabled").selectpicker("refresh"),Object(m.D)(t.selectedShips[e])||t._setSelectedShip(e,new S(e,a,t.selectedShips[e]._shipCompareData,t))})):this._setSelectedShip(e,new S(e,this.selectedShips.Base._shipData,a,this))},a._enableCompareSelects=function(){var e=this;this._columnsCompare.forEach(function(t){e._selectShip$[t].removeAttr("disabled").selectpicker("refresh")})},a._modulesSelected=function(e){var t=this;this._selectedUpgradeIdsList[e]=[],this._selectedUpgradeIdsPerType[e]={},this._moduleTypes.forEach(function(a){t._selectedUpgradeIdsPerType[e][a]=t._selectModule$[e][a].val(),Array.isArray(t._selectedUpgradeIdsPerType[e][a])?t._selectedUpgradeIdsPerType[e][a]=t._selectedUpgradeIdsPerType[e][a].map(Number):t._selectedUpgradeIdsPerType[e][a]=""===t._selectedUpgradeIdsPerType[e][a]?[]:[Number(t._selectedUpgradeIdsPerType[e][a])],t._selectedUpgradeIdsPerType[e][a].length&&(t._selectedUpgradeIdsList[e]=t._selectedUpgradeIdsList[e].concat(t._selectedUpgradeIdsPerType[e][a]))})},a._setupSelectListener=function(e){var t=this;this._selectShip$[e].selectpicker({title:"Ship"}).on("changed.bs.select",function(){t._shipIds[e]=Number(t._selectShip$[e].val()),"ship-journey"!==t._baseId&&t._setupModulesSelect(e),t._refreshShips(e),"Base"===e&&"ship-journey"!==t._baseId&&t._enableCompareSelects(),t.woodCompare.enableSelects(e)}),["frame","trim"].forEach(function(a){t._selectWood$[e][a].on("changed.bs.select",function(){t.woodCompare._woodSelected(e,a,t._selectWood$[e][a]),t._refreshShips(e)}).selectpicker({title:"Wood "+a,width:"150px"})})},a.initFromClipboard=function(e){var t,a,s=this,i=function(e,t){t&&e.val(t),e.selectpicker("render")},r=u.x.decode(e.get("cmp"));r.length&&(this._shipCompareSelected(),r.length>3&&this._enableCompareSelects(),t=r,a=0,s._columns.some(function(e){return!!s._shipData.find(function(e){return e.id===t[a]})&&(s._shipIds[e]=t[a],a+=1,i(s._selectShip$[e],s._shipIds[e]),"Base"===e&&"ship-journey"!==s._baseId&&s._enableCompareSelects(),s.woodCompare.enableSelects(e),s._setupModulesSelect(e),t[a]?["frame","trim"].forEach(function(r){i(s._selectWood$[e][r],t[a]),a+=1,s.woodCompare._woodSelected(e,r,s._selectWood$[e][r])}):a+=2,s._refreshShips(e),a>=t.length)}),s._columns.forEach(function(t,a){var r=!1;f(s._moduleTypes).forEach(function(n,o){if(e.has(""+a+o)){var p=u.x.decode(e.get(""+a+o));s._selectedUpgradeIdsPerType[t]||(s._selectedUpgradeIdsPerType[t]={}),s._selectedUpgradeIdsList[t]||(s._selectedUpgradeIdsList[t]=[]),s._selectedUpgradeIdsPerType[t][n]=p.map(Number),i(s._selectModule$[t][n],s._selectedUpgradeIdsPerType[t][n]),s._selectedUpgradeIdsList[t]=s._selectedUpgradeIdsList[t].concat(s._selectedUpgradeIdsPerType[t][n]),r=!0}}),r&&s._refreshShips(t)}))},a._getShipSelectId=function(e){return this._baseId+"-"+e+"-select"},a._getWoodSelectId=function(e,t){return this._woodId+"-"+e+"-"+t+"-select"},a._getModuleSelectId=function(e,t){return this._moduleId+"-"+e.replace(/\s/,"")+"-"+t+"-select"},a._setSelectedShip=function(e,t){this._selectedShips[e]=t},b(t,[{key:"woodCompare",get:function(){return this._woodCompare}},{key:"selectedShips",get:function(){return this._selectedShips}},{key:"minSpeed",get:function(){return this._minSpeed}},{key:"maxSpeed",get:function(){return this._maxSpeed}},{key:"colorScale",get:function(){return this._colorScale}},{key:"svgWidth",set:function(e){this._svgWidth=e},get:function(){return this._svgWidth}},{key:"svgHeight",set:function(e){this._svgHeight=e},get:function(){return this._svgHeight}},{key:"outerRadius",set:function(e){this._outerRadius=e},get:function(){return this._outerRadius}},{key:"innerRadius",set:function(e){this._innerRadius=e},get:function(){return this._innerRadius}},{key:"radiusScaleAbsolute",set:function(e){this._radiusScaleAbsolute=e},get:function(){return this._radiusScaleAbsolute}}]),t}()}).call(this,a("xeH2"))},pFgi:function(e,t,a){"use strict";(function(e){a.d(t,"a",function(){return l});a("iPZ8"),a("kypl"),a("pCzD"),a("hi3g"),a("lYjL"),a("IlJM"),a("Se8w"),a("4owi"),a("/YXa"),a("lmye"),a("WB5j"),a("aOEW"),a("bEJU"),a("D/wG"),a("1Qwx"),a("fp7Y"),a("ZEAQ"),a("JBxO"),a("9UJh"),a("RsMT"),a("WoWj"),a("SgDD"),a("3dw1"),a("U00V");var s=a("ED/D"),i=a("qKAC"),r=a("nUlG"),n=a("f4w0"),o=a("0lY5"),p=a("Av7d");function c(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function h(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var d=function(){function e(e,t){this._id=e,this._woodCompare=t,this._select="#"+this._woodCompare._baseFunction+"-"+this._id,this._setupMainDiv(),this._g=Object(r.f)(this._select).select("g")}return e.prototype._setupMainDiv=function(){Object(r.f)(this._select+" div").remove(),Object(r.f)(this._select).append("div")},e}(),u=function(t){function a(e,a,s){var i;return(i=t.call(this,e,s)||this)._woodData=a,i._woodCompare=s,i._printText(),i}h(a,t);var s=a.prototype;return s._getProperty=function(e,t){var a=this._woodData[t].properties.find(function(t){return t.modifier===e}),s=0,i=!1;return a&&a.amount&&(s=a.amount,i=a.isPercentage),{amount:s,isPercentage:i}},s._getPropertySum=function(e){var t=this._getProperty(e,"frame"),a=this._getProperty(e,"trim");return{amount:t.amount+a.amount,isPercentage:a.isPercentage}},s._getText=function(e){var t=this,a='<table class="table table-sm table-striped small mt-4"><thead>';return a+="<tr>",a+="<tr><th><em>Property</em></th><th><em>Change</em></th></tr></thead><tbody>",e.properties.forEach(function(e,s){if(a+="<tr><td>"+s+"</td><td>"+(e.isPercentage?Object(o.u)(e.amount/100):Object(o.p)(e.amount)),a+='<span class="rate">',e.amount>0){var i=e.amount/t._woodCompare._minMaxProperty.get(s).max*50;a+='<span class="bar neutral" style="width:50%;"></span>',a+='<span class="bar pos diff" style="width:'+i+'%;"></span>'}else if(e.amount<0){var r=e.amount/t._woodCompare._minMaxProperty.get(s).min*50;a+='<span class="bar neutral" style="width:'+(50-r)+'%;"></span>',a+='<span class="bar neg diff" style="width:'+r+'%;"></span>'}else a+='<span class="bar neutral"></span>';a+="</span></td></tr>"}),a+="</tbody></table>"},s._printText=function(){var t=this,a={frame:this._woodData.frame.id,trim:this._woodData.trim.id};a.properties=new Map,this._woodCompare.propertyNames.forEach(function(e){var s=t._getPropertySum(e);a.properties.set(e,{amount:s.amount,isPercentage:s.isPercentage})}),e(""+this._select).find("div").append(this._getText(a))},a}(d),m=function(t){function a(e,a,s,i){var r;return(r=t.call(this,e,i)||this)._baseData=a,r._compareData=s,r._woodCompare=i,r._printTextComparison(),r}h(a,t);var s=a.prototype;return s._getBaseProperty=function(e,t){var a=this._baseData[t].properties.find(function(t){return t.modifier===e}),s=0,i=!1;return a&&a.amount&&(s=a.amount,i=a.isPercentage),{amount:s,isPercentage:i}},s._getBasePropertySum=function(e){var t=this._getBaseProperty(e,"frame"),a=this._getBaseProperty(e,"trim");return{amount:t.amount+a.amount,isPercentage:a.isPercentage}},s._getCompareProperty=function(e,t){var a=this._compareData[t].properties.find(function(t){return t.modifier===e}),s=0,i=!1;return a&&a.amount&&(s=a.amount,i=a.isPercentage),{amount:s,isPercentage:i}},s._getComparePropertySum=function(e){var t=this._getCompareProperty(e,"frame"),a=this._getCompareProperty(e,"trim");return{amount:t.amount+a.amount,isPercentage:t.isPercentage&&a.isPercentage}},s._getText=function(e){var t=this;var a=0,s=0,i=0,r="",n='<table class="table table-sm table-striped small wood mt-4"><thead>';return n+="<tr>",n+="<tr><th><em>Property</em></th><th><em>Change</em></th></tr></thead><tbody>",e.properties.forEach(function(e,p){n+="<tr><td>"+p+"</td><td>"+function(e,t,a,s){void 0===s&&(s=1);var i=parseFloat((e-t).toFixed(s));return(a?Object(o.u)(e/100,s):Object(o.p)(e))+' <span class="badge badge-white">'+Object(o.x)(i)+"</span>"}(e.compare,e.base,e.isPercentage),n+='<span class="rate">',e.compare>=0?(e.base>=0?e.compare>e.base?(a=e.base,s=e.compare-e.base,r="pos"):(a=e.compare,s=e.base-e.compare,r="neg"):(a=0,s=e.compare,r="pos"),n+='<span class="bar neutral" style="width:50%;"></span>',n+='<span class="bar pos diff" style="width:'+a/t._woodCompare._minMaxProperty.get(p).max*50+'%;"></span>',n+='<span class="bar '+r+'" style="width:'+s/t._woodCompare._minMaxProperty.get(p).max*50+'%;"></span>'):e.compare<0?(e.base<0?e.compare>=e.base?(a=e.compare,s=e.base-e.compare,i=-e.base,r="pos"):(a=e.base,s=e.compare-e.base,i=-e.compare,r="neg"):(a=0,s=e.compare,i=-e.compare,r="neg"),n+='<span class="bar neutral" style="width:'+(50+i/t._woodCompare._minMaxProperty.get(p).min*50)+'%;"></span>',n+='<span class="bar '+r+'" style="width:'+s/t._woodCompare._minMaxProperty.get(p).min*50+'%;"></span>',n+='<span class="bar neg diff" style="width:'+a/t._woodCompare._minMaxProperty.get(p).min*50+'%;"></span>'):n+='<span class="bar neutral"></span>',n+="</span></td></tr>"}),n+="</tbody></table>"},s._printTextComparison=function(){var t=this,a={frame:this._compareData.frame.name,trim:this._compareData.trim.name};a.properties=new Map,this._woodCompare.propertyNames.forEach(function(e){var s=t._getBasePropertySum(e),i=t._getComparePropertySum(e);a.properties.set(e,{base:s.amount,compare:i.amount,isPercentage:s.isPercentage})}),e(""+this._select).find("div").append(this._getText(a))},a}(d),l=function(){function t(e,t){var a=this;this._woodData=e,this._baseFunction=t,this._baseName="Compare woods",this._baseId=this._baseFunction+"-compare",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId;var s=function(e,t){return a._woodData[e].find(function(e){return e.name===t}).id};"wood"===this._baseFunction?(this._defaultWood={frame:s("frame","Fir"),trim:s("trim","Crew Space")},this._columnsCompare=["C1","C2","C3"]):"wood-journey"===this._baseFunction?(this._defaultWood={frame:s("frame","Oak"),trim:s("trim","Oak")},this._columnsCompare=[]):(this._defaultWood={frame:s("frame","Oak"),trim:s("trim","Oak")},this._columnsCompare=["C1","C2"]),this._columns=this._columnsCompare.slice(),this._columns.unshift("Base"),this._woodsSelected=[],this._instances=[],this.propertyNames=new Set([].concat(c(this._woodData.frame.map(function(e){return e.properties.map(function(e){return e.modifier})}).flat()),c(this._woodData.trim.map(function(e){return e.properties.map(function(e){return e.modifier})}).flat())).sort()),this._options={},this._minMaxProperty=new Map,this._setupListener()}var a=t.prototype;return a._setupListener=function(){var t=this;e("#"+this._buttonId).on("click",function(e){Object(n.b)("Tools",t._baseName),e.stopPropagation(),t._woodCompareSelected()})},a._woodCompareSelected=function(){document.getElementById(this._modalId)||this._initModal(),e("#"+this._modalId).modal("show")},a._setupData=function(){var e=this;this._frameSelectData=this._woodData.frame.sort(Object(o.K)(["name"])),this._trimSelectData=this._woodData.trim.sort(Object(o.K)(["name"])),this._setOption(this._frameSelectData.map(function(e){return'<option value="'+e.id+'">'+e.name+"</option>"}),this._trimSelectData.map(function(e){return'<option value="'+e.id+'">'+e.name+"</option>"})),this.propertyNames.forEach(function(t){var a=c(e._woodData.frame.map(function(e){return e.properties.filter(function(e){return e.modifier===t}).map(function(e){return e.amount})[0]})),r=c(e._woodData.trim.map(function(e){return e.properties.filter(function(e){return e.modifier===t}).map(function(e){return e.amount})[0]})),n=Object(s.a)(a)||0,o=Object(i.a)(a)||0,p=Object(s.a)(r)||0,h=Object(i.a)(r)||0;e._addMinMaxProperty(t,{min:n+p>=0?0:n+p,max:o+h})})},a._injectModal=function(){var e=this;Object(p.D)(this._modalId,this._baseName);var t=Object(r.f)("#"+this._modalId+" .modal-body").append("div").attr("class","container-fluid").append("div").attr("class","row wood");this._columns.forEach(function(a){var s=t.append("div").attr("class","col-md-3 ml-auto pt-2 "+("Base"===a?"column-base":"column-comp"));["frame","trim"].forEach(function(t){var i=e._baseFunction+"-"+t+"-"+a+"-select";s.append("label").attr("for",i),s.append("select").attr("name",i).attr("id",i).attr("class","selectpicker")}),s.append("div").attr("id",e._baseFunction+"-"+a)})},a._initModal=function(){var t=this;this._setupData(),this._injectModal(),this._columns.forEach(function(a){["frame","trim"].forEach(function(s){var i=e("#"+t._baseFunction+"-"+s+"-"+a+"-select");t._setupWoodSelects(a,s,i),t._setupSelectListener(a,s,i)})})},a._setWoodsSelected=function(e,t,a){this._woodsSelected[e]||(this._woodsSelected[e]={}),this._woodsSelected[e][t]=a},a._setupWoodSelects=function(e,t,a){this._setWoodsSelected(e,t,this._defaultWood[t]),a.append(this._options[t]),("wood"!==this._baseFunction||"Base"!==e&&"wood"===this._baseFunction)&&a.attr("disabled","disabled")},a._setOtherSelect=function(t,a){var s="frame"===a?"trim":"frame";this._woodsSelected[t][s]===this._defaultWood[s]&&e("#"+this._baseFunction+"-"+s+"-"+t+"-select").val(this._defaultWood[s]).selectpicker("refresh")},a.enableSelects=function(t){var a=this;["frame","trim"].forEach(function(s){e("#"+a._baseFunction+"-"+s+"-"+t+"-select").removeAttr("disabled").selectpicker("refresh")})},a._woodSelected=function(e,t,a){var s=this,i=Number(a.val());this._setWoodsSelected(e,t,i),this._setOtherSelect(e,t),"Base"===e?(this._addInstance(e,new u("Base",this._getWoodData("Base"),this)),this._columnsCompare.forEach(function(e){"wood"===s._baseFunction&&s.enableSelects(e),s._instances[e]&&s._addInstance(e,new m(e,s._getWoodData("Base"),s._getWoodData(e),s))})):this._addInstance(e,new m(e,this._getWoodData("Base"),this._getWoodData(e),this))},a._setupSelectListener=function(e,t,a){var s=this;a.on("change",function(){return s._woodSelected(e,t,a)}).selectpicker({title:"Select "+t})},a._getWoodData=function(e){return{frame:this.getWoodTypeData("frame",this._woodsSelected[e].frame),trim:this.getWoodTypeData("trim",this._woodsSelected[e].trim)}},a._addMinMaxProperty=function(e,t){this._minMaxProperty.set(e,t)},a._setOption=function(e,t){this._options.frame=e,this._options.trim=t},a._addInstance=function(e,t){this._instances[e]=t},a.getWoodTypeData=function(e,t){return this._woodData[e].find(function(e){return e.id===t})},t}()}).call(this,a("xeH2"))}}]);