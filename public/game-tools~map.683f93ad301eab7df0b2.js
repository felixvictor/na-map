/*! For license information please see game-tools~map.683f93ad301eab7df0b2.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{iSiJ:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return x}));a("iPZ8"),a("kypl"),a("pCzD"),a("hi3g"),a("C4nn"),a("lYjL"),a("IlJM"),a("SJSz"),a("4owi"),a("IvQZ"),a("/YXa"),a("8cZI"),a("lmye"),a("WB5j"),a("aOEW"),a("RsBt"),a("D/wG"),a("1Qwx"),a("fp7Y"),a("ZEAQ"),a("JBxO"),a("FdtR"),a("9UJh"),a("RsMT"),a("WoWj"),a("y89P"),a("aZFp"),a("MTDe"),a("3dw1"),a("U00V"),a("9DLp"),a("wcNg"),a("3XUK"),a("Peo2"),a("/1Gu");var s=a("ED/D"),i=a("qKAC"),r=a("SYoz"),o=a("BfWa"),n=a("Tj8s"),p=a("8RCj"),c=a("OQCi"),h=a("nUlG"),d=a("bTsO"),u=a("u1QP"),l=a("qbdS"),m=a("mIOj"),_=a("f4w0"),f=a("Av7d"),b=a("0lY5"),g=a("pFgi"),D=a("t1jV"),S=a.n(D);function v(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function C(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function w(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function k(e,t,a){return t&&w(e.prototype,t),a&&w(e,a),e}var y=2*Math.PI/24,A=f.H/f.I,j=function(){function e(e,t){this._id=e,this._shipCompare=t,this._ticksSpeed=[12,8,4,0],this._ticksSpeedLabels=["12 knots","8 knots","4 knots","0 knots"],this._select="#ship-compare-"+this._id,this._setupSvg(),this._g=Object(h.f)(this._select).select("g"),this._setCompass()}var t=e.prototype;return t._setupSvg=function(){var e=Object(h.f)(this.select);Object(h.f)(this.select+" svg").remove(),e.append("svg").attr("width",this._shipCompare.svgWidth).attr("height",this._shipCompare.svgHeight).attr("data-ui-component","sailing-profile").attr("fill","none").append("g").attr("transform","translate("+this._shipCompare.svgWidth/2+", "+this._shipCompare.svgHeight/2+")"),Object(h.f)(this.select+" div").remove(),e.append("div").attr("class","block-small")},t._setCompass=function(){var e=this,t=new Array(12);t.fill(1,0);var a=Object(d.a)().sort(null).value(1)(t),s=Object(u.a)().outerRadius(this._shipCompare.radiusScaleAbsolute(12)).innerRadius(this._shipCompare.innerRadius);this.g.append("g").attr("class","compass-arc").selectAll("path").data(a).join((function(e){return e.append("path").attr("d",s)})),this.g.append("g").attr("class","speed-circle").selectAll("circle").data(this._ticksSpeed).join((function(t){return t.append("circle").attr("r",(function(t){return e._shipCompare.radiusScaleAbsolute(t)}))})),this.g.append("path").attr("d","M0-79v-81z").attr("class","ship-profile-arrow").attr("marker-end","url(#ship-profile-arrow-head)")},e.pd=function(e){var t='<span class="badge badge-white">'+e[0]+" / ";return e[1]?t+=""+e[1]:t+="–",t+=" lb</span>"},e.getCannonsPerDeck=function(t,a){for(var s=a[0]+" "+e.pd(t[0]),i="",r=1;r<4;r+=1)a[r]?s=a[r]+" "+e.pd(t[r])+" <br>"+s:i+="<br>";return[s,i]},e.displaySecondBlock=function(){return'<div class="col-9"><div class="row no-gutters">'},e.getText=function(t){var a=0;function s(e){return'<div class="row row-small '+((a+=1)%2?"row-light":"")+'"><div class="col-3">'+e+"</div>"}function i(e,a,s){void 0===s&&(s=6);var i="",r="";if("cannonsPerDeck"===e){var o=t[e];i=o[0],r="<br>"+(r=o[1])}else i=""===e?"":t[e];return'<div class="col-'+s+'">'+i+'<br><span class="des">'+a+"</span>"+r+"</div>"}var r="";return r+=s(t.shipRating),r+=e.displaySecondBlock(),r+=i("battleRating","Battle rating"),r+=i("guns","Cannons"),r+=i("upgradeXP","Knowledge XP"),r+=i("waterlineHeight","Water line"),r+="</div></div></div>",r+=s(t.decks),r+=e.displaySecondBlock(),r+=i("cannonsPerDeck","Gun decks"),r+=i("firezoneHorizontalWidth","Firezone horizontal width"),r+="</div></div></div>",r+=s("Broadside (lb)"),r+=e.displaySecondBlock(),r+=i("cannonBroadside","Cannons"),r+=i("carroBroadside","Carronades"),r+="</div></div></div>",r+=s("Chasers"),r+=e.displaySecondBlock(),r+=i("gunsFront","Bow"),r+=i("gunsBack","Stern"),r+="</div></div></div>",r+=s("Speed"),r+=e.displaySecondBlock(),r+=i("maxSpeed","Maximum"),r+=i("",""),r+=i("acceleration","Acceleration"),r+=i("deceleration","Deceleration"),r+=i("maxTurningSpeed","Turn speed"),r+=i("halfturnTime","Rudder half time"),r+="</div></div></div>",r+=s('Hit points <span class="badge badge-white">Thickness</span>'),r+=e.displaySecondBlock(),r+=i("sideArmor","Sides"),r+=i("structure","Hull"),r+=i("frontArmor","Bow"),r+=i("backArmor","Stern"),r+=i("pump","Pump"),r+=i("rudder","Rudder"),r+="</div></div></div>",r+=s('Masts <span class="badge badge-white">Thickness</span>'),r+=e.displaySecondBlock(),r+=i("sails","Sails"),r+=i("mastBottomArmor","Bottom"),r+=i("mastMiddleArmor","Middle"),r+=i("mastTopArmor","Top"),r+="</div></div></div>",r+=s("Crew"),r+=e.displaySecondBlock(),r+=i("minCrew","Minimum",4),r+=i("sailingCrew","Sailing",4),r+=i("maxCrew","Maximum",4),r+="</div></div></div>",r+=s("Resistance"),r+=e.displaySecondBlock(),r+=i("fireResistance","Fire",4),r+=i("leakResistance","Leak",4),r+=i("splinterResistance","Splinter",4),r+="</div></div></div>",r+=s('Repairs needed <span class="badge badge-white">Set of 5</span>'),r+=e.displaySecondBlock(),r+=i("hullRepairsNeeded","Hull",4),r+=i("rigRepairsNeeded","Rig",4),r+=i("rumRepairsNeeded","Rum",4),r+="</div></div></div>",r+=s("Repair"),r+=e.displaySecondBlock(),r+=i("hullRepairAmount","Hull %",4),r+=i("rigRepairAmount","Rig %",4),r+=i("repairTime","Time (sec)",4),r+="</div></div></div>",r+=s("Hold"),r+=e.displaySecondBlock(),r+=i("maxWeight","Tons"),r+=i("holdSize","Cargo slots"),r+="</div></div></div>",r+="</div>"},k(e,[{key:"id",get:function(){return this._id}},{key:"shipData",get:function(){return this._shipData}},{key:"select",get:function(){return this._select}},{key:"g",get:function(){return this._g}}]),e}(),B=function(t){function a(e,a,s){var i;return(i=t.call(this,e,s)||this)._shipData=a,i._shipCompare=s,i._setupDrag(),i._setBackground(),i._drawProfile(),i._printText(),i}C(a,t);var s=a.prototype;return s._setupDrag=function(){var e=this;this._dragShip=Object(n.a)().on("start",(function(e,t,a){Object(h.f)(a[t]).classed("drag-active",!0)})).on("drag",(function(t,a,s){var i=h.b.x-e._xShip,r=h.b.y-e._yShip,o=Math.atan2(r,i);e._shipRotate+=Object(b.H)(o),Object(h.f)(s[a]).attr("transform","rotate("+e._shipRotate+")")})).on("end",(function(e,t,a){Object(h.f)(a[t]).classed("drag-active",!1)}))},s._setBackground=function(){var e=this,t=Object(u.a)().outerRadius((function(t){return e._shipCompare.radiusScaleAbsolute(t)+2})).innerRadius((function(t){return e._shipCompare.radiusScaleAbsolute(t)+1})).startAngle(-Math.PI/2).endAngle(Math.PI/2);this.g.append("g").attr("data-ui-component","speed-textpath").selectAll("path").data(this._ticksSpeed).join((function(e){return e.append("path").attr("d",t).attr("id",(function(e,t){return"tick"+t}))})),this.g.append("g").attr("class","speed-text").selectAll("text").data(this._ticksSpeed).join((function(t){return t.append("text").append("textPath").attr("href",(function(e,t){return"#tick"+t})).text((function(t,a){return e._ticksSpeedLabels[a]})).attr("startOffset","10%")}));var a=this._shipData.shipMass;this._heightShip=this._shipCompare.shipMassScale(a),this._widthShip=this._heightShip,this._xShip=-this._widthShip/2,this._yShip=-this._heightShip/2,this._shipRotate=0;var s=this.g.append("g").attr("class","ship-outline").attr("transform","rotate("+this._shipRotate+")");s.append("image").attr("height",this._heightShip).attr("width",this._widthShip).attr("x",this._xShip).attr("y",this._yShip).attr("xlink:href",S.a),s.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",160),s.append("circle").attr("cx","0").attr("cy","160").attr("r","10")},s._drawProfile=function(){var e=this,t=Object(d.a)().sort(null).value(1)(this._shipData.speedDegrees),a=l.a,s=Object(m.a)().angle((function(e,t){return t*y})).radius((function(t){return e._shipCompare.radiusScaleAbsolute(t.data)})).curve(a);this.g.append("path").attr("class","base-profile").attr("d",s(t)),this.g.append("g").attr("data-ui-component","speed-markers").selectAll("circle").data(t).join((function(t){return t.append("circle").attr("r",5).attr("cy",(function(t,a){return Math.cos(a*y)*-e._shipCompare.radiusScaleAbsolute(t.data)})).attr("cx",(function(t,a){return Math.sin(a*y)*e._shipCompare.radiusScaleAbsolute(t.data)})).attr("fill",(function(t){return e._shipCompare.colorScale(t.data)})).attr("fill",(function(t){return e._shipCompare.colorScale(t.data)})).append("title").text((function(e){return Math.round(10*e.data)/10+" knots"}))}))},s._printText=function(){var t=j.getCannonsPerDeck(this._shipData.deckClassLimit,this._shipData.gunsPerDeck),a=Math.round(this._shipData.sides.armour*this._shipData.repairAmount.armour/f.x),s=Math.round(this._shipData.sails.armour*this._shipData.repairAmount.sails/f.G),i=Math.round(this._shipData.crew.max*A),r={shipRating:Object(b.A)(this._shipData.class)+" rate",battleRating:this._shipData.battleRating,guns:this._shipData.guns,decks:this._shipData.decks+" deck"+(this._shipData.decks>1?"s":""),additionalRow:this._shipData.decks<4?"<br> ":"",cannonsPerDeck:t,cannonBroadside:Object(b.r)(this._shipData.broadside.cannons),carroBroadside:Object(b.r)(this._shipData.broadside.carronades),gunsFront:this._shipData.gunsPerDeck[4],limitFront:this._shipData.deckClassLimit[4],gunsBack:this._shipData.gunsPerDeck[5],limitBack:this._shipData.deckClassLimit[5],firezoneHorizontalWidth:this._shipData.ship.firezoneHorizontalWidth,waterlineHeight:Object(b.o)(this._shipData.ship.waterlineHeight),maxSpeed:Object(b.o)(this._shipData.speed.max,4),acceleration:Object(b.o)(this._shipData.ship.acceleration),deceleration:Object(b.o)(this._shipData.ship.deceleration),maxTurningSpeed:Object(b.o)(this._shipData.rudder.turnSpeed,3),halfturnTime:Object(b.o)(this._shipData.rudder.halfturnTime),sideArmor:Object(b.r)(this._shipData.sides.armour)+' <span class="badge badge-white">'+Object(b.r)(this._shipData.sides.thickness)+"</span>",frontArmor:Object(b.r)(this._shipData.bow.armour)+' <span class="badge badge-white">'+Object(b.r)(this._shipData.bow.thickness)+"</span>",pump:Object(b.r)(this._shipData.pump.armour),sails:Object(b.r)(this._shipData.sails.armour),structure:Object(b.r)(this._shipData.structure.armour),backArmor:Object(b.r)(this._shipData.stern.armour)+' <span class="badge badge-white">'+Object(b.r)(this._shipData.stern.thickness)+"</span>",rudder:Object(b.r)(this._shipData.rudder.armour)+' <span class="badge badge-white">'+Object(b.r)(this._shipData.rudder.thickness)+"</span>",minCrew:Object(b.r)(this._shipData.crew.min),maxCrew:Object(b.r)(this._shipData.crew.max),sailingCrew:Object(b.r)(this._shipData.crew.sailing||0),maxWeight:Object(b.r)(this._shipData.maxWeight),holdSize:Object(b.r)(this._shipData.holdSize),upgradeXP:Object(b.r)(this._shipData.upgradeXP),sternRepair:""+Object(b.r)(this._shipData.repairTime.stern),bowRepair:""+Object(b.r)(this._shipData.repairTime.bow),hullRepairAmount:""+Object(b.r)(100*(this._shipData.repairAmount.armour+this._shipData.repairAmount.armourPerk)),rigRepairAmount:""+Object(b.r)(100*(this._shipData.repairAmount.sails+this._shipData.repairAmount.sailsPerk)),repairTime:""+Object(b.r)(this._shipData.repairTime.sides),hullRepairsNeeded:Object(b.r)(a)+' <span class="badge badge-white">'+Object(b.r)(5*a)+"</span>",rigRepairsNeeded:Object(b.r)(s)+' <span class="badge badge-white">'+Object(b.r)(5*s)+"</span>",rumRepairsNeeded:Object(b.r)(i)+' <span class="badge badge-white">'+Object(b.r)(5*i)+"</span>",fireResistance:Object(b.u)(this._shipData.resistance.fire,0),leakResistance:Object(b.u)(this._shipData.resistance.leaks,0),splinterResistance:Object(b.u)(this._shipData.resistance.splinter,0),mastBottomArmor:Object(b.r)(this._shipData.mast.bottomArmour)+' <span class="badge badge-white">'+Object(b.r)(this._shipData.mast.bottomThickness)+"</span>",mastMiddleArmor:Object(b.r)(this._shipData.mast.middleArmour)+' <span class="badge badge-white">'+Object(b.r)(this._shipData.mast.middleThickness)+"</span>",mastTopArmor:Object(b.r)(this._shipData.mast.topArmour)+' <span class="badge badge-white">'+Object(b.r)(this._shipData.mast.topThickness)+"</span>"};r.gunsFront?r.gunsFront+=" "+j.pd(r.limitFront):r.gunsFront="–",r.gunsBack?r.gunsBack+=" "+j.pd(r.limitBack):r.gunsBack="–",e(""+this.select).find("div").append(j.getText(r))},a}(j),O=function(t){function a(e,a,r,o){var n;(n=t.call(this,e,o)||this)._shipBaseData=a,n._shipCompareData=r,n._shipCompare=o,n._pie=Object(d.a)().sort(null).value(1);var p=l.a;return n._line=Object(m.a)().angle((function(e,t){return t*y})).radius((function(e){return n.shipCompare.radiusScaleAbsolute(e.data)})).curve(p),n._arcsBase=n._pie(n.shipBaseData.speedDegrees),n._arcsComp=n._pie(n.shipCompareData.speedDegrees),n._speedDiff=n.shipCompareData.speedDegrees.map((function(e,t){return Object(b.J)(e-n.shipBaseData.speedDegrees[t])})),n._minSpeedDiff=Object(s.a)(n._speedDiff),n._maxSpeedDiff=Object(i.a)(n._speedDiff),n._drawDifferenceProfile(),n._injectTextComparison(),n}C(a,t);var r=a.prototype;return r._setColourScale=function(e,t){var a=Math.min(e,this._shipCompare.colourScaleSpeedDiff.domain()[0]),s=Math.max(t,this._shipCompare.colourScaleSpeedDiff.domain()[this._shipCompare.colourScaleSpeedDiff.domain().length-1]);this._shipCompare.colourScaleSpeedDiff.domain([a,0,s])},r._drawDifferenceProfile=function(){var e=this._shipCompareData.shipMass,t=this._shipCompare.shipMassScale(e),a=t;this.g.append("image").attr("height",t).attr("width",a).attr("x",-a/2).attr("y",-t/2).attr("class","ship-outline").attr("transform","rotate(90)").attr("xlink:href",S.a),this.g.append("path").attr("class","base-profile").attr("d",this._line(this._arcsBase)),this.g.append("path").attr("class","comp-profile").attr("d",this._line(this._arcsComp))},r.updateDifferenceProfile=function(){var e=this;this._setColourScale(this._minSpeedDiff,this._maxSpeedDiff),this.g.append("g").attr("data-ui-component","speed-markers").selectAll("circle").data(this._arcsComp).join((function(t){t.append("circle").attr("r",5).attr("cy",(function(t,a){return Math.cos(a*y)*-e.shipCompare.radiusScaleAbsolute(t.data)})).attr("cx",(function(t,a){return Math.sin(a*y)*e.shipCompare.radiusScaleAbsolute(t.data)})).attr("fill",(function(t,a){return e._shipCompare.colourScaleSpeedDiff(e._speedDiff[a])})).append("title").text((function(t,a){return Math.round(10*t.data)/10+" ("+Object(b.x)(e._speedDiff[a],1)+") knots"}))})).select("circle").attr("fill",(function(t,a){return e._shipCompare.colourScaleSpeedDiff(e._speedDiff[a])}))},r._injectTextComparison=function(){function t(e,t,a,s){void 0===a&&(a=0),void 0===s&&(s=!1);var i=parseFloat((e-t).toFixed(a));return s&&(i*=100),i<0?'<span class="badge badge-danger">'+Object(b.o)(Math.abs(i))+"</span>":i>0?'<span class="badge badge-success">'+Object(b.o)(i)+"</span>":""}var a=Math.round(this.shipBaseData.sides.armour*this.shipBaseData.repairAmount.armour/f.x),s=Math.round(this.shipBaseData.sails.armour*this.shipBaseData.repairAmount.sails/f.G),i=Math.round(this.shipBaseData.crew.max*A),r=Math.round(this.shipCompareData.sides.armour*this.shipCompareData.repairAmount.armour/f.x),o=Math.round(this.shipCompareData.sails.armour*this.shipCompareData.repairAmount.sails/f.G),n=Math.round(this.shipCompareData.crew.max*A),p={shipRating:Object(b.A)(this.shipCompareData.class)+" rate",battleRating:this.shipCompareData.battleRating+" "+t(this.shipCompareData.battleRating,this.shipBaseData.battleRating),guns:this.shipCompareData.guns+" "+t(this.shipCompareData.guns,this.shipBaseData.guns),decks:this.shipCompareData.decks+" "+t(this.shipCompareData.decks,this.shipBaseData.decks)+" deck"+(this.shipCompareData.decks>1?"s":""),additionalRow:this.shipCompareData.decks<4?"<br> ":"",cannonsPerDeck:j.getCannonsPerDeck(this.shipCompareData.deckClassLimit,this.shipCompareData.gunsPerDeck),cannonBroadside:this.shipCompareData.broadside.cannons+" "+t(this.shipCompareData.broadside.cannons,this.shipBaseData.broadside.cannons),carroBroadside:this.shipCompareData.broadside.carronades+" "+t(this.shipCompareData.broadside.carronades,this.shipBaseData.broadside.carronades),gunsFront:this.shipCompareData.gunsPerDeck[4],limitFront:this.shipCompareData.deckClassLimit[4],gunsBack:this.shipCompareData.gunsPerDeck[5],limitBack:this.shipCompareData.deckClassLimit[5],minSpeed:Object(b.o)(this.shipCompareData.speed.min)+" "+t(this.shipCompareData.speed.min,this.shipBaseData.speed.min,2),maxSpeed:Object(b.o)(this.shipCompareData.speed.max,4)+" "+t(this.shipCompareData.speed.max,this.shipBaseData.speed.max,2),maxTurningSpeed:Object(b.o)(this.shipCompareData.rudder.turnSpeed)+" "+t(this.shipCompareData.rudder.turnSpeed,this.shipBaseData.rudder.turnSpeed,2),firezoneHorizontalWidth:this.shipCompareData.ship.firezoneHorizontalWidth+" "+t(this.shipCompareData.ship.firezoneHorizontalWidth,this.shipBaseData.ship.firezoneHorizontalWidth),waterlineHeight:Object(b.o)(this.shipCompareData.ship.waterlineHeight)+" "+t(this.shipCompareData.ship.waterlineHeight,this.shipBaseData.ship.waterlineHeight,2),acceleration:Object(b.o)(this.shipCompareData.ship.acceleration)+" "+t(this.shipCompareData.ship.acceleration,this.shipBaseData.ship.acceleration,2),deceleration:Object(b.o)(this.shipCompareData.ship.deceleration)+" "+t(this.shipCompareData.ship.deceleration,this.shipBaseData.ship.deceleration,2),halfturnTime:Object(b.o)(this.shipCompareData.rudder.halfturnTime)+" "+t(this.shipCompareData.rudder.halfturnTime,this.shipBaseData.rudder.halfturnTime),sideArmor:Object(b.s)(this.shipCompareData.sides.armour)+" "+t(this.shipCompareData.sides.armour,this.shipBaseData.sides.armour)+' <span class="badge badge-white">'+Object(b.s)(this.shipCompareData.sides.thickness)+"</span>"+t(this.shipCompareData.sides.thickness,this.shipBaseData.sides.thickness),frontArmor:Object(b.s)(this.shipCompareData.bow.armour)+" "+t(this.shipCompareData.bow.armour,this.shipBaseData.bow.armour)+' <span class="badge badge-white">'+Object(b.s)(this.shipCompareData.bow.thickness)+"</span>"+t(this.shipCompareData.bow.thickness,this.shipBaseData.bow.thickness),backArmor:Object(b.s)(this.shipCompareData.stern.armour)+" "+t(this.shipCompareData.stern.armour,this.shipBaseData.stern.armour)+' <span class="badge badge-white">'+Object(b.s)(this.shipCompareData.stern.thickness)+"</span>"+t(this.shipCompareData.stern.thickness,this.shipBaseData.stern.thickness),pump:Object(b.s)(this.shipCompareData.pump.armour)+" "+t(this.shipCompareData.pump.armour,this.shipBaseData.pump.armour),sails:Object(b.s)(this.shipCompareData.sails.armour)+" "+t(this.shipCompareData.sails.armour,this.shipBaseData.sails.armour),structure:Object(b.s)(this.shipCompareData.structure.armour)+" "+t(this.shipCompareData.structure.armour,this.shipBaseData.structure.armour),rudder:Object(b.s)(this.shipCompareData.rudder.armour)+" "+t(this.shipCompareData.rudder.armour,this.shipBaseData.rudder.armour)+' <span class="badge badge-white">'+Object(b.s)(this.shipCompareData.rudder.thickness)+"</span>"+t(this.shipCompareData.rudder.thickness,this.shipBaseData.rudder.thickness),minCrew:Object(b.s)(this.shipCompareData.crew.min)+" "+t(this.shipCompareData.crew.min,this.shipBaseData.crew.min),maxCrew:Object(b.s)(this.shipCompareData.crew.max)+" "+t(this.shipCompareData.crew.max,this.shipBaseData.crew.max),sailingCrew:Object(b.s)(this.shipCompareData.crew.sailing)+" "+t(this.shipCompareData.crew.sailing,this.shipBaseData.crew.sailing),maxWeight:Object(b.s)(this.shipCompareData.maxWeight)+" "+t(this.shipCompareData.maxWeight,this.shipBaseData.maxWeight),holdSize:Object(b.s)(this.shipCompareData.holdSize)+" "+t(this.shipCompareData.holdSize,this.shipBaseData.holdSize),upgradeXP:Object(b.s)(this.shipCompareData.upgradeXP)+" "+t(this.shipCompareData.upgradeXP,this.shipBaseData.upgradeXP),hullRepairAmount:Object(b.s)(100*(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk))+" "+t(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk,this.shipBaseData.repairAmount.armour+this.shipBaseData.repairAmount.armourPerk,3,!0),rigRepairAmount:Object(b.s)(100*(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk))+" "+t(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk,this.shipBaseData.repairAmount.sails+this.shipBaseData.repairAmount.sailsPerk,3,!0),repairTime:Object(b.s)(this.shipCompareData.repairTime.sides)+" "+t(this.shipBaseData.repairTime.sides,this.shipCompareData.repairTime.sides),hullRepairsNeeded:Object(b.s)(r)+" "+t(r,a)+' <span class="badge badge-white">'+Object(b.s)(5*r)+"</span>",rigRepairsNeeded:Object(b.s)(o)+" "+t(o,s)+' <span class="badge badge-white">'+Object(b.s)(5*o)+"</span>",rumRepairsNeeded:Object(b.s)(n)+" "+t(n,i)+' <span class="badge badge-white">'+Object(b.s)(5*n)+"</span>",fireResistance:Object(b.u)(this.shipCompareData.resistance.fire,0)+" "+t(this.shipCompareData.resistance.fire,this.shipBaseData.resistance.fire,2,!0),leakResistance:Object(b.u)(this.shipCompareData.resistance.leaks,0)+" "+t(this.shipCompareData.resistance.leaks,this.shipBaseData.resistance.leaks,2,!0),splinterResistance:Object(b.u)(this.shipCompareData.resistance.splinter,0)+" "+t(this.shipCompareData.resistance.splinter,this.shipBaseData.resistance.splinter,2,!0),mastBottomArmor:Object(b.s)(this.shipCompareData.mast.bottomArmour)+" "+t(this.shipCompareData.mast.bottomArmour,this.shipBaseData.mast.bottomArmour)+' <span class="badge badge-white">'+Object(b.s)(this.shipCompareData.mast.bottomThickness)+"</span>"+t(this.shipCompareData.mast.bottomThickness,this.shipBaseData.mast.bottomThickness),mastMiddleArmor:Object(b.s)(this.shipCompareData.mast.middleArmour)+" "+t(this.shipCompareData.mast.middleArmour,this.shipBaseData.mast.middleArmour)+' <span class="badge badge-white">'+Object(b.s)(this.shipCompareData.mast.middleThickness)+"</span>"+t(this.shipCompareData.mast.middleThickness,this.shipBaseData.mast.middleThickness),mastTopArmor:Object(b.s)(this.shipCompareData.mast.topArmour)+" "+t(this.shipCompareData.mast.topArmour,this.shipBaseData.mast.topArmour)+' <span class="badge badge-white">'+Object(b.s)(this.shipCompareData.mast.topThickness)+"</span>"+t(this.shipCompareData.mast.topThickness,this.shipBaseData.mast.topThickness)};p.gunsFront?p.gunsFront+=" "+j.pd(p.limitFront):p.gunsFront="–",p.gunsBack?p.gunsBack+=" "+j.pd(p.limitBack):p.gunsBack="–",e(""+this.select).find("div").append(j.getText(p))},k(a,[{key:"shipBaseData",get:function(){return this._shipBaseData}},{key:"shipCompareData",get:function(){return this._shipCompareData}},{key:"shipCompare",get:function(){return this._shipCompare}}]),a}(j),x=function(){function t(e){void 0===e&&(e="ship-compare"),this._baseId=e,this._baseName="Compare ships",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._moduleId=this._baseId+"-module",this._copyButtonId="button-copy-"+this._baseId,this.colourScaleSpeedDiff=Object(c.a)().range([f.i,f.k,f.f]).interpolate(p.a),this._shipIds=[],this._selectedUpgradeIdsPerType=[],this._selectedUpgradeIdsList=[],this._selectShip$={},this._selectWood$={},this._selectModule$={},this._modal$=null,this._modifierAmount=new Map,"ship-compare"===this._baseId?this._columnsCompare=["C1","C2"]:this._columnsCompare=[],this._columns=this._columnsCompare.slice(),this._columns.unshift("Base"),this._selectedShips={Base:{},C1:{},C2:{}},"ship-journey"===this._baseId?this._woodId="wood-journey":this._woodId="wood-ship",this._setupArrow(),"ship-journey"!==this._baseId&&this._setupListener()}var n=t.prototype;return n._setupArrow=function(){var e=document.getElementById("journey-arrow").cloneNode(!0);e.id="ship-profile-arrow-head",e.hasChildNodes()&&e.childNodes.forEach((function(e){e.classList.replace("journey-arrow-head","ship-profile-arrow-head")})),document.querySelector("#na-map svg defs").appendChild(e)},n.shipJourneyInit=function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this._loadAndSetupData());case 2:this._initData(),this._initSelects();case 4:case"end":return e.stop()}}),null,this)},n._setupData=function(){this._woodChanges=new Map([["Acceleration",{properties:["ship.acceleration"],isBaseValueAbsolute:!0}],["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],isBaseValueAbsolute:!0}],["Armour hit points",{properties:["bow.armour","sides.armour","stern.armour"],isBaseValueAbsolute:!0}],["Splinter resistance",{properties:["resistance.splinter"],isBaseValueAbsolute:!1}],["Crew",{properties:["crew.max"],isBaseValueAbsolute:!0}],["Fire resistance",{properties:["resistance.fire"],isBaseValueAbsolute:!1}],["Hull hit points",{properties:["structure.armour"],isBaseValueAbsolute:!0}],["Leak resistance",{properties:["resistance.leaks"],isBaseValueAbsolute:!1}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],isBaseValueAbsolute:!0}],["Rudder speed",{properties:["rudder.halfturnTime"],isBaseValueAbsolute:!0}],["Max speed",{properties:["speed.max"],isBaseValueAbsolute:!0}],["Turn rate",{properties:["rudder.turnSpeed"],isBaseValueAbsolute:!0}]]),this._moduleChanges=new Map([["Acceleration",{properties:["ship.acceleration"],isBaseValueAbsolute:!0}],["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],isBaseValueAbsolute:!0}],["Armour repair amount (perk)",{properties:["repairAmount.armourPerk"],isBaseValueAbsolute:!0}],["Armour repair amount",{properties:["repairAmount.armour"],isBaseValueAbsolute:!0}],["Armour hit points",{properties:["bow.armour","sides.armour","stern.armour"],isBaseValueAbsolute:!0}],["Back armour thickness",{properties:["stern.thickness"],isBaseValueAbsolute:!0}],["Splinter resistance",{properties:["resistance.splinter"],isBaseValueAbsolute:!1}],["Crew",{properties:["crew.max"],isBaseValueAbsolute:!0}],["Fire resistance",{properties:["resistance.fire"],isBaseValueAbsolute:!1}],["Front armour thickness",{properties:["bow.thickness"],isBaseValueAbsolute:!0}],["Hold weight",{properties:["maxWeight"],isBaseValueAbsolute:!0}],["Hull hit points",{properties:["structure.armour"],isBaseValueAbsolute:!0}],["Leak resistance",{properties:["resistance.leaks"],isBaseValueAbsolute:!1}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],isBaseValueAbsolute:!0}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],isBaseValueAbsolute:!0}],["Rudder health",{properties:["rudder.armour"],isBaseValueAbsolute:!0}],["Rudder repair time",{properties:["repairTime.rudder"],isBaseValueAbsolute:!0}],["Rudder speed",{properties:["rudder.halfturnTime"],isBaseValueAbsolute:!0}],["Sail repair amount (perk)",{properties:["repairAmount.sailsPerk"],isBaseValueAbsolute:!0}],["Sail repair amount",{properties:["repairAmount.sails"],isBaseValueAbsolute:!0}],["Sail repair time",{properties:["repairTime.sails"],isBaseValueAbsolute:!0}],["Sailing crew",{properties:["crew.sailing"],isBaseValueAbsolute:!0}],["Max speed",{properties:["speed.max"],isBaseValueAbsolute:!0}],["Side armour repair time",{properties:["repairTime.sides"],isBaseValueAbsolute:!0}],["Speed decrease",{properties:["ship.deceleration"],isBaseValueAbsolute:!0}],["Turn rate",{properties:["rudder.turnSpeed"],isBaseValueAbsolute:!0}],["Water pump health",{properties:["pump.armour"],isBaseValueAbsolute:!0}],["Water repair time",{properties:["repairTime.pump"],isBaseValueAbsolute:!0}]]),this._moduleCaps=new Map([["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],cap:{amount:.3,isPercentage:!0}}],["Armour hit points",{properties:["bow.armour","sides.armour","stern.armour"],cap:{amount:.3,isPercentage:!0}}],["Structure hit points",{properties:["structure.armour"],cap:{amount:.3,isPercentage:!0}}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],cap:{amount:.3,isPercentage:!0}}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],cap:{amount:.3,isPercentage:!0}}],["Max speed",{properties:["speed.max"],cap:{amount:15.5,isPercentage:!1}}],["Turn rate",{properties:["rudder.turnSpeed"],cap:{amount:.25,isPercentage:!0}}]]);var e=1.2*Object(s.a)(this._shipData,(function(e){return e.speed.min})),t=this._moduleCaps.get("Max speed").cap.amount;this._minSpeed=e,this._maxSpeed=t,this._colorScale=Object(c.a)().domain([this._minSpeed,0,this._maxSpeed]).range([f.i,f.k,f.f]).interpolate(p.a);var a=Object(s.a)(this._shipData,(function(e){return e.shipMass})),r=Object(i.a)(this._shipData,(function(e){return e.shipMass}));this.shipMassScale=Object(c.a)().domain([a,r]).range([100,200])},n._loadAndSetupData=function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(a.e(5).then(a.t.bind(null,"3KT9",3)));case 3:return this._moduleDataDefault=e.sent.default,e.next=6,regeneratorRuntime.awrap(a.e(12).then(a.t.bind(null,"wtJ6",3)));case 6:this._shipData=e.sent.default,this._setupData(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),Object(b.G)(e.t0);case 13:case"end":return e.stop()}}),null,this,[[0,10]])},n._setupListener=function(){var e=this,t=!0;document.getElementById(this._buttonId).addEventListener("click",(function(a){return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(!t){s.next=4;break}return t=!1,s.next=4,regeneratorRuntime.awrap(e._loadAndSetupData());case 4:Object(_.b)("Tools",e._baseName),a.stopPropagation(),e._shipCompareSelected();case 7:case"end":return s.stop()}}))}))},n._setGraphicsParameters=function(){this.svgWidth=parseInt(e("#"+this._modalId+" .column-base").width(),10),this.svgHeight=this.svgWidth,this.outerRadius=Math.floor(Math.min(this.svgWidth,this.svgHeight)/2),this.innerRadius=Math.floor(.3*this.outerRadius),this.radiusScaleAbsolute=Object(c.a)().domain([this.minSpeed,0,this.maxSpeed]).range([10,this.innerRadius,this.outerRadius])},n._shipCompareSelected=function(){var t=this;this._modal$||(this._initModal(),this._modal$=e("#"+this._modalId),this._modal$.on("keydown",(function(e){"KeyC"===e.code&&e.ctrlKey&&t._copyDataClicked(e)})),document.getElementById(this._copyButtonId).addEventListener("click",(function(e){t._copyDataClicked(e)}))),this._modal$.modal("show"),this._setGraphicsParameters()},n._getShipAndWoodIds=function(){var e=this,t=[];return this._columns.forEach((function(a){void 0!==e._shipIds[a]&&(t.push(e._shipIds[a]),["frame","trim"].forEach((function(s){t.push(Number(e._selectWood$[a][s].val()))})))})),t},n._copyDataClicked=function(e){var t=this;Object(_.b)("Menu","Copy ship compare"),e.preventDefault();var a=this._getShipAndWoodIds();if(a.length){var s=new URL(window.location);s.searchParams.set("v",encodeURIComponent(f.d)),s.searchParams.set("cmp",f.v.encode(a)),this._columns.forEach((function(e,a){t._selectedUpgradeIdsPerType[e]&&v(t._moduleTypes).forEach((function(i,r){var o=t._selectedUpgradeIdsPerType[e][i];if(o&&o.length){var n=""+a+r;s.searchParams.set(n,f.v.encode(o))}}))})),Object(b.g)(s.href)}},n._setupShipData=function(){this.shipSelectData=Object(o.b)().key((function(e){return e.class})).sortKeys(r.a).entries(this._shipData.map((function(e){return{id:e.id,name:e.name,class:e.class,battleRating:e.battleRating,guns:e.guns}})).sort(Object(b.K)(["name"])))},n._setupModuleData=function(){var e=this;this._moduleProperties=new Map(this._moduleDataDefault.flatMap((function(t){return t[1].filter((function(t){return t.properties.some((function(t){return e._moduleChanges.has(t.modifier)}))})).map((function(e){return[e.id,e]}))}))),this._moduleTypes=new Set(v(this._moduleProperties).map((function(e){return e[1].type.replace(/\s\u2013\s[a-zA-Z/\u25CB\s]+/,"")})))},n._injectModal=function(){var e=this;Object(f.B)(this._modalId,this._baseName);var t=Object(h.f)("#"+this._modalId+" .modal-body").append("div").attr("class","container-fluid").append("div").attr("class","row");this._columns.forEach((function(a){var s=t.append("div").attr("class","col-md-4 ml-auto pt-2 "+("Base"===a?"column-base":"column-comp")),i=e._getShipSelectId(a);s.append("label").append("select").attr("name",i).attr("id",i).attr("class","selectpicker"),["frame","trim"].forEach((function(t){var i=e._getWoodSelectId(t,a);s.append("label").append("select").attr("name",i).attr("id",i).attr("class","selectpicker")})),e._moduleTypes.forEach((function(t){var i=e._getModuleSelectId(t,a);s.append("label").append("select").attr("name",i).attr("id",i).property("multiple",!0).attr("class","selectpicker")})),s.append("div").attr("id",e._baseId+"-"+a).attr("class","Base"===a?"ship-base":"ship-compare")})),Object(h.f)("#"+this._modalId+" .modal-footer").insert("button","button").classed("btn btn-outline-secondary icon-outline-button",!0).attr("id",this._copyButtonId).attr("title","Copy to clipboard (ctrl-c)").attr("type","button").append("i").classed("icon icon-copy",!0)},n._initData=function(){this._setupShipData(),this._setupModuleData()},n._initSelects=function(){var t=this;this.woodCompare=new g.a(this._woodId),this.woodCompare.woodInit().then((function(){t._columns.forEach((function(a){t._selectWood$[a]={},t._setupShipSelect(a),["frame","trim"].forEach((function(s){t._selectWood$[a][s]=e("#"+t._getWoodSelectId(s,a)),t.woodCompare._setupWoodSelects(a,s,t._selectWood$[a][s])})),t._setupSelectListener(a)}))}))},n._initModal=function(){this._initData(),this._injectModal(),this._initSelects()},n._getShipOptions=function(){return this.shipSelectData.map((function(e){return'<optgroup label="'+Object(b.A)(e.key,!1)+' rate">'+e.values.map((function(e){return'<option data-subtext="'+e.battleRating+'" value="'+e.id+'">'+e.name+" ("+e.guns+")"})).join("</option>")})).join("</optgroup>")},n._setupShipSelect=function(t){this._selectShip$[t]=e("#"+this._getShipSelectId(t));var a=this._getShipOptions();this._selectShip$[t].append(a),"Base"!==t&&this._selectShip$[t].attr("disabled","disabled")},t._getModuleLevel=function(e){return e<=3?"L":e<=5?"M":"S"},n._getUpgradesOptions=function(e,a){var s=Object(o.b)().key((function(e){return e[1].type.replace(/[a-zA-Z\s]+\s–\s/,"")})).sortKeys(r.a).entries(v(this._moduleProperties).filter((function(s){return s[1].type.replace(/\s–\s[a-zA-Z/\u25CB\s]+/,"")===e&&("U"===s[1].moduleLevel||s[1].moduleLevel===t._getModuleLevel(a))}))),i=["Permanent","Ship trim"];return s.length>1?s.map((function(t){return'<optgroup label="'+t.key+'" data-max-options="'+(i.includes(e.replace(/[a-zA-Z\s]+\s–\s/,""))?1:5)+'">'+t.values.map((function(e){return'<option value="'+e[0]+'">'+e[1].name})).join("</option>")})).join("</optgroup>"):s.map((function(e){return""+e.values.map((function(e){return'<option value="'+e[0]+'">'+e[1].name})).join("</option>")}))},n._fillModuleSelect=function(e,t){var a=this,s=this._getUpgradesOptions(t,a._shipData.find((function(t){return t.id===a._shipIds[e]})).class);this._selectModule$[e][t].find("option").remove(),this._selectModule$[e][t].append(s)},n._resetModuleSelects=function(e){var t=this;this._moduleTypes.forEach((function(a){t._fillModuleSelect(e,a),t._selectModule$[e][a].selectpicker("refresh")}))},n._getModuleFromName=function(e){var t={};return this._moduleDataDefault.some((function(a){return t=a[1].find((function(t){return t.name===e})),Boolean(t)})),t},n._getModifierFromModule=function(e){return'<p class="mb-0">'+e.map((function(e){var t=e.isPercentage?Object(b.z)(e.amount/100):e.amount<1&&e.amount>0?Object(b.t)(e.amount):Object(b.y)(e.amount);return e.modifier+" "+t})).join("<br>")+"</p>"},n._setupModulesSelect=function(t){var a=this;this._selectModule$[t]||(this._selectModule$[t]={},this._moduleTypes.forEach((function(s){a._selectModule$[t][s]=e("#"+a._getModuleSelectId(s,t)),a._selectModule$[t][s].on("changed.bs.select",(function(){a._modulesSelected(t),a._refreshShips(t)})).on("show.bs.select",(function(t){e(t.currentTarget).parent().find("button.bs-select-all").remove()})).on("show.bs.select",(function(t){e(t.currentTarget).data("selectpicker").selectpicker.current.elements.forEach((function(t){if(!t.classList.contains("dropdown-divider")&&!t.classList.contains("dropdown-header")){var s=a._getModuleFromName(t.innerText);e(t).attr("data-original-title",a._getModifierFromModule(s.properties)).tooltip({boundary:"viewport",html:!0})}}))})).selectpicker({actionsBox:!0,countSelectedText:function(e){return e+" "+s.toLowerCase()+"s selected"},deselectAllText:"Clear",liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",maxOptions:s.startsWith("Ship trim")?6:5,selectedTextFormat:"count > 1",title:""+s,width:"150px"})}))),this._resetModuleSelects(t)},n._getShipData=function(e){var t=this,a=this._shipData.find((function(a){return a.id===t._shipIds[e]})),s=a;return s.repairAmount={armour:f.w,armourPerk:0,sails:f.F,sailsPerk:0},s.repairTime.sides=f.E,s.repairTime.default=f.E,s=this._addWoodData(a,e),s=this._addModulesData(a,s,e)},t._adjustAbsolute=function(e,t){return e?e+t:t},t._adjustPercentage=function(e,t,a){return e?a?e*(1+t):e+t:t},n._adjustValue=function(e,a,s){var i=e;if(this._modifierAmount.get(a).absolute){var r=this._modifierAmount.get(a).absolute;i=t._adjustAbsolute(i,r)}if(this._modifierAmount.get(a).percentage){var o=this._modifierAmount.get(a).percentage/100;i=t._adjustPercentage(i,o,s)}return i},n._setModifier=function(e){var t=e.isPercentage?0:e.amount,a=e.isPercentage?e.amount:0;this._modifierAmount.has(e.modifier)&&(t+=this._modifierAmount.get(e.modifier).absolute,a+=this._modifierAmount.get(e.modifier).percentage),this._modifierAmount.set(e.modifier,{absolute:t,percentage:a})},n._addWoodData=function(e,t){var a=this,s=JSON.parse(JSON.stringify(e));if(s.resistance={fire:0,leaks:0,splinter:0},void 0!==this.woodCompare._instances[t]){var i="_woodData";"Base"!==t&&(i="_compareData"),this._modifierAmount=new Map,["frame","trim"].forEach((function(e){a.woodCompare._instances[t][i][e].properties.forEach((function(e){a._woodChanges.has(e.modifier)&&a._setModifier(e)}))})),this._modifierAmount.forEach((function(e,t){a._woodChanges.get(t).properties.forEach((function(e){var i=e.split(".");i.length>1?s[i[0]][i[1]]=a._adjustValue(s[i[0]][i[1]],t,a._woodChanges.get(t).isBaseValueAbsolute):s[i[0]]=a._adjustValue(s[i[0]],t,a._woodChanges.get(t).isBaseValueAbsolute)}))})),s.speedDegrees=s.speedDegrees.map((function(e){var t=1+a._modifierAmount.get("Max speed").percentage/100;return Math.max(Math.min(e*t,a._maxSpeed),a._minSpeed)}))}return s},n._showCappingAdvice=function(e){var t=this._baseId+"-"+e+"-capping";if(!document.getElementById(t)){var a=document.createElement("p");a.id=t,a.className="alert alert-warning",a.innerHTML="Values capped",document.getElementById(this._baseId+"-"+e).firstChild.after(a)}},n._removeCappingAdvice=function(e){var t=this._baseId+"-"+e+"-capping",a=document.getElementById(t);a&&a.remove()},n._addModulesData=function(e,t,a){var s=this,i=JSON.parse(JSON.stringify(t));this._modifierAmount=new Map;var r,o;return this._selectedUpgradeIdsList[a]?(s._selectedUpgradeIdsList[a].forEach((function(e){s._moduleProperties.get(e).properties.forEach((function(e){s._moduleChanges.has(e.modifier)&&s._setModifier(e)}))})),s._modifierAmount.forEach((function(e,t){s._moduleChanges.get(t).properties&&s._moduleChanges.get(t).properties.forEach((function(e){var a=e.split(".");a.length>1?i[a[0]][a[1]]=s._adjustValue(i[a[0]][a[1]],t,s._moduleChanges.get(t).isBaseValueAbsolute):i[a[0]]=s._adjustValue(i[a[0]],t,s._moduleChanges.get(t).isBaseValueAbsolute)}))})),r=!1,o=function(e,t,a,s){var i=Math.min(e,s?t*(1+a):a);return e!==i&&(r=!0),i},s._modifierAmount.forEach((function(t,a){if(s._moduleCaps.has(a)){var r=s._moduleCaps.get(a).cap;s._moduleCaps.get(a).properties.forEach((function(t){var a=t.split(".");a.length>1?i[a[0]][a[1]]&&(i[a[0]][a[1]]=o(i[a[0]][a[1]],e[a[0]][a[1]],r.amount,r.isPercentage)):i[a[0]]&&(i[a[0]]=o(i[a[0]],e[a[0]],r.amount,r.isPercentage))}))}})),r?s._showCappingAdvice(a):s._removeCappingAdvice(a),this._modifierAmount.has("Max speed")&&(i.speedDegrees=i.speedDegrees.map((function(e){var t=1+s._modifierAmount.get("Max speed").percentage/100,a=e>0?e*t:e/t;return Math.max(Math.min(a,s._maxSpeed),s._minSpeed)}))),i):i},n._updateDifferenceProfileNeeded=function(e){"Base"===e||Object(b.C)(this._selectedShips[e])||this._selectedShips[e].updateDifferenceProfile()},n._updateSailingProfile=function(e){var t=this;this._updateDifferenceProfileNeeded(e),this._columnsCompare.filter((function(t){return t!==e})).forEach((function(e){t._updateDifferenceProfileNeeded(e)}))},n._refreshShips=function(e){var t=this;"ship-journey"!==this._baseId&&this._modulesSelected(e);var a=this._getShipData(e);"ship-journey"===this._baseId?this._singleShipData=a:"Base"===e?(this._setSelectedShip(e,new B(e,a,this)),this._columnsCompare.forEach((function(e){t._selectShip$[e].removeAttr("disabled").selectpicker("refresh"),Object(b.C)(t.selectedShips[e])||t._setSelectedShip(e,new O(e,a,t.selectedShips[e]._shipCompareData,t))}))):this._setSelectedShip(e,new O(e,this.selectedShips.Base._shipData,a,this)),this._updateSailingProfile(e)},n._enableCompareSelects=function(){var e=this;this._columnsCompare.forEach((function(t){e._selectShip$[t].removeAttr("disabled").selectpicker("refresh")}))},n._modulesSelected=function(e){var t=this;this._selectedUpgradeIdsList[e]=[],this._selectedUpgradeIdsPerType[e]={},this._moduleTypes.forEach((function(a){t._selectedUpgradeIdsPerType[e][a]=t._selectModule$[e][a].val(),Array.isArray(t._selectedUpgradeIdsPerType[e][a])?t._selectedUpgradeIdsPerType[e][a]=t._selectedUpgradeIdsPerType[e][a].map(Number):t._selectedUpgradeIdsPerType[e][a]=""===t._selectedUpgradeIdsPerType[e][a]?[]:[Number(t._selectedUpgradeIdsPerType[e][a])],t._selectedUpgradeIdsPerType[e][a].length&&(t._selectedUpgradeIdsList[e]=t._selectedUpgradeIdsList[e].concat(t._selectedUpgradeIdsPerType[e][a]))}))},n._setupSelectListener=function(e){var t=this;this._selectShip$[e].selectpicker({title:"Ship"}).on("changed.bs.select",(function(){t._shipIds[e]=Number(t._selectShip$[e].val()),"ship-journey"!==t._baseId&&t._setupModulesSelect(e),t._refreshShips(e),"Base"===e&&"ship-journey"!==t._baseId&&t._enableCompareSelects(),t.woodCompare.enableSelects(e)})),["frame","trim"].forEach((function(a){t._selectWood$[e][a].on("changed.bs.select",(function(){t.woodCompare._woodSelected(e,a,t._selectWood$[e][a]),t._refreshShips(e)})).selectpicker({title:"Wood "+a,width:"150px"})}))},t._setSelect=function(e,t){t&&e.val(t),e.selectpicker("render")},n._setShipAndWoodsSelects=function(e){var a=this,s=0;this._columns.some((function(i){return!!a._shipData.find((function(t){return t.id===e[s]}))&&(a._shipIds[i]=e[s],s+=1,t._setSelect(a._selectShip$[i],a._shipIds[i]),"Base"===i&&"ship-journey"!==a._baseId&&a._enableCompareSelects(),a.woodCompare.enableSelects(i),a._setupModulesSelect(i),e[s]?["frame","trim"].forEach((function(r){t._setSelect(a._selectWood$[i][r],e[s]),s+=1,a.woodCompare._woodSelected(i,r,a._selectWood$[i][r])})):s+=2,a._refreshShips(i),s>=e.length)}))},n._setModuleSelects=function(e){var t=this;this._columns.forEach((function(a,s){var i=!1;v(t._moduleTypes).forEach((function(r,o){if(e.has(""+s+o)){var n=f.v.decode(e.get(""+s+o));t._selectedUpgradeIdsPerType[a]||(t._selectedUpgradeIdsPerType[a]={}),t._selectedUpgradeIdsList[a]||(t._selectedUpgradeIdsList[a]=[]),t._selectedUpgradeIdsPerType[a][r]=n.map(Number),t._setSelect(t._selectModule$[a][r],t._selectedUpgradeIdsPerType[a][r]),t._selectedUpgradeIdsList[a]=t._selectedUpgradeIdsList[a].concat(t._selectedUpgradeIdsPerType[a][r]),i=!0}})),i&&t._refreshShips(a)}))},n.initFromClipboard=function(e){var t=f.v.decode(e.get("cmp"));t.length&&(this._shipCompareSelected(),t.length>3&&this._enableCompareSelects(),this._setShipAndWoodsSelects(t),this._setModuleSelects(e))},n._getShipSelectId=function(e){return this._baseId+"-"+e+"-select"},n._getWoodSelectId=function(e,t){return this._woodId+"-"+e+"-"+t+"-select"},n._getModuleSelectId=function(e,t){return this._moduleId+"-"+e.replace(/\s/,"")+"-"+t+"-select"},n._setSelectedShip=function(e,t){this._selectedShips[e]=t},k(t,[{key:"woodCompare",set:function(e){this._woodCompare=e},get:function(){return this._woodCompare}},{key:"selectedShips",get:function(){return this._selectedShips}},{key:"minSpeed",get:function(){return this._minSpeed}},{key:"maxSpeed",get:function(){return this._maxSpeed}},{key:"colorScale",get:function(){return this._colorScale}},{key:"svgWidth",set:function(e){this._svgWidth=e},get:function(){return this._svgWidth}},{key:"svgHeight",set:function(e){this._svgHeight=e},get:function(){return this._svgHeight}},{key:"outerRadius",set:function(e){this._outerRadius=e},get:function(){return this._outerRadius}},{key:"innerRadius",set:function(e){this._innerRadius=e},get:function(){return this._innerRadius}},{key:"radiusScaleAbsolute",set:function(e){this._radiusScaleAbsolute=e},get:function(){return this._radiusScaleAbsolute}}]),t}()}).call(this,a("xeH2"))},pFgi:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return m}));a("iPZ8"),a("kypl"),a("pCzD"),a("hi3g"),a("lYjL"),a("IlJM"),a("SJSz"),a("4owi"),a("/YXa"),a("lmye"),a("WB5j"),a("aOEW"),a("RsBt"),a("D/wG"),a("1Qwx"),a("fp7Y"),a("ZEAQ"),a("JBxO"),a("FdtR"),a("9UJh"),a("RsMT"),a("WoWj"),a("SgDD"),a("3dw1"),a("U00V"),a("wcNg"),a("3XUK"),a("Peo2");var s=a("ED/D"),i=a("qKAC"),r=a("nUlG"),o=a("f4w0"),n=a("Av7d"),p=a("0lY5");function c(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function h(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var d=function(){function e(e,t){this._id=e,this._woodCompare=t,this._select="#"+this._woodCompare._baseFunction+"-"+this._id,this._setupMainDiv(),this._g=Object(r.f)(this._select).select("g")}return e.prototype._setupMainDiv=function(){Object(r.f)(this._select+" div").remove(),Object(r.f)(this._select).append("div")},e}(),u=function(t){function a(e,a,s){var i;return(i=t.call(this,e,s)||this)._woodData=a,i._woodCompare=s,i._printText(),i}h(a,t);var s=a.prototype;return s._getProperty=function(e,t){var a=this._woodData[t].properties.find((function(t){return t.modifier===e})),s=0,i=!1;return a&&a.amount&&(s=a.amount,i=a.isPercentage),{amount:s,isPercentage:i}},s._getPropertySum=function(e){var t=this._getProperty(e,"frame"),a=this._getProperty(e,"trim");return{amount:t.amount+a.amount,isPercentage:a.isPercentage}},s._getText=function(e){var t=this,a='<table class="table table-sm table-striped small mt-4"><thead>';return a+="<tr>",a+="<tr><th><em>Property</em></th><th><em>Change</em></th></tr></thead><tbody>",e.properties.forEach((function(e,s){if(a+="<tr><td>"+s+"</td><td>"+(e.isPercentage?Object(p.u)(e.amount/100):Object(p.o)(e.amount)),a+='<span class="rate">',e.amount>0){var i=e.amount/t._woodCompare._minMaxProperty.get(s).max*50;a+='<span class="bar neutral" style="width:50%;"></span>',a+='<span class="bar pos diff" style="width:'+i+'%;"></span>'}else if(e.amount<0){var r=e.amount/t._woodCompare._minMaxProperty.get(s).min*50;a+='<span class="bar neutral" style="width:'+(50-r)+'%;"></span>',a+='<span class="bar neg diff" style="width:'+r+'%;"></span>'}else a+='<span class="bar neutral"></span>';a+="</span></td></tr>"})),a+="</tbody></table>"},s._printText=function(){var t=this,a={frame:this._woodData.frame.id,trim:this._woodData.trim.id};a.properties=new Map,this._woodCompare.propertyNames.forEach((function(e){var s=t._getPropertySum(e);a.properties.set(e,{amount:s.amount,isPercentage:s.isPercentage})})),e(""+this._select).find("div").append(this._getText(a))},a}(d),l=function(t){function a(e,a,s,i){var r;return(r=t.call(this,e,i)||this)._baseData=a,r._compareData=s,r._woodCompare=i,r._printTextComparison(),r}h(a,t);var s=a.prototype;return s._getBaseProperty=function(e,t){var a=this._baseData[t].properties.find((function(t){return t.modifier===e})),s=0,i=!1;return a&&a.amount&&(s=a.amount,i=a.isPercentage),{amount:s,isPercentage:i}},s._getBasePropertySum=function(e){var t=this._getBaseProperty(e,"frame"),a=this._getBaseProperty(e,"trim");return{amount:t.amount+a.amount,isPercentage:a.isPercentage}},s._getCompareProperty=function(e,t){var a=this._compareData[t].properties.find((function(t){return t.modifier===e})),s=0,i=!1;return a&&a.amount&&(s=a.amount,i=a.isPercentage),{amount:s,isPercentage:i}},s._getComparePropertySum=function(e){var t=this._getCompareProperty(e,"frame"),a=this._getCompareProperty(e,"trim");return{amount:t.amount+a.amount,isPercentage:t.isPercentage&&a.isPercentage}},s._getText=function(e){var t=this;var a=0,s=0,i=0,r="",o='<table class="table table-sm table-striped small wood mt-4"><thead>';return o+="<tr>",o+="<tr><th><em>Property</em></th><th><em>Change</em></th></tr></thead><tbody>",e.properties.forEach((function(e,n){o+="<tr><td>"+n+"</td><td>"+function(e,t,a,s){void 0===s&&(s=1);var i=parseFloat((e-t).toFixed(s));return(a?Object(p.u)(e/100,s):Object(p.o)(e))+' <span class="badge badge-white">'+Object(p.x)(i)+"</span>"}(e.compare,e.base,e.isPercentage),o+='<span class="rate">',e.compare>=0?(e.base>=0?e.compare>e.base?(a=e.base,s=e.compare-e.base,r="pos"):(a=e.compare,s=e.base-e.compare,r="neg"):(a=0,s=e.compare,r="pos"),o+='<span class="bar neutral" style="width:50%;"></span>',o+='<span class="bar pos diff" style="width:'+a/t._woodCompare._minMaxProperty.get(n).max*50+'%;"></span>',o+='<span class="bar '+r+'" style="width:'+s/t._woodCompare._minMaxProperty.get(n).max*50+'%;"></span>'):e.compare<0?(e.base<0?e.compare>=e.base?(a=e.compare,s=e.base-e.compare,i=-e.base,r="pos"):(a=e.base,s=e.compare-e.base,i=-e.compare,r="neg"):(a=0,s=e.compare,i=-e.compare,r="neg"),o+='<span class="bar neutral" style="width:'+(50+i/t._woodCompare._minMaxProperty.get(n).min*50)+'%;"></span>',o+='<span class="bar '+r+'" style="width:'+s/t._woodCompare._minMaxProperty.get(n).min*50+'%;"></span>',o+='<span class="bar neg diff" style="width:'+a/t._woodCompare._minMaxProperty.get(n).min*50+'%;"></span>'):o+='<span class="bar neutral"></span>',o+="</span></td></tr>"})),o+="</tbody></table>"},s._printTextComparison=function(){var t=this,a={frame:this._compareData.frame.name,trim:this._compareData.trim.name};a.properties=new Map,this._woodCompare.propertyNames.forEach((function(e){var s=t._getBasePropertySum(e),i=t._getComparePropertySum(e);a.properties.set(e,{base:s.amount,compare:i.amount,isPercentage:s.isPercentage})})),e(""+this._select).find("div").append(this._getText(a))},a}(d),m=function(){function t(e){this._baseFunction=e,this._baseName="Compare woods",this._baseId=this._baseFunction+"-compare",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._woodsSelected=[],this._instances=[],this._options={},this._minMaxProperty=new Map,"wood"===this._baseFunction&&this._setupListener()}var h=t.prototype;return h.woodInit=function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this._loadAndSetupData());case 2:this._initData();case 3:case"end":return e.stop()}}),null,this)},h._setupData=function(){var e=this,t=function(t,a){return e._woodData[t].find((function(e){return e.name===a})).id};this.propertyNames=new Set([].concat(c(this._woodData.frame.flatMap((function(e){return e.properties.map((function(e){return e.modifier}))}))),c(this._woodData.trim.flatMap((function(e){return e.properties.map((function(e){return e.modifier}))})))).sort()),"wood"===this._baseFunction?(this._defaultWood={frame:t("frame","Fir"),trim:t("trim","Crew Space")},this._columnsCompare=["C1","C2","C3"]):"wood-journey"===this._baseFunction?(this._defaultWood={frame:t("frame","Oak"),trim:t("trim","Oak")},this._columnsCompare=[]):(this._defaultWood={frame:t("frame","Oak"),trim:t("trim","Oak")},this._columnsCompare=["C1","C2"]),this._columns=this._columnsCompare.slice(),this._columns.unshift("Base")},h._loadAndSetupData=function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(a.e(13).then(a.t.bind(null,"c8Sa",3)));case 3:this._woodData=e.sent.default,this._setupData(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Object(p.G)(e.t0);case 10:case"end":return e.stop()}}),null,this,[[0,7]])},h._setupListener=function(){var e=this,t=!0;document.getElementById(this._buttonId).addEventListener("click",(function(a){return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(!t){s.next=4;break}return t=!1,s.next=4,regeneratorRuntime.awrap(e._loadAndSetupData());case 4:Object(o.b)("Tools",e._baseName),a.stopPropagation(),e._woodCompareSelected();case 7:case"end":return s.stop()}}))}))},h._woodCompareSelected=function(){document.getElementById(this._modalId)||this._initModal(),e("#"+this._modalId).modal("show")},h._initData=function(){var e=this;this._frameSelectData=this._woodData.frame.sort(Object(p.K)(["name"])),this._trimSelectData=this._woodData.trim.sort(Object(p.K)(["name"])),this._setOption(this._frameSelectData.map((function(e){return'<option value="'+e.id+'">'+e.name+"</option>"})),this._trimSelectData.map((function(e){return'<option value="'+e.id+'">'+e.name+"</option>"}))),this.propertyNames.forEach((function(t){var a=c(e._woodData.frame.map((function(e){return e.properties.filter((function(e){return e.modifier===t})).map((function(e){return e.amount}))[0]}))),r=c(e._woodData.trim.map((function(e){return e.properties.filter((function(e){return e.modifier===t})).map((function(e){return e.amount}))[0]}))),o=Object(s.a)(a)||0,n=Object(i.a)(a)||0,p=Object(s.a)(r)||0,h=Object(i.a)(r)||0;e._addMinMaxProperty(t,{min:o+p>=0?0:o+p,max:n+h})}))},h._injectModal=function(){var e=this;Object(n.B)(this._modalId,this._baseName);var t=Object(r.f)("#"+this._modalId+" .modal-body").append("div").attr("class","container-fluid").append("div").attr("class","row wood");this._columns.forEach((function(a){var s=t.append("div").attr("class","col-md-3 ml-auto pt-2 "+("Base"===a?"column-base":"column-comp"));["frame","trim"].forEach((function(t){var i=e._baseFunction+"-"+t+"-"+a+"-select";s.append("label").attr("for",i),s.append("select").attr("name",i).attr("id",i).attr("class","selectpicker")})),s.append("div").attr("id",e._baseFunction+"-"+a)}))},h._initModal=function(){var t=this;this._initData(),this._injectModal(),this._columns.forEach((function(a){["frame","trim"].forEach((function(s){var i=e("#"+t._baseFunction+"-"+s+"-"+a+"-select");t._setupWoodSelects(a,s,i),t._setupSelectListener(a,s,i)}))}))},h._setWoodsSelected=function(e,t,a){this._woodsSelected[e]||(this._woodsSelected[e]={}),this._woodsSelected[e][t]=a},h._setupWoodSelects=function(e,t,a){this._setWoodsSelected(e,t,this._defaultWood[t]),a.append(this._options[t]),("wood"!==this._baseFunction||"Base"!==e&&"wood"===this._baseFunction)&&a.attr("disabled","disabled")},h._setOtherSelect=function(t,a){var s="frame"===a?"trim":"frame";this._woodsSelected[t][s]===this._defaultWood[s]&&e("#"+this._baseFunction+"-"+s+"-"+t+"-select").val(this._defaultWood[s]).selectpicker("refresh")},h.enableSelects=function(t){var a=this;["frame","trim"].forEach((function(s){e("#"+a._baseFunction+"-"+s+"-"+t+"-select").removeAttr("disabled").selectpicker("refresh")}))},h._woodSelected=function(e,t,a){var s=this,i=Number(a.val());this._setWoodsSelected(e,t,i),this._setOtherSelect(e,t),"Base"===e?(this._addInstance(e,new u("Base",this._getWoodData("Base"),this)),this._columnsCompare.forEach((function(e){"wood"===s._baseFunction&&s.enableSelects(e),s._instances[e]&&s._addInstance(e,new l(e,s._getWoodData("Base"),s._getWoodData(e),s))}))):this._addInstance(e,new l(e,this._getWoodData("Base"),this._getWoodData(e),this))},h._setupSelectListener=function(e,t,a){var s=this;a.on("change",(function(){return s._woodSelected(e,t,a)})).selectpicker({title:"Select "+t})},h._getWoodData=function(e){return{frame:this.getWoodTypeData("frame",this._woodsSelected[e].frame),trim:this.getWoodTypeData("trim",this._woodsSelected[e].trim)}},h._addMinMaxProperty=function(e,t){this._minMaxProperty.set(e,t)},h._setOption=function(e,t){this._options.frame=e,this._options.trim=t},h._addInstance=function(e,t){this._instances[e]=t},h.getWoodTypeData=function(e,t){return this._woodData[e].find((function(e){return e.id===t}))},t}()}).call(this,a("xeH2"))},t1jV:function(e,t){e.exports="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 420.5 120'%3E%3Cpath fill='%236a7153' d='M385.5 91.4v-68C208.3-7 84.8 1.9 12.8 60.1c72 68 195.2 64.4 372.7 31.3z'/%3E%3C/svg%3E"}}]);