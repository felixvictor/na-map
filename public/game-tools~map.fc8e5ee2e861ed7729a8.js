(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{iSiJ:function(e,t,s){"use strict";(function(e){s.d(t,"a",function(){return k});s("iPZ8"),s("kypl"),s("pCzD"),s("hi3g"),s("C4nn"),s("lYjL"),s("IlJM"),s("SJSz"),s("4owi"),s("/YXa"),s("8cZI"),s("lmye"),s("WB5j"),s("aOEW"),s("RsBt"),s("D/wG"),s("1Qwx"),s("fp7Y"),s("ZEAQ"),s("JBxO"),s("9UJh"),s("RsMT"),s("WoWj"),s("y89P"),s("aZFp"),s("MTDe"),s("3dw1"),s("U00V"),s("9DLp");var a=s("lpOn"),i=s("ED/D"),r=s("SYoz"),o=s("BfWa"),n=s("yw3p"),p=s("wbYc"),h=s("nUlG"),c=s("aBO9"),d=s("f4w0"),u=s("Av7d"),l=s("0lY5"),m=s("pFgi");function f(e){return function(e){if(Array.isArray(e)){for(var t=0,s=new Array(e.length);t<e.length;t++)s[t]=e[t];return s}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function b(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function g(e,t,s){return t&&b(e.prototype,t),s&&b(e,s),e}var D=2*Math.PI/24,v=u.J/u.K,C=function(){function e(e,t){this._id=e,this._shipData=t,this._ticksSpeed=[12,8,4,0],this._ticksSpeedLabels=["12 knots","8 knots","4 knots","0 knots"],this._select="#ship-compare-"+this._id,this._setupSvg(),this._g=Object(h.f)(this._select).select("g"),this._setCompass()}var t=e.prototype;return t._setupSvg=function(){var e=Object(h.f)(this.select);Object(h.f)(this.select+" svg").remove(),e.append("svg").attr("width",this.shipData.svgWidth).attr("height",this.shipData.svgHeight).attr("data-ui-component","sailing-profile").attr("fill","none").append("g").attr("transform","translate("+this.shipData.svgWidth/2+", "+this.shipData.svgHeight/2+")"),Object(h.f)(this.select+" div").remove(),e.append("div").attr("class","block-small")},t._setCompass=function(){var e=this,t=new Array(12);t.fill(1,0);var s=Object(c.f)().sort(null).value(1)(t),a=Object(c.a)().outerRadius(this.shipData.radiusScaleAbsolute(12)).innerRadius(this.shipData.innerRadius);this.g.selectAll(".compass-arc").data(s).join(function(e){return e.append("path").attr("class","compass-arc").attr("d",a)}),this.g.selectAll(".speed-circle").data(this._ticksSpeed).join(function(t){return t.append("circle").attr("class","speed-circle").attr("r",function(t){return e.shipData.radiusScaleAbsolute(t)})}),this.g.append("line").attr("x1",0).attr("y1",-160).attr("x2",0).attr("y2",-79).attr("class","wind-arrow").attr("marker-end","url(#course-arrow)")},e.pd=function(e){var t='<span class="badge badge-white">'+e[0]+" / ";return e[1]?t+=""+e[1]:t+="–",t+=" lb</span>"},e.getCannonsPerDeck=function(t,s){for(var a=s[0]+" "+e.pd(t[0]),i="",r=1;r<4;r+=1)s[r]?a=s[r]+" "+e.pd(t[r])+" <br>"+a:i+="<br>";return[a,i]},e.getText=function(e){var t=0;function s(e){return'<div class="row row-small '+((t+=1)%2?"row-light":"")+'"><div class="col-3">'+e+"</div>"}function a(t,s,a){void 0===a&&(a=6);var i="",r="";if("cannonsPerDeck"===t){var o=e[t];i=o[0],r="<br>"+(r=o[1])}else i=""===t?"":e[t];return'<div class="col-'+a+'">'+i+'<br><span class="des">'+s+"</span>"+r+"</div>"}var i="";return i+=s(e.shipRating),i+='<div class="col-9"><div class="row no-gutters">',i+=a("battleRating","Battle rating"),i+=a("guns","Cannons"),i+=a("upgradeXP","Knowledge XP"),i+=a("waterlineHeight","Water line"),i+="</div></div></div>",i+=s(e.decks),i+='<div class="col-9"><div class="row no-gutters">',i+=a("cannonsPerDeck","Gun decks"),i+=a("firezoneHorizontalWidth","Firezone horizontal width"),i+="</div></div></div>",i+=s("Broadside (lb)"),i+='<div class="col-9"><div class="row no-gutters">',i+=a("cannonBroadside","Cannons"),i+=a("carroBroadside","Carronades"),i+="</div></div></div>",i+=s("Chasers"),i+='<div class="col-9"><div class="row no-gutters">',i+=a("gunsFront","Bow"),i+=a("gunsBack","Stern"),i+="</div></div></div>",i+=s("Speed"),i+='<div class="col-9"><div class="row no-gutters">',i+=a("maxSpeed","Maximum"),i+=a("",""),i+=a("acceleration","Acceleration"),i+=a("deceleration","Deceleration"),i+=a("maxTurningSpeed","Turn speed"),i+=a("halfturnTime","Rudder half time"),i+="</div></div></div>",i+=s('Armour <span class="badge badge-white">Thickness</span>'),i+='<div class="col-9"><div class="row no-gutters">',i+=a("sideArmor","Sides"),i+=a("structure","Hull"),i+=a("frontArmor","Bow"),i+=a("backArmor","Stern"),i+=a("pump","Pump"),i+=a("rudder","Rudder"),i+="</div></div></div>",i+=s('Masts <span class="badge badge-white">Thickness</span>'),i+='<div class="col-9"><div class="row no-gutters">',i+=a("sails","Sails"),i+=a("mastBottomArmor","Bottom"),i+=a("mastMiddleArmor","Middle"),i+=a("mastTopArmor","Top"),i+="</div></div></div>",i+=s("Crew"),i+='<div class="col-9"><div class="row no-gutters">',i+=a("minCrew","Minimum",4),i+=a("sailingCrew","Sailing",4),i+=a("maxCrew","Maximum",4),i+="</div></div></div>",i+=s("Resistance"),i+='<div class="col-9"><div class="row no-gutters">',i+=a("fireResistance","Fire",4),i+=a("leakResistance","Leak",4),i+=a("splinterResistance","Splinter",4),i+="</div></div></div>",i+=s('Repairs needed <span class="badge badge-white">Set of 5</span>'),i+='<div class="col-9"><div class="row no-gutters">',i+=a("hullRepairsNeeded","Hull",4),i+=a("rigRepairsNeeded","Rig",4),i+=a("rumRepairsNeeded","Rum",4),i+="</div></div></div>",i+=s("Repair"),i+='<div class="col-9"><div class="row no-gutters">',i+=a("hullRepairAmount","Hull %",4),i+=a("rigRepairAmount","Rig %",4),i+=a("repairTime","Time (sec)",4),i+="</div></div></div>",i+=s("Hold"),i+='<div class="col-9"><div class="row no-gutters">',i+=a("maxWeight","Tons"),i+=a("holdSize","Cargo slots"),i+="</div></div></div>",i+="</div>"},g(e,[{key:"id",get:function(){return this._id}},{key:"shipData",get:function(){return this._shipData}},{key:"select",get:function(){return this._select}},{key:"g",get:function(){return this._g}}]),e}(),w=function(t){function s(e,s,a){var i;return(i=t.call(this,e,a)||this)._shipData=s,i._shipCompareData=a,i._setBackground(),i._setBackgroundGradient(),i._drawProfile(),i._printText(),i}_(s,t);var i=s.prototype;return i._setBackground=function(){var e=this,t=Object(c.a)().outerRadius(function(t){return e.shipCompareData.radiusScaleAbsolute(t)+2}).innerRadius(function(t){return e.shipCompareData.radiusScaleAbsolute(t)+1}).startAngle(-Math.PI/2).endAngle(Math.PI/2);this.g.selectAll(".speed-textpath").data(this._ticksSpeed).join(function(e){return e.append("path").attr("class","speed-textpath").attr("d",t).attr("id",function(e,t){return"tick"+t})}),this.g.selectAll(".speed-text").data(this._ticksSpeed).join(function(t){return t.append("text").attr("class","speed-text").append("textPath").attr("href",function(e,t){return"#tick"+t}).text(function(t,s){return e._ticksSpeedLabels[s]}).attr("startOffset","10%")})},i._setBackgroundGradient=function(){var e=this,t=Object(p.scaleLinear)().domain([this.shipData.speed.min,this.shipData.speed.max]).range([0,this.shipCompareData.svgWidth]),s=t.domain();s[2]=s[1]-s[0];for(var i=[],r=0;r<30;r+=1)i.push(r*s[2]/29+s[0]);this.g.append("defs").append("radialGradient").attr("id","gradient").attr("cx",.5).attr("cy",.25).attr("r",.5).selectAll("stop").data(Object(a.a)(30)).join(function(s){return s.append("stop").attr("offset",function(s,a){return t(i[a])/e.shipCompareData.svgWidth}).attr("stop-color",function(t,s){return e.shipCompareData.colorScale(i[s])})})},i._drawProfile=function(){var e=this,t=Object(c.f)().sort(null).value(1)(this.shipData.speedDegrees),s=c.d,a=Object(c.g)().angle(function(e,t){return t*D}).radius(function(t){return e.shipCompareData.radiusScaleAbsolute(t.data)}).curve(s);this.g.append("path").attr("class","base-profile").attr("d",a(t)),this.g.selectAll(".speed-markers").data(t).join(function(t){return t.append("circle").attr("class","speed-markers").attr("r",5).attr("cy",function(t,s){return Math.cos(s*D)*-e.shipCompareData.radiusScaleAbsolute(t.data)}).attr("cx",function(t,s){return Math.sin(s*D)*e.shipCompareData.radiusScaleAbsolute(t.data)}).attr("fill",function(t){return e.shipCompareData.colorScale(t.data)}).append("title").text(function(e){return Math.round(10*e.data)/10+" knots"})})},i._printText=function(){var t=C.getCannonsPerDeck(this.shipData.deckClassLimit,this.shipData.gunsPerDeck),s=Math.round(this.shipData.sides.armour*this.shipData.repairAmount.armour/u.z),a=Math.round(this.shipData.sails.armour*this.shipData.repairAmount.sails/u.I),i=Math.round(this.shipData.crew.max*v),r={shipRating:Object(l.B)(this.shipData.class)+" rate",battleRating:this.shipData.battleRating,guns:this.shipData.guns,decks:this.shipData.decks+" deck"+(this.shipData.decks>1?"s":""),additionalRow:this.shipData.decks<4?"<br> ":"",cannonsPerDeck:t,cannonBroadside:Object(l.s)(this.shipData.broadside.cannons),carroBroadside:Object(l.s)(this.shipData.broadside.carronades),gunsFront:this.shipData.gunsPerDeck[4],limitFront:this.shipData.deckClassLimit[4],gunsBack:this.shipData.gunsPerDeck[5],limitBack:this.shipData.deckClassLimit[5],firezoneHorizontalWidth:this.shipData.ship.firezoneHorizontalWidth,waterlineHeight:Object(l.p)(this.shipData.ship.waterlineHeight),maxSpeed:Object(l.p)(this.shipData.speed.max,3),acceleration:Object(l.p)(this.shipData.ship.acceleration),deceleration:Object(l.p)(this.shipData.ship.deceleration),maxTurningSpeed:Object(l.p)(this.shipData.rudder.turnSpeed),halfturnTime:Object(l.p)(this.shipData.rudder.halfturnTime),sideArmor:Object(l.s)(this.shipData.sides.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipData.sides.thickness)+"</span>",frontArmor:Object(l.s)(this.shipData.bow.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipData.bow.thickness)+"</span>",pump:Object(l.s)(this.shipData.pump.armour),sails:Object(l.s)(this.shipData.sails.armour),structure:Object(l.s)(this.shipData.structure.armour),backArmor:Object(l.s)(this.shipData.stern.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipData.stern.thickness)+"</span>",rudder:Object(l.s)(this.shipData.rudder.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipData.rudder.thickness)+"</span>",minCrew:Object(l.s)(this.shipData.crew.min),maxCrew:Object(l.s)(this.shipData.crew.max),sailingCrew:Object(l.s)(this.shipData.crew.sailing||0),maxWeight:Object(l.s)(this.shipData.maxWeight),holdSize:Object(l.s)(this.shipData.holdSize),upgradeXP:Object(l.s)(this.shipData.upgradeXP),sternRepair:""+Object(l.s)(this.shipData.repairTime.stern),bowRepair:""+Object(l.s)(this.shipData.repairTime.bow),hullRepairAmount:""+Object(l.s)(100*(this.shipData.repairAmount.armour+this.shipData.repairAmount.armourPerk)),rigRepairAmount:""+Object(l.s)(100*(this.shipData.repairAmount.sails+this.shipData.repairAmount.sailsPerk)),repairTime:""+Object(l.s)(this.shipData.repairTime.sides),hullRepairsNeeded:Object(l.s)(s)+' <span class="badge badge-white">'+Object(l.s)(5*s)+"</span>",rigRepairsNeeded:Object(l.s)(a)+' <span class="badge badge-white">'+Object(l.s)(5*a)+"</span>",rumRepairsNeeded:Object(l.s)(i)+' <span class="badge badge-white">'+Object(l.s)(5*i)+"</span>",fireResistance:Object(l.u)(this.shipData.resistance.fire,0),leakResistance:Object(l.u)(this.shipData.resistance.leaks,0),splinterResistance:Object(l.u)(this.shipData.resistance.splinter,0),mastBottomArmor:Object(l.s)(this.shipData.mast.bottomArmour)+' <span class="badge badge-white">'+Object(l.s)(this.shipData.mast.bottomThickness)+"</span>",mastMiddleArmor:Object(l.s)(this.shipData.mast.middleArmour)+' <span class="badge badge-white">'+Object(l.s)(this.shipData.mast.middleThickness)+"</span>",mastTopArmor:Object(l.s)(this.shipData.mast.topArmour)+' <span class="badge badge-white">'+Object(l.s)(this.shipData.mast.topThickness)+"</span>"};r.gunsFront?r.gunsFront+=" "+C.pd(r.limitFront):r.gunsFront="–",r.gunsBack?r.gunsBack+=" "+C.pd(r.limitBack):r.gunsBack="–",e(""+this.select).find("div").append(C.getText(r))},g(s,[{key:"shipData",get:function(){return this._shipData}},{key:"shipCompareData",get:function(){return this._shipCompareData}}]),s}(C),S=function(t){function s(e,s,a,i){var r;return(r=t.call(this,e,i)||this)._shipBaseData=s,r._shipCompareData=a,r._shipCompare=i,r._drawDifferenceProfile(),r._injectTextComparison(),r}_(s,t);var a=s.prototype;return a._drawDifferenceProfile=function(){var e=this,t=Object(c.f)().sort(null).value(1),s=t(this.shipCompareData.speedDegrees),a=t(this.shipBaseData.speedDegrees),i=c.d,r=Object(c.g)().angle(function(e,t){return t*D}).radius(function(t){return e.shipCompare.radiusScaleAbsolute(t.data)}).curve(i),o=this.shipCompareData.speedDegrees.map(function(t,s){return Object(l.J)(t-e.shipBaseData.speedDegrees[s])}),h=this._shipCompare._minSpeed,d=this._shipCompare._maxSpeed,m=Object(p.scaleLinear)().domain([h,-1,-.1,0,.1,1,d]).range([u.k,u.j,u.l,"#fff",u.h,u.f,u.g]).interpolate(n.c);this.g.append("path").attr("class","base-profile").attr("d",r(a)),this.g.append("path").attr("class","comp-profile").attr("d",r(s)),this.g.selectAll(".speed-markers").data(s).join(function(t){return t.append("circle").attr("class","speed-markers").attr("r",5).attr("cy",function(t,s){return Math.cos(s*D)*-e.shipCompare.radiusScaleAbsolute(t.data)}).attr("cx",function(t,s){return Math.sin(s*D)*e.shipCompare.radiusScaleAbsolute(t.data)}).attr("fill",function(e,t){return m(o[t])}).append("title").text(function(e){return Math.round(10*e.data)/10+" knots"})})},a._injectTextComparison=function(){function t(e,t,s,a){void 0===s&&(s=0),void 0===a&&(a=!1);var i=parseFloat((e-t).toFixed(s));return a&&(i*=100),i<0?'<span class="badge badge-danger">'+Object(l.p)(Math.abs(i))+"</span>":i>0?'<span class="badge badge-success">'+Object(l.p)(i)+"</span>":""}var s=Math.round(this.shipBaseData.sides.armour*this.shipBaseData.repairAmount.armour/u.z),a=Math.round(this.shipBaseData.sails.armour*this.shipBaseData.repairAmount.sails/u.I),i=Math.round(this.shipBaseData.crew.max*v),r=Math.round(this.shipCompareData.sides.armour*this.shipCompareData.repairAmount.armour/u.z),o=Math.round(this.shipCompareData.sails.armour*this.shipCompareData.repairAmount.sails/u.I),n=Math.round(this.shipCompareData.crew.max*v),p={shipRating:Object(l.B)(this.shipCompareData.class)+" rate",battleRating:this.shipCompareData.battleRating+" "+t(this.shipCompareData.battleRating,this.shipBaseData.battleRating),guns:this.shipCompareData.guns+" "+t(this.shipCompareData.guns,this.shipBaseData.guns),decks:this.shipCompareData.decks+" deck"+(this.shipCompareData.decks>1?"s":"")+" "+t(this.shipCompareData.decks,this.shipBaseData.decks),additionalRow:this.shipCompareData.decks<4?"<br> ":"",cannonsPerDeck:C.getCannonsPerDeck(this.shipCompareData.deckClassLimit,this.shipCompareData.gunsPerDeck),cannonBroadside:this.shipCompareData.broadside.cannons+" "+t(this.shipCompareData.broadside.cannons,this.shipBaseData.broadside.cannons),carroBroadside:this.shipCompareData.broadside.carronades+" "+t(this.shipCompareData.broadside.carronades,this.shipBaseData.broadside.carronades),gunsFront:this.shipCompareData.gunsPerDeck[4],limitFront:this.shipCompareData.deckClassLimit[4],gunsBack:this.shipCompareData.gunsPerDeck[5],limitBack:this.shipCompareData.deckClassLimit[5],minSpeed:Object(l.p)(this.shipCompareData.speed.min)+" "+t(this.shipCompareData.speed.min,this.shipBaseData.speed.min,2),maxSpeed:Object(l.p)(this.shipCompareData.speed.max,3)+" "+t(this.shipCompareData.speed.max,this.shipBaseData.speed.max,2),maxTurningSpeed:Object(l.p)(this.shipCompareData.rudder.turnSpeed)+" "+t(this.shipCompareData.rudder.turnSpeed,this.shipBaseData.rudder.turnSpeed,2),firezoneHorizontalWidth:this.shipCompareData.ship.firezoneHorizontalWidth+" "+t(this.shipCompareData.ship.firezoneHorizontalWidth,this.shipBaseData.ship.firezoneHorizontalWidth),waterlineHeight:Object(l.p)(this.shipCompareData.ship.waterlineHeight)+" "+t(this.shipCompareData.ship.waterlineHeight,this.shipBaseData.ship.waterlineHeight,2),acceleration:Object(l.p)(this.shipCompareData.ship.acceleration)+" "+t(this.shipCompareData.ship.acceleration,this.shipBaseData.ship.acceleration,2),deceleration:Object(l.p)(this.shipCompareData.ship.deceleration)+" "+t(this.shipCompareData.ship.deceleration,this.shipBaseData.ship.deceleration,2),halfturnTime:Object(l.p)(this.shipCompareData.rudder.halfturnTime)+" "+t(this.shipCompareData.rudder.halfturnTime,this.shipBaseData.rudder.halfturnTime),sideArmor:Object(l.s)(this.shipCompareData.sides.armour)+" "+t(this.shipCompareData.sides.armour,this.shipBaseData.sides.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.sides.thickness)+"</span>"+t(this.shipCompareData.sides.thickness,this.shipBaseData.sides.thickness),frontArmor:Object(l.s)(this.shipCompareData.bow.armour)+" "+t(this.shipCompareData.bow.armour,this.shipBaseData.bow.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.bow.thickness)+"</span>"+t(this.shipCompareData.bow.thickness,this.shipBaseData.bow.thickness),backArmor:Object(l.s)(this.shipCompareData.stern.armour)+" "+t(this.shipCompareData.stern.armour,this.shipBaseData.stern.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.stern.thickness)+"</span>"+t(this.shipCompareData.stern.thickness,this.shipBaseData.stern.thickness),pump:Object(l.s)(this.shipCompareData.pump.armour)+" "+t(this.shipCompareData.pump.armour,this.shipBaseData.pump.armour),sails:Object(l.s)(this.shipCompareData.sails.armour)+" "+t(this.shipCompareData.sails.armour,this.shipBaseData.sails.armour),structure:Object(l.s)(this.shipCompareData.structure.armour)+" "+t(this.shipCompareData.structure.armour,this.shipBaseData.structure.armour),rudder:Object(l.s)(this.shipCompareData.rudder.armour)+" "+t(this.shipCompareData.rudder.armour,this.shipBaseData.rudder.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.rudder.thickness)+"</span>"+t(this.shipCompareData.rudder.thickness,this.shipBaseData.rudder.thickness),minCrew:Object(l.s)(this.shipCompareData.crew.min)+" "+t(this.shipCompareData.crew.min,this.shipBaseData.crew.min),maxCrew:Object(l.s)(this.shipCompareData.crew.max)+" "+t(this.shipCompareData.crew.max,this.shipBaseData.crew.max),sailingCrew:Object(l.s)(this.shipCompareData.crew.sailing)+" "+t(this.shipCompareData.crew.sailing,this.shipBaseData.crew.sailing),maxWeight:Object(l.s)(this.shipCompareData.maxWeight)+" "+t(this.shipCompareData.maxWeight,this.shipBaseData.maxWeight),holdSize:Object(l.s)(this.shipCompareData.holdSize)+" "+t(this.shipCompareData.holdSize,this.shipBaseData.holdSize),upgradeXP:Object(l.s)(this.shipCompareData.upgradeXP)+" "+t(this.shipCompareData.upgradeXP,this.shipBaseData.upgradeXP),hullRepairAmount:Object(l.s)(100*(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk))+" "+t(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk,this.shipBaseData.repairAmount.armour+this.shipBaseData.repairAmount.armourPerk,3,!0),rigRepairAmount:Object(l.s)(100*(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk))+" "+t(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk,this.shipBaseData.repairAmount.sails+this.shipBaseData.repairAmount.sailsPerk,3,!0),repairTime:Object(l.s)(this.shipCompareData.repairTime.sides)+" "+t(this.shipBaseData.repairTime.sides,this.shipCompareData.repairTime.sides),hullRepairsNeeded:Object(l.s)(r)+" "+t(r,s)+' <span class="badge badge-white">'+Object(l.s)(5*r)+"</span>",rigRepairsNeeded:Object(l.s)(o)+" "+t(o,a)+' <span class="badge badge-white">'+Object(l.s)(5*o)+"</span>",rumRepairsNeeded:Object(l.s)(n)+" "+t(n,i)+' <span class="badge badge-white">'+Object(l.s)(5*n)+"</span>",fireResistance:Object(l.u)(this.shipCompareData.resistance.fire,0)+" "+t(this.shipCompareData.resistance.fire,this.shipBaseData.resistance.fire,2,!0),leakResistance:Object(l.u)(this.shipCompareData.resistance.leaks,0)+" "+t(this.shipCompareData.resistance.leaks,this.shipBaseData.resistance.leaks,2,!0),splinterResistance:Object(l.u)(this.shipCompareData.resistance.splinter,0)+" "+t(this.shipCompareData.resistance.splinter,this.shipBaseData.resistance.splinter,2,!0),mastBottomArmor:Object(l.s)(this.shipCompareData.mast.bottomArmour)+" "+t(this.shipCompareData.mast.bottomArmour,this.shipBaseData.mast.bottomArmour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.mast.bottomThickness)+"</span>"+t(this.shipCompareData.mast.bottomThickness,this.shipBaseData.mast.bottomThickness),mastMiddleArmor:Object(l.s)(this.shipCompareData.mast.middleArmour)+" "+t(this.shipCompareData.mast.middleArmour,this.shipBaseData.mast.middleArmour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.mast.middleThickness)+"</span>"+t(this.shipCompareData.mast.middleThickness,this.shipBaseData.mast.middleThickness),mastTopArmor:Object(l.s)(this.shipCompareData.mast.topArmour)+" "+t(this.shipCompareData.mast.topArmour,this.shipBaseData.mast.topArmour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.mast.topThickness)+"</span>"+t(this.shipCompareData.mast.topThickness,this.shipBaseData.mast.topThickness)};p.gunsFront?p.gunsFront+=" "+C.pd(p.limitFront):p.gunsFront="–",p.gunsBack?p.gunsBack+=" "+C.pd(p.limitBack):p.gunsBack="–",e(""+this.select).find("div").append(C.getText(p))},g(s,[{key:"shipBaseData",get:function(){return this._shipBaseData}},{key:"shipCompareData",get:function(){return this._shipCompareData}},{key:"shipCompare",get:function(){return this._shipCompare}}]),s}(C),k=function(){function t(e){var t=e.shipData,s=e.woodData,a=e.moduleData,r=e.id,o=void 0===r?"ship-compare":r;this._shipData=t,this._moduleDataDefault=a,this._baseId=o,this._baseName="Compare ships",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._moduleId=this._baseId+"-module",this._copyButtonId="button-copy-"+this._baseId,this._shipIds=[],this._selectedUpgradeIdsPerType=[],this._selectedUpgradeIdsList=[],this._selectShip$={},this._selectWood$={},this._selectModule$={},this._modal$=null,this._modifierAmount=new Map,"ship-compare"===this._baseId?this._columnsCompare=["C1","C2"]:this._columnsCompare=[],this._columns=this._columnsCompare.slice(),this._columns.unshift("Base"),this._selectedShips={Base:{},C1:{},C2:{}},this._woodChanges=new Map([["Acceleration",{properties:["ship.acceleration"],isBaseValueAbsolute:!0}],["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],isBaseValueAbsolute:!0}],["Armour strength",{properties:["bow.armour","sides.armour","stern.armour"],isBaseValueAbsolute:!0}],["Splinter resistance",{properties:["resistance.splinter"],isBaseValueAbsolute:!1}],["Crew",{properties:["crew.max"],isBaseValueAbsolute:!0}],["Fire resistance",{properties:["resistance.fire"],isBaseValueAbsolute:!1}],["Hull strength",{properties:["structure.armour"],isBaseValueAbsolute:!0}],["Leak resistance",{properties:["resistance.leaks"],isBaseValueAbsolute:!1}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],isBaseValueAbsolute:!0}],["Rudder speed",{properties:["rudder.halfturnTime"],isBaseValueAbsolute:!0}],["Max speed",{properties:["speed.max"],isBaseValueAbsolute:!0}],["Turn rate",{properties:["rudder.turnSpeed"],isBaseValueAbsolute:!0}]]),this._moduleChanges=new Map([["Acceleration",{properties:["ship.acceleration"],isBaseValueAbsolute:!0}],["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],isBaseValueAbsolute:!0}],["Armour repair amount (perk)",{properties:["repairAmount.armourPerk"],isBaseValueAbsolute:!0}],["Armour repair amount",{properties:["repairAmount.armour"],isBaseValueAbsolute:!0}],["Armour strength",{properties:["bow.armour","sides.armour","stern.armour"],isBaseValueAbsolute:!0}],["Back armour thickness",{properties:["stern.thickness"],isBaseValueAbsolute:!0}],["Splinter resistance",{properties:["resistance.splinter"],isBaseValueAbsolute:!1}],["Crew",{properties:["crew.max"],isBaseValueAbsolute:!0}],["Fire resistance",{properties:["resistance.fire"],isBaseValueAbsolute:!1}],["Front armour thickness",{properties:["bow.thickness"],isBaseValueAbsolute:!0}],["Hold weight",{properties:["maxWeight"],isBaseValueAbsolute:!0}],["Hull strength",{properties:["structure.armour"],isBaseValueAbsolute:!0}],["Leak resistance",{properties:["resistance.leaks"],isBaseValueAbsolute:!1}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],isBaseValueAbsolute:!0}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],isBaseValueAbsolute:!0}],["Rudder health",{properties:["rudder.armour"],isBaseValueAbsolute:!0}],["Rudder repair time",{properties:["repairTime.rudder"],isBaseValueAbsolute:!0}],["Rudder speed",{properties:["rudder.halfturnTime"],isBaseValueAbsolute:!0}],["Sail repair amount (perk)",{properties:["repairAmount.sailsPerk"],isBaseValueAbsolute:!0}],["Sail repair amount",{properties:["repairAmount.sails"],isBaseValueAbsolute:!0}],["Sail repair time",{properties:["repairTime.sails"],isBaseValueAbsolute:!0}],["Sailing crew",{properties:["crew.sailing"],isBaseValueAbsolute:!0}],["Max speed",{properties:["speed.max"],isBaseValueAbsolute:!0}],["Side armour repair time",{properties:["repairTime.sides"],isBaseValueAbsolute:!0}],["Speed decrease",{properties:["ship.deceleration"],isBaseValueAbsolute:!0}],["Turn rate",{properties:["rudder.turnSpeed"],isBaseValueAbsolute:!0}],["Water pump health",{properties:["pump.armour"],isBaseValueAbsolute:!0}],["Water repair time",{properties:["repairTime.pump"],isBaseValueAbsolute:!0}]]),this._moduleCaps=new Map([["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],cap:{amount:.3,isPercentage:!0}}],["Armour strength",{properties:["bow.armour","sides.armour","stern.armour"],cap:{amount:.3,isPercentage:!0}}],["Back armour thickness",{properties:["stern.thickness"],cap:{amount:.3,isPercentage:!0}}],["Front armour thickness",{properties:["bow.thickness"],cap:{amount:.3,isPercentage:!0}}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],cap:{amount:.3,isPercentage:!0}}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],cap:{amount:.3,isPercentage:!0}}],["Max speed",{properties:["speed.max"],cap:{amount:15.5,isPercentage:!1}}],["Turn rate",{properties:["rudder.turnSpeed"],cap:{amount:.25,isPercentage:!0}}]]);var h=1.2*Object(i.a)(this._shipData,function(e){return e.speed.min}),c=this._moduleCaps.get("Max speed").cap.amount;this._minSpeed=h,this._maxSpeed=c,this._colorScale=Object(p.scaleLinear)().domain([this._minSpeed,0,8,12,this._maxSpeed]).range([u.j,"#fff",u.h,u.f,u.g]).interpolate(n.c),"ship-journey"===this._baseId?this._woodId="wood-journey":this._woodId="wood-ship",this._woodCompare=new m.a(s,this._woodId),"ship-journey"===this._baseId?(this._initData(),this._initSelects()):this._setupListener()}var s=t.prototype;return s._setupListener=function(){var t=this;e("#"+this._buttonId).on("click",function(e){Object(d.b)("Tools",t._baseName),e.stopPropagation(),t._shipCompareSelected()})},s._setGraphicsParameters=function(){this.svgWidth=parseInt(e("#"+this._modalId+" .column-base").width(),10),this.svgHeight=this.svgWidth,this.outerRadius=Math.floor(Math.min(this.svgWidth,this.svgHeight)/2),this.innerRadius=Math.floor(.3*this.outerRadius),this.radiusScaleAbsolute=Object(p.scaleLinear)().domain([this.minSpeed,0,this.maxSpeed]).range([10,this.innerRadius,this.outerRadius])},s._shipCompareSelected=function(){var t=this;this._modal$||(this._initModal(),this._modal$=e("#"+this._modalId),this._modal$.on("keydown",function(e){"KeyC"===e.code&&e.ctrlKey&&t._copyDataClicked(e)}),document.getElementById(this._copyButtonId).addEventListener("click",function(e){t._copyDataClicked(e)})),this._modal$.modal("show"),this._setGraphicsParameters()},s._getShipAndWoodIds=function(){var e=this,t=[];return this._columns.forEach(function(s){void 0!==e._shipIds[s]&&(t.push(e._shipIds[s]),["frame","trim"].forEach(function(a){t.push(Number(e._selectWood$[s][a].val()))}))}),t},s._copyDataClicked=function(e){var t=this;Object(d.b)("Menu","Copy ship compare"),e.preventDefault();var s=this._getShipAndWoodIds();if(s.length){var a=new URL(window.location);a.searchParams.set("v",encodeURIComponent(u.d)),a.searchParams.set("cmp",u.x.encode(s)),this._columns.forEach(function(e,s){t._selectedUpgradeIdsPerType[e]&&f(t._moduleTypes).forEach(function(i,r){var o=t._selectedUpgradeIdsPerType[e][i];if(o&&o.length){var n=""+s+r;a.searchParams.set(n,u.x.encode(o))}})}),Object(l.h)(a.href)}},s._setupShipData=function(){this.shipSelectData=Object(o.b)().key(function(e){return e.class}).sortKeys(r.a).entries(this._shipData.map(function(e){return{id:e.id,name:e.name,class:e.class,battleRating:e.battleRating,guns:e.guns}}).sort(Object(l.K)(["name"])))},s._setupModuleData=function(){var e=this;this._moduleProperties=new Map(this._moduleDataDefault.flatMap(function(t){return t[1].filter(function(t){return t.properties.some(function(t){return e._moduleChanges.has(t.modifier)})}).map(function(e){return[e.id,e]})})),this._moduleTypes=new Set(f(this._moduleProperties).map(function(e){return e[1].type.replace(/\s–\s[a-zA-Z\/\s]+/,"")}))},s._injectModal=function(){var e=this;Object(u.D)(this._modalId,this._baseName);var t=Object(h.f)("#"+this._modalId+" .modal-body").append("div").attr("class","container-fluid").append("div").attr("class","row");this._columns.forEach(function(s){var a=t.append("div").attr("class","col-md-4 ml-auto pt-2 "+("Base"===s?"column-base":"column-comp")),i=e._getShipSelectId(s);a.append("label").append("select").attr("name",i).attr("id",i).attr("class","selectpicker"),["frame","trim"].forEach(function(t){var i=e._getWoodSelectId(t,s);a.append("label").append("select").attr("name",i).attr("id",i).attr("class","selectpicker")}),e._moduleTypes.forEach(function(t){var i=e._getModuleSelectId(t,s);a.append("label").append("select").attr("name",i).attr("id",i).property("multiple",!0).attr("class","selectpicker")}),a.append("div").attr("id",e._baseId+"-"+s).attr("class","Base"===s?"ship-base":"ship-compare")}),Object(h.f)("#"+this._modalId+" .modal-footer").insert("button","button").classed("btn btn-outline-secondary",!0).attr("id",this._copyButtonId).attr("title","Copy to clipboard (ctrl-c)").attr("type","button").append("i").classed("far fa-copy",!0)},s._initData=function(){this._setupShipData(),this._setupModuleData(),this.woodCompare._setupData()},s._initSelects=function(){var t=this;this._columns.forEach(function(s){t._selectWood$[s]={},t._setupShipSelect(s),["frame","trim"].forEach(function(a){t._selectWood$[s][a]=e("#"+t._getWoodSelectId(a,s)),t.woodCompare._setupWoodSelects(s,a,t._selectWood$[s][a])}),t._setupSelectListener(s)})},s._initModal=function(){this._initData(),this._injectModal(),this._initSelects()},s._getShipOptions=function(){return this.shipSelectData.map(function(e){return'<optgroup label="'+Object(l.B)(e.key,!1)+' rate">'+e.values.map(function(e){return'<option data-subtext="'+e.battleRating+'" value="'+e.id+'">'+e.name+" ("+e.guns+")"}).join("</option>")}).join("</optgroup>")},s._setupShipSelect=function(t){this._selectShip$[t]=e("#"+this._getShipSelectId(t));var s=this._getShipOptions();this._selectShip$[t].append(s),"Base"!==t&&this._selectShip$[t].attr("disabled","disabled")},s._getUpgradesOptions=function(e,t){var s=Object(o.b)().key(function(e){return e[1].type.replace(/[a-zA-Z\s]+\s–\s/,"")}).sortKeys(r.a).entries(f(this._moduleProperties).filter(function(s){return s[1].type.replace(/\s–\s[a-zA-Z\/\s]+/,"")===e&&("U"===s[1].moduleLevel||s[1].moduleLevel===((a=t)<=3?"L":a<=5?"M":"S"));var a}));return s.length>1?s.map(function(t){return'<optgroup label="'+t.key+'" data-max-options="'+(e.startsWith("Ship trim")?1:5)+'">'+t.values.map(function(e){return'<option value="'+e[0]+'">'+e[1].name}).join("</option>")}).join("</optgroup>"):s.map(function(e){return""+e.values.map(function(e){return'<option value="'+e[0]+'">'+e[1].name}).join("</option>")})},s._fillModuleSelect=function(e,t){var s=this,a=this._getUpgradesOptions(t,s._shipData.find(function(t){return t.id===s._shipIds[e]}).class);this._selectModule$[e][t].find("option").remove(),this._selectModule$[e][t].append(a)},s._resetModuleSelects=function(e){var t=this;this._moduleTypes.forEach(function(s){t._fillModuleSelect(e,s),t._selectModule$[e][s].selectpicker("refresh")})},s._setupModulesSelect=function(t){var s=this;this._selectModule$[t]||(this._selectModule$[t]={},this._moduleTypes.forEach(function(a){s._selectModule$[t][a]=e("#"+s._getModuleSelectId(a,t)),s._selectModule$[t][a].on("changed.bs.select",function(){s._modulesSelected(t),s._refreshShips(t)}).on("show.bs.select",function(){s._selectModule$[t][a].parent().find("button.bs-select-all").remove()}).selectpicker({actionsBox:!0,countSelectedText:function(e){return e+" "+a.toLowerCase()+"s selected"},deselectAllText:"Clear",maxOptions:a.startsWith("Ship trim")?6:5,selectedTextFormat:"count > 1",title:""+a,width:"150px"})})),this._resetModuleSelects(t)},s._getShipData=function(e){var t=this,s=this._shipData.find(function(s){return s.id===t._shipIds[e]}),a=s;return a.repairAmount={},a.repairAmount.armour=u.y,a.repairAmount.armourPerk=0,a.repairAmount.sails=u.H,a.repairAmount.sailsPerk=0,a.repairTime.sides=u.G,a.repairTime.default=u.G,a=this._addWoodData(s,e),a=this._addModulesData(s,a,e)},s._adjustValue=function(e,t,s){var a,i,r=0;if(this._modifierAmount.get(t).absolute){var o=this._modifierAmount.get(t).absolute;i=o,r=(a=e)?a+i:i}this._modifierAmount.get(t).percentage&&(r=function(e,t){return e?s?e*(1+t):e+t:t}(e,this._modifierAmount.get(t).percentage/100));return r},s._setModifier=function(e){var t=e.isPercentage?0:e.amount,s=e.isPercentage?e.amount:0;this._modifierAmount.has(e.modifier)&&(t+=this._modifierAmount.get(e.modifier).absolute,s+=this._modifierAmount.get(e.modifier).percentage),this._modifierAmount.set(e.modifier,{absolute:t,percentage:s})},s._addWoodData=function(e,t){var s=this,a=JSON.parse(JSON.stringify(e));if(a.resistance={},a.resistance.fire=0,a.resistance.leaks=0,a.resistance.splinter=0,void 0!==this.woodCompare._instances[t]){var i="_woodData";"Base"!==t&&(i="_compareData"),this._modifierAmount=new Map,["frame","trim"].forEach(function(e){s.woodCompare._instances[t][i][e].properties.forEach(function(e){s._woodChanges.has(e.modifier)&&s._setModifier(e)})}),this._modifierAmount.forEach(function(e,t){s._woodChanges.get(t).properties.forEach(function(e){var i=e.split(".");i.length>1?a[i[0]][i[1]]=s._adjustValue(a[i[0]][i[1]],t,s._woodChanges.get(t).isBaseValueAbsolute):a[i[0]]=s._adjustValue(a[i[0]],t,s._woodChanges.get(t).isBaseValueAbsolute)})}),a.speedDegrees=a.speedDegrees.map(function(e){var t=1+s._modifierAmount.get("Max speed").percentage/100;return Math.max(Math.min(e*t,s._maxSpeed),s._minSpeed)})}return a},s._addModulesData=function(e,t,s){var a=this,i=JSON.parse(JSON.stringify(t));this._modifierAmount=new Map;return this._selectedUpgradeIdsList[s]?(a._selectedUpgradeIdsList[s].forEach(function(e){a._moduleProperties.get(e).properties.forEach(function(e){a._moduleChanges.has(e.modifier)&&a._setModifier(e)})}),a._modifierAmount.forEach(function(e,t){a._moduleChanges.get(t).properties&&a._moduleChanges.get(t).properties.forEach(function(e){var s=e.split(".");s.length>1?i[s[0]][s[1]]=a._adjustValue(i[s[0]][s[1]],t,a._moduleChanges.get(t).isBaseValueAbsolute):i[s[0]]=a._adjustValue(i[s[0]],t,a._moduleChanges.get(t).isBaseValueAbsolute)})}),a._modifierAmount.forEach(function(t,s){if(a._moduleCaps.has(s)){var r=a._moduleCaps.get(s).cap;a._moduleCaps.get(s).properties.forEach(function(t){var s=t.split(".");s.length>1?i[s[0]][s[1]]&&(i[s[0]][s[1]]=Math.min(i[s[0]][s[1]],r.isPercentage?e[s[0]][s[1]]*(1+r.amount):r.amount)):i[s[0]]&&(i[s[0]]=Math.min(i[s[0]],r.isPercentage?e[s[0]]*(1+r.amount):r.amount))})}}),this._modifierAmount.has("Max speed")&&(i.speedDegrees=i.speedDegrees.map(function(e){var t=1+a._modifierAmount.get("Max speed").percentage/100,s=e>0?e*t:e/t;return Math.max(Math.min(s,a._maxSpeed),a._minSpeed)})),i):i},s._refreshShips=function(e){var t=this;"ship-journey"!==this._baseId&&this._modulesSelected(e);var s=this._getShipData(e);"ship-journey"===this._baseId?this._singleShipData=s:"Base"===e?(this._setSelectedShip(e,new w(e,s,this)),this._columnsCompare.forEach(function(e){t._selectShip$[e].removeAttr("disabled").selectpicker("refresh"),Object(l.D)(t.selectedShips[e])||t._setSelectedShip(e,new S(e,s,t.selectedShips[e]._shipCompareData,t))})):this._setSelectedShip(e,new S(e,this.selectedShips.Base._shipData,s,this))},s._enableCompareSelects=function(){var e=this;this._columnsCompare.forEach(function(t){e._selectShip$[t].removeAttr("disabled").selectpicker("refresh")})},s._modulesSelected=function(e){var t=this;this._selectedUpgradeIdsList[e]=[],this._selectedUpgradeIdsPerType[e]={},this._moduleTypes.forEach(function(s){t._selectedUpgradeIdsPerType[e][s]=t._selectModule$[e][s].val(),Array.isArray(t._selectedUpgradeIdsPerType[e][s])?t._selectedUpgradeIdsPerType[e][s]=t._selectedUpgradeIdsPerType[e][s].map(Number):t._selectedUpgradeIdsPerType[e][s]=""===t._selectedUpgradeIdsPerType[e][s]?[]:[Number(t._selectedUpgradeIdsPerType[e][s])],t._selectedUpgradeIdsPerType[e][s].length&&(t._selectedUpgradeIdsList[e]=t._selectedUpgradeIdsList[e].concat(t._selectedUpgradeIdsPerType[e][s]))})},s._setupSelectListener=function(e){var t=this;this._selectShip$[e].selectpicker({title:"Ship"}).on("changed.bs.select",function(){t._shipIds[e]=Number(t._selectShip$[e].val()),"ship-journey"!==t._baseId&&t._setupModulesSelect(e),t._refreshShips(e),"Base"===e&&"ship-journey"!==t._baseId&&t._enableCompareSelects(),t.woodCompare.enableSelects(e)}),["frame","trim"].forEach(function(s){t._selectWood$[e][s].on("changed.bs.select",function(){t.woodCompare._woodSelected(e,s,t._selectWood$[e][s]),t._refreshShips(e)}).selectpicker({title:"Wood "+s,width:"150px"})})},s.initFromClipboard=function(e){var t,s,a=this,i=function(e,t){t&&e.val(t),e.selectpicker("render")},r=u.x.decode(e.get("cmp"));r.length&&(this._shipCompareSelected(),r.length>3&&this._enableCompareSelects(),t=r,s=0,a._columns.some(function(e){return!!a._shipData.find(function(e){return e.id===t[s]})&&(a._shipIds[e]=t[s],s+=1,i(a._selectShip$[e],a._shipIds[e]),"Base"===e&&"ship-journey"!==a._baseId&&a._enableCompareSelects(),a.woodCompare.enableSelects(e),a._setupModulesSelect(e),t[s]?["frame","trim"].forEach(function(r){i(a._selectWood$[e][r],t[s]),s+=1,a.woodCompare._woodSelected(e,r,a._selectWood$[e][r])}):s+=2,a._refreshShips(e),s>=t.length)}),a._columns.forEach(function(t,s){var r=!1;f(a._moduleTypes).forEach(function(o,n){if(e.has(""+s+n)){var p=u.x.decode(e.get(""+s+n));a._selectedUpgradeIdsPerType[t]||(a._selectedUpgradeIdsPerType[t]={}),a._selectedUpgradeIdsList[t]||(a._selectedUpgradeIdsList[t]=[]),a._selectedUpgradeIdsPerType[t][o]=p.map(Number),i(a._selectModule$[t][o],a._selectedUpgradeIdsPerType[t][o]),a._selectedUpgradeIdsList[t]=a._selectedUpgradeIdsList[t].concat(a._selectedUpgradeIdsPerType[t][o]),r=!0}}),r&&a._refreshShips(t)}))},s._getShipSelectId=function(e){return this._baseId+"-"+e+"-select"},s._getWoodSelectId=function(e,t){return this._woodId+"-"+e+"-"+t+"-select"},s._getModuleSelectId=function(e,t){return this._moduleId+"-"+e.replace(/\s/,"")+"-"+t+"-select"},s._setSelectedShip=function(e,t){this._selectedShips[e]=t},g(t,[{key:"woodCompare",get:function(){return this._woodCompare}},{key:"selectedShips",get:function(){return this._selectedShips}},{key:"minSpeed",get:function(){return this._minSpeed}},{key:"maxSpeed",get:function(){return this._maxSpeed}},{key:"colorScale",get:function(){return this._colorScale}},{key:"svgWidth",set:function(e){this._svgWidth=e},get:function(){return this._svgWidth}},{key:"svgHeight",set:function(e){this._svgHeight=e},get:function(){return this._svgHeight}},{key:"outerRadius",set:function(e){this._outerRadius=e},get:function(){return this._outerRadius}},{key:"innerRadius",set:function(e){this._innerRadius=e},get:function(){return this._innerRadius}},{key:"radiusScaleAbsolute",set:function(e){this._radiusScaleAbsolute=e},get:function(){return this._radiusScaleAbsolute}}]),t}()}).call(this,s("xeH2"))},pFgi:function(e,t,s){"use strict";(function(e){s.d(t,"a",function(){return m});s("iPZ8"),s("kypl"),s("pCzD"),s("hi3g"),s("lYjL"),s("IlJM"),s("Se8w"),s("4owi"),s("/YXa"),s("lmye"),s("WB5j"),s("aOEW"),s("bEJU"),s("D/wG"),s("1Qwx"),s("fp7Y"),s("ZEAQ"),s("JBxO"),s("9UJh"),s("RsMT"),s("WoWj"),s("SgDD"),s("3dw1"),s("U00V");var a=s("ED/D"),i=s("qKAC"),r=s("nUlG"),o=s("f4w0"),n=s("0lY5"),p=s("Av7d");function h(e){return function(e){if(Array.isArray(e)){for(var t=0,s=new Array(e.length);t<e.length;t++)s[t]=e[t];return s}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var d=function(){function e(e,t){this._id=e,this._woodCompare=t,this._select="#"+this._woodCompare._baseFunction+"-"+this._id,this._setupMainDiv(),this._g=Object(r.f)(this._select).select("g")}return e.prototype._setupMainDiv=function(){Object(r.f)(this._select+" div").remove(),Object(r.f)(this._select).append("div")},e}(),u=function(t){function s(e,s,a){var i;return(i=t.call(this,e,a)||this)._woodData=s,i._woodCompare=a,i._printText(),i}c(s,t);var a=s.prototype;return a._getProperty=function(e,t){var s=this._woodData[t].properties.find(function(t){return t.modifier===e}),a=0,i=!1;return s&&s.amount&&(a=s.amount,i=s.isPercentage),{amount:a,isPercentage:i}},a._getPropertySum=function(e){var t=this._getProperty(e,"frame"),s=this._getProperty(e,"trim");return{amount:t.amount+s.amount,isPercentage:s.isPercentage}},a._getText=function(e){var t=this,s='<table class="table table-sm table-striped small mt-4"><thead>';return s+="<tr>",s+="<tr><th><em>Property</em></th><th><em>Change</em></th></tr></thead><tbody>",e.properties.forEach(function(e,a){if(s+="<tr><td>"+a+"</td><td>"+(e.isPercentage?Object(n.u)(e.amount/100):Object(n.p)(e.amount)),s+='<span class="rate">',e.amount>0){var i=e.amount/t._woodCompare._minMaxProperty.get(a).max*50;s+='<span class="bar neutral" style="width:50%;"></span>',s+='<span class="bar pos diff" style="width:'+i+'%;"></span>'}else if(e.amount<0){var r=e.amount/t._woodCompare._minMaxProperty.get(a).min*50;s+='<span class="bar neutral" style="width:'+(50-r)+'%;"></span>',s+='<span class="bar neg diff" style="width:'+r+'%;"></span>'}else s+='<span class="bar neutral"></span>';s+="</span></td></tr>"}),s+="</tbody></table>"},a._printText=function(){var t=this,s={frame:this._woodData.frame.id,trim:this._woodData.trim.id};s.properties=new Map,this._woodCompare.propertyNames.forEach(function(e){var a=t._getPropertySum(e);s.properties.set(e,{amount:a.amount,isPercentage:a.isPercentage})}),e(""+this._select).find("div").append(this._getText(s))},s}(d),l=function(t){function s(e,s,a,i){var r;return(r=t.call(this,e,i)||this)._baseData=s,r._compareData=a,r._woodCompare=i,r._printTextComparison(),r}c(s,t);var a=s.prototype;return a._getBaseProperty=function(e,t){var s=this._baseData[t].properties.find(function(t){return t.modifier===e}),a=0,i=!1;return s&&s.amount&&(a=s.amount,i=s.isPercentage),{amount:a,isPercentage:i}},a._getBasePropertySum=function(e){var t=this._getBaseProperty(e,"frame"),s=this._getBaseProperty(e,"trim");return{amount:t.amount+s.amount,isPercentage:s.isPercentage}},a._getCompareProperty=function(e,t){var s=this._compareData[t].properties.find(function(t){return t.modifier===e}),a=0,i=!1;return s&&s.amount&&(a=s.amount,i=s.isPercentage),{amount:a,isPercentage:i}},a._getComparePropertySum=function(e){var t=this._getCompareProperty(e,"frame"),s=this._getCompareProperty(e,"trim");return{amount:t.amount+s.amount,isPercentage:t.isPercentage&&s.isPercentage}},a._getText=function(e){var t=this;var s=0,a=0,i=0,r="",o='<table class="table table-sm table-striped small wood mt-4"><thead>';return o+="<tr>",o+="<tr><th><em>Property</em></th><th><em>Change</em></th></tr></thead><tbody>",e.properties.forEach(function(e,p){o+="<tr><td>"+p+"</td><td>"+function(e,t,s,a){void 0===a&&(a=1);var i=parseFloat((e-t).toFixed(a));return(s?Object(n.u)(e/100,a):Object(n.p)(e))+' <span class="badge badge-white">'+Object(n.x)(i)+"</span>"}(e.compare,e.base,e.isPercentage),o+='<span class="rate">',e.compare>=0?(e.base>=0?e.compare>e.base?(s=e.base,a=e.compare-e.base,r="pos"):(s=e.compare,a=e.base-e.compare,r="neg"):(s=0,a=e.compare,r="pos"),o+='<span class="bar neutral" style="width:50%;"></span>',o+='<span class="bar pos diff" style="width:'+s/t._woodCompare._minMaxProperty.get(p).max*50+'%;"></span>',o+='<span class="bar '+r+'" style="width:'+a/t._woodCompare._minMaxProperty.get(p).max*50+'%;"></span>'):e.compare<0?(e.base<0?e.compare>=e.base?(s=e.compare,a=e.base-e.compare,i=-e.base,r="pos"):(s=e.base,a=e.compare-e.base,i=-e.compare,r="neg"):(s=0,a=e.compare,i=-e.compare,r="neg"),o+='<span class="bar neutral" style="width:'+(50+i/t._woodCompare._minMaxProperty.get(p).min*50)+'%;"></span>',o+='<span class="bar '+r+'" style="width:'+a/t._woodCompare._minMaxProperty.get(p).min*50+'%;"></span>',o+='<span class="bar neg diff" style="width:'+s/t._woodCompare._minMaxProperty.get(p).min*50+'%;"></span>'):o+='<span class="bar neutral"></span>',o+="</span></td></tr>"}),o+="</tbody></table>"},a._printTextComparison=function(){var t=this,s={frame:this._compareData.frame.name,trim:this._compareData.trim.name};s.properties=new Map,this._woodCompare.propertyNames.forEach(function(e){var a=t._getBasePropertySum(e),i=t._getComparePropertySum(e);s.properties.set(e,{base:a.amount,compare:i.amount,isPercentage:a.isPercentage})}),e(""+this._select).find("div").append(this._getText(s))},s}(d),m=function(){function t(e,t){var s=this;this._woodData=e,this._baseFunction=t,this._baseName="Compare woods",this._baseId=this._baseFunction+"-compare",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId;var a=function(e,t){return s._woodData[e].find(function(e){return e.name===t}).id};"wood"===this._baseFunction?(this._defaultWood={frame:a("frame","Fir"),trim:a("trim","Crew Space")},this._columnsCompare=["C1","C2","C3"]):"wood-journey"===this._baseFunction?(this._defaultWood={frame:a("frame","Oak"),trim:a("trim","Oak")},this._columnsCompare=[]):(this._defaultWood={frame:a("frame","Oak"),trim:a("trim","Oak")},this._columnsCompare=["C1","C2"]),this._columns=this._columnsCompare.slice(),this._columns.unshift("Base"),this._woodsSelected=[],this._instances=[],this.propertyNames=new Set([].concat(h(this._woodData.frame.map(function(e){return e.properties.map(function(e){return e.modifier})}).flat()),h(this._woodData.trim.map(function(e){return e.properties.map(function(e){return e.modifier})}).flat())).sort()),this._options={},this._minMaxProperty=new Map,this._setupListener()}var s=t.prototype;return s._setupListener=function(){var t=this;e("#"+this._buttonId).on("click",function(e){Object(o.b)("Tools",t._baseName),e.stopPropagation(),t._woodCompareSelected()})},s._woodCompareSelected=function(){document.getElementById(this._modalId)||this._initModal(),e("#"+this._modalId).modal("show")},s._setupData=function(){var e=this;this._frameSelectData=this._woodData.frame.sort(Object(n.K)(["name"])),this._trimSelectData=this._woodData.trim.sort(Object(n.K)(["name"])),this._setOption(this._frameSelectData.map(function(e){return'<option value="'+e.id+'">'+e.name+"</option>"}),this._trimSelectData.map(function(e){return'<option value="'+e.id+'">'+e.name+"</option>"})),this.propertyNames.forEach(function(t){var s=h(e._woodData.frame.map(function(e){return e.properties.filter(function(e){return e.modifier===t}).map(function(e){return e.amount})[0]})),r=h(e._woodData.trim.map(function(e){return e.properties.filter(function(e){return e.modifier===t}).map(function(e){return e.amount})[0]})),o=Object(a.a)(s)||0,n=Object(i.a)(s)||0,p=Object(a.a)(r)||0,c=Object(i.a)(r)||0;e._addMinMaxProperty(t,{min:o+p>=0?0:o+p,max:n+c})})},s._injectModal=function(){var e=this;Object(p.D)(this._modalId,this._baseName);var t=Object(r.f)("#"+this._modalId+" .modal-body").append("div").attr("class","container-fluid").append("div").attr("class","row wood");this._columns.forEach(function(s){var a=t.append("div").attr("class","col-md-3 ml-auto pt-2 "+("Base"===s?"column-base":"column-comp"));["frame","trim"].forEach(function(t){var i=e._baseFunction+"-"+t+"-"+s+"-select";a.append("label").attr("for",i),a.append("select").attr("name",i).attr("id",i).attr("class","selectpicker")}),a.append("div").attr("id",e._baseFunction+"-"+s)})},s._initModal=function(){var t=this;this._setupData(),this._injectModal(),this._columns.forEach(function(s){["frame","trim"].forEach(function(a){var i=e("#"+t._baseFunction+"-"+a+"-"+s+"-select");t._setupWoodSelects(s,a,i),t._setupSelectListener(s,a,i)})})},s._setWoodsSelected=function(e,t,s){this._woodsSelected[e]||(this._woodsSelected[e]={}),this._woodsSelected[e][t]=s},s._setupWoodSelects=function(e,t,s){this._setWoodsSelected(e,t,this._defaultWood[t]),s.append(this._options[t]),("wood"!==this._baseFunction||"Base"!==e&&"wood"===this._baseFunction)&&s.attr("disabled","disabled")},s._setOtherSelect=function(t,s){var a="frame"===s?"trim":"frame";this._woodsSelected[t][a]===this._defaultWood[a]&&e("#"+this._baseFunction+"-"+a+"-"+t+"-select").val(this._defaultWood[a]).selectpicker("refresh")},s.enableSelects=function(t){var s=this;["frame","trim"].forEach(function(a){e("#"+s._baseFunction+"-"+a+"-"+t+"-select").removeAttr("disabled").selectpicker("refresh")})},s._woodSelected=function(e,t,s){var a=this,i=Number(s.val());this._setWoodsSelected(e,t,i),this._setOtherSelect(e,t),"Base"===e?(this._addInstance(e,new u("Base",this._getWoodData("Base"),this)),this._columnsCompare.forEach(function(e){"wood"===a._baseFunction&&a.enableSelects(e),a._instances[e]&&a._addInstance(e,new l(e,a._getWoodData("Base"),a._getWoodData(e),a))})):this._addInstance(e,new l(e,this._getWoodData("Base"),this._getWoodData(e),this))},s._setupSelectListener=function(e,t,s){var a=this;s.on("change",function(){return a._woodSelected(e,t,s)}).selectpicker({title:"Select "+t})},s._getWoodData=function(e){return{frame:this.getWoodTypeData("frame",this._woodsSelected[e].frame),trim:this.getWoodTypeData("trim",this._woodsSelected[e].trim)}},s._addMinMaxProperty=function(e,t){this._minMaxProperty.set(e,t)},s._setOption=function(e,t){this._options.frame=e,this._options.trim=t},s._addInstance=function(e,t){this._instances[e]=t},s.getWoodTypeData=function(e,t){return this._woodData[e].find(function(e){return e.id===t})},t}()}).call(this,s("xeH2"))}}]);