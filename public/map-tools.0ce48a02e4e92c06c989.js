/*! For license information please see map-tools.0ce48a02e4e92c06c989.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"8+NV":function(t,i,e){(function(t){e.d(i,"a",(function(){return g}));e("WUlJ"),e("fCtr"),e("ry7D");var s=e("AKWm"),r=e("+ugm"),n=(e("b6Yt"),e("Iohx"),e("pOjD")),d=e("Q4du"),a=e("otg8"),o=e("dNoP"),h=e("Wgwc"),l=e.n(h),c=e("+QaA"),u=e.n(c),p=e("Ds8A"),_=e.n(p),m=e("m+OL");function v(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}l.a.extend(u.a),l.a.extend(_.a);class g{constructor(){v(this,"_line",void 0),v(this,"_windPath",void 0),v(this,"_windArrowWidth",void 0),v(this,"_intervalSeconds",void 0),v(this,"_baseName",void 0),v(this,"_baseId",void 0),v(this,"_buttonId",void 0),v(this,"_modalId",void 0),v(this,"_formId",void 0),v(this,"_sliderId",void 0),v(this,"_cookieExpire",void 0),v(this,"_cookieWindDegrees",void 0),v(this,"_cookieTime",void 0),v(this,"_currentWindDegrees",void 0),v(this,"_height",void 0),v(this,"_yCompass",void 0),v(this,"_width",void 0),v(this,"_xCompass",void 0),v(this,"_compassRadius",void 0),v(this,"_length",void 0),v(this,"_intervalId",void 0),v(this,"_svg",void 0),v(this,"_div",void 0),this._line=Object(r.a)().x((t=>t[0])).y((t=>t[1])),this._windArrowWidth=4,this._intervalSeconds=40,this._baseName="In-game wind",this._baseId="ingame-wind",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._formId="form-"+this._baseId,this._sliderId="slider-"+this._baseId,this._cookieExpire=this._getExpire(),this._cookieWindDegrees=new m.a({id:this._baseId+"-degrees",expire:this._cookieExpire}),this._cookieTime=new m.a({id:this._baseId+"-time"}),this._currentWindDegrees=this._getCurrentWindCookie(),this._setupListener(),this._currentWindDegrees&&this._initShowCurrentWind()}_getHeight(){const t=document.querySelector("#port-summary .block");if(t){const{height:i,top:e}=t.getBoundingClientRect();return i-e-Number.parseFloat(window.getComputedStyle(t).getPropertyValue("padding-top"))-Number.parseFloat(window.getComputedStyle(t).getPropertyValue("padding-bottom"))}return 0}_getCurrentWindCookie(){const t=Number(this._cookieWindDegrees.get());if(t){const i=Number(this._cookieTime.get()),e=Math.round((Date.now()-i)/1e3);this._currentWindDegrees=360+Math.floor(t-d.i*e)%360}return t}_getExpire(){const t=l.a.utc();let i=l()().utc().hour(10).minute(0).second(0);return t.hour()>=i.hour()&&(i=i.add(1,"day")),i.local().toDate()}_storeCurrentWindCookie(){this._cookieWindDegrees.set(String(this._currentWindDegrees)),this._cookieTime.set(String(Date.now()))}_setupSvg(){const t=Object(s.a)("#port-summary");t.classed("port-summary-no-wind",!1).classed("port-summary-wind",!0),this._div=t.insert("div",":first-child").attr("id",this._baseId).attr("class","block p-0"),this._svg=this._div.append("svg").attr("class","ingame-wind small")}_navbarClick(){Object(n.b)("Menu",this._baseName),this._windRoseSelected()}_setupListener(){var t;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",(()=>this._navbarClick()))}_setupWindInput(){const i=t.fn.roundSlider.prototype._getTooltipPos;t.fn.roundSlider.prototype._getTooltipPos=function(){this.tooltip.is(":visible")||t("body").append(this.tooltip);const e=i.call(this);return this.container.append(this.tooltip),e},window.tooltip=t=>`${Object(o.e)(t.value)}<br>${String(t.value)}°`,t("#"+this._sliderId).roundSlider({sliderType:"default",handleSize:"+1",startAngle:90,width:20,radius:110,min:0,max:359,step:360/a.b.length,editableTooltip:!1,tooltipFormat:"tooltip",create(){this.control.css("display","block")}})}_injectModal(){Object(d.k)({id:this._modalId,title:this._baseName,size:"modal-sm"});const t=Object(s.a)(`#${this._modalId} .modal-body`).append("form").attr("id",this._formId).append("div").attr("class","form-group").append("div").attr("class","alert alert-primary");t.append("label").attr("for",this._sliderId).text("Current in-game wind"),t.append("div").attr("id",this._sliderId).attr("class","rslider")}_initModal(){this._injectModal(),this._setupWindInput()}_windRoseSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show").one("hidden.bs.modal",(()=>{this._useUserInput()}))}_windChange(){this._currentWindDegrees=360+(this._currentWindDegrees-d.i*this._intervalSeconds)%360,this._updateWindDirection()}_useUserInput(){this._currentWindDegrees=Object(o.j)(this._sliderId),this._windPath?this._updateWindDirection():this._initShowCurrentWind()}_initShowCurrentWind(){this._setupSvg(),this._initPrintCompassRose(),this._updateWindDirection(),this._intervalId=window.setInterval((()=>{this._windChange()}),1e3*this._intervalSeconds)}_updateWindDirection(){const t=Object(a.n)(this._currentWindDegrees),i=this._length*Math.cos(t),e=this._length*Math.sin(t),s=[[Math.round(this._xCompass+i),Math.round(this._yCompass+e)],[Math.round(this._xCompass-i),Math.round(this._yCompass-e)]];this._windPath&&(this._windPath.datum(s).attr("d",this._line),this._storeCurrentWindCookie())}_initPrintCompassRose(){this._height=this._getHeight(),this._yCompass=this._height/2,this._width=this._height,this._xCompass=this._width/2,this._compassRadius=Math.min(this._height,this._width)/2,this._length=.6*this._compassRadius,this._svg.attr("height",this._height).attr("width",this._width);const t=this._svg.append("svg").attr("class","compass").attr("x",this._xCompass).attr("y",this._yCompass);Object(o.l)({element:t,radius:this._compassRadius}),this._windPath=this._svg.append("path").attr("marker-end","url(#wind-arrow)")}clearMap(){window.clearInterval(this._intervalId),this._div&&this._div.remove(),this._windPath=void 0,this._cookieWindDegrees.remove()}}}).call(this,e("xeH2"))},"AT7/":function(t,i,e){},Iohx:function(t,i,e){},dNoP:function(t,i,e){(function(t){e.d(i,"e",(function(){return d})),e.d(i,"f",(function(){return a})),e.d(i,"j",(function(){return o})),e.d(i,"m",(function(){return h})),e.d(i,"a",(function(){return l})),e.d(i,"k",(function(){return c})),e.d(i,"l",(function(){return u})),e.d(i,"d",(function(){return p})),e.d(i,"c",(function(){return _})),e.d(i,"b",(function(){return m})),e.d(i,"g",(function(){return v})),e.d(i,"i",(function(){return g})),e.d(i,"h",(function(){return b}));var s=e("sCaM"),r=e("Q4du"),n=e("otg8");const d=(t,i=!1)=>{let e;return e=Number.isNaN(Number(t))?t:Object(n.m)(Number(t)),`<${i?"tspan":"span"} class="caps">${e}</${i?"tspan":"span"}>`},a=(t,i=!1)=>{let e,s;return Number.isNaN(Number(t))?(e=t,s=Object(n.c)(e)%n.j):(s=Number(t),e=Object(n.m)(s)),`<${i?"tspan":"span"} class="caps">${e}</${i?"tspan":"span"}> (${s}°)`},o=i=>{const e=Object(n.m)(t("#"+i).roundSlider("getValue"));let s;return s=Number.isNaN(Number(e))?Object(n.c)(e):Number(e),s},h=(t,i)=>{let e=Math.atan2(i.y-t.y,i.x-t.x);e-=Math.PI/2;let s=Object(n.t)(e);return s<0&&(s+=n.j),s},l=(t,i,e=!0)=>{if(i<2)return[t];const s=t.length,r=[];let n,d=0;if(s%i==0)for(n=Math.floor(s/i);d<s;)r.push(t.slice(d,d+=n));else if(e)for(;d<s;)n=Math.ceil((s-d)/i--),r.push(t.slice(d,d+=n));else{for(i-=1,n=Math.floor(s/i),s%n==0&&(n-=1);d<n*i;)r.push(t.slice(d,d+=n));r.push(t.slice(n*i))}return r},c=({element:t,radius:i})=>{const e=r.l,d=n.j/e,a=Math.round(.8*i),o=new Array(e).fill(void 0).map(((t,i)=>Object(n.m)(i*d))),h=Object(s.a)().range([0-d/2,n.j-d/2]).domain(o).align(0);t.append("circle").attr("r",a).style("stroke-width","3px");const l=t.append("text"),c=t.selectAll("g").data(o).join((t=>t.append("g").attr("transform",(t=>{var i;return`rotate(${Math.round((null!==(i=h(t))&&void 0!==i?i:0)+h.bandwidth()/2-n.l)})translate(${a},0)`}))));c.filter(((t,i)=>i%3!=0)).append("line").attr("x2",9),c.filter(((t,i)=>i%3==0)).append("text").attr("transform",(t=>{var i,e,s,r,n;let d,a=Math.round((null!==(i=h(t))&&void 0!==i?i:0)+h.bandwidth()/2);l.text(t);const o=null!==(e=null===(s=l.node())||void 0===s?void 0:s.getBBox().height)&&void 0!==e?e:0,c=null!==(r=null===(n=l.node())||void 0===n?void 0:n.getBBox().width)&&void 0!==r?r:0;return a>=0&&a<=45||315===a?(a=90,d="0,-"+o/2):90===a?(a=0,d=c/2+3+",0"):270===a?(a=180,d=`-${c/2+3},0`):(a=-90,d="0,"+(o/2+3+2)),`rotate(${a})translate(${d})`})).text((t=>t)),l.remove()},u=({element:t,radius:i})=>{const e=r.l,d=n.j/e,a=Math.round(.8*i),o=new Array(e).fill(void 0).map(((t,i)=>Object(n.m)(i*d))),h=Object(s.a)().range([0-d/2,n.j-d/2]).domain(o).align(0);t.append("circle").attr("r",a).style("stroke-width","1.5px");t.selectAll("line").data(o).join((t=>t.append("line").attr("x2",((t,i)=>i%3==0?i%6==0?6:4:2)).attr("transform",(t=>{var i;return`rotate(${Math.round((null!==(i=h(t))&&void 0!==i?i:0)+h.bandwidth()/2)})translate(${a},0)`}))))},p=t=>`<span class="caps">${t}</span>`,_=(t,i)=>{navigator.clipboard||((t,i)=>{var e,s;if(!(null===(e=(s=document).queryCommandSupported)||void 0===e?void 0:e.call(s,"copy")))return console.error(`Insufficient rights to copy ${t} to clipboard`),!1;{const e=document.createElement("input");e.type="text",e.value=t,e.style.position="absolute",e.style.left="-1000px",e.style.top="-1000px",i.append(e),e.select();try{document.execCommand("copy")}catch(t){return console.error("Copy to clipboard failed.",t),!1}finally{e.remove()}}})(t,i),(async t=>{navigator.clipboard.writeText(t).then((()=>!0)).catch((i=>(console.error(`Cannot copy ${t} to clipboard`,i),!1)))})(t)},m=(t,i,e)=>{if(Number.isFinite(t)&&Number.isFinite(i)){const s=new URL(window.location.href);s.searchParams.set("x",String(t)),s.searchParams.set("z",String(i)),_(s.href,e)}},v=(t,i,e)=>`M${t-e},${i}a${e},${e} 0 10${2*e},0a${e},${e} 0 10${2*-e},0`,g=(t,i,e)=>`M${t-e/2},${i-e/2}h${e}v${e}h${-e}z`,b=(t,i,e)=>`M${t},${i}v${e}`}).call(this,e("xeH2"))},sL5V:function(t,i,e){e.r(i),e.d(i,"init",(function(){return n}));var s=e("uvNv"),r=e("8+NV");e("AT7/");const n=()=>{new s.a,new r.a}},uvNv:function(t,i,e){(function(t){e.d(i,"a",(function(){return v}));e("WUlJ"),e("fCtr");var s=e("AKWm"),r=e("+ugm"),n=(e("b6Yt"),e("pOjD")),d=e("Q4du"),a=e("otg8"),o=e("dNoP"),h=e("Wgwc"),l=e.n(h),c=e("+QaA"),u=e.n(c),p=e("Ds8A"),_=e.n(p);function m(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}l.a.extend(u.a),l.a.extend(_.a),l.a.locale("en-gb");class v{constructor(){m(this,"_height",void 0),m(this,"_width",void 0),m(this,"_windArrowWidth",void 0),m(this,"_baseName",void 0),m(this,"_baseId",void 0),m(this,"_buttonId",void 0),m(this,"_modalId",void 0),m(this,"_formId",void 0),m(this,"_sliderId",void 0),m(this,"_timeGroupId",void 0),m(this,"_timeInputId",void 0),m(this,"_svg",void 0),this._height=300,this._width=260,this._windArrowWidth=3,this._baseName="Predict wind",this._baseId="predict-wind",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._formId="form-"+this._baseId,this._sliderId="slider-"+this._baseId,this._timeGroupId="input-group-"+this._baseId,this._timeInputId="input-"+this._baseId,this._setupSvg(),this._setupArrow(),this._setupListener()}_setupSvg(){this._svg=Object(s.a)("#wind svg")}_setupArrow(){const t=this._windArrowWidth,i=2*this._windArrowWidth;Object(s.a)("#na-svg defs").append("marker").attr("id","wind-arrow").attr("viewBox",`0 -${t} ${i} ${i}`).attr("refX",t).attr("refY",0).attr("markerWidth",t).attr("markerHeight",t).attr("orient","auto").append("path").attr("d",`M0,-${t}L${i},0L0,${t}`).attr("class","wind-predict-arrow-head")}_navbarClick(){Object(n.b)("Menu",this._baseName),this._windSelected()}_setupListener(){var t;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",(()=>this._navbarClick()))}_setupWindInput(){const i=t.fn.roundSlider.prototype._getTooltipPos;t.fn.roundSlider.prototype._getTooltipPos=function(){this.tooltip.is(":visible")||t("body").append(this.tooltip);const e=i.call(this);return this.container.append(this.tooltip),e},window.tooltip=t=>`${Object(o.e)(t.value)}<br>${String(t.value)}°`,t("#"+this._sliderId).roundSlider({sliderType:"default",handleSize:"+1",startAngle:90,width:20,radius:110,min:0,max:359,step:360/a.b.length,editableTooltip:!1,tooltipFormat:"tooltip",create(){this.control.css("display","block")}})}_injectModal(){Object(d.k)({id:this._modalId,title:this._baseName,size:"modal-sm"});const t=Object(s.a)(`#${this._modalId} .modal-body`).append("form").attr("id",this._formId),i=t.append("div").attr("class","form-group").append("div").classed("alert alert-primary",!0);i.append("label").attr("for",this._sliderId).text("Current in-game wind"),i.append("div").attr("id",this._sliderId).attr("class","rslider");const e=t.append("div").attr("class","form-group").append("div").attr("class","alert alert-primary");e.append("label").attr("for",this._timeInputId).text("Predict time (server time)");e.append("div").classed("input-group date",!0).attr("id",this._timeGroupId).attr("data-target-input","nearest").append("input").attr("class","form-control").attr("type","time").attr("id",this._timeInputId).attr("value",l.a.utc().format("HH:mm")).attr("data-target","#"+this._timeGroupId).attr("aria-label",this._timeGroupId).attr("required","")}_initModal(){this._injectModal(),this._setupWindInput()}_windSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show").one("hidden.bs.modal",(()=>{this._useUserInput()}))}_useUserInput(){const i=Object(o.j)(this._sliderId),e=t("#"+this._timeInputId).val().trim();this._predictWind(i,e)}_predictWind(t,i){const e="H.mm";let s;const r=/(\d+)[\s.:](\d+)/.exec(i),n=Number.parseInt(r[1],10),o=Number.parseInt(r[2],10);s=Number.isNaN(Number(t))?Object(a.c)(String(t)):Number(t);const h=l()().utc().second(0).millisecond(0),c=l()(h).hour(n).minute(o);c.isBefore(h)&&c.add(1,"day");const u=c.diff(h,"second"),p=360+(s-d.i*u)%360;this._printPredictedWind(p,c.format(e),Object(a.m)(t),h.format(e))}_printCompass(t){const i=Object(r.a)(),e=Math.min(this._height/1.4,this._width/1.4)/2,s=this._width/2,n=this._height/2.8,d=Object(a.n)(t),h=.6*e,l=h*Math.cos(d),c=h*Math.sin(d),u=[[Math.round(s+l),Math.round(n+c)],[Math.round(s-l),Math.round(n-c)]];this._svg.attr("height",this._height).attr("width",this._width);const p=this._svg.append("svg").attr("class","compass").attr("x",s).attr("y",n);Object(o.k)({element:p,radius:e}),this._svg.append("path").datum(u).attr("d",i).attr("marker-end","url(#wind-arrow)")}_printText(t,i,e,s){var r,n;const d=Object(a.m)(t),h=Number.parseInt(window.getComputedStyle(document.querySelector("#wind")).getPropertyValue("line-height"),10),l=this._svg.append("svg"),c=l.append("text").attr("x","50%").attr("y","33%").html(`From ${Object(o.f)(d,!0)} at ${i}`),u=l.append("text").attr("x","50%").attr("y","66%").attr("class","text-light-separation").html(`Currently at ${s} from ${Object(o.f)(e,!0)}`),p=null===(r=c.node())||void 0===r?void 0:r.getBoundingClientRect(),_=null===(n=u.node())||void 0===n?void 0:n.getBoundingClientRect(),m=2*Math.max(Number(null==p?void 0:p.height),Number(null==_?void 0:_.height))+h,v=Math.max(Number(null==p?void 0:p.width),Number(null==_?void 0:_.width))+h;l.attr("x",(this._width-v)/2).attr("y","72%").attr("height",m).attr("width",v)}_addBackground(){this._svg.insert("rect",":first-child").attr("x",0).attr("y",0).attr("height",this._height).attr("width",this._width)}_printPredictedWind(t,i,e,s){this.clearMap(),this._svg.classed("d-none",!1),this._printCompass(t),this._printText(t,i,e,s),this._addBackground()}setPosition(t,i){this._svg.style("margin-left",i+"px").style("margin-top",t+"px")}clearMap(){this._svg.selectAll("*").remove(),this._svg.classed("d-none",!0)}}}).call(this,e("xeH2"))}}]);