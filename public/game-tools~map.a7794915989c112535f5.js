/*! For license information please see game-tools~map.a7794915989c112535f5.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"1mfJ":function(e,t){e.exports="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 146.5 386.1'%3E%3Cpath fill='%236a7153' d='M73.5 382.8l25 .1 25 .1c19.6-73.9 24.6-165.2 15.9-239.9S108.4 10.4 73.5 3H73C38.1 10.4 15.8 68.5 7.1 143.2S3.4 309.1 23 383l25-.1 25-.1'/%3E%3C/svg%3E"},"8ZGG":function(e,t,s){s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return i}));const a=["loot","chests","items"],i=["crew","gunnery","hull","mast","sailing"]},Bx8B:function(e,t,s){s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return i}));s("UxlC");const a=(e,t)=>e&&t?e.localeCompare(t):0,i=e=>(t,s)=>{let a=0;return e.some((e=>{let i=1;return String(e).startsWith("-")&&(i=-1,e=String(e).slice(1)),a=Number.isNaN(Number(t[e]))&&Number.isNaN(Number(s[e]))?String(t[e]).localeCompare(String(s[e]))*i:(Number(t[e])-Number(s[e]))*i,0!==a})),a}},Qs7V:function(e,t,s){s.d(t,"e",(function(){return n})),s.d(t,"b",(function(){return p})),s.d(t,"k",(function(){return h})),s.d(t,"c",(function(){return c})),s.d(t,"a",(function(){return l})),s.d(t,"d",(function(){return u})),s.d(t,"l",(function(){return m})),s.d(t,"f",(function(){return b})),s.d(t,"i",(function(){return _})),s.d(t,"j",(function(){return f})),s.d(t,"h",(function(){return D})),s.d(t,"g",(function(){return v})),s.d(t,"m",(function(){return S}));s("UxlC");var a=s("sXBl"),i=s("JQHs"),r=s("2mXy");const o=i.a.bind(r.a),n=Object(a.a)({decimal:".",thousands:" ",grouping:[3],currency:[""," reales"],percent:" %",minus:"− "}),d=n.formatPrefix(",.0",1e3),p=(e,t=2)=>n.format(`,.${t}~r`)(e),h=(e,t=2)=>n.format(`+,.${t}~r`)(e).replace("+","+ "),c=(e,t=2)=>n.format(`.${t}f`)(e).replace(".00",'<span class="hidden">.00</span>').replace(/\.(\d)0/g,'.$1<span class="hidden">0</span>'),l=e=>d(-1*e).replace("k"," k"),u=e=>n.format(",d")(e),m=e=>n.format("+,d")(e).replace("+","+ "),b=(e,t=0)=>n.format(`,.${t}%`)(e).replace("%","pp"),g='<span class="caps">m</span>',_=e=>n.format(",.2s")(e).replace(".0","").replace("k"," k").replace("m"," m").replace("M"," "+g),f=e=>{const t=_(e);return t.endsWith(g)?o`${t.replace(g,"")}<span class="caps">m</span>`:o`${t}`},D=e=>n.format("$,.2s")(e).replace(".0","").replace("M",' <span class="caps">m</span>').replace("k"," k"),v=(e,t=1)=>n.format(`.${t}%`)(e).replace(".0",""),S=e=>n.format("+.1%")(e).replace(".0","").replace("+","＋ ")},Z5fe:function(e,t,s){s.d(t,"a",(function(){return d}));var a=s("AKWm"),i=s("iPFw"),r=s("ZQwz"),o=s("Q4du");function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class d{constructor(e,t){n(this,"ticksSpeed",void 0),n(this,"ticksSpeedLabels",void 0),n(this,"_shipCompare",void 0),n(this,"select",void 0),n(this,"_mainG",void 0),n(this,"_id",void 0),n(this,"_svg",void 0),this._id=e,this._shipCompare=t,this.ticksSpeed=[12,8,4,0],this.ticksSpeedLabels=this.ticksSpeed.map((e=>e+" knots")),this.select="#ship-compare-"+this._id,this._setupSvg(),this._setCompass()}static pd(e){let t=`<span class="badge badge-white">${e.maxCannonLb} / `;return e.maxCarroLb?t+=""+e.maxCarroLb:t+="–",t+=" lb</span>",t}static getCannonsPerDeck(e){let t=`${e.gunsPerDeck[0].amount} ${d.pd(e.gunsPerDeck[0])}`,s="";for(let a=1;a<4;a+=1)e.gunsPerDeck[a].amount?t=`${e.gunsPerDeck[a].amount} ${d.pd(e.gunsPerDeck[a])} <br>${t}`:s+="<br>";return[t,s]}static displaySecondBlock(){return'<div class="col-9"><div class="row">'}static getText(e){let t=0;function s(e){return t+=1,`<div class="row row-small ${t%2?"row-light":""}"><div class="col-compress col-3">${e}</div>`}function a(t,s,a=6){let i,r="";return"cannonsPerDeck"===t?([i,r]=e[t],r="<br>"+r):i=""===t?"":String(e[t]),`<div class="col-compress col-${a}">${i}<br><span class="des">${s}</span>${r}</div>`}let i="";return i+=s(e.shipRating),i+=d.displaySecondBlock(),i+=a("battleRating","Battle rating"),i+=a("guns","Cannons"),i+=a("upgradeXP","Knowledge XP"),i+=a("rollAngle","Roll angle"),i+="</div></div></div>",i+=s(e.decks),i+=d.displaySecondBlock(),i+=a("cannonsPerDeck","Gun decks"),i+=a("firezoneHorizontalWidth","Firezone horizontal width"),i+="</div></div></div>",i+=s("Broadside (lb)"),i+=d.displaySecondBlock(),i+=a("cannonBroadside","Cannons"),i+=a("carroBroadside","Carronades"),i+="</div></div></div>",i+=s("Chasers"),i+=d.displaySecondBlock(),i+=a("gunsFront","Bow"),i+=a("gunsBack","Stern"),i+="</div></div></div>",i+=s("Speed"),i+=d.displaySecondBlock(),i+=a("maxSpeed","Maximum"),i+=a("halfturnTime","Rudder half time"),i+=a("acceleration","Acceleration"),i+=a("deceleration","Deceleration"),i+=a("turnSpeed","Turn speed"),i+=a("turnAcceleration","Turn acceleration"),i+="</div></div></div>",i+=s('Hit points <span class="badge badge-white">Thickness</span>'),i+=d.displaySecondBlock(),i+=a("sideArmor","Sides"),i+=a("structure","Hull"),i+=a("frontArmor","Bow"),i+=a("backArmor","Stern"),i+="</div></div></div>",i+=s('Masts <span class="badge badge-white">Thickness</span>'),i+=d.displaySecondBlock(),i+=a("sails","Sails"),i+=a("mastBottomArmor","Bottom"),i+=a("mastMiddleArmor","Middle"),i+=a("mastTopArmor","Top"),i+="</div></div></div>",i+=s("Crew"),i+=d.displaySecondBlock(),i+=a("minCrew","Minimum",4),i+=a("sailingCrew","Sailing",4),i+=a("maxCrew","Maximum",4),i+=a("cannonCrew","Cannon",4),i+=a("carroCrew","Carronades",4),i+="</div></div></div>",i+=s("Gunnery"),i+=d.displaySecondBlock(),i+=a("reload","Reload %",4),i+=a("dispersionHorizontal","Horizontal dispersion %",4),i+=a("dispersionVertical","Vertical dispersion %",4),i+=a("penetration","Ball penetration %",4),i+=a("traverseUpDown","Up/down traverse %",4),i+=a("traverseSide","Side traverse %",4),i+="</div></div></div>",i+=s("Boarding"),i+=d.displaySecondBlock(),i+=a("morale","Morale",4),i+=a("attack","Attack",4),i+=a("defense","Defense",4),i+=a("musketsCrew","Crew with muskets",4),i+=a("musketsAccuracy","Musket accuracy %",4),i+=a("cannonsAccuracy","Cannon accuracy %",4),i+=a("prepPerRound","Preparation per round",4),i+=a("prepInitial","Initial preparation",4),i+=a("disengageTime","Rounds to disengage",4),i+="</div></div></div>",i+=s("Resistance"),i+=d.displaySecondBlock(),i+=a("leakResistance","Leak %"),i+=a("splinterResistance","Splinter %"),i+="</div></div></div>",i+=s('Repairs needed <span class="badge badge-white">Set of 5</span>'),i+=d.displaySecondBlock(),i+=a("hullRepairsNeeded","Hull",4),i+=a("rigRepairsNeeded","Rig",4),i+=a("rumRepairsNeeded","Rum",4),i+="</div></div></div>",i+=s("Repair"),i+=d.displaySecondBlock(),i+=a("hullRepairAmount","Hull %",4),i+=a("rigRepairAmount","Rig %",4),i+=a("repairTime","Time (sec)",4),i+="</div></div></div>",i+=s("Hold"),i+=d.displaySecondBlock(),i+=a("holdSize","Cargo slots"),i+=a("maxWeight","Tons"),i+="</div></div></div>",i+=s("Weight"),i+=d.displaySecondBlock(),i+=a("cannonWeight","Cannons",4),i+=a("carroWeight","Carronades",4),i+=a("repairWeight","Repair Set",4),i+="</div></div></div>",i+="</div>",i}_setupSvg(){const e=Object(a.a)(this.select);Object(a.a)(this.select+" svg").remove(),this._svg=e.append("svg").attr("width",this._shipCompare.svgWidth).attr("height",this._shipCompare.svgHeight).attr("data-ui-component","sailing-profile").attr("fill","none"),this._mainG=this._svg.append("g").attr("transform",`translate(${this._shipCompare.svgWidth/2},${this._shipCompare.svgHeight/2})`),Object(a.a)(this.select+" div").remove(),e.append("div")}_setCompass(){var e;const t=new Array(o.n/2);t.fill(1,0);const s=Object(i.a)().sort(null).value(1)(t),a=Object(r.a)().outerRadius(null!==(e=this._shipCompare.radiusSpeedScale(12))&&void 0!==e?e:0).innerRadius(this._shipCompare.innerRadius);this._mainG.append("g").attr("class","compass-arc").selectAll("path").data(s).join((e=>e.append("path").attr("d",a))),this._mainG.append("g").attr("class","speed-circle").selectAll("circle").data(this.ticksSpeed).join((e=>e.append("circle").attr("r",(e=>{var t;return null!==(t=this._shipCompare.radiusSpeedScale(e))&&void 0!==t?t:0}))))}}},awzk:function(e,t,s){(function(e){s.d(t,"a",(function(){return S}));var a=s("AJ/N"),i=s("VIqg"),r=s("ZQwz"),o=s("iPFw"),n=s("VkQ2"),d=s("TI0E"),p=s("pxNS"),h=s("Q4du"),c=s("Qs7V"),l=s("otg8"),u=s("dNoP"),m=s("Z5fe"),b=s("oggF"),g=s("1mfJ"),_=s.n(g);function f(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return D(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}function v(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class S extends m.a{constructor(e,t,s){super(e,s),v(this,"shipData",void 0),v(this,"_speedScale",void 0),v(this,"_shipRotate",void 0),v(this,"_speedText",void 0),v(this,"_drag",void 0),this.shipData=t,this._setBackground(),this._setupDrag(),this._drawWindProfile(),this._setupShipOutline(),this._printText()}_setBackground(){const e=Object(r.a)().outerRadius((e=>{var t;return(null!==(t=this._shipCompare.radiusSpeedScale(e))&&void 0!==t?t:0)+2})).innerRadius((e=>{var t;return(null!==(t=this._shipCompare.radiusSpeedScale(e))&&void 0!==t?t:0)+1})).startAngle(-Math.PI/2).endAngle(Math.PI/2);this._mainG.append("g").attr("data-ui-component","speed-textpath").selectAll("path").data(this.ticksSpeed).join((t=>t.append("path").attr("d",e).attr("id",((e,t)=>"tick"+t)))),this._mainG.append("g").attr("class","speed-text").selectAll("text").data(this.ticksSpeed).join((e=>e.append("text").append("textPath").attr("href",((e,t)=>"#tick"+t)).text(((e,t)=>this.ticksSpeedLabels[t])).attr("startOffset","10%")))}_getHeadingInDegrees(e,t){let s=e-t-180;return s<0&&(s+=360),s}_getSpeed(e){var t;return Object(c.b)(null!==(t=this._speedScale(Math.abs(e)))&&void 0!==t?t:0)}_getHeadingInCompass(e){return Object(l.m)(e)}_updateCompareWindProfiles(){for(const e of this._shipCompare.columnsCompare)Object(p.e)(this._shipCompare.selectedShips[e])||this._shipCompare.selectedShips[e].updateWindProfileRotation()}_setupDrag(){const e=this.shipData.speedDegrees.length,t=360/e,s=f(new Array(e+1)).map(((e,s)=>s*t));this._speedScale=Object(i.a)().domain(s).range([].concat(f(this.shipData.speedDegrees),[this.shipData.speedDegrees[0]])).clamp(!0);const r=(e,t)=>{const{x:s,y:a}=e;t.rotate=this._getHeadingInDegrees(Object(u.m)({x:t.initX,y:t.initY},{x:s,y:a}),t.correctionValueDegrees),(()=>{t.this.attr("transform",(e=>`rotate(${e.rotate})`)),t.compassText.attr("transform",(e=>`rotate(${-e.rotate},${e.compassTextX},${e.compassTextY})`)).text((e=>this._getHeadingInCompass(e.rotate))),"ship"===t.type?this._shipRotate=t.rotate:"windProfile"===t.type&&(this._shipCompare.windProfileRotate=t.rotate),this._speedText.attr("transform",`rotate(${-this._shipRotate})`).text(this._getSpeed(this._shipCompare.windProfileRotate-this._shipRotate))})(),"windProfile"===t.type&&this._updateCompareWindProfiles()};this._drag=Object(a.a)().on("drag",((e,t)=>r(e,t))).container((()=>this._mainG.node()))}_setupShipOutline(){var e;this._shipRotate=0;const{shipMass:t}=this.shipData,s=null!==(e=this._shipCompare.shipMassScale(t))&&void 0!==e?e:0,a=s,i=this._shipCompare.svgHeight/2-40,r={initX:0,initY:0,initRotate:this._shipRotate,correctionValueDegrees:180,compassTextX:0,compassTextY:i,speedTextX:0,speedTextY:0,type:"ship"},o=this._mainG.append("g").datum(r).attr("class","ship-outline");o.append("line").attr("x1",(e=>e.initX)).attr("y1",i-20).attr("x2",(e=>e.initX)).attr("y2",(e=>e.initY)),o.append("image").attr("height",s).attr("width",a).attr("x",-s/2).attr("y",-a/2).attr("xlink:href",_.a),o.append("circle").attr("cx",(e=>e.compassTextX)).attr("cy",(e=>e.compassTextY)).attr("r",20).call(this._drag);const n=o.append("text").attr("x",(e=>e.compassTextX)).attr("y",(e=>e.compassTextY)).attr("transform",(e=>`rotate(${-e.initRotate},${e.compassTextX},${e.compassTextY})`)).text((e=>this._getHeadingInCompass(e.initRotate)));this._speedText=o.append("text").attr("x",(e=>e.speedTextX)).attr("y",(e=>e.speedTextY)).attr("transform",(e=>`rotate(${-e.initRotate})`)).text((e=>this._getSpeed(e.initRotate))),r.this=o,r.compassText=n,o.datum(r).attr("transform",(e=>`rotate(${e.initRotate-90})`)),o.transition().duration(1e3).delay(500).attr("transform",(e=>`rotate(${e.initRotate})`))}_drawWindProfile(){const e=Object(o.a)().sort(null).value(1)(this.shipData.speedDegrees),t=n.a,s=Object(d.a)().angle(((e,t)=>t*h.q)).radius((e=>{var t;return null!==(t=this._shipCompare.radiusSpeedScale(e.data))&&void 0!==t?t:0})).curve(t);this._shipCompare.windProfileRotate=0;const a=this._shipCompare.svgHeight/2-20,i={initX:0,initY:0,initRotate:this._shipCompare.windProfileRotate,correctionValueDegrees:0,compassTextX:0,compassTextY:-a,type:"windProfile"},r=this._mainG.append("g").datum(i).attr("class","wind-profile");r.append("path").attr("d",(e=>String(Object(u.g)(e.compassTextX,e.compassTextY,20))+Object(u.h)(e.compassTextX,e.compassTextY,-e.compassTextY/2))).attr("class","wind-profile-arrow").attr("marker-end","url(#wind-profile-arrow-head)").call(this._drag),r.append("circle").attr("cx",(e=>e.compassTextX)).attr("cy",(e=>e.compassTextY)).attr("r",20);const p=r.append("text").attr("x",(e=>e.compassTextX)).attr("y",(e=>e.compassTextY)).attr("transform",(e=>`rotate(${-e.initRotate},${e.compassTextX},${e.compassTextY})`)).text((e=>this._getHeadingInCompass(e.initRotate)));r.append("path").attr("class","base-profile").attr("d",s(e)),r.append("g").attr("data-ui-component","speed-markers").selectAll("circle").data(e).join((e=>e.append("circle").attr("r",5).attr("cy",((e,t)=>{var s;return Math.cos(t*h.q)*-(null!==(s=this._shipCompare.radiusSpeedScale(e.data))&&void 0!==s?s:0)})).attr("cx",((e,t)=>{var s;return Math.sin(t*h.q)*(null!==(s=this._shipCompare.radiusSpeedScale(e.data))&&void 0!==s?s:0)})).attr("fill",(e=>{var t;return null!==(t=this._shipCompare.colorScale(e.data))&&void 0!==t?t:0})).attr("fill",(e=>{var t;return null!==(t=this._shipCompare.colorScale(e.data))&&void 0!==t?t:0})).append("title").text((e=>Math.round(10*e.data)/10+" knots")))),i.this=r,i.compassText=p,r.datum(i).attr("transform",(e=>`rotate(${e.initRotate+90})`)),r.transition().duration(1e3).delay(500).attr("transform",(e=>`rotate(${e.initRotate})`))}_printText(){var t;const s=m.a.getCannonsPerDeck(this.shipData.guns),a=Math.round(this.shipData.sides.armour*this.shipData.repairAmount.armour/b.h),i=Math.round(this.shipData.sails.armour*this.shipData.repairAmount.sails/b.m),r=Math.round(this.shipData.crew.max*b.n),o={attack:Object(c.k)(this.shipData.boarding.attack,2),cannonsAccuracy:Object(c.l)(100*this.shipData.boarding.cannonsAccuracy),defense:Object(c.k)(this.shipData.boarding.defense,2),disengageTime:Object(c.d)(this.shipData.boarding.disengageTime),morale:Object(c.d)(this.shipData.boarding.morale),musketsAccuracy:Object(c.l)(100*this.shipData.boarding.musketsAccuracy),musketsCrew:Object(c.d)(this.shipData.boarding.musketsCrew/100*this.shipData.crew.max),prepPerRound:Object(c.d)(this.shipData.boarding.prepPerRound),prepInitial:Object(c.d)(this.shipData.boarding.prepInitial),reload:Object(c.l)(100*this.shipData.gunnery.reload),penetration:Object(c.l)(100*this.shipData.gunnery.penetration),dispersionHorizontal:Object(c.l)(100*this.shipData.gunnery.dispersionHorizontal),dispersionVertical:Object(c.l)(100*this.shipData.gunnery.dispersionVertical),traverseUpDown:Object(c.l)(100*this.shipData.gunnery.traverseUpDown),traverseSide:Object(c.l)(100*this.shipData.gunnery.traverseSide),acceleration:Object(c.b)(this.shipData.ship.acceleration),additionalRow:""+(this.shipData.guns.decks<4?"<br> ":""),backArmor:`${Object(c.d)(this.shipData.stern.armour)}</br><span class="badge badge-white">${Object(c.d)(this.shipData.stern.thickness)}</span>`,battleRating:String(this.shipData.battleRating),bowRepair:""+Object(c.d)(this.shipData.repairTime.bow),cannonBroadside:Object(c.d)(this.shipData.guns.broadside.cannons),cannonsPerDeck:s,carroBroadside:Object(c.d)(this.shipData.guns.broadside.carronades),deceleration:Object(c.b)(this.shipData.ship.deceleration),decks:Object(h.o)(this.shipData.guns.decks,"deck"),firezoneHorizontalWidth:String(this.shipData.ship.firezoneHorizontalWidth),frontArmor:`${Object(c.d)(this.shipData.bow.armour)}</br><span class="badge badge-white">${Object(c.d)(this.shipData.bow.thickness)}</span>`,guns:String(this.shipData.guns.total),gunsBack:this.shipData.guns.gunsPerDeck[5].amount,gunsFront:this.shipData.guns.gunsPerDeck[4].amount,halfturnTime:Object(c.b)(this.shipData.rudder.halfturnTime,4),holdSize:Object(c.d)(this.shipData.holdSize),hullRepairAmount:""+Object(c.d)(100*(this.shipData.repairAmount.armour+this.shipData.repairAmount.armourPerk)),hullRepairsNeeded:`${Object(c.d)(a)} <span class="badge badge-white">${Object(c.d)(a*b.k)}</span>`,leakResistance:Object(c.l)(100*this.shipData.resistance.leaks),limitBack:this.shipData.guns.gunsPerDeck[5],limitFront:this.shipData.guns.gunsPerDeck[4],mastBottomArmor:`${Object(c.d)(this.shipData.mast.bottomArmour)}</br><span class="badge badge-white">${Object(c.d)(this.shipData.mast.bottomThickness)}</span>`,mastMiddleArmor:`${Object(c.d)(this.shipData.mast.middleArmour)}</br><span class="badge badge-white">${Object(c.d)(this.shipData.mast.middleThickness)}</span>`,mastTopArmor:`${Object(c.d)(this.shipData.mast.topArmour)}</br><span class="badge badge-white">${Object(c.d)(this.shipData.mast.topThickness)}</span>`,maxCrew:Object(c.d)(this.shipData.crew.max),maxSpeed:Object(c.b)(this.shipData.speed.max,3),maxWeight:Object(c.d)(this.shipData.maxWeight),minCrew:Object(c.d)(this.shipData.crew.min),cannonCrew:Object(c.d)(this.shipData.crew.cannons),carroCrew:Object(c.d)(this.shipData.crew.carronades),pump:Object(c.d)(this.shipData.pump.armour),repairTime:""+Object(c.d)(this.shipData.repairTime.sides),rigRepairAmount:""+Object(c.d)(100*(this.shipData.repairAmount.sails+this.shipData.repairAmount.sailsPerk)),rigRepairsNeeded:`${Object(c.d)(i)} <span class="badge badge-white">${Object(c.d)(i*b.k)}</span>`,rollAngle:Object(c.d)(this.shipData.ship.rollAngle),rudder:`${Object(c.d)(this.shipData.rudder.armour)} <span class="badge badge-white">${Object(c.d)(this.shipData.rudder.thickness)}</span>`,rumRepairsNeeded:`${Object(c.d)(r)} <span class="badge badge-white">${Object(c.d)(r*b.k)}</span>`,sailingCrew:Object(c.d)(null!==(t=this.shipData.crew.sailing)&&void 0!==t?t:0),sails:Object(c.d)(this.shipData.sails.armour),shipRating:Object(l.q)(this.shipData.class)+" rate",sideArmor:`${Object(c.d)(this.shipData.sides.armour)}</br><span class="badge badge-white">${Object(c.d)(this.shipData.sides.thickness)}</span>`,splinterResistance:Object(c.l)(100*this.shipData.resistance.splinter),sternRepair:""+Object(c.d)(this.shipData.repairTime.stern),structure:Object(c.d)(this.shipData.structure.armour),turnAcceleration:Object(c.b)(this.shipData.ship.turnAcceleration,4),turnSpeed:Object(c.b)(this.shipData.ship.turnSpeed,3),upgradeXP:Object(c.d)(this.shipData.upgradeXP),waterlineHeight:Object(c.b)(this.shipData.ship.waterlineHeight),cannonWeight:Object(c.d)(this.shipData.guns.weight.cannons),carroWeight:Object(c.d)(this.shipData.guns.weight.carronades)};o.repairWeight=Object(c.d)((a+i+.1*r)*b.k),o.gunsFront?o.gunsFront+=" "+m.a.pd(o.limitFront):o.gunsFront="–",o.gunsBack?o.gunsBack+=" "+m.a.pd(o.limitBack):o.gunsBack="–",e(""+this.select).find("div").append(m.a.getText(o))}}}).call(this,s("xeH2"))},ck04:function(e,t,s){(function(e){s.d(t,"a",(function(){return _}));s("WUlJ"),s("fCtr"),s("dbdZ");var a=s("mrVq"),i=s("gj+k"),r=s("AKWm"),o=s("pOjD"),n=s("Q4du"),d=s("Qs7V"),p=s("pxNS"),h=s("Bx8B");function c(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class m{constructor(e,t){u(this,"select",void 0),u(this,"_woodCompare",void 0),u(this,"_id",void 0),u(this,"_g",void 0),this._id=e,this._woodCompare=t,this.select=`#${this._woodCompare.baseFunction}-${this._id}`,this._setupMainDiv(),this._g=Object(r.a)(this.select).select("g")}_setupMainDiv(){Object(r.a)(this.select+" div").remove(),Object(r.a)(this.select).append("div")}}class b extends m{constructor(e,t,s){super(e,s),u(this,"_woodData",void 0),this._woodData=t,this._printText()}_getProperty(e,t){const s=this._woodData[t].properties.find((t=>t.modifier===e));let a=0,i=!1;return(null==s?void 0:s.amount)&&({amount:a,isPercentage:i}=s),{amount:a,isPercentage:i}}_getPropertySum(e){const t=this._getProperty(e,"frame"),s=this._getProperty(e,"trim");return{amount:t.amount+s.amount,isPercentage:s.isPercentage}}_getText(e){let t='<table class="table table-sm table-striped small mt-4"><thead>';t+="<tr>",t+='<tr><th scope="col">Property</th><th scope="col">Change</th></tr></thead><tbody>';for(const[o,n]of e.properties){if(t+=`<tr><td>${o}</td><td>${n.isPercentage?Object(d.g)(n.amount/100):Object(d.b)(n.amount)}`,t+='<span class="rate">',n.amount>0){var s,a;t+='<span class="bar neutral" style="width:50%;"></span>',t+=`<span class="bar pos diff" style="width:${n.amount/(null!==(s=null===(a=this._woodCompare.minMaxProperty.get(o))||void 0===a?void 0:a.max)&&void 0!==s?s:1)*50}%;"></span>`}else if(n.amount<0){var i,r;const e=n.amount/(null!==(i=null===(r=this._woodCompare.minMaxProperty.get(o))||void 0===r?void 0:r.min)&&void 0!==i?i:1)*50;t+=`<span class="bar neutral" style="width:${50-e}%;"></span>`,t+=`<span class="bar neg diff" style="width:${e}%;"></span>`}else t+='<span class="bar neutral"></span>';t+="</span></td></tr>"}return t+="</tbody></table>",t}_printText(){const t={frame:this._woodData.frame.name,trim:this._woodData.trim.name,properties:new Map};for(const e of this._woodCompare.propertyNames){const s=this._getPropertySum(e);t.properties.set(e,{amount:s.amount,isPercentage:s.isPercentage})}e(""+this.select).find("div").append(this._getText(t))}}class g extends m{constructor(e,t,s,a){super(e,a),u(this,"_baseData",void 0),u(this,"_compareData",void 0),this._baseData=t,this._compareData=s,this._printTextComparison()}static _getDiff(e,t,s,a=1){const i=Number.parseFloat((e-t).toFixed(a));return`${s?Object(d.g)(e/100,a):Object(d.b)(e)} <span class="badge badge-white">${Object(d.k)(i)}</span>`}_getBaseProperty(e,t){const s=this._baseData[t].properties.find((t=>t.modifier===e));let a=0,i=!1;return(null==s?void 0:s.amount)&&({amount:a,isPercentage:i}=s),{amount:a,isPercentage:i}}_getBasePropertySum(e){const t=this._getBaseProperty(e,"frame"),s=this._getBaseProperty(e,"trim");return{amount:t.amount+s.amount,isPercentage:s.isPercentage}}_getCompareProperty(e,t){const s=this._compareData[t].properties.find((t=>t.modifier===e));let a=0,i=!1;return(null==s?void 0:s.amount)&&(a=s.amount,i=s.isPercentage),{amount:a,isPercentage:i}}_getComparePropertySum(e){const t=this._getCompareProperty(e,"frame"),s=this._getCompareProperty(e,"trim");return{amount:t.amount+s.amount,isPercentage:t.isPercentage&&s.isPercentage}}_getText(e){const t=50;let s=0,a=0,i=0,r="",o='<table class="table table-sm table-striped small wood mt-4"><thead>';o+='<tr><th scope="col">Property</th><th scope="col">Change</th></tr></thead><tbody>';for(const[f,D]of e.properties){var n,d,p,h;if(o+=`<tr><td>${f}</td><td>${g._getDiff(D.compare,D.base,D.isPercentage)}`,o+='<span class="rate">',D.compare>=0)D.base>=0?D.compare>D.base?(s=D.base,a=D.compare-D.base,r="pos"):(s=D.compare,a=D.base-D.compare,r="neg"):(s=0,a=D.compare,r="pos"),o+='<span class="bar neutral" style="width:50%;"></span>',o+=`<span class="bar pos diff" style="width:${s/(null!==(n=null===(d=this._woodCompare.minMaxProperty.get(f))||void 0===d?void 0:d.max)&&void 0!==n?n:1)*t}%;"></span>`,o+=`<span class="bar ${r}" style="width:${a/(null!==(p=null===(h=this._woodCompare.minMaxProperty.get(f))||void 0===h?void 0:h.max)&&void 0!==p?p:1)*t}%;"></span>`;else if(D.compare<0){var c,l,u,m,b,_;D.base<0?D.compare>=D.base?(s=D.compare,a=D.base-D.compare,i=-D.base,r="pos"):(s=D.base,a=D.compare-D.base,i=-D.compare,r="neg"):(s=0,a=D.compare,i=-D.compare,r="neg"),o+=`<span class="bar neutral" style="width:${t+i/(null!==(c=null===(l=this._woodCompare.minMaxProperty.get(f))||void 0===l?void 0:l.min)&&void 0!==c?c:1)*t}%;"></span>`,o+=`<span class="bar ${r}" style="width:${a/(null!==(u=null===(m=this._woodCompare.minMaxProperty.get(f))||void 0===m?void 0:m.min)&&void 0!==u?u:1)*t}%;"></span>`,o+=`<span class="bar neg diff" style="width:${s/(null!==(b=null===(_=this._woodCompare.minMaxProperty.get(f))||void 0===_?void 0:_.min)&&void 0!==b?b:1)*t}%;"></span>`}else o+='<span class="bar neutral"></span>';o+="</span></td></tr>"}return o+="</tbody></table>",o}_printTextComparison(){const t={frame:this._compareData.frame.name,trim:this._compareData.trim.name,properties:new Map};for(const e of this._woodCompare.propertyNames){const s=this._getBasePropertySum(e),a=this._getComparePropertySum(e);t.properties.set(e,{base:s.amount,compare:a.amount,isPercentage:s.isPercentage})}e(""+this.select).find("div").append(this._getText(t))}}class _{constructor(e){u(this,"baseFunction",void 0),u(this,"instances",{}),u(this,"minMaxProperty",new Map),u(this,"propertyNames",void 0),u(this,"_baseName",void 0),u(this,"_baseId",void 0),u(this,"_buttonId",void 0),u(this,"_modalId",void 0),u(this,"_woodData",void 0),u(this,"_columnsCompare",void 0),u(this,"_defaultWoodId",{}),u(this,"_columns",void 0),u(this,"_frameSelectData",void 0),u(this,"_trimSelectData",void 0),u(this,"_options",{}),u(this,"_woodIdsSelected",{}),this.baseFunction=e,this._baseName="Compare woods",this._baseId=this.baseFunction+"-compare",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,"wood"===this.baseFunction&&this._setupListener()}async woodInit(){await this._loadAndSetupData(),this._initData()}getWoodName(e,t){var s,a;return null!==(s=null===(a=this._woodData[e].find((e=>e.id===t)))||void 0===a?void 0:a.name)&&void 0!==s?s:""}_findWoodId(e,t){var s,a;return null!==(s=null===(a=this._woodData[e].find((e=>e.name===t)))||void 0===a?void 0:a.id)&&void 0!==s?s:0}_setupData(){this.propertyNames=new Set([].concat(c(this._woodData.frame.flatMap((e=>e.properties.map((e=>e.modifier))))),c(this._woodData.trim.flatMap((e=>e.properties.map((e=>e.modifier)))))).sort(h.a)),"wood"===this.baseFunction?(this._defaultWoodId={frame:this._findWoodId("frame","Fir"),trim:this._findWoodId("trim","Crew Space")},this._columnsCompare=["C1","C2","C3"]):"wood-journey"===this.baseFunction?(this._defaultWoodId={frame:this._findWoodId("frame","Oak"),trim:this._findWoodId("trim","Oak")},this._columnsCompare=[]):(this._defaultWoodId={frame:this._findWoodId("frame","Oak"),trim:this._findWoodId("trim","Oak")},this._columnsCompare=["C1","C2"]),this._columns=this._columnsCompare.slice(),this._columns.unshift("Base")}async _loadAndSetupData(){try{this._woodData=(await s.e(14).then(s.t.bind(null,"xOpV",3))).default,this._setupData()}catch(e){Object(p.g)(e)}}_setupListener(){var e;let t=!0;null===(e=document.querySelector("#"+this._buttonId))||void 0===e||e.addEventListener("click",(async()=>{t&&(t=!1,await this._loadAndSetupData()),Object(o.b)("Tools",this._baseName),this._woodCompareSelected()}))}_woodCompareSelected(){document.querySelector("#"+this._modalId)||this._initModal(),e("#"+this._modalId).modal("show")}_initData(){this._frameSelectData=this._woodData.frame.sort(Object(h.b)(["name"])),this._trimSelectData=this._woodData.trim.sort(Object(h.b)(["name"])),this._setOption(this._frameSelectData.map((e=>`<option value="${e.id}">${e.name}</option>`)).toString(),this._trimSelectData.map((e=>`<option value="${e.id}">${e.name}</option>`)).toString());for(const o of this.propertyNames){var e,t,s,r;const n=c(this._woodData.frame.map((e=>{var t,s;return null!==(t=null===(s=e.properties.find((e=>e.modifier===o)))||void 0===s?void 0:s.amount)&&void 0!==t?t:0}))),d=c(this._woodData.trim.map((e=>{var t,s;return null!==(t=null===(s=e.properties.find((e=>e.modifier===o)))||void 0===s?void 0:s.amount)&&void 0!==t?t:0}))),p=null!==(e=Object(a.a)(n))&&void 0!==e?e:0,h=null!==(t=Object(i.a)(n))&&void 0!==t?t:0,l=null!==(s=Object(a.a)(d))&&void 0!==s?s:0,u=null!==(r=Object(i.a)(d))&&void 0!==r?r:0;this._addMinMaxProperty(o,{min:p+l>=0?0:p+l,max:h+u})}}_injectModal(){Object(n.m)({id:this._modalId,title:this._baseName});const e=Object(r.a)(`#${this._modalId} .modal-body`).append("div").attr("class","container-fluid").append("div").attr("class","row wood");for(const t of this._columns){const s=e.append("div").attr("class","col-md-3 ml-auto pt-2 "+("Base"===t?"column-base":"column-comp"));for(const e of p.j){const a=`${this.baseFunction}-${e}-${t}-select`;s.append("label").attr("for",a),s.append("select").attr("name",a).attr("id",a).attr("class","selectpicker")}s.append("div").attr("id",`${this.baseFunction}-${t}`)}}_initModal(){this._initData(),this._injectModal();for(const t of this._columns)for(const s of p.j){const a=e(`#${this.baseFunction}-${s}-${t}-select`);this._setupWoodSelects(t,s,a),this._setupSelectListener(t,s,a)}}_setWoodsSelected(e,t,s){this._woodIdsSelected[e]||(this._woodIdsSelected[e]={}),this._woodIdsSelected[e][t]=s}_setupWoodSelects(e,t,s){this._setWoodsSelected(e,t,this._defaultWoodId[t]),s.append(this._options[t]),("wood"!==this.baseFunction||"Base"!==e&&"wood"===this.baseFunction)&&s.attr("disabled","disabled")}_setOtherSelect(t,s){const a="frame"===s?"trim":"frame";this._woodIdsSelected[t][a]===this._defaultWoodId[a]&&e(`#${this.baseFunction}-${a}-${t}-select`).val(this._defaultWoodId[a]).selectpicker("refresh")}enableSelects(t){for(const s of p.j)e(`#${this.baseFunction}-${s}-${t}-select`).removeAttr("disabled").selectpicker("refresh")}_woodSelected(e,t,s){const a=Number(s.val());if(this._setWoodsSelected(e,t,a),this._setOtherSelect(e,t),"Base"===e){this._addInstance(e,new b("Base",this._getWoodData("Base"),this));for(const e of this._columnsCompare)"wood"===this.baseFunction&&this.enableSelects(e),this.instances[e]&&this._addInstance(e,new g(e,this._getWoodData("Base"),this._getWoodData(e),this))}else this._addInstance(e,new g(e,this._getWoodData("Base"),this._getWoodData(e),this))}_setupSelectListener(e,t,s){s.on("change",(()=>this._woodSelected(e,t,s))).selectpicker({title:"Select "+t})}_getWoodData(e){return{frame:this.getWoodTypeData("frame",this._woodIdsSelected[e].frame),trim:this.getWoodTypeData("trim",this._woodIdsSelected[e].trim)}}_addMinMaxProperty(e,t){this.minMaxProperty.set(e,t)}_setOption(e,t){this._options.frame=e,this._options.trim=t}_addInstance(e,t){this.instances[e]=t}getWoodTypeData(e,t){var s;return null!==(s=this._woodData[e].find((e=>e.id===t)))&&void 0!==s?s:{}}}}).call(this,s("xeH2"))},dNoP:function(e,t,s){(function(e){s.d(t,"e",(function(){return d})),s.d(t,"f",(function(){return p})),s.d(t,"j",(function(){return h})),s.d(t,"m",(function(){return c})),s.d(t,"a",(function(){return l})),s.d(t,"k",(function(){return u})),s.d(t,"l",(function(){return m})),s.d(t,"d",(function(){return b})),s.d(t,"c",(function(){return g})),s.d(t,"b",(function(){return _})),s.d(t,"g",(function(){return f})),s.d(t,"i",(function(){return D})),s.d(t,"h",(function(){return v}));var a=s("sCaM"),i=s("Q4du"),r=s("otg8");function o(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}const d=(e,t=!1)=>{let s;return s=Number.isNaN(Number(e))?e:Object(r.m)(Number(e)),`<${t?"tspan":"span"} class="caps">${s}</${t?"tspan":"span"}>`},p=(e,t=!1)=>{let s,a;return Number.isNaN(Number(e))?(s=e,a=Object(r.c)(s)%r.j):(a=Number(e),s=Object(r.m)(a)),`<${t?"tspan":"span"} class="caps">${s}</${t?"tspan":"span"}> (${a}°)`},h=t=>{const s=Object(r.m)(e("#"+t).roundSlider("getValue"));let a;return a=Number.isNaN(Number(s))?Object(r.c)(s):Number(s),a},c=(e,t)=>{let s=Math.atan2(t.y-e.y,t.x-e.x);s-=Math.PI/2;let a=Object(r.t)(s);return a<0&&(a+=r.j),a},l=(e,t,s=!0)=>{if(t<2)return[e];const a=e.length,i=[];let r,o=0;if(a%t==0)for(r=Math.floor(a/t);o<a;)i.push(e.slice(o,o+=r));else if(s)for(;o<a;)r=Math.ceil((a-o)/t--),i.push(e.slice(o,o+=r));else{for(t-=1,r=Math.floor(a/t),a%r==0&&(r-=1);o<r*t;)i.push(e.slice(o,o+=r));i.push(e.slice(r*t))}return i},u=({element:e,radius:t})=>{const s=i.n,n=r.j/s,d=Math.round(.8*t),p=o(new Array(s)).map(((e,t)=>Object(r.m)(t*n))),h=Object(a.a)().range([0-n/2,r.j-n/2]).domain(p).align(0);e.append("circle").attr("r",d).style("stroke-width","3px");const c=e.append("text"),l=e.selectAll("g").data(p).join((e=>e.append("g").attr("transform",(e=>{var t;return`rotate(${Math.round((null!==(t=h(e))&&void 0!==t?t:0)+h.bandwidth()/2-r.l)})translate(${d},0)`}))));l.filter(((e,t)=>t%3!=0)).append("line").attr("x2",9),l.filter(((e,t)=>t%3==0)).append("text").attr("transform",(e=>{var t,s,a,i,r;let o,n=Math.round((null!==(t=h(e))&&void 0!==t?t:0)+h.bandwidth()/2);c.text(e);const d=null!==(s=null===(a=c.node())||void 0===a?void 0:a.getBBox().height)&&void 0!==s?s:0,p=null!==(i=null===(r=c.node())||void 0===r?void 0:r.getBBox().width)&&void 0!==i?i:0;return n>=0&&n<=45||315===n?(n=90,o="0,-"+d/2):90===n?(n=0,o=p/2+3+",0"):270===n?(n=180,o=`-${p/2+3},0`):(n=-90,o="0,"+(d/2+3+2)),`rotate(${n})translate(${o})`})).text((e=>e)),c.remove()},m=({element:e,radius:t})=>{const s=i.n,n=r.j/s,d=Math.round(.8*t),p=o(new Array(s)).map(((e,t)=>Object(r.m)(t*n))),h=Object(a.a)().range([0-n/2,r.j-n/2]).domain(p).align(0);e.append("circle").attr("r",d).style("stroke-width","1.5px");e.selectAll("line").data(p).join((e=>e.append("line").attr("x2",((e,t)=>t%3==0?t%6==0?6:4:2)).attr("transform",(e=>{var t;return`rotate(${Math.round((null!==(t=h(e))&&void 0!==t?t:0)+h.bandwidth()/2)})translate(${d},0)`}))))},b=e=>`<span class="caps">${e}</span>`,g=(e,t)=>{navigator.clipboard||((e,t)=>{var s,a;if(!(null===(s=(a=document).queryCommandSupported)||void 0===s?void 0:s.call(a,"copy")))return console.error(`Insufficient rights to copy ${e} to clipboard`),!1;{const s=document.createElement("input");s.type="text",s.value=e,s.style.position="absolute",s.style.left="-1000px",s.style.top="-1000px",t.append(s),s.select();try{document.execCommand("copy")}catch(e){return console.error("Copy to clipboard failed.",e),!1}finally{s.remove()}}})(e,t),(async e=>{navigator.clipboard.writeText(e).then((()=>!0)).catch((t=>(console.error(`Cannot copy ${e} to clipboard`,t),!1)))})(e)},_=(e,t,s)=>{if(Number.isFinite(e)&&Number.isFinite(t)){const a=new URL(window.location.href);a.searchParams.set("x",String(e)),a.searchParams.set("z",String(t)),g(a.href,s)}},f=(e,t,s)=>`M${e-s},${t}a${s},${s} 0 10${2*s},0a${s},${s} 0 10${2*-s},0`,D=(e,t,s)=>`M${e-s/2},${t-s/2}h${s}v${s}h${-s}z`,v=(e,t,s)=>`M${e},${t}v${s}`}).call(this,s("xeH2"))},iftE:function(e,t,s){(function(e){s.d(t,"a",(function(){return S}));var a=s("mrVq"),i=s("gj+k"),r=s("AJ/N"),o=s("VIqg"),n=s("iPFw"),d=s("VkQ2"),p=s("TI0E"),h=s("Qs7V"),c=s("otg8"),l=s("dNoP"),u=s("1mfJ"),m=s.n(u),b=s("Z5fe"),g=s("Q4du"),_=s("oggF");function f(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return D(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}function v(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class S extends b.a{constructor(e,t,s,a){super(e,a),v(this,"shipCompareData",void 0),v(this,"_shipBaseData",void 0),v(this,"_speedScale",void 0),v(this,"_speedDiff",void 0),v(this,"_minSpeedDiff",void 0),v(this,"_maxSpeedDiff",void 0),v(this,"_shipRotate",void 0),v(this,"_speedText",void 0),v(this,"_drag",void 0),v(this,"_windProfile",void 0),v(this,"_gWindProfile",void 0),v(this,"_arcsComp",void 0),this._shipBaseData=t,this.shipCompareData=s,this._setupDrag(),this._drawDifferenceProfile(),this._setupShipOutline(),this._injectTextComparison()}_setColourScale(e,t){const s=Math.min(e,this._shipCompare.colourScaleSpeedDiff.domain()[0]),a=Math.max(t,this._shipCompare.colourScaleSpeedDiff.domain()[this._shipCompare.colourScaleSpeedDiff.domain().length-1]);this._shipCompare.colourScaleSpeedDiff.domain([s,0,a])}_getHeadingInDegrees(e,t){let s=e-t-180;return s<0&&(s+=360),s}_getSpeed(e){var t;return Object(h.b)(null!==(t=this._speedScale(Math.abs(e)))&&void 0!==t?t:0)}_getHeadingInCompass(e){return Object(c.m)(e)}_updateSpeedText(){this._speedText.attr("transform",`rotate(${-this._shipRotate})`).text(this._getSpeed(this._shipCompare.windProfileRotate-this._shipRotate))}_setupDrag(){const e=this.shipCompareData.speedDegrees.length,t=360/e,s=f(new Array(e+1)).map(((e,s)=>s*t));this._speedScale=Object(o.a)().domain(s).range([].concat(f(this.shipCompareData.speedDegrees),[this.shipCompareData.speedDegrees[0]])).clamp(!0);const a=(e,t)=>{const{x:s,y:a}=e;t.rotate=this._getHeadingInDegrees(Object(l.m)({x:t.initX,y:t.initY},{x:s,y:a}),t.correctionValueDegrees),(()=>{t.this.attr("transform",(e=>`rotate(${e.rotate})`)),t.compassText.attr("transform",(e=>`rotate(${-e.rotate},${e.compassTextX},${e.compassTextY})`)).text((e=>this._getHeadingInCompass(e.rotate))),this._shipRotate=t.rotate,this._updateSpeedText()})()};this._drag=Object(r.a)().on("drag",((e,t)=>a(e,t))).container((()=>this._mainG.node()))}_setupShipOutline(){var e;this._shipRotate=0;const{shipMass:t}=this.shipCompareData,s=null!==(e=this._shipCompare.shipMassScale(t))&&void 0!==e?e:0,a=s,i=this._shipCompare.svgHeight/2-40,r={initX:0,initY:0,initRotate:this._shipRotate,correctionValueDegrees:180,compassTextX:0,compassTextY:i,speedTextX:0,speedTextY:0,type:"ship"},o=this._mainG.append("g").datum(r).attr("class","ship-outline");o.append("line").attr("x1",(e=>e.initX)).attr("y1",i-20).attr("x2",(e=>e.initX)).attr("y2",(e=>e.initY)),o.append("image").attr("height",s).attr("width",a).attr("x",-s/2).attr("y",-a/2).attr("xlink:href",m.a),o.append("circle").attr("cx",(e=>e.compassTextX)).attr("cy",(e=>e.compassTextY)).attr("r",20).call(this._drag);const n=o.append("text").attr("x",(e=>e.compassTextX)).attr("y",(e=>e.compassTextY)).attr("transform",(e=>`rotate(${-e.initRotate},${e.compassTextX},${e.compassTextY})`)).text((e=>this._getHeadingInCompass(e.initRotate)));this._speedText=o.append("text").attr("x",(e=>e.speedTextX)).attr("y",(e=>e.speedTextY)).attr("transform",(e=>`rotate(${-e.initRotate})`)).text((e=>this._getSpeed(this._shipCompare.windProfileRotate-e.initRotate))),r.this=o,r.compassText=n,o.datum(r).attr("transform",(e=>`rotate(${e.initRotate-90})`)),o.transition().duration(1e3).delay(500).attr("transform",(e=>`rotate(${e.initRotate})`))}_drawDifferenceProfile(){var e,t;const s=Object(n.a)().sort(null).value(1),r=s(this._shipBaseData.speedDegrees);this._arcsComp=s(this.shipCompareData.speedDegrees),this._speedDiff=this.shipCompareData.speedDegrees.map(((e,t)=>Object(c.u)(e-this._shipBaseData.speedDegrees[t]))),this._minSpeedDiff=null!==(e=Object(a.a)(this._speedDiff))&&void 0!==e?e:0,this._maxSpeedDiff=null!==(t=Object(i.a)(this._speedDiff))&&void 0!==t?t:0;const o=d.a,h=Object(p.a)().angle(((e,t)=>t*g.q)).radius((e=>{var t;return null!==(t=this._shipCompare.radiusSpeedScale(e.data))&&void 0!==t?t:0})).curve(o),l=this._shipCompare.svgHeight/2-20;this._windProfile={initX:0,initY:0,initRotate:this._shipCompare.windProfileRotate,correctionValueDegrees:0,compassTextX:0,compassTextY:-l,type:"windProfile"},this._gWindProfile=this._mainG.append("g").attr("class","wind-profile").attr("transform",`rotate(${this._windProfile.initRotate})`),this._gWindProfile.append("path").attr("class","base-profile").attr("d",h(r)),this._gWindProfile.append("path").attr("class","comp-profile").attr("d",h(this._arcsComp))}updateWindProfileRotation(){this._gWindProfile.attr("transform",`rotate(${this._shipCompare.windProfileRotate})`),this._updateSpeedText()}updateDifferenceProfile(){this._setColourScale(this._minSpeedDiff,this._maxSpeedDiff),this._gWindProfile.append("g").attr("data-ui-component","speed-markers").selectAll("circle").data(this._arcsComp).join((e=>e.append("circle").attr("r",5).attr("cy",((e,t)=>{var s;return Math.cos(t*g.q)*-(null!==(s=this._shipCompare.radiusSpeedScale(e.data))&&void 0!==s?s:0)})).attr("cx",((e,t)=>{var s;return Math.sin(t*g.q)*(null!==(s=this._shipCompare.radiusSpeedScale(e.data))&&void 0!==s?s:0)})).attr("fill",((e,t)=>{var s;return null!==(s=this._shipCompare.colourScaleSpeedDiff(this._speedDiff[t]))&&void 0!==s?s:0})).append("title").text(((e,t)=>`${Math.round(10*e.data)/10} (${Object(h.k)(this._speedDiff[t],1)}) knots`)))).select("circle").attr("fill",((e,t)=>{var s;return null!==(s=this._shipCompare.colourScaleSpeedDiff(this._speedDiff[t]))&&void 0!==s?s:g.i}))}_injectTextComparison(){function t(e,t,s=0,a=!1){if(e===t)return"";let i,r,o="badge-danger";return a?(i=100*Number.parseFloat((t-e).toFixed(s)),r=Object(h.b)(Math.abs(i))):0===e||0===t?(i=t-e,r=Object(h.b)(Math.abs(i))):(i=1-e/t,r=Object(h.g)(Math.abs(i),0)),i<0&&(o="badge-success"),`<span class="badge ${o}">${r}</span>`}const s=Math.round(this._shipBaseData.sides.armour*this._shipBaseData.repairAmount.armour/_.h),a=Math.round(this._shipBaseData.sails.armour*this._shipBaseData.repairAmount.sails/_.m),i=Math.round(this._shipBaseData.crew.max*_.n),r=Math.round(this.shipCompareData.sides.armour*this.shipCompareData.repairAmount.armour/_.h),o=Math.round(this.shipCompareData.sails.armour*this.shipCompareData.repairAmount.sails/_.m),n=Math.round(this.shipCompareData.crew.max*_.n),d={morale:`${Object(h.d)(this.shipCompareData.boarding.morale)} ${t(this.shipCompareData.boarding.morale,this._shipBaseData.boarding.morale)}`,musketsAccuracy:`${Object(h.l)(100*this.shipCompareData.boarding.musketsAccuracy)} ${t(100*this.shipCompareData.boarding.musketsAccuracy,100*this._shipBaseData.boarding.musketsAccuracy)}`,prepPerRound:`${Object(h.d)(this.shipCompareData.boarding.prepPerRound)} ${t(this.shipCompareData.boarding.prepPerRound,this._shipBaseData.boarding.prepPerRound)}`,attack:`${Object(h.k)(this.shipCompareData.boarding.attack,2)} ${t(this.shipCompareData.boarding.attack/100,this._shipBaseData.boarding.attack/100,3,!0)}`,defense:`${Object(h.k)(this.shipCompareData.boarding.defense,2)} ${t(this.shipCompareData.boarding.defense/100,this._shipBaseData.boarding.defense/100,3,!0)}`,disengageTime:`${Object(h.d)(this.shipCompareData.boarding.disengageTime)} ${t(this._shipBaseData.boarding.disengageTime,this.shipCompareData.boarding.disengageTime)}`,musketsCrew:`${Object(h.d)(this.shipCompareData.boarding.musketsCrew/100*this.shipCompareData.crew.max)} ${t(this.shipCompareData.boarding.musketsCrew/100*this.shipCompareData.crew.max,this._shipBaseData.boarding.musketsCrew/100*this._shipBaseData.crew.max)}`,prepInitial:`${Object(h.d)(this.shipCompareData.boarding.prepInitial)} ${t(this.shipCompareData.boarding.prepInitial,this._shipBaseData.boarding.prepInitial)}`,cannonsAccuracy:`${Object(h.l)(100*this.shipCompareData.boarding.cannonsAccuracy)} ${t(100*this.shipCompareData.boarding.cannonsAccuracy,100*this._shipBaseData.boarding.cannonsAccuracy)}`,reload:`${Object(h.l)(100*this.shipCompareData.gunnery.reload)} ${t(this._shipBaseData.gunnery.reload,this.shipCompareData.gunnery.reload,3,!0)}`,penetration:`${Object(h.l)(100*this.shipCompareData.gunnery.penetration)} ${t(this.shipCompareData.gunnery.penetration,this._shipBaseData.gunnery.penetration,3,!0)}`,dispersionHorizontal:`${Object(h.l)(100*this.shipCompareData.gunnery.dispersionHorizontal)} ${t(this._shipBaseData.gunnery.dispersionHorizontal,this.shipCompareData.gunnery.dispersionHorizontal,3,!0)}`,dispersionVertical:`${Object(h.l)(100*this.shipCompareData.gunnery.dispersionVertical)} ${t(this._shipBaseData.gunnery.dispersionVertical,this.shipCompareData.gunnery.dispersionVertical,3,!0)}`,traverseUpDown:`${Object(h.l)(100*this.shipCompareData.gunnery.traverseUpDown)} ${t(this.shipCompareData.gunnery.traverseUpDown,this._shipBaseData.gunnery.traverseUpDown,3,!0)}`,traverseSide:`${Object(h.l)(100*this.shipCompareData.gunnery.traverseSide)} ${t(this.shipCompareData.gunnery.traverseSide,this._shipBaseData.gunnery.traverseSide,3,!0)}`,acceleration:`${Object(h.b)(this.shipCompareData.ship.acceleration)} ${t(this.shipCompareData.ship.acceleration,this._shipBaseData.ship.acceleration,2)}`,additionalRow:""+(this.shipCompareData.guns.decks<4?"<br> ":""),backArmor:`${Object(h.d)(this.shipCompareData.stern.armour)} ${t(this.shipCompareData.stern.armour,this._shipBaseData.stern.armour)}</br><span class="badge badge-white">${Object(h.d)(this.shipCompareData.stern.thickness)}</span>${t(this.shipCompareData.stern.thickness,this._shipBaseData.stern.thickness)}`,battleRating:`${this.shipCompareData.battleRating} ${t(this.shipCompareData.battleRating,this._shipBaseData.battleRating)}`,cannonBroadside:`${this.shipCompareData.guns.broadside.cannons} ${t(this.shipCompareData.guns.broadside.cannons,this._shipBaseData.guns.broadside.cannons)}`,cannonsPerDeck:b.a.getCannonsPerDeck(this.shipCompareData.guns),carroBroadside:`${this.shipCompareData.guns.broadside.carronades} ${t(this.shipCompareData.guns.broadside.carronades,this._shipBaseData.guns.broadside.carronades)}`,deceleration:`${Object(h.b)(this.shipCompareData.ship.deceleration)} ${t(this.shipCompareData.ship.deceleration,this._shipBaseData.ship.deceleration,2)}`,rollAngle:`${Object(h.d)(this.shipCompareData.ship.rollAngle)} ${t(this._shipBaseData.ship.rollAngle,this.shipCompareData.ship.rollAngle)}`,turnAcceleration:`${Object(h.b)(this.shipCompareData.ship.turnAcceleration)} ${t(this.shipCompareData.ship.turnAcceleration,this._shipBaseData.ship.turnAcceleration,2)}`,turnSpeed:`${Object(h.b)(this.shipCompareData.ship.turnSpeed,3)} ${t(this.shipCompareData.ship.turnSpeed,this._shipBaseData.ship.turnSpeed,2)}`,decks:Object(g.o)(this.shipCompareData.guns.decks,"deck"),firezoneHorizontalWidth:`${this.shipCompareData.ship.firezoneHorizontalWidth} ${t(this.shipCompareData.ship.firezoneHorizontalWidth,this._shipBaseData.ship.firezoneHorizontalWidth)}`,frontArmor:`${Object(h.d)(this.shipCompareData.bow.armour)} ${t(this.shipCompareData.bow.armour,this._shipBaseData.bow.armour)}</br><span class="badge badge-white">${Object(h.d)(this.shipCompareData.bow.thickness)}</span>${t(this.shipCompareData.bow.thickness,this._shipBaseData.bow.thickness)}`,guns:`${this.shipCompareData.guns.total} ${t(this.shipCompareData.guns.total,this._shipBaseData.guns.total)}`,gunsBack:this.shipCompareData.guns.gunsPerDeck[5].amount,gunsFront:this.shipCompareData.guns.gunsPerDeck[4].amount,halfturnTime:`${Object(h.b)(this.shipCompareData.rudder.halfturnTime,4)} ${t(this._shipBaseData.rudder.halfturnTime,this.shipCompareData.rudder.halfturnTime,2)}`,holdSize:`${Object(h.d)(this.shipCompareData.holdSize)} ${t(this.shipCompareData.holdSize,this._shipBaseData.holdSize)}`,hullRepairAmount:`${Object(h.d)(100*(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk))} ${t(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk,this._shipBaseData.repairAmount.armour+this._shipBaseData.repairAmount.armourPerk,3,!0)}`,hullRepairsNeeded:`${Object(h.d)(r)} <span class="badge badge-white">${Object(h.d)(r*_.k)}</span>`,leakResistance:`${Object(h.l)(100*this.shipCompareData.resistance.leaks)} ${t(this.shipCompareData.resistance.leaks,this._shipBaseData.resistance.leaks,2,!0)}`,limitBack:this.shipCompareData.guns.gunsPerDeck[5],limitFront:this.shipCompareData.guns.gunsPerDeck[4],mastBottomArmor:`${Object(h.d)(this.shipCompareData.mast.bottomArmour)} ${t(this.shipCompareData.mast.bottomArmour,this._shipBaseData.mast.bottomArmour)}</br><span class="badge badge-white">${Object(h.d)(this.shipCompareData.mast.bottomThickness)}</span>${t(this.shipCompareData.mast.bottomThickness,this._shipBaseData.mast.bottomThickness)}`,mastMiddleArmor:`${Object(h.d)(this.shipCompareData.mast.middleArmour)} ${t(this.shipCompareData.mast.middleArmour,this._shipBaseData.mast.middleArmour)}</br><span class="badge badge-white">${Object(h.d)(this.shipCompareData.mast.middleThickness)}</span>${t(this.shipCompareData.mast.middleThickness,this._shipBaseData.mast.middleThickness)}`,mastTopArmor:`${Object(h.d)(this.shipCompareData.mast.topArmour)} ${t(this.shipCompareData.mast.topArmour,this._shipBaseData.mast.topArmour)}</br><span class="badge badge-white">${Object(h.d)(this.shipCompareData.mast.topThickness)}</span>${t(this.shipCompareData.mast.topThickness,this._shipBaseData.mast.topThickness)}`,maxCrew:`${Object(h.d)(this.shipCompareData.crew.max)} ${t(this.shipCompareData.crew.max,this._shipBaseData.crew.max)}`,maxSpeed:`${Object(h.b)(this.shipCompareData.speed.max,3)} ${t(this.shipCompareData.speed.max,this._shipBaseData.speed.max,2)}`,maxWeight:`${Object(h.d)(this.shipCompareData.maxWeight)} ${t(this.shipCompareData.maxWeight,this._shipBaseData.maxWeight)}`,minCrew:Object(h.d)(this.shipCompareData.crew.min),cannonCrew:`${Object(h.d)(this.shipCompareData.crew.cannons)} ${t(this._shipBaseData.crew.cannons,this.shipCompareData.crew.cannons)}`,carroCrew:`${Object(h.d)(this.shipCompareData.crew.carronades)} ${t(this._shipBaseData.crew.carronades,this.shipCompareData.crew.carronades)}`,minSpeed:`${Object(h.b)(this.shipCompareData.speed.min)} ${t(this.shipCompareData.speed.min,this._shipBaseData.speed.min,2)}`,repairTime:`${Object(h.d)(this.shipCompareData.repairTime.sides)} ${t(this._shipBaseData.repairTime.sides,this.shipCompareData.repairTime.sides)}`,rigRepairAmount:`${Object(h.d)(100*(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk))} ${t(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk,this._shipBaseData.repairAmount.sails+this._shipBaseData.repairAmount.sailsPerk,3,!0)}`,rigRepairsNeeded:`${Object(h.d)(o)} <span class="badge badge-white">${Object(h.d)(o*_.k)}</span>`,rumRepairsNeeded:`${Object(h.d)(n)} <span class="badge badge-white">${Object(h.d)(n*_.k)}</span>`,sailingCrew:""+Object(h.d)(this.shipCompareData.crew.sailing),sails:`${Object(h.d)(this.shipCompareData.sails.armour)} ${t(this.shipCompareData.sails.armour,this._shipBaseData.sails.armour)}`,shipRating:Object(c.q)(this.shipCompareData.class)+" rate",sideArmor:`${Object(h.d)(this.shipCompareData.sides.armour)} ${t(this.shipCompareData.sides.armour,this._shipBaseData.sides.armour)}</br><span class="badge badge-white">${Object(h.d)(this.shipCompareData.sides.thickness)}</span>${t(this.shipCompareData.sides.thickness,this._shipBaseData.sides.thickness)}`,splinterResistance:`${Object(h.l)(100*this.shipCompareData.resistance.splinter)} ${t(this.shipCompareData.resistance.splinter,this._shipBaseData.resistance.splinter,2,!0)}`,structure:`${Object(h.d)(this.shipCompareData.structure.armour)} ${t(this.shipCompareData.structure.armour,this._shipBaseData.structure.armour)}`,upgradeXP:`${Object(h.d)(this.shipCompareData.upgradeXP)} ${t(this._shipBaseData.upgradeXP,this.shipCompareData.upgradeXP)}`,waterlineHeight:`${Object(h.b)(this.shipCompareData.ship.waterlineHeight)} ${t(this.shipCompareData.ship.waterlineHeight,this._shipBaseData.ship.waterlineHeight,2)}`,cannonWeight:`${Object(h.d)(this.shipCompareData.guns.weight.cannons)} ${t(this._shipBaseData.guns.weight.cannons,this.shipCompareData.guns.weight.cannons)}`,carroWeight:`${Object(h.d)(this.shipCompareData.guns.weight.carronades)} ${t(this._shipBaseData.guns.weight.carronades,this.shipCompareData.guns.weight.carronades)}`};d.repairWeight=`${Object(h.d)((r+o+.1*n)*_.k)} ${t((s+a+.1*i)*_.k,(r+o+.1*n)*_.k)}`,d.gunsFront?d.gunsFront+=" "+b.a.pd(d.limitFront):d.gunsFront="–",d.gunsBack?d.gunsBack+=" "+b.a.pd(d.limitBack):d.gunsBack="–",e(""+this.select).find("div").append(b.a.getText(d))}}}).call(this,s("xeH2"))},oggF:function(e,t,s){s.d(t,"g",(function(){return h})),s.d(t,"h",(function(){return c})),s.d(t,"j",(function(){return l})),s.d(t,"l",(function(){return u})),s.d(t,"m",(function(){return m})),s.d(t,"n",(function(){return _})),s.d(t,"k",(function(){return f})),s.d(t,"f",(function(){return D})),s.d(t,"i",(function(){return S})),s.d(t,"o",(function(){return C})),s.d(t,"a",(function(){return y})),s.d(t,"c",(function(){return w})),s.d(t,"e",(function(){return $})),s.d(t,"d",(function(){return j})),s.d(t,"b",(function(){return A}));s("UxlC");var a=s("FmoU"),i=s("GjCO"),r=s.n(i),o=s("JQHs"),n=s("2mXy"),d=s("Q4du");s("Qs7V");const p=o.a.bind(n.a),h=Number(.2),c=Number(300),l=Number(90),u=Number(.25),m=Number(300),b=Number(.25),g=Number(1),_=Number(b)/Number(g),f=5,D=new r.a("My salt: Yet another Naval Action map"),v=" (i)",S=e=>e.includes(v),C=e=>e.replace(v,""),y=e=>C(e)+(S(e)?' <span class="caps small">imported</span>':""),w=({id:e,title:t,size:s="modal-xl",body:a,footer:i})=>p`
        <div id="${e}" class="modal" tabindex="-1" role="dialog" aria-labelledby="title-${e}" aria-hidden="true">
            <div class="modal-dialog ${s}" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 id="title-${e}" class="modal-title">${t}</h5>
                    </div>
                    <div class="modal-body">${a()}</div>
                    <div class="modal-footer">${i()}</div>
                </div>
            </div>
        </div>
    `,$=e=>`${e} real${Number(e)>1?"s":""}`,j=e=>{var t,s;const{r:i,g:r,b:o}=Object(a.b)(e);return(299*i+587*r+114*o)/1e3>=128?null!==(t=null===(s=Object(a.a)(d.i))||void 0===s?void 0:s.darker(5).toString())&&void 0!==t?t:"#111":d.i},A=e=>p`<span class="caps">${e}</span>`},qE0g:function(e,t,s){(function(e){s.d(t,"a",(function(){return P}));s("UxlC"),s("WUlJ"),s("fCtr");var a=s("mrVq"),i=s("gj+k"),r=s("4TqM"),o=s("Ws9M"),n=s("VIqg"),d=s("AKWm"),p=s("Wgwc"),h=s.n(p),c=s("+QaA"),l=s.n(c),u=s("Ds8A"),m=s.n(u),b=s("pOjD"),g=s("Q4du"),_=s("pxNS"),f=s("Qs7V"),D=s("oggF"),v=s("otg8"),S=s("Bx8B"),C=s("dNoP"),y=s("ck04"),w=s("awzk"),$=s("iftE");function j(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return A(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}function k(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function O(e,t){var s=t.get(e);if(!s)throw new TypeError("attempted to get private field on non-instance");return s.get?s.get.call(e):s.value}function x(e,t,s){var a=t.get(e);if(!a)throw new TypeError("attempted to set private field on non-instance");if(a.set)a.set.call(e,s);else{if(!a.writable)throw new TypeError("attempted to set read only private field");a.value=s}return s}h.a.extend(l.a),h.a.extend(m.a);var I=new WeakMap,B=new WeakMap;class P{constructor(e="ship-compare"){k(this,"colorScale",void 0),k(this,"colourScaleSpeedDiff",void 0),k(this,"columnsCompare",void 0),k(this,"innerRadius",void 0),k(this,"outerRadius",void 0),k(this,"radiusSpeedScale",void 0),k(this,"selectedShips",void 0),k(this,"singleShipData",void 0),k(this,"shipMassScale",void 0),k(this,"svgHeight",void 0),k(this,"svgWidth",void 0),k(this,"windProfileRotate",0),k(this,"woodCompare",void 0),I.set(this,{writable:!0,value:void 0}),B.set(this,{writable:!0,value:void 0}),k(this,"_maxSpeed",void 0),k(this,"_minSpeed",void 0),k(this,"_modal$",{}),k(this,"_modifierAmount",new Map),k(this,"_moduleAndWoodCaps",void 0),k(this,"_moduleAndWoodChanges",void 0),k(this,"_moduleDataDefault",void 0),k(this,"_moduleProperties",void 0),k(this,"_moduleTypes",void 0),k(this,"_selectedUpgradeIdsList",{}),k(this,"_selectedUpgradeIdsPerType",{}),k(this,"_selectModule$",{}),k(this,"_selectShip$",{}),k(this,"_selectWood$",{}),k(this,"_shipData",void 0),k(this,"_shipIds",{}),k(this,"_shipSelectData",void 0),k(this,"_baseId",void 0),k(this,"_baseName",void 0),k(this,"_buttonId",void 0),k(this,"_columns",void 0),k(this,"_copyButtonId",void 0),k(this,"_cloneLeftButtonId",void 0),k(this,"_cloneRightButtonId",void 0),k(this,"_imageButtonId",void 0),k(this,"_modalId",void 0),k(this,"_moduleId",void 0),k(this,"_woodId",void 0),this._baseId=e,this._baseName="Compare ships",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._moduleId=this._baseId+"-module",this._copyButtonId="button-copy-"+this._baseId,this._cloneLeftButtonId="button-clone-left-"+this._baseId,this._cloneRightButtonId="button-clone-right-"+this._baseId,this._imageButtonId="button-image-"+this._baseId,this.colourScaleSpeedDiff=Object(n.a)().range([g.h,g.i,g.f]).interpolate(o.a),"ship-compare"===this._baseId?this.columnsCompare=["C1","C2"]:this.columnsCompare=[],this._columns=this.columnsCompare.slice(),this._columns.unshift("Base"),this.selectedShips={Base:{},C1:{},C2:{}},this._woodId="wood-ship",this._setupArrow(),"ship-journey"!==this._baseId&&this._setupListener()}static _getModuleLevel(e){return e<=3?"L":e<=5?"M":"S"}static _adjustAbsolute(e,t){return e?e+t:t}static _adjustPercentage(e,t,s){return s?e?e*(1+t):t:e?e+t:t}static _getModifierFromModule(e){return`<p class="mb-0">${e.map((e=>{let t;return t=e.isPercentage?Object(f.m)(e.amount/100):e.amount<1&&e.amount>0?Object(f.f)(e.amount,1):Object(f.k)(e.amount,2),`${e.modifier} ${t}`})).join("<br>")}</p>`}static _setSelect(e,t){let s;s=Array.isArray(t)?t.map((e=>String(e))):String(t),s&&e.val(s),e.selectpicker("render")}static _saveCanvasAsImage(e){const t=`na-map ship compare ${h.a.utc().format("YYYY-MM-DD HH-mm-ss")}.png`,s=document.createElement("a");s.href=e,s.download=t,document.body.append(s),s.click(),s.remove()}_getShipId(e){return this._shipIds[e]}_setShip(e,t){this._shipIds[e]=t,P._setSelect(this._selectShip$[e],t),"Base"===e&&"ship-journey"!==this._baseId&&this._enableCompareSelects()}_cloneShipData(e,t){const s=this._getShipId(e);return s&&this._setShip(t,s),void 0!==s}_getWoodId(e,t){return Number(this._selectWood$[e][t].val())}_setWood(e,t,s){P._setSelect(this._selectWood$[e][t],s),this.woodCompare._woodSelected(e,t,this._selectWood$[e][t])}_cloneWoodData(e,t){if(this.woodCompare.enableSelects(t),""!==this._selectWood$[e].frame.val())for(const s of _.j){const a=this._getWoodId(e,s);this._setWood(t,s,a)}}_getModuleIds(e,t){return this._selectedUpgradeIdsPerType[e][t]}_setModules(e,t,s){var a;this._selectedUpgradeIdsPerType[e]||(this._selectedUpgradeIdsPerType[e]={}),this._selectedUpgradeIdsList[e]||(this._selectedUpgradeIdsList[e]=[]),this._selectedUpgradeIdsPerType[e][t]=s.map((e=>Number(e))),P._setSelect(this._selectModule$[e][t],this._selectedUpgradeIdsPerType[e][t]),(a=this._selectedUpgradeIdsList[e]).push.apply(a,j(this._selectedUpgradeIdsPerType[e][t]))}_cloneModuleData(e,t){if(this._setupModulesSelect(t),this._selectedUpgradeIdsPerType[e])for(const s of j(this._moduleTypes)){const a=this._getModuleIds(e,s);this._setModules(t,s,a)}}_cloneShipToLeft(e){const t=this._columns.findIndex((t=>t===e)),s=this._columns[t-1];this._cloneShipData(e,s)&&(this._cloneWoodData(e,s),this._cloneModuleData(e,s),this._refreshShips(s))}_cloneShipToRight(e){const t=this._columns.findIndex((t=>t===e)),s=this._columns[t+1];this._cloneShipData(e,s)&&(this._cloneWoodData(e,s),this._cloneModuleData(e,s),this._refreshShips(s))}async CompareShipsInit(){await this._loadAndSetupData(),this._initData(),this._initSelects()}async initFromClipboard(e){var t;await this._loadAndSetupData();const s=D.f.decode(null!==(t=e.get("cmp"))&&void 0!==t?t:"");s.length>0&&(this._shipCompareSelected(),this._setShipAndWoodsSelects(s),this._setModuleSelects(e))}_setupArrow(){const e=document.querySelector("#journey-arrow");if(e){const t=e.cloneNode(!0);if(t.id="wind-profile-arrow-head",t.hasChildNodes())for(const e of t.childNodes)e.classList.replace("journey-arrow-head","wind-profile-arrow-head");const s=document.querySelector("#na-map svg defs");s&&s.append(t)}}_setupData(){var e,t,s;this._moduleAndWoodChanges=new Map([["Cannon horizontal dispersion",{properties:["gunnery.dispersionHorizontal"],isBaseValueAbsolute:!0}],["Cannon vertical dispersion",{properties:["gunnery.dispersionVertical"],isBaseValueAbsolute:!0}],["Cannon reload time",{properties:["gunnery.reload"],isBaseValueAbsolute:!0}],["Cannon ball penetration",{properties:["gunnery.penetration"],isBaseValueAbsolute:!0}],["Cannon side traverse",{properties:["gunnery.traverseSide"],isBaseValueAbsolute:!0}],["Cannon up/down traverse",{properties:["gunnery.traverseUpDown"],isBaseValueAbsolute:!0}],["Morale",{properties:["boarding.morale"],isBaseValueAbsolute:!0}],["Muskets accuracy",{properties:["boarding.musketsAccuracy"],isBaseValueAbsolute:!1}],["Preparation",{properties:["boarding.prepPerRound"],isBaseValueAbsolute:!0}],["Initial preparation",{properties:["boarding.prepInitial"],isBaseValueAbsolute:!0}],["Melee attack",{properties:["boarding.attack"],isBaseValueAbsolute:!1}],["Melee defense",{properties:["boarding.defense"],isBaseValueAbsolute:!1}],["Disengage time",{properties:["boarding.disengageTime"],isBaseValueAbsolute:!0}],["Crew with muskets",{properties:["boarding.musketsCrew"],isBaseValueAbsolute:!0}],["Boarding cannons accuracy",{properties:["boarding.cannonsAccuracy"],isBaseValueAbsolute:!1}],["Acceleration",{properties:["ship.acceleration"],isBaseValueAbsolute:!0}],["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],isBaseValueAbsolute:!0}],["Armour hit points",{properties:["bow.armour","sides.armour","stern.armour"],isBaseValueAbsolute:!0}],["Armour repair amount (perk)",{properties:["repairAmount.armourPerk"],isBaseValueAbsolute:!0}],["Back armour thickness",{properties:["stern.thickness"],isBaseValueAbsolute:!0}],["Cannon crew",{properties:["crew.cannons"],isBaseValueAbsolute:!0}],["Carronade crew",{properties:["crew.carronades"],isBaseValueAbsolute:!0}],["Crew",{properties:["crew.max"],isBaseValueAbsolute:!0}],["Deceleration",{properties:["ship.deceleration"],isBaseValueAbsolute:!0}],["Front armour thickness",{properties:["bow.thickness"],isBaseValueAbsolute:!0}],["Hold weight",{properties:["maxWeight"],isBaseValueAbsolute:!0}],["Hull hit points",{properties:["structure.armour"],isBaseValueAbsolute:!0}],["Sail hit points",{properties:["sails.armour"],isBaseValueAbsolute:!0}],["Mast hit points",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],isBaseValueAbsolute:!0}],["Leak resistance",{properties:["resistance.leaks"],isBaseValueAbsolute:!1}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],isBaseValueAbsolute:!0}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],isBaseValueAbsolute:!0}],["Max speed",{properties:["speed.max"],isBaseValueAbsolute:!0}],["Repair amount",{properties:["repairAmount.armour"],isBaseValueAbsolute:!0}],["Repair time",{properties:["repairTime.sides"],isBaseValueAbsolute:!0}],["Roll angle",{properties:["ship.rollAngle"],isBaseValueAbsolute:!0}],["Rudder health",{properties:["rudder.armour"],isBaseValueAbsolute:!0}],["Rudder speed",{properties:["rudder.halfturnTime"],isBaseValueAbsolute:!0}],["Sail repair amount (perk)",{properties:["repairAmount.sailsPerk"],isBaseValueAbsolute:!0}],["Sailing crew",{properties:["crew.sailing"],isBaseValueAbsolute:!0}],["Splinter resistance",{properties:["resistance.splinter"],isBaseValueAbsolute:!1}],["Turn acceleration",{properties:["ship.turnAcceleration"],isBaseValueAbsolute:!0}],["Turn speed",{properties:["ship.turnSpeed"],isBaseValueAbsolute:!0}],["Water pump health",{properties:["pump.armour"],isBaseValueAbsolute:!0}]]),x(this,I,new Set(["Turn acceleration"])),this._moduleAndWoodCaps=new Map([["Armor thickness",{properties:["sides.thickness"],cap:{amount:1,isPercentage:!0}}],["Armour hit points",{properties:["bow.armour","sides.armour","stern.armour"],cap:{amount:1,isPercentage:!0}}],["Structure hit points",{properties:["structure.armour"],cap:{amount:1,isPercentage:!0}}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],cap:{amount:1,isPercentage:!0}}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],cap:{amount:1,isPercentage:!0}}],["Max speed",{properties:["speed.max"],cap:{amount:18,isPercentage:!1}}],["Turn rate",{properties:["rudder.turnSpeed"],cap:{amount:.25,isPercentage:!0}}]]);const r=1.2*(null!==(e=Object(a.a)(this._shipData,(e=>e.speed.min)))&&void 0!==e?e:0),d=this._moduleAndWoodCaps.get("Max speed").cap.amount;this._minSpeed=r,this._maxSpeed=d,this.colorScale=Object(n.a)().domain([this._minSpeed,0,this._maxSpeed]).range([g.h,g.i,g.f]).interpolate(o.a);const p=null!==(t=Object(a.a)(this._shipData,(e=>e.shipMass)))&&void 0!==t?t:0,h=null!==(s=Object(i.a)(this._shipData,(e=>e.shipMass)))&&void 0!==s?s:0;this.shipMassScale=Object(n.a)().domain([p,h]).range([100,150])}async _loadAndSetupData(){try{this._moduleDataDefault=(await s.e(8).then(s.t.bind(null,"jhXC",3))).default,this._shipData=(await s.e(13).then(s.t.bind(null,"pcjM",3))).default,this._setupData(),"ship-journey"!==this._baseId&&(this.woodCompare=new y.a(this._woodId),await this.woodCompare.woodInit())}catch(e){Object(_.g)(e)}}_setupListener(){var e;let t=!0;null===(e=document.querySelector("#"+this._buttonId))||void 0===e||e.addEventListener("click",(async()=>{t&&(t=!1,await this._loadAndSetupData()),Object(b.b)("Tools",this._baseName),this._shipCompareSelected()}))}_setGraphicsParameters(){var t;this.svgWidth=null!==(t=e(`#${this._modalId} .column-base`).width())&&void 0!==t?t:0,this.svgHeight=this.svgWidth,this.outerRadius=Math.floor(Math.min(this.svgWidth,this.svgHeight)/2),this.innerRadius=Math.floor(.3*this.outerRadius),this.radiusSpeedScale=Object(n.a)().domain([this._minSpeed,0,this._maxSpeed]).range([10,this.innerRadius,this.outerRadius])}_getShipName(e){var t,s;return null!==(t=null===(s=this._shipData.find((t=>t.id===e)))||void 0===s?void 0:s.name)&&void 0!==t?t:""}_getSelectedData(e){const t={moduleData:new Map,ship:"",wood:[]};if(this._shipIds[e]){t.ship=this._getShipName(this._shipIds[e]);for(const s of _.j)t.wood.push(this.woodCompare.getWoodName(s,Number(this._selectWood$[e][s].val())));if(this._selectedUpgradeIdsPerType[e])for(const i of j(this._moduleTypes)){const r=[];for(const t of this._selectedUpgradeIdsPerType[e][i]){var s,a;r.push(null!==(s=null===(a=this._moduleProperties.get(t))||void 0===a?void 0:a.name.replace(" Bonus",""))&&void 0!==s?s:"")}t.moduleData.set(i,r.join(", "))}}return t}_printSelectedData(e,t,s){const a=e.querySelectorAll(`#${this._baseId}-${s.toLowerCase()} label`),i=a[0].parentNode,r=a[0].offsetHeight;for(const e of a)e.remove();const o=Object(d.a)(i).insert("div",":first-child").style("height",5*r+"px");t.ship&&o.append("div").style("margin-bottom","5px").style("line-height","1.1").text(t.ship),""!==t.wood[0]&&o.append("div").style("font-size","smaller").style("margin-bottom","5px").style("line-height","1.1").text(t.wood.join(" | "));for(const[e,s]of t.moduleData)""!==s&&o.append("div").style("font-size","small").style("margin-bottom","5px").style("line-height","1.1").html(`<em>${e}</em>: ${s}`)}_replaceSelectsWithText(e){for(const t of this._columns){const s=this._getSelectedData(t);this._printSelectedData(e,s,t)}}_setMakeImageSpinner(){O(this,B).select("i").remove(),O(this,B).attr("class","btn btn-primary").property("disabled",!0),O(this,B).append("span").attr("class","spinner-border spinner-border-sm").attr("role","status").attr("aria-hidden","true"),O(this,B).append("span").attr("class","sr-only").text("Loading...")}_unsetMakeImageSpinner(){O(this,B).selectAll("span").remove(),O(this,B).attr("class","btn btn-outline-secondary icon-outline-button").property("disabled",!1),O(this,B).append("i").attr("class","icon icon-image")}async _makeImage(e){e.preventDefault(),this._setMakeImageSpinner();const t=await s.e(21).then(s.t.bind(null,"wOnQ",7)),a=document.querySelector(`#${this._modalId} .modal-dialog .modal-content .modal-body`);if(a){const e=await t.default(a,{allowTaint:!0,foreignObjectRendering:!0,ignoreElements:e=>e.classList.contains("central")||e.classList.contains("overlay")||e.classList.contains("navbar"),logging:!0,onclone:e=>{this._replaceSelectsWithText(e)},x:0,y:0});P._saveCanvasAsImage(e.toDataURL())}this._unsetMakeImageSpinner()}_shipCompareSelected(){var t,s,a;Object(_.e)(this._modal$)&&(this._initModal(),this._modal$=e("#"+this._modalId),null===(t=document.querySelector("#"+this._modalId))||void 0===t||t.addEventListener("keydown",(e=>{"KeyC"===e.key&&e.ctrlKey&&this._copyDataClicked(e)})),null===(s=document.querySelector("#"+this._copyButtonId))||void 0===s||s.addEventListener("click",(e=>{this._copyDataClicked(e)})),null===(a=document.querySelector("#"+this._imageButtonId))||void 0===a||a.addEventListener("click",(async e=>{Object(b.b)("Menu","Ship compare image"),await this._makeImage(e)})));this._modal$.modal("show"),this._setGraphicsParameters()}_getShipAndWoodIds(){const e=[];for(const t of this._columns){const s=this._getShipId(t);if(s){e.push(s);for(const s of _.j){const a=this._getWoodId(t,s);e.push(a)}}}return e}_copyDataClicked(e){Object(b.b)("Menu","Copy ship compare"),e.preventDefault();const t=this._getShipAndWoodIds();if(t.length>0){const e=new URL(window.location.href);e.searchParams.set("v",encodeURIComponent(g.d)),e.searchParams.set("cmp",D.f.encode(t));for(const t of this._columns){const s=this._columns.indexOf(t);if(this._selectedUpgradeIdsPerType[t])for(const a of j(this._moduleTypes)){const i=this._getModuleIds(t,a),r=j(this._moduleTypes).indexOf(a);if(null==i?void 0:i.length){const t=`${s}${r}`;e.searchParams.set(t,D.f.encode(i))}}}Object(C.c)(e.href,this._modal$)}}_setupShipData(){this._shipSelectData=j(Object(r.a)(this._shipData,(e=>e.class))).map((([e,t])=>({key:e,values:t.map((e=>({id:e.id,name:e.name,class:e.class,battleRating:e.battleRating,guns:e.guns.total}))).sort(Object(S.b)(["name"]))}))).sort(Object(S.b)(["key"]))}_setupModuleData(){this._moduleProperties=new Map(this._moduleDataDefault.flatMap((e=>e[1].filter((e=>e.properties.some((e=>this._moduleAndWoodChanges.has(e.modifier))))).map((e=>[e.id,e]))))),this._moduleTypes=new Set(j(this._moduleProperties).map((e=>e[1].type.replace(/\s\u2013\s[\s/A-Za-z\u25CB]+/,""))))}_injectModal(){Object(g.m)({id:this._modalId,title:this._baseName});const e=Object(d.a)(`#${this._modalId} .modal-body`).append("div").attr("class","container-fluid").append("div").attr("class","row");for(const t of this._columns){const s=e.append("div").attr("id",`${this._baseId}-${t.toLowerCase()}`).attr("class","col-md-4 ml-auto pt-2 "+("Base"===t?"column-base":"column-comp")),a=this._getShipSelectId(t),i=s.append("div").attr("class","input-group justify-content-between mb-1");t!==this._columns[0]&&i.append("div").attr("class","input-group-prepend").append("button").attr("class","btn btn-default icon-outline-button").attr("id",`${this._cloneLeftButtonId}-${t}`).attr("title","Clone ship to left").attr("type","button").append("i").attr("class","icon icon-clone-left"),i.append("label").append("select").attr("name",a).attr("id",a).attr("class","selectpicker"),t!==this.columnsCompare[this.columnsCompare.length-1]&&i.append("div").attr("class","input-group-append").append("button").attr("class","btn btn-default icon-outline-button").attr("id",`${this._cloneRightButtonId}-${t}`).attr("title","Clone ship to right").attr("type","button").append("i").attr("class","icon icon-clone-right");const r=s.append("div").attr("class","input-group justify-content-between mb-1");for(const e of _.j){const s=this._getWoodSelectId(e,t);r.append("label").append("select").attr("name",s).attr("id",s).attr("class","selectpicker")}const o=s.append("div").attr("class","input-group justify-content-between");for(const e of this._moduleTypes){const s=this._getModuleSelectId(e,t);o.append("label").attr("class","mb-1").append("select").attr("name",s).attr("id",s).property("multiple",!0).attr("class","selectpicker")}s.append("div").attr("id",`${this._baseId}-${t}`).attr("class",("Base"===t?"ship-base":"ship-compare")+" compress")}const t=Object(d.a)(`#${this._modalId} .modal-footer`);t.insert("button","button").attr("class","btn btn-outline-secondary icon-outline-button").attr("id",this._copyButtonId).attr("title","Copy to clipboard (ctrl-c)").attr("type","button").append("i").attr("class","icon icon-copy"),x(this,B,t.insert("button","button").attr("class","btn btn-outline-secondary icon-outline-button").attr("id",this._imageButtonId).attr("title","Make image").attr("type","button")),O(this,B).append("i").attr("class","icon icon-image")}_initData(){this._setupShipData(),this._setupModuleData()}_initSelectColumns(){for(const t of this._columns){if(this._setupShipSelect(t),"ship-journey"!==this._baseId){this._selectWood$[t]={};for(const s of _.j)this._selectWood$[t][s]=e("#"+this._getWoodSelectId(s,t)),this.woodCompare._setupWoodSelects(t,s,this._selectWood$[t][s])}this._setupSelectListener(t)}}_initSelects(){this._initSelectColumns()}_initCloneListeners(){for(const s of this._columns){var e,t;if(s!==this._columns[0])null===(e=document.querySelector(`#${this._cloneLeftButtonId}-${s}`))||void 0===e||e.addEventListener("click",(()=>{this._cloneShipToLeft(s)}));if(s!==this.columnsCompare[this.columnsCompare.length-1])null===(t=document.querySelector(`#${this._cloneRightButtonId}-${s}`))||void 0===t||t.addEventListener("click",(()=>{this._cloneShipToRight(s)}))}}_initModal(){this._initData(),this._injectModal(),this._initSelects(),this._initCloneListeners()}_getShipOptions(){return this._shipSelectData.map((e=>`<optgroup label="${Object(v.q)(Number(e.key),!1)} rate">${e.values.map((e=>`<option data-subtext="${e.battleRating} ${Object(D.i)(e.name)?"Imported":""}" value="${e.id}">${Object(D.o)(e.name)} (${e.guns})`)).join("</option>")}`)).join("</optgroup>")}_setupShipSelect(t){this._selectShip$[t]=e("#"+this._getShipSelectId(t));const s=this._getShipOptions();this._selectShip$[t].append(s),"Base"!==t&&this._selectShip$[t].attr("disabled","disabled")}_getUpgradesOptions(e,t){const s=j(this._moduleProperties).filter((s=>s[1].type.replace(/\s–\s[\s/A-Za-z\u25CB]+/,"")===e&&("U"===s[1].moduleLevel||s[1].moduleLevel===P._getModuleLevel(t)))),a=j(Object(r.a)(s,(e=>e[1].type.replace(/[\sA-Za-z]+\s–\s/,"")))).map((([e,t])=>({key:e,values:t.sort(((e,t)=>e[1].name.localeCompare(t[1].name)))}))).sort(Object(S.b)(["key"]));let i;const o=new Set(["Permanent","Ship trim"]);return i=a.length>1?a.map((t=>`<optgroup label="${t.key}" data-max-options="${o.has(e.replace(/[\sA-Za-z]+\s–\s/,""))?1:5}">${t.values.map((e=>`<option value="${e[0]}">${e[1].name}`)).join("</option>")}`)).join("</optgroup>"):a.map((e=>""+e.values.map((e=>`<option value="${e[0]}">${e[1].name}`)).join("</option>"))).join(""),i}_fillModuleSelect(e,t){const s=this._getUpgradesOptions(t,(()=>this._shipData.find((t=>t.id===this._shipIds[e])).class)());this._selectModule$[e][t].find("option").remove(),this._selectModule$[e][t].append(s)}_resetModuleSelects(e){for(const t of this._moduleTypes)this._fillModuleSelect(e,t),this._selectModule$[e][t].selectpicker("refresh")}_getModuleFromName(e){let t={};return this._moduleDataDefault.some((s=>(t=s[1].find((t=>t.name===e)),Boolean(t)))),t}_setupModulesSelect(t){if(!this._selectModule$[t]){this._selectModule$[t]={};for(const s of this._moduleTypes){const a=new Map;this._selectModule$[t][s]=e("#"+this._getModuleSelectId(s,t)),this._selectModule$[t][s].on("changed.bs.select",(()=>{this._modulesSelected(t),this._refreshShips(t)})).on("show.bs.select",(t=>{const s=e(t.currentTarget);s.parent().find("button.bs-select-all").remove();for(const t of s.data("selectpicker").selectpicker.current.elements)if(!t.classList.contains("dropdown-divider")&&!t.classList.contains("dropdown-header")){const s=this._getModuleFromName(t.textContent);e(t).attr("data-original-title",P._getModifierFromModule(s.properties)).tooltip({boundary:"viewport",html:!0}).on("show.bs.tooltip",(()=>{a.set(s.id,e(t))})).on("hide.bs.tooltip",(()=>{a.set(s.id,null)}))}})).selectpicker({actionsBox:!0,countSelectedText:e=>`${e} ${s.toLowerCase()}s selected`,deselectAllText:"Clear",liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",maxOptions:s.startsWith("Ship trim")?6:5,selectedTextFormat:"count > 1",title:""+s,width:"150px"}).on("hide.bs.select",(()=>{for(const[,e]of a)e&&e.tooltip("hide");a.clear()}))}}this._resetModuleSelects(t)}_getShipData(e){const t=this._shipData.find((t=>t.id===this._shipIds[e]));t.boarding={attack:0,cannonsAccuracy:0,defense:0,disengageTime:4,morale:t.boarding.morale,musketsAccuracy:0,musketsCrew:30,prepInitial:t.boarding.prepInitial,prepPerRound:t.boarding.prepPerRound};let s=t;return s.repairAmount={armour:D.g,armourPerk:0,sails:D.l,sailsPerk:0},s.repairTime={sides:D.j,default:D.j},s.resistance={leaks:0,splinter:0},s.gunnery={dispersionHorizontal:0,dispersionVertical:0,penetration:0,reload:0,traverseUpDown:0,traverseSide:0},s=this._addModulesAndWoodData(t,s,e),s}_roundPropertyValue(e,t,s=!1){return Number.isInteger(e)&&!s?Math.round(t):Math.trunc(100*t)/100}_adjustValue(e,t,s){var a,i;let r=e;if(0!==(null===(a=this._modifierAmount.get(t))||void 0===a?void 0:a.percentage)){const e=this._modifierAmount.get(t).percentage/100;r=P._adjustPercentage(r,e,s)}if(0!==(null===(i=this._modifierAmount.get(t))||void 0===i?void 0:i.absolute)){const{absolute:e}=this._modifierAmount.get(t);r=P._adjustAbsolute(r,e)}const o=O(this,I).has(t)||s||0===e;return this._roundPropertyValue(e,r,o)}_setModifier(e){let t=e.isPercentage?0:e.amount,s=e.isPercentage?e.amount:0;var a,i,r,o;this._modifierAmount.has(e.modifier)&&(t+=null!==(a=null===(i=this._modifierAmount.get(e.modifier))||void 0===i?void 0:i.absolute)&&void 0!==a?a:0,s+=null!==(r=null===(o=this._modifierAmount.get(e.modifier))||void 0===o?void 0:o.percentage)&&void 0!==r?r:0);this._modifierAmount.set(e.modifier,{absolute:t,percentage:s})}_showCappingAdvice(e,t){const s=`${this._baseId}-${e}-capping`;let a=document.querySelector("#"+s);if(!a){var i;a=document.createElement("p"),a.id=s,a.className="alert alert-warning";const t=document.querySelector(`#${this._baseId}-${e}`);null==t||null===(i=t.firstChild)||void 0===i||i.after(a)}a.innerHTML=j(t).join(", ")+" capped"}_removeCappingAdvice(e){const t=`${this._baseId}-${e}-capping`,s=document.querySelector("#"+t);s&&s.remove()}_addModulesAndWoodData(e,t,s){const a=JSON.parse(JSON.stringify(t)),i=()=>{a.speedDegrees=a.speedDegrees.map((e=>{const t=1+this._modifierAmount.get("Max speed").percentage/100,s=e>0?e*t:e/t;return Math.max(Math.min(s,this._maxSpeed),this._minSpeed)}))};return this._modifierAmount=new Map,(()=>{for(const e of this._selectedUpgradeIdsList[s]){const t=this._moduleProperties.get(e);for(const e of t.properties)this._moduleAndWoodChanges.has(e.modifier)&&this._setModifier(e)}if(this.woodCompare.instances[s]){let e="_woodData";"Base"!==s&&(e="_compareData");for(const t of _.j)for(const a of this.woodCompare.instances[s][e][t].properties)this._moduleAndWoodChanges.has(a.modifier)&&this._setModifier(a)}})(),(()=>{for(const[t]of this._modifierAmount.entries()){var e;if(null===(e=this._moduleAndWoodChanges.get(t))||void 0===e?void 0:e.properties){const{properties:e,isBaseValueAbsolute:s}=this._moduleAndWoodChanges.get(t);for(const i of e){const e=i.split(".");e.length>1?a[e[0]][e[1]]=this._adjustValue(a[e[0]][e[1]],t,s):a[e[0]]=this._adjustValue(a[e[0]],t,s)}}}})(),(()=>{const t={isCapped:!1,modifiers:new Set},i=(e,s,a,{amount:i,isPercentage:r})=>{const o=Math.min(s,r?this._roundPropertyValue(a,a*(1+i)):i);return s>o&&(t.isCapped=!0,t.modifiers.add(e)),o};for(const[t]of this._modifierAmount.entries())if(this._moduleAndWoodCaps.has(t)){const{cap:s}=this._moduleAndWoodCaps.get(t);for(const r of this._moduleAndWoodCaps.get(t).properties){const o=r.split(".");o.length>1?a[o[0]][o[1]]&&(a[o[0]][o[1]]=i(t,a[o[0]][o[1]],e[o[0]][o[1]],s)):a[o[0]]&&(a[o[0]]=i(t,a[o[0]],e[o[0]],s))}}t.isCapped?this._showCappingAdvice(s,t.modifiers):this._removeCappingAdvice(s)})(),this._modifierAmount.has("Max speed")&&i(),a}_updateDifferenceProfileNeeded(e){"Base"===e||Object(_.e)(this.selectedShips[e])||this.selectedShips[e].updateDifferenceProfile()}_updateSailingProfile(e){this._updateDifferenceProfileNeeded(e);for(const t of this.columnsCompare)t!==e&&this._updateDifferenceProfileNeeded(t)}_refreshShips(e){if("ship-journey"===this._baseId)this.singleShipData=this._shipData.find((t=>t.id===this._shipIds[e]));else{this._modulesSelected(e);const t=this._getShipData(e);if("Base"===e){this._setSelectedShip(e,new w.a(e,t,this));for(const e of this.columnsCompare)this._selectShip$[e].removeAttr("disabled").selectpicker("refresh"),Object(_.e)(this.selectedShips[e])||this._setSelectedShip(e,new $.a(e,t,this.selectedShips[e].shipCompareData,this))}else this._setSelectedShip(e,new $.a(e,this.selectedShips.Base.shipData,t,this));this._updateSailingProfile(e)}}_enableCompareSelects(){for(const e of this.columnsCompare)this._selectShip$[e].removeAttr("disabled").selectpicker("refresh")}_modulesSelected(e){this._selectedUpgradeIdsList[e]=[],this._selectedUpgradeIdsPerType[e]={};for(const t of this._moduleTypes)this._selectedUpgradeIdsPerType[e][t]=this._selectModule$[e][t].val(),Array.isArray(this._selectedUpgradeIdsPerType[e][t])?this._selectedUpgradeIdsPerType[e][t]=this._selectedUpgradeIdsPerType[e][t].map((e=>Number(e))):this._selectedUpgradeIdsPerType[e][t]=this._selectedUpgradeIdsPerType[e][t]?[Number(this._selectedUpgradeIdsPerType[e][t])]:[],this._selectedUpgradeIdsPerType[e][t].length>0&&(this._selectedUpgradeIdsList[e]=this._selectedUpgradeIdsList[e].concat(this._selectedUpgradeIdsPerType[e][t]))}_setupSelectListener(e){if(this._selectShip$[e].selectpicker({title:"Ship"}).on("changed.bs.select",(()=>{this._shipIds[e]=Number(this._selectShip$[e].val()),"ship-journey"!==this._baseId&&this._setupModulesSelect(e),this._refreshShips(e),"Base"===e&&"ship-journey"!==this._baseId&&this._enableCompareSelects(),"ship-journey"!==this._baseId&&this.woodCompare.enableSelects(e)})),"ship-journey"!==this._baseId)for(const t of _.j)this._selectWood$[e][t].on("changed.bs.select",(()=>{this.woodCompare._woodSelected(e,t,this._selectWood$[e][t]),this._refreshShips(e)})).selectpicker({title:"Wood "+t,width:"150px"})}_setShipAndWoodsSelects(e){let t=0;this._columns.some((s=>{if(!this._shipData.find((s=>s.id===e[t])))return!1;if(this._setShip(s,e[t]),t+=1,this.woodCompare.enableSelects(s),this._setupModulesSelect(s),e[t])for(const a of _.j)this._setWood(s,a,e[t]),t+=1;else t+=2;return this._refreshShips(s),t>=e.length}))}_setModuleSelects(e){for(const t of this._columns){const s=this._columns.indexOf(t);let a=!1;for(const i of j(this._moduleTypes)){const r=j(this._moduleTypes).indexOf(i);if(e.has(`${s}${r}`)){const o=D.f.decode(e.get(`${s}${r}`));this._setModules(t,i,o),a=!0}}a&&this._refreshShips(t)}}_getShipSelectId(e){return`${this._baseId}-${e}-select`}_getWoodSelectId(e,t){return`${this._woodId}-${e}-${t}-select`}_getModuleSelectId(e,t){return`${this._moduleId}-${e.replace(/\s/,"")}-${t}-select`}_setSelectedShip(e,t){this.selectedShips[e]=t}}}).call(this,s("xeH2"))},u3gz:function(e,t,s){s("Z5fe"),s("awzk"),s("iftE");var a=s("qE0g");s.d(t,"a",(function(){return a.a}))}}]);