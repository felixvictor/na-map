/*! For license information please see game-tools.dce1868b5eeed1675ced.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"8ZGG":function(t,e,a){a.d(e,"a",(function(){return s}));const s=["loot","chests","items"]},D04b:function(t,e,a){(function(t){a.d(e,"a",(function(){return y}));a("WUlJ"),a("fCtr"),a("dbdZ");var s=a("PuWf"),i=a("wz8V"),o=a("mrVq"),n=a("gj+k"),r=a("RhHs"),d=a("3xmg"),l=a("R0i0"),c=a("VIqg"),h=a("AKWm"),u=a("wIsI"),b=a("0T5i"),p=a("44y/"),_=a("jICm"),m=a("pOjD"),f=a("pxNS"),v=a("Q4du"),g=a("oggF");function j(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}class y{constructor(){j(this,"_baseName",void 0),j(this,"_baseId",void 0),j(this,"_buttonId",void 0),j(this,"_modalId",void 0),j(this,"_ownershipData",{}),j(this,"_nationData",{}),j(this,"_colourScale",void 0),j(this,"_mainDiv",void 0),j(this,"_div",void 0),j(this,"_svg",void 0),this._baseName="Port ownership",this._baseId="ownership-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._colourScale=Object(d.a)().range(v.f),this._setupListener()}static getHeight(){return Math.floor(.75*top.innerHeight)}_getWidth(){var t;return null!==(t=Math.floor(this._mainDiv.node().offsetWidth))&&void 0!==t?t:0}async _loadAndSetupData(){try{this._nationData=(await a.e(10).then(a.t.bind(null,"igRa",3))).default,this._ownershipData=(await a.e(11).then(a.t.bind(null,"kH+C",3))).default}catch(t){Object(f.f)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(m.b)("Tools",this._baseName),this._ownershipListSelected()})}_injectModal(){Object(v.k)({id:this._modalId,title:this._baseName});const t=this._baseId+"-select",e=Object(h.a)(`#${this._modalId} .modal-body`);e.append("label").append("select").attr("name",t).attr("id",t),this._mainDiv=e.append("div").attr("id",""+this._baseId),this._div=this._mainDiv.append("div"),this._svg=this._mainDiv.append("svg").attr("class","area")}_getOptions(){return""+this._ownershipData.map(t=>`<option value="${t.region}">${t.region}</option>;`).join("")}_setupSelect(){const e=t(`#${this._baseId}-select`),a=this._getOptions();e.append(a)}_setupSelectListener(){t(`#${this._baseId}-select`).addClass("selectpicker").on("change",t=>this._regionSelected(t)).selectpicker({noneSelectedText:"Select region"}).val("default").selectpicker("refresh")}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_ownershipListSelected(){let e=!1;document.querySelector("#"+this._modalId)||(e=!0,this._initModal()),t("#"+this._modalId).on("shown.bs.modal",()=>{e&&(this._injectArea(),e=!1)}).modal("show")}_injectArea(){const t=this._getWidth(),e=Math.min(1e3,y.getHeight()),a=32,d=32,h=32,m=f.e.filter(t=>9!==t.id).map(t=>t.short),v=this._nationData;v.keys=m;const j=Object(u.a)().offset(b.a).keys(m)(v);this._svg.attr("width",t).attr("height",e),(()=>{const r=(()=>{const s=Object(c.a)().domain(Object(i.a)(v,t=>new Date(t.date))).range([h,t-a]),r=Object(c.a)().domain([Object(o.a)(j[0],t=>t[0]),Object(n.a)(j[j.length-1],t=>t[1])]).range([e-d,0]);return Object(p.a)().x(t=>s(new Date(t.data.date))).y0(t=>r(t[0])).y1(t=>r(t[1])).curve(_.a)})(),l=new Map(f.e.map(t=>[t.short,t.name]));this._colourScale.domain(m),this._svg.selectAll("path").data(j).join(t=>t.append("path").attr("fill",t=>this._colourScale(t.key)).attr("stroke",t=>this._colourScale(t.key)).attr("d",r)),this._svg.selectAll(".area-label").data(j).join(t=>t.append("text").attr("class","area-label").text(t=>l.get(t.key)).attr("fill",t=>Object(g.e)(this._colourScale(t.key))).attr("transform",Object(s.areaLabel)(r)))})(),this._svg.append("g").call(s=>{const o=Object(l.b)().domain(Object(i.a)(v,t=>new Date(t.date))).range([h,t-a]);s.attr("transform",`translate(0,${e-d})`).call(Object(r.a)(o).ticks(t/80).tickSizeOuter(0)),s.attr("font-size",".8rem").attr("font-family","")})}async _injectChart(t){(await Promise.all([a.e(4),a.e(27)]).then(a.bind(null,"ZiDp"))).default().data(t).enableAnimations(!1).timeFormat("%-d %B %Y").zQualitative(!0).zColorScale(this._colourScale).width(this._getWidth())(this._div.node())}_regionSelected(e){const a=t(e.currentTarget).find(":selected").val();this._div.selectAll("*").remove();const s=this._ownershipData.filter(t=>t.region===a).map(t=>t.data)[0];this._injectChart(s)}}}).call(this,a("xeH2"))},"Jz/z":function(t,e,a){(function(t){a.d(e,"a",(function(){return h}));a("WUlJ"),a("fCtr"),a("dbdZ");var s=a("AKWm"),i=a("pOjD"),o=a("pxNS"),n=a("Q4du"),r=a("Qs7V"),d=a("Bx8B");function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const c=["Resources","Extra","Materials"];class h{constructor(){l(this,"_baseName",void 0),l(this,"_baseId",void 0),l(this,"_buttonId",void 0),l(this,"_modalId",void 0),l(this,"_init",!0),l(this,"_blueprintData",{}),l(this,"_woodData",{}),l(this,"_extractionCosts",{}),l(this,"_craftingCosts",{}),l(this,"_blueprint",void 0),l(this,"_woodOptions",{}),l(this,"_defaultWood",void 0),l(this,"_woodsSelected",{}),l(this,"_blueprintList",void 0),l(this,"_currentBlueprint",{}),l(this,"_tables",{}),this._baseName="List ship blueprint",this._baseId="ship-blueprint-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._defaultWood={frame:"Fir",trim:"Crew Space"},this._setupListener()}async _loadAndSetupData(){try{this._blueprintData=(await a.e(15).then(a.t.bind(null,"lFc/",3))).default,this._woodData=(await a.e(17).then(a.t.bind(null,"xOpV",3))).default;const t=(await a.e(15).then(a.t.bind(null,"ZII7",3))).default;this._extractionCosts=new Map(t.standard.map(t=>{var e;return[t.name,{reales:t.reales,labour:null!==(e=null==t?void 0:t.labour)&&void 0!==e?e:0}]})),this._craftingCosts=new Map(t.seasoned.map(t=>[t.name,{reales:t.reales,labour:t.labour,doubloon:t.doubloon,tool:t.tool}]))}catch(t){Object(o.f)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(i.b)("Tools",this._baseName),this._listSelected()})}_injectModal(){Object(n.k)({id:this._modalId,title:this._baseName,size:"modal-lg"});const t=this._baseId+"-ship-select",e=Object(s.a)(`#${this._modalId} .modal-body`);let a=e.append("div").classed("row no-gutters mb-2",!0);a.append("label").attr("for",t),a.append("select").attr("name",t).attr("id",t),a=e.append("div").classed("row no-gutters",!0);for(const t of o.h){const e=`${this._baseId}-${t}-select`;a.append("label").attr("for",e),a.append("select").attr("name",e).attr("id",e).classed("pr-2",!0)}this._blueprintList=e.append("div").attr("id",""+this._baseId).classed("blueprint mt-4",!0)}_getShipOptions(){return""+this._blueprintData.sort(Object(d.b)(["name"])).map(t=>`<option value="${t.name}">${t.name}</option>;`).join("")}_setupShipSelect(){const e=t(`#${this._baseId}-ship-select`),a=this._getShipOptions();e.append(a)}_setupWoodOptions(){const t=this._woodData.frame.sort(Object(d.b)(["name"])),e=this._woodData.trim.filter(t=>"Light"!==t.name).sort(Object(d.b)(["name"]));this._woodOptions={frame:t.map(t=>`<option value="${t.name}">${t.name}</option>`).join(""),trim:e.map(t=>`<option value="${t.name}">${t.name}</option>`).join("")}}_setupWoodSelect(t,e){this._setupWoodOptions(),this._woodsSelected[t]=this._defaultWood[t],e.append(this._woodOptions[t]),e.attr("disabled","disabled")}_setupSelects(){this._setupShipSelect();for(const e of o.h){const a=t(`#${this._baseId}-${e}-select`);this._setupWoodSelect(e,a)}}_setupShipSelectListener(){t(`#${this._baseId}-ship-select`).addClass("selectpicker").on("change",t=>this._blueprintSelected(t)).selectpicker({noneSelectedText:"Select blueprint",width:"fit"}).val("default").selectpicker("refresh")}_setupWoodSelectListener(t,e){e.addClass("selectpicker").on("change",()=>this._woodSelected(t,e)).selectpicker({noneSelectedText:"Select "+t,width:"fit"}).val("default").selectpicker("refresh")}_setupSelectListener(){this._setupShipSelectListener();for(const e of o.h){const a=t(`#${this._baseId}-${e}-select`);this._setupWoodSelectListener(e,a)}}_initModal(){this._injectModal(),this._setupSelects(),this._setupSelectListener()}_setWoodSelect(e){t(`#${this._baseId}-${e}-select`).removeAttr("disabled").val(this._defaultWood[e]).selectpicker("refresh")}_woodSelected(t,e){this._woodsSelected[t]=e.val(),this._updateText()}_listSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_updateTable(t,e){t.select("tbody").selectAll("tr").data(e).join(t=>t.append("tr")).selectAll("td").data(t=>t).join(t=>t.append("td")).html(t=>t)}_updateText(){let t=this._currentBlueprint.resources.map(t=>[t.name,t.amount]),e=!1,a=!1,s=0,i=0;if("Crew Space"===this._woodsSelected.trim){const e=this._currentBlueprint.wood.find(t=>"Crew Space"===t.name).amount,a=t.findIndex(t=>"Hemp"===t[0]);t[a][1]=t[a][1]+e}else if(i=this._currentBlueprint.wood.find(t=>"Planking"===t.name).amount,this._woodsSelected.trim===this._woodsSelected.frame)s+=i;else{const e=t.findIndex(t=>t[0]===this._woodsSelected.trim);e>=0?t[e][1]=t[e][1]+i:(a=!0,t.push([this._woodsSelected.trim,i]))}s+=this._currentBlueprint.wood.find(t=>"Frame"===t.name).amount;const n=t.findIndex(t=>t[0]===this._woodsSelected.frame);if(n>=0?t[n][1]=t[n][1]+s:(e=!0,t.push([this._woodsSelected.frame,s])),e&&a){const e=t.length-1;[t[e],t[e-1]]=[t[e-1],t[e]]}let d=[];this._currentBlueprint.price&&d.push(["Reales",this._currentBlueprint.price]),d.push(["Provisions",this._currentBlueprint.provisions]),this._currentBlueprint.permit&&d.push(["Permit",this._currentBlueprint.permit]),d.push(["Craft level",this._currentBlueprint.craftLevel],["Shipyard level",this._currentBlueprint.shipyardLevel],["Labour hours",this._currentBlueprint.labourHours],["Craft experience",this._currentBlueprint.craftXP]);const l=[];let c=0,h=0;const u=t=>{var e,a;return(null!==(e=null===(a=this._extractionCosts.get(t[0]))||void 0===a?void 0:a.reales)&&void 0!==e?e:0)*t[1]},b=t=>{var e,a;return(null!==(e=null===(a=this._extractionCosts.get(t[0]))||void 0===a?void 0:a.labour)&&void 0!==e?e:0)*t[1]},p=t=>{for(const e of t.filter(t=>this._extractionCosts.has(t[0])))c+=u(e),h+=b(e)};p(t),p(d),c&&l.push(["Reales",Object(r.c)(c)],["Labour hours",Object(r.c)(h)]);let _=0,m=0,f=0,v=0;for(const t of o.h){const e=this._craftingCosts.get(this._woodsSelected[t]);var g,j,y,S;if(e)_+=(null!==(g=e.reales)&&void 0!==g?g:0)*s,m+=(null!==(j=e.labour)&&void 0!==j?j:0)*s,f+=(null!==(y=e.doubloon)&&void 0!==y?y:0)*s,v+=(null!==(S=e.tool)&&void 0!==S?S:0)*s}_&&l.push(["(S) reales",Object(r.c)(_)]),m&&l.push(["(S) labour hours",Object(r.c)(m)]),f&&l.push(["(S) doubloons",Object(r.c)(f)]),v&&l.push(["(S) tools",Object(r.c)(v)]),t=t.map(t=>[t[0],Object(r.c)(t[1])]),d=d.map(t=>[t[0],Object(r.c)(t[1])]),this._updateTable(this._tables.Resources,t),this._updateTable(this._tables.Extra,d),this._updateTable(this._tables.Materials,l)}_blueprintSelected(e){if(this._init){this._init=!1;for(const t of o.h)this._setWoodSelect(t);const t=this._blueprintList.append("div").classed("card-deck",!0),e=e=>{const a=t.append("div").classed("card",!0);a.append("div").classed("card-header",!0).text(e);const s=a.append("div").classed("card-body",!0);this._tables[e]=s.append("table").classed("table table-sm card-table",!0),this._tables[e].append("thead"),this._tables[e].append("tbody")};for(const t of c)e(t)}this._blueprint=t(e.currentTarget).find(":selected").val(),this._currentBlueprint=this._getBlueprintData(this._blueprint),this._updateText()}_getBlueprintData(t){return this._blueprintData.find(e=>e.name===t)}}}).call(this,a("xeH2"))},K5dq:function(t,e,a){(function(t){a.d(e,"a",(function(){return v}));a("WUlJ"),a("fCtr");var s=a("AKWm"),i=a("XXsb"),o=a.n(i),n=a("2mXy"),r=a("JQHs"),d=a("pOjD"),l=a("pxNS"),c=a("Q4du"),h=a("Qs7V"),u=a("oggF"),b=a("Bx8B");function p(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return _(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return _(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}function m(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const f=r.a.bind(n.a);class v{constructor(){m(this,"_baseName",void 0),m(this,"_baseId",void 0),m(this,"_buttonId",void 0),m(this,"_modalId",void 0),m(this,"_woodData",{}),m(this,"_div",void 0),this._baseName="List woods",this._baseId="wood-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{this._woodData=(await a.e(17).then(a.t.bind(null,"xOpV",3))).default}catch(t){Object(l.f)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(d.b)("Tools",this._baseName),this._woodListSelected()})}_injectModal(){Object(c.k)({id:this._modalId,title:this._baseName,size:"modal-xl"});const t=Object(s.a)(`#${this._modalId} .modal-body`);this._div={};for(const e of l.h)t.append("h5").text(Object(l.b)(e+"s")),this._div[e]=t.append("div").attr("id",e+"-list")}_initModal(){Object(u.j)(),this._injectModal();for(const t of l.h)this._injectList(t)}_woodListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getModifiers(t){const e=new Set;return this._woodData[t].forEach(t=>{t.properties.forEach(t=>{"Ship material"!==t.modifier&&"Boarding morale"!==t.modifier&&e.add(t.modifier)})}),p(e).sort(b.a)}_getList(t){const e=this._getModifiers(t);return f`
            <table id="table-${this._baseId}-${t}-list" class="table table-sm small tablesort na-table">
                ${f` <thead>
                <tr>
                    <th data-sort-default>Wood</th>
                    ${e.map(t=>f`<th class="text-right">
                            ${(t=>{const e=t.split(" ",2),a=t.slice(e.join(" ").length);return f`${e[0]}<br />${e[1]} ${a}`})(t)}
                        </th>`)}
                </tr>
            </thead>`} ${(t=>f`<tbody>
                ${this._woodData[t].map(t=>f`
                            <tr>
                                <td>${t.name}</td>

                                ${e.map(e=>{var a,s;const i=null!==(a=null===(s=t.properties.find(t=>t.modifier===e))||void 0===s?void 0:s.amount)&&void 0!==a?a:0;let o;return o="Repair amount"===e&&i?Object(h.e)(i,1):i?Object(u.c)(i):"",f`<td class="text-right" data-sort="${null!=i?i:0}">
                                        ${o}
                                    </td>`})}
                            </tr>
                        `)}
            </tbody>`)(t)}
            </table>
        `}_injectList(t){Object(n.b)(this._getList(t),this._div[t].node());const e=document.querySelector(`#table-${this._baseId}-${t}-list`);new o.a(e)}}}).call(this,a("xeH2"))},KbbR:function(t,e,a){(function(t){a.d(e,"a",(function(){return b}));a("WUlJ"),a("fCtr"),a("ry7D");var s=a("AKWm"),i=a("pOjD"),o=a("pxNS"),n=a("Q4du"),r=a("Qs7V"),d=a("Bx8B"),l=a("dNoP");function c(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return h(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}function u(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}class b{constructor(){u(this,"_baseName",void 0),u(this,"_baseId",void 0),u(this,"_buttonId",void 0),u(this,"_modalId",void 0),u(this,"_moduleData",{}),u(this,"_ingredientData",{}),this._baseName="List recipe ingredients",this._baseId="ingredient-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{this._moduleData=(await a.e(9).then(a.t.bind(null,"jhXC",3))).default,this._ingredientData=(await a.e(14).then(a.t.bind(null,"Oi4q",3))).default.ingredient}catch(t){Object(o.f)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(i.b)("Tools",this._baseName),this._ingredientListSelected()})}_injectModal(){Object(n.k)({id:this._modalId,title:this._baseName});Object(s.a)(`#${this._modalId} .modal-body`).append("div").attr("id",""+this._baseId).attr("class","container-fluid")}_initModal(){this._injectModal(),this._injectList()}_ingredientListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getProperties(t){let e,a="",s="";for(const e of this._moduleData){const i=e[1].sort(Object(d.b)(["name"])).filter(e=>e.name===t);for(const t of i)a=e[0],s=`<tr><td>${t.properties.map(t=>{const e=t.isPercentage?Object(r.l)(t.amount/100):Object(r.k)(t.amount);return`${t.modifier} ${e}`}).join("</td></tr><tr><td>")}</td></tr>`}return e=`<h6 class='text-muted text-left'>${a}</h6>`,e+=`<table class='table table-sm'><tbody>${s}</tbody></table>`,s?e:""}_getRows(){return this._ingredientData.map(t=>`<tr><td>${t.name}</td><td>${t.recipeNames.map(t=>{const e=this._getProperties(t);return e?`<a data-toggle="tooltip" title="${e}">${t}</a>`:t}).join("<br>")}</td></tr>`)}_getText(){const t=this._getRows(),e=Object(l.a)(t,2);let a="";for(const t of c(new Array(e.length).keys()))a+=`<div class="col-md-${Math.floor(12/e.length)}">`,a+='<table class="table table-sm na-table"><thead>',a+="<tr><th>Ingredient</th><th>Recipes</th></tr></thead><tbody>",a+=e[t].join(""),a+="</tbody></table></div>";return a}_injectList(){Object(s.a)(`#${this._baseId} div`).remove(),Object(s.a)("#"+this._baseId).append("div").classed("row",!0),Object(s.a)(`#${this._baseId} div`).html(this._getText()),t('[data-toggle="tooltip"]').tooltip({html:!0,placement:"auto",sanitize:!1})}}}).call(this,a("xeH2"))},MICP:function(t,e,a){(function(t){a.d(e,"a",(function(){return p}));a("UxlC"),a("WUlJ"),a("fCtr"),a("dbdZ");var s=a("AKWm"),i=a("pOjD"),o=a("pxNS"),n=a("Q4du"),r=a("Qs7V"),d=a("oggF"),l=a("otg8"),c=a("Bx8B");function h(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const u=a("Bhad"),b=(t,e,a)=>`${Object(l.q)(e)} – ${Object(l.q)(a)}`;class p{constructor(t){h(this,"_serverType",void 0),h(this,"_baseName",void 0),h(this,"_baseId",void 0),h(this,"_buttonId",void 0),h(this,"_modalId",void 0),h(this,"_moduleData",[]),h(this,"_recipeData",[]),h(this,"_recipes",void 0),this._serverType=u.find(e=>e.id===t).type,this._baseName="List admiralty items and recipes",this._baseId="recipe-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{this._moduleData=(await a.e(9).then(a.t.bind(null,"jhXC",3))).default,this._recipeData=(await a.e(14).then(a.t.bind(null,"Oi4q",3))).default.recipe,this._recipes=new Map(this._recipeData.flatMap(t=>t.recipes.map(t=>[t.id,t])))}catch(t){Object(o.f)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(i.b)("Tools",this._baseName),this._recipeListSelected()})}_injectModal(){Object(n.k)({id:this._modalId,title:this._baseName});const t=this._baseId+"-select",e=Object(s.a)(`#${this._modalId} .modal-body`);e.append("select").attr("name",t).attr("id",t),e.append("label").attr("for",t).attr("class","text-muted pl-2").text("Items listed here may not be available in the game (yet)."),e.append("div").attr("id",""+this._baseId).attr("class","container-fluid")}_getOptions(){return this._recipeData.map(t=>`<optgroup label="${t.group}">${t.recipes.filter(t=>"Any"===t.serverType||t.serverType===this._serverType).sort(Object(c.b)(["name"])).map(t=>`<option value="${t.id}">${t.name.replace(/(\d)-(\d)(st|rd|th)/,b)}`).join("</option>")}`).join("</optgroup>")}_setupSelect(){const e=t(`#${this._baseId}-select`),a=this._getOptions();e.append(a)}_setupSelectListener(){t(`#${this._baseId}-select`).addClass("selectpicker").on("change",t=>this._recipeSelected(t)).selectpicker({dropupAuto:!1,liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",title:"Select item",virtualScroll:!0})}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_recipeListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getRecipeData(t){return this._recipes.get(t)}_getRequirementText(t){let e='<table class="table table-sm card-table"><tbody>';return t.labourPrice&&(e+=`<tr><td>${t.labourPrice} labour hours</td></tr>`),t.goldPrice&&(e+=`<tr><td>${Object(d.f)(t.goldPrice)}</td></tr>`),t.itemRequirements.length>0&&(e+=`<tr><td>${t.itemRequirements.map(t=>`${t.amount} ${t.name}`).join("</td></tr><tr><td>")}</td></tr>`),e+="</tbody></table>",e}_getPropertiesText(t){let e="",a="",s="";for(const e of this._moduleData){const i=e[1].filter(e=>e.id===t.result.id);for(const t of i)[a]=e,s=`<tr><td>${t.properties.map(t=>{const e=t.isPercentage?Object(r.l)(t.amount/100):t.amount;return`${t.modifier} ${e}`}).join("</td></tr><tr><td>")}</td></tr>`}return s?(e+=`<h6 class="card-subtitle mb-2 text-muted">${a}</h6>`,e+=`<table class="table table-sm card-table na-table"><tbody>${s}</tbody></table>`):e+=`<p>${Object(r.c)(t.result.amount)} ${t.result.name}</p>`,e}_getText(t){const e=this._getRecipeData(t);let a='<div class="row no-gutters card-deck">';return a+='<div class="card col-6"><div class="card-header">Item</div>',a+='<div class="card-body">',a+=this._getRequirementText(e),a+="</div></div>",a+='<div class="card col-6"><div class="card-header">Result</div>',a+='<div class="card-body">',a+=this._getPropertiesText(e),a+="</div></div>",a+="</div></div>",a}_recipeSelected(e){const a=Number(t(e.currentTarget).find(":selected").val());Object(s.a)(`#${this._baseId} div`).remove(),Object(s.a)("#"+this._baseId).append("div").classed("mt-4",!0),Object(s.a)(`#${this._baseId} div`).html(this._getText(a))}}}).call(this,a("xeH2"))},TwRt:function(t,e,a){a.r(e),a.d(e,"init",(function(){return v}));var s=a("pOjD"),i=a("Q4du"),o=a("u3gz"),n=a("ck04"),r=a("q1Yc"),d=a("eA68"),l=a("KbbR"),c=a("VUH8"),h=a("VnNF"),u=a("qTn5"),b=a("D04b"),p=a("MICP"),_=a("hVxF"),m=a("Jz/z"),f=a("K5dq");a("yU80");const v=(t,e)=>{const a=new o.a("ship-compare");(()=>{if(e.has("cmp")&&e.has("v")){const t=e.get("v");t&&t.split(".")[0]===i.d.split(".")[0]&&(Object(s.b)("Menu","Paste ship compare"),a.initFromClipboard(e))}})(),new n.a("wood"),new f.a,new r.a,new d.a,new l.a,new c.a,new h.a,new u.a(t),new b.a,new p.a(t),new _.a,new m.a}},VUH8:function(t,e,a){(function(t){a.d(e,"a",(function(){return D}));a("WUlJ"),a("fCtr"),a("dbdZ");var s=a("2mXy"),i=a("JQHs"),o=a("pOjD"),n=a("pxNS"),r=a("Qs7V"),d=a("oggF"),l=a("Bx8B"),c=a("8ZGG");function h(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}function b(t,e){var a=e.get(t);if(!a)throw new TypeError("attempted to get private field on non-instance");return a.get?a.get.call(t):a.value}function p(t,e,a){var s=e.get(t);if(!s)throw new TypeError("attempted to set private field on non-instance");if(s.set)s.set.call(t,a);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=a}return a}const _=i.a.bind(s.a);var m=new WeakMap,f=new WeakMap,v=new WeakMap,g=new WeakMap,j=new WeakMap,y=new WeakMap,S=new WeakMap,O=new WeakMap,w=new WeakMap,I=new WeakMap,$=new WeakMap,x=new WeakMap,L=new WeakMap;class D{constructor(){m.set(this,{writable:!0,value:void 0}),f.set(this,{writable:!0,value:void 0}),v.set(this,{writable:!0,value:void 0}),g.set(this,{writable:!0,value:void 0}),j.set(this,{writable:!0,value:c.a}),y.set(this,{writable:!0,value:""}),S.set(this,{writable:!0,value:{}}),O.set(this,{writable:!0,value:{}}),w.set(this,{writable:!0,value:0}),I.set(this,{writable:!0,value:void 0}),$.set(this,{writable:!0,value:void 0}),x.set(this,{writable:!0,value:void 0}),L.set(this,{writable:!0,value:void 0}),p(this,m,"List loot and chests"),p(this,f,"loot-list"),p(this,v,"button-"+b(this,f)),p(this,g,"modal-"+b(this,f));for(const t of b(this,j))b(this,S)[t]=`${b(this,f)}-${t}-select`;this._setupListener()}static _printAmount(t){return t.min===t.max?Object(r.c)(t.min):`${Object(r.c)(t.min)} to ${Object(r.c)(t.max)}`}static _printChance(t){return Object(r.c)(100*(1-t))}async _loadAndSetupData(){try{const t=(await a.e(8).then(a.t.bind(null,"fg1m",3))).default;p(this,x,t.loot),p(this,L,t.chests)}catch(t){Object(n.f)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#"+b(this,v)))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(o.b)("Tools",b(this,m)),this._sourceListSelected()})}_getLootOptions(){return _`
            ${b(this,x).sort(Object(l.b)(["name"])).map(t=>_`<option value="${t.id}">${t.name}</option>`)}
        `}_getChestsOptions(){return _`
            ${b(this,L).sort(Object(l.b)(["name"])).map(t=>_`<option value="${t.id}">${t.name}</option>`)}
        `}_getItemsOptions(){const t=new Map,e=(e,a,s)=>{const i=new Map([[e.id,{id:e.id,name:e.name,chance:s,amount:a.amount}]]);t.set(a.id,{name:a.name,sources:t.has(a.id)?new Map([].concat(h(t.get(a.id).sources),h(i))):i})};for(const t of b(this,x)){const{items:a}=t;for(const s of a)e(t,s,s.chance)}for(const t of b(this,L))for(const a of t.itemGroup){const{items:s}=a;for(const i of s)e(t,i,a.chance)}return p(this,$,new Map(h(t.entries()).sort((t,e)=>t[1].name.localeCompare(e[1].name)))),_`${h(b(this,$)).map(t=>_`<option value="${t[0]}">${t[1].name}</option>`)}`}_getOptions(t){let e=_``;return"items"===t&&(e=this._getItemsOptions()),"chests"===t&&(e=this._getChestsOptions()),"loot"===t&&(e=this._getLootOptions()),e}_getModalBody(){return _`
            ${b(this,j).map(t=>_`
                        <label>
                            <select id="${b(this,S)[t]}" class="selectpicker">
                                ${this._getOptions(t)}
                            </select>
                        </label>
                    `)}
            <div id="${b(this,f)}"></div>
        `}_getModalFooter(){return _`
            <button type="button" class="btn btn-secondary" data-dismiss="modal">
                Close
            </button>
        `}_injectModal(){Object(s.b)(Object(d.d)({id:b(this,g),title:b(this,m),size:"modal-md",body:this._getModalBody.bind(this),footer:this._getModalFooter}),document.querySelector("#modal-section"))}_setupSelectListeners(){for(const t of b(this,j))b(this,O)[t].on("change",()=>{p(this,y,t),this._itemSelected()}).selectpicker({dropupAuto:!1,liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",title:"Select "+t,virtualScroll:!0})}_initModal(){this._injectModal(),p(this,I,document.querySelector("#"+b(this,f)));for(const e of b(this,j))b(this,O)[e]=t("#"+b(this,S)[e]);this._setupSelectListeners()}_sourceListSelected(){document.querySelector("#"+b(this,g))||this._initModal(),t("#"+b(this,g)).modal("show")}_getLootItemsText(t,e=!0){return _`
            <table class="table table-sm small na-table no-sort">
                <thead>
                    <tr>
                        <th scope="col">Item</th>
                        ${e?_`<th scope="col" class="text-right">Chance (0 − 100)</th>`:""}
                        <th scope="col" class="text-right">Amount</th>
                    </tr>
                </thead>
                <tbody>
                    ${t.map(t=>_`
                                <tr>
                                    <td>${t.name}</td>
                                    ${e?_` <td class="text-right">
                                              ${D._printChance(t.chance)}
                                          </td>`:""}
                                    <td class="text-right">
                                        ${D._printAmount(t.amount)}
                                    </td>
                                </tr>
                            `)}
                </tbody>
            </table>
        `}_getSourceText(){const t=h(b(this,$).get(b(this,w)).sources).map(t=>t[1]).sort(Object(l.b)(["chance","name"]));return _`${this._getLootItemsText(t)}`}_getChestsText(){const t=b(this,L).find(t=>t.id===b(this,w));return _`
            <p>Weight ${Object(r.c)(t.weight)} tons<br />Lifetime ${Object(r.c)(t.lifetime)} hours</p>
            ${t.itemGroup.map(t=>_` <h5>Group chance: ${D._printChance(t.chance)}</h5>
                    ${this._getLootItemsText(t.items.sort(Object(l.b)(["name"])),!1)}`)}
        `}_getLootText(){const t=b(this,x).find(t=>t.id===b(this,w)).items.sort(Object(l.b)(["chance","name"]));return _`${this._getLootItemsText(t)}`}_getText(){return"items"===b(this,y)?this._getSourceText():"chests"===b(this,y)?this._getChestsText():this._getLootText()}_getTable(){return _`
            <div class="mt-4">
                ${this._getText()}
            </div>
        `}_resetOtherSelects(){const t=b(this,j).filter(t=>t!==b(this,y));for(const e of t)b(this,O)[e].val("default").selectpicker("refresh")}_itemSelected(){const t=b(this,O)[b(this,y)].find(":selected");p(this,w,Number(t.val())),this._resetOtherSelects(),Object(s.b)(this._getTable(),b(this,I))}}}).call(this,a("xeH2"))},VnNF:function(t,e,a){(function(t){a.d(e,"a",(function(){return p}));a("WUlJ"),a("fCtr"),a("dbdZ");var s=a("AKWm"),i=a("pOjD"),o=a("pxNS"),n=a("Q4du"),r=a("Qs7V"),d=a("otg8"),l=a("Bx8B"),c=a("dNoP");function h(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}function b(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}class p{constructor(){b(this,"_baseName",void 0),b(this,"_baseId",void 0),b(this,"_buttonId",void 0),b(this,"_modalId",void 0),b(this,"_moduleData",{}),this._baseName="List modules",this._baseId="module-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{this._moduleData=(await a.e(9).then(a.t.bind(null,"jhXC",3))).default}catch(t){Object(o.f)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(i.b)("Tools",this._baseName),this._moduleListSelected()})}_injectModal(){Object(n.k)({id:this._modalId,title:this._baseName});const t=this._baseId+"-select",e=Object(s.a)(`#${this._modalId} .modal-body`);e.append("label").attr("for",t),e.append("select").attr("name",t).attr("id",t),e.append("div").attr("id",""+this._baseId)}_getOptions(){return""+this._moduleData.map(t=>`<option value="${t[0]}"">${t[0]}</option>;`).join("")}_setupSelect(){const e=t(`#${this._baseId}-select`),a=this._getOptions();e.append(a)}_setupSelectListener(){t(`#${this._baseId}-select`).addClass("selectpicker").on("change",t=>this._moduleSelected(t)).selectpicker({noneSelectedText:"Select module category"}).val("default").selectpicker("refresh")}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_moduleListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getRows(t){const e=new Map([["L",`${Object(d.q)(1)} – ${Object(d.q)(3)}`],["M",`${Object(d.q)(4)} – ${Object(d.q)(5)}`],["S",`${Object(d.q)(6)} – ${Object(d.q)(7)}`]]),a=t=>{var a;return"U"===t?"":""+(null!==(a=e.get(t))&&void 0!==a?a:"")};let s="";const i=[];for(const e of this._moduleData)e[0]===t&&e[1].sort(Object(l.b)(["name"])).forEach((t,o)=>{const n=a=>a<e[1].length&&t.name===e[1][a].name&&JSON.stringify(t.properties)===JSON.stringify(e[1][a].properties);s=a(t.moduleLevel),n(o+1)&&(e[1][o+1].hasSamePropertiesAsPrevious=!0,s+="<br>"+a(e[1][o+1].moduleLevel)),n(o+2)&&(e[1][o+2].hasSamePropertiesAsPrevious=!0,s=""),void 0!==t.hasSamePropertiesAsPrevious&&t.hasSamePropertiesAsPrevious||i.push(`<tr><td><span class="name">${t.name}<br>${s}</span></td><td>${t.properties.map(t=>{let e;return e=t.isPercentage?Object(r.l)(t.amount/100):t.amount<1&&t.amount>0?Object(r.e)(t.amount,1):Object(r.k)(t.amount),`${t.modifier} ${e}`}).join("<br>")}</td></tr>`)});return i}_getText(t){const e=this._getRows(t),a=Object(c.a)(e,3);let s="";for(const t of h(new Array(a.length).keys()))s+=`<div class="col-md-${Math.floor(12/a.length)}">`,s+='<table class="table table-sm small na-table"><thead>',s+="<tr><th>Module</th><th>Modifier</th></tr></thead><tbody>",s+=a[t].join(""),s+="</tbody></table></div>";return s}_moduleSelected(e){const a=t(e.currentTarget).find(":selected").val();Object(s.a)(`#${this._baseId} div`).remove(),Object(s.a)("#"+this._baseId).append("div").classed("row mt-4",!0),Object(s.a)(`#${this._baseId} div`).html(this._getText(a))}}}).call(this,a("xeH2"))},eA68:function(t,e,a){(function(t){a.d(e,"a",(function(){return p}));a("WUlJ"),a("sfzn"),a("fCtr");var s=a("2mXy"),i=a("JQHs"),o=a("XXsb"),n=a.n(o),r=a("pOjD"),d=a("pxNS"),l=a("oggF");function c(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return h(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}function u(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const b=i.a.bind(s.a);class p{constructor(){u(this,"_cannonData",{}),u(this,"_baseName",void 0),u(this,"_baseId",void 0),u(this,"_buttonId",void 0),u(this,"_modalId",void 0),u(this,"_groups",void 0),this._groups=new Map,this._baseName="List cannons",this._baseId="cannon-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{const t=(await a.e(6).then(a.t.bind(null,"XG8V",3))).default;this._setupData(t)}catch(t){Object(d.f)(t)}}_setupData(t){for(const e of t.long)for(const[t,a]of Object.entries(e))"name"!==t&&this._groups.set(t,{values:a,count:Object.entries(a).length});const e=["name","damage","penetration","dispersion","traverse","generic"];for(const a of d.a)this._cannonData[a]=t[a].map(t=>Object.keys(t).sort((t,a)=>e.indexOf(t)-e.indexOf(a)).reduce((e,a)=>(e[a]=t[a],e),{}));this._groups=new Map(c(this._groups.entries()).sort((t,a)=>e.indexOf(t[0])-e.indexOf(a[0])))}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(r.b)("Tools",this._baseName),this._cannonListSelected()})}_getList(t){return b`
            <table id="table-${this._baseId}-${t}-list" class="table table-sm small tablesort na-table">
                <thead>
                    <tr class="thead-group">
                        <th scope="col" class="border-bottom-0"></th>
                        ${c(this._groups).map(t=>(t=>b`
            <th scope="col" class="text-center" colspan="${t[1].count}">
                ${Object(d.b)(t[0])}
            </th>
        `)(t))}
                    </tr>
                    <tr data-sort-method="thead">
                        <th scope="col" class="text-right border-top-0" data-sort-default>Lb</th>
                        ${c(this._groups).map(t=>(t=>b`
            ${Object.entries(t[1].values).map(t=>b`<th class="text-right">${Object(d.b)(t[0])}</th>`)}
        `)(t))}
                    </tr>
                </thead>
                <tbody>
                    ${this._cannonData[t].map(t=>b`
                            <tr>
                                ${(t=>{let e=t;const a=t.split(" "),s="c"+a[0].padStart(3,"0"),i=a[1]?a[1][1]:"0";return a.length>1&&(e=b`${a[0]} <em>${a[1]}</em>`),b`
                <td class="text-right" data-sort="${s}${i}">
                    ${e}
                </td>
            `})(t.name)}${(t=>b`
            ${Object.entries(t).map(t=>"name"===t[0]?b``:Object.entries(t[1]).map(t=>{var e,a;return b`
                            <td class="text-right" data-sort="${null!==(e=t[1].value)&&void 0!==e?e:0}">
                                ${t[1]?Object(l.c)(t[1].value,null!==(a=t[1].digits)&&void 0!==a?a:0):""}
                            </td>
                        `}))}
        `)(t)}
                            </tr>
                        `)}
                </tbody>
            </table>
        `}_getModalBody(){return b`
            <ul class="nav nav-pills" role="tablist">
                ${d.a.map((t,e)=>b`
                            <li class="nav-item">
                                <a
                                    class="nav-link${0===e?" active":""}"
                                    id="tab-${this._baseId}-${t}"
                                    data-toggle="tab"
                                    href="#tab-content-${this._baseId}-${t}"
                                    role="tab"
                                    aria-controls="home"
                                    aria-selected="true"
                                    >${Object(d.b)(t)}</a
                                >
                            </li>
                        `)}
            </ul>
            <div class="tab-content pt-2">
                ${d.a.map((t,e)=>b`
                            <div
                                class="tab-pane fade${0===e?" show active":""}"
                                id="tab-content-${this._baseId}-${t}"
                                role="tabpanel"
                                aria-labelledby="tab-${this._baseId}-${t}"
                            >
                                <div id="${t}-list">
                                    ${this._getList(t)}
                                </div>
                            </div>
                        `)}
            </div>
        `}_getModalFooter(){return b`
            <button type="button" class="btn btn-secondary" data-dismiss="modal">
                Close
            </button>
        `}_injectModal(){Object(s.b)(Object(l.d)({id:this._modalId,title:this._baseName,body:this._getModalBody.bind(this),footer:this._getModalFooter}),document.querySelector("#modal-section"));for(const t of d.a){const e=document.querySelector(`#table-${this._baseId}-${t}-list`);e&&new n.a(e)}}_initModal(){Object(l.j)(),this._injectModal()}_cannonListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}}}).call(this,a("xeH2"))},hVxF:function(t,e,a){(function(t){a.d(e,"a",(function(){return m}));a("WUlJ"),a("fCtr");var s=a("AKWm"),i=a("2mXy"),o=a("JQHs"),n=a("XXsb"),r=a.n(n),d=a("pOjD"),l=a("pxNS"),c=a("Q4du"),h=a("Qs7V"),u=a("oggF"),b=a("Bx8B");function p(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const _=o.a.bind(i.a);class m{constructor(){p(this,"_baseName",void 0),p(this,"_baseId",void 0),p(this,"_buttonId",void 0),p(this,"_modalId",void 0),p(this,"_shipListData",{}),p(this,"_mainDiv",void 0),this._baseName="List ships",this._baseId="ship-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{const t=(await a.e(16).then(a.t.bind(null,"pcjM",3))).default.sort(Object(b.b)(["class","-battleRating","name"]));this._shipListData=t.map(t=>({class:[t.class,t.class],name:[t.name,Object(u.a)(t.name)],guns:[t.guns.total,t.guns.total],battleRating:[t.battleRating,Object(h.c)(t.battleRating)],crew:[t.crew.max,Object(h.c)(t.crew.max)],maxSpeed:[t.ship.maxSpeed,Object(u.c)(t.ship.maxSpeed)],turnSpeed:[t.rudder.turnSpeed,Object(u.c)(t.rudder.turnSpeed)],broadside:[t.guns.broadside.cannons,Object(h.c)(t.guns.broadside.cannons)],bowChaser:[t.guns.gunsPerDeck[4].amount,t.guns.gunsPerDeck[4]?String(t.guns.gunsPerDeck[4].amount):""],sternChaser:[t.guns.gunsPerDeck[5].amount,t.guns.gunsPerDeck[5]?String(t.guns.gunsPerDeck[5].amount):""],sides:[t.sides.armour,`${Object(h.c)(t.sides.armour)} (${t.sides.thickness})`]}))}catch(t){Object(l.f)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(d.b)("Tools",this._baseName),this._shipListSelected()})}_injectModal(){Object(c.k)({id:this._modalId,title:this._baseName,size:"modal-lg"}),this._mainDiv=Object(s.a)(`#${this._modalId} .modal-body`).append("div").attr("id",""+this._baseId)}_initModal(){Object(u.j)(),this._injectModal(),this._injectList()}_shipListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getHead(){return _`
            <thead>
                <tr class="thead-group">
                    <th scope="col" class="border-bottom-0"></th>
                    <th scope="col" class="border-bottom-0"></th>
                    <th scope="col" class="text-right border-bottom-0"></th>
                    <th scope="col" class="text-right border-bottom-0"></th>
                    <th scope="col" class="text-right border-bottom-0"></th>
                    <th scope="col" class="text-center" colspan="2">Speed</th>
                    <th scope="col" class="text-right border-bottom-0"></th>
                    <th scope="col" class="text-center" colspan="2">Chasers</th>
                    <th scope="col" class="text-right border-bottom-0"></th>
                </tr>

                <tr data-sort-method="thead">
                    <th scope="col" class="text-right border-top-0">Class</th>
                    <th scope="col" class="border-top-0">Name</th>
                    <th scope="col" class="text-right border-top-0">Guns</th>
                    <th scope="col" class="text-right border-top-0">Battle rating</th>
                    <th scope="col" class="text-right border-top-0">Crew</th>
                    <th scope="col" class="text-right">Maximum</th>
                    <th scope="col" class="text-right">Turn</th>
                    <th scope="col" class="text-right border-top-0">Broadside</th>
                    <th scope="col" class="text-right border-top-0">Bow</th>
                    <th scope="col" class="text-right">Stern</th>
                    <th scope="col" class="text-right border-top-0">Sides</th>
                </tr>
            </thead>
        `}_getBody(){return _`
            <tbody>
                ${this._shipListData.map(t=>_`<tr>
                        ${Object.entries(t).map(t=>_`<td class="${"name"===t[0]?"":"text-right"}" data-sort="${t[1][0]}">
                                    ${t[1][1]}
                                </td>`)}
                    </tr>`)}
            </tbody>
        `}_getList(){return _`
            <table id="table-${this._baseId}" class="table table-sm small tablesort na-table">
                ${this._getHead()} ${this._getBody()}
            </table>
        `}_injectList(){Object(i.b)(this._getList(),this._mainDiv.node());const t=document.querySelector("#table-"+this._baseId);new r.a(t)}}}).call(this,a("xeH2"))},q1Yc:function(t,e,a){(function(t){a.d(e,"a",(function(){return h}));a("WUlJ"),a("fCtr");var s=a("AKWm"),i=(a("dbdZ"),a("pOjD")),o=a("Q4du"),n=a("pxNS"),r=a("Qs7V"),d=a("oggF"),l=a("Bx8B");function c(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}class h{constructor(){c(this,"_baseName",void 0),c(this,"_baseId",void 0),c(this,"_buttonId",void 0),c(this,"_modalId",void 0),c(this,"_buildingData",void 0),this._baseName="List buildings",this._baseId="building-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._buildingData=[],this._setupListener()}async _loadAndSetupData(){try{this._buildingData=(await a.e(5).then(a.t.bind(null,"7IKn",3))).default}catch(t){Object(n.f)(t)}}_setupListener(){let t=!0;document.querySelector("#"+this._buttonId).addEventListener("click",async()=>{t&&(t=!1,await this._loadAndSetupData()),Object(i.b)("Tools",this._baseName),this._buildingListSelected()})}_injectModal(){Object(o.k)({id:this._modalId,title:this._baseName});const t=this._baseId+"-select",e=Object(s.a)(`#${this._modalId} .modal-body`);e.append("label").attr("for",t),e.append("select").attr("name",t).attr("id",t),e.append("div").attr("id",""+this._baseId).attr("class","container-fluid")}_getOptions(){return""+this._buildingData.sort(Object(l.b)(["name"])).map(t=>`<option value="${t.name}">${t.name}</option>;`).join("")}_setupSelect(){const e=t(`#${this._baseId}-select`),a=this._getOptions();e.append(a)}_setupSelectListener(){const e=t(`#${this._baseId}-select`);e.addClass("selectpicker").on("change",t=>this._buildingSelected(t)).selectpicker({noneSelectedText:"Select building"}),e.val("default").selectpicker("refresh")}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_buildingListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getBuildingData(t){return this._buildingData.find(e=>e.name===t)}_getProductText(t){let e="";return t.result&&(t.result.length>1?(e+='<table class="table table-sm"><tbody>',e+=`<tr><td>${t.result.map(t=>t.name).join("</td></tr><tr><td>")}</td></tr>`,e+="</tbody></table>"):(e+=`<h5 class="card-title">${t.result[0].name}</h5>`,t.result[0].price&&(e+='<table class="table table-sm card-table"><tbody>',e+=`<tr><td>${Object(d.f)(t.result[0].price)} per unit</td></tr>`,t.batch&&(e+=`<tr><td>${t.batch.labour} labour hour${t.batch.labour>1?"s":""} per unit</td></tr>`),e+="</tbody></table>"))),e}_getRequirementText(t){let e="";if(e+='<table class="table table-sm card-table"><thead>',t.levels[0].materials.length>0){e+="<tr><th>Level</th><th>Level build materials</th><th>Build price (reales)</th></tr>",e+="</thead><tbody>";for(const a of t.levels){e+=`<tr><td>${t.levels.indexOf(a)+1}</td><td class="text-left">`,e+=a.materials.map(t=>`${Object(r.c)(t.amount)} ${t.item}`).join("<br>"),e+="</td>",e+=`<td>${Object(r.c)(a.price)}</td>`,e+="</tr>"}}else{e+="<tr><th>Level</th><th>Production</th><th>Labour cost (%)</th><th>Storage</th><th>Build price (reales)</th></tr>",e+="</thead><tbody>";for(const a of t.levels){e+=`<tr><td>${t.levels.indexOf(a)+1}</td><td>${Object(r.c)(a.production)}</td><td>${Object(r.c)(-100*a.labourDiscount)}</td><td>${Object(r.c)(a.maxStorage)}</td><td>${Object(r.c)(a.price)}</td></tr>`}}return e+="</tbody></table>",e}_getText(t){const e=this._getBuildingData(t);let a='<div class="row no-gutters card-deck">';return a+='<div class="card col-5"><div class="card-header">Product</div>',a+='<div class="card-body product">',a+=this._getProductText(e),a+="</div></div>",a+='<div class="card col-7"><div class="card-header">Requirements</div>',a+='<div class="card-body px-0 requirements">',a+=this._getRequirementText(e),a+="</div></div>",a+="</div>",a}_buildingSelected(e){const a=String(t(e.currentTarget).find(":selected").val());Object(s.a)(`#${this._baseId} div`).remove(),Object(s.a)("#"+this._baseId).append("div").classed("buildings mt-4",!0),Object(s.a)(`#${this._baseId} div`).html(this._getText(a))}}}).call(this,a("xeH2"))},qTn5:function(t,e,a){(function(t){a.d(e,"a",(function(){return L}));a("WUlJ"),a("fCtr");var s=a("AKWm"),i=a("XXsb"),o=a.n(i),n=a("2mXy"),r=a("JQHs"),d=a("Wgwc"),l=a.n(d),c=(a("9xm0"),a("+QaA")),h=a.n(c),u=a("QgiU"),b=a.n(u),p=a("Ds8A"),_=a.n(p),m=a("pOjD"),f=a("pxNS"),v=a("Q4du"),g=a("oggF");function j(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function y(t,e){var a=e.get(t);if(!a)throw new TypeError("attempted to get private field on non-instance");return a.get?a.get.call(t):a.value}function S(t,e,a){var s=e.get(t);if(!s)throw new TypeError("attempted to set private field on non-instance");if(s.set)s.set.call(t,a);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=a}return a}const O=r.a.bind(n.a);l.a.extend(h.a),l.a.extend(b.a),l.a.extend(_.a),l.a.locale("en-gb");var w=new WeakMap,I=new WeakMap,$=new WeakMap,x=new WeakMap;class L{constructor(t){w.set(this,{writable:!0,value:void 0}),I.set(this,{writable:!0,value:void 0}),$.set(this,{writable:!0,value:void 0}),x.set(this,{writable:!0,value:void 0}),j(this,"_baseName",void 0),j(this,"_baseId",void 0),j(this,"_buttonId",void 0),j(this,"_modalId",void 0),S(this,x,t),this._baseName="List of port battles",this._baseId="pb-list",this._buttonId="button-"+this._baseId,S(this,I,"table-"+this._baseId),this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{const t=await(await fetch(`data/${y(this,x)}-pb.json`)).json();S(this,$,t.filter(t=>1===t.attackHostility))}catch(t){Object(f.f)(t)}}_setupListener(){var t;let e=!0;null===(t=document.querySelector("#"+this._buttonId))||void 0===t||t.addEventListener("click",async()=>{e&&(e=!1,await this._loadAndSetupData()),Object(m.b)("Tools",this._baseName),this._pbListSelected()})}_injectModal(){Object(v.k)({id:this._modalId,title:this._baseName,size:"modal-xl"});const t=Object(s.a)(`#${this._modalId} .modal-body`);S(this,w,t.append("div").attr("id",this._baseId))}_initModal(){Object(g.j)(),this._injectModal(),this._injectList()}_pbListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getList(){return O`
            <table id="${y(this,I)}" class="table table-sm tablesort na-table">
                ${O` <thead>
                <tr>
                    <th data-sort-default>Time</th>
                    <th>Port</th>
                    <th>Attacker</th>
                    <th>Defender</th>
                </tr>
            </thead>`} ${(()=>O`<tbody>
                ${y(this,$).map(t=>{var e;const a=l.a.utc(t.portBattle).local(),s=l.a.utc(t.portBattle),i=s===a?"":` (${a.format("H.mm")} local)`,o=null===(e=Object(f.c)(t.nation))||void 0===e?void 0:e.name,n=t.capturer?O`${o} (${Object(g.b)(t.capturer)})`:o;return O`
                        <tr>
                            <td data-sort="${t.portBattle}">
                                ${Object(f.b)(s.fromNow())} at ${s.format("H.mm")}
                                ${i}
                            </td>
                            <td>${t.name}</td>
                            <td>${t.attackerNation} (${Object(g.b)(t.attackerClan)})</td>
                            <td>${n}</td>
                        </tr>
                    `})}
            </tbody>`)()}
            </table>
        `}_injectList(){Object(n.b)(this._getList(),y(this,w).node());const t=document.querySelector("#"+y(this,I));new o.a(t)}}}).call(this,a("xeH2"))},yU80:function(t,e,a){}}]);