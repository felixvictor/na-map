/*! For license information please see game-tools.c24e6ea67d58a72150c7.mjs.LICENSE.txt */
(self.webpackChunkna_map=self.webpackChunkna_map||[]).push([[639],{2350:(t,e,a)=>{a.r(e),a.d(e,{init:()=>Fs});var i=a(9492),s=a(2855),n=a(2157),r=a(9022),o=a(7015),l=a(5923),h=a(9843),d=a(29);function c(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function u(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,w(t,e,"get"))}function p(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,w(t,e,"set"),a),a}function w(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var m=new WeakMap,v=new WeakMap,f=new WeakMap,b=new WeakMap,g=new WeakMap,_=new WeakMap,y=new WeakMap;class S{constructor(){c(this,m,{writable:!0,value:void 0}),c(this,v,{writable:!0,value:"List of buildings"}),c(this,f,{writable:!0,value:void 0}),c(this,b,{writable:!0,value:{}}),c(this,g,{writable:!0,value:{}}),c(this,_,{writable:!0,value:void 0}),c(this,y,{writable:!0,value:{}}),p(this,m,(0,r.MF)(u(this,v))),p(this,f,`menu-${u(this,m)}`),this._setupListener()}async _loadAndSetupData(){p(this,b,(await a.e(337).then(a.t.bind(a,6045,19))).default)}async _menuClicked(){(0,s.KS)("Tools",u(this,v)),u(this,_)?u(this,_).show():(await this._loadAndSetupData(),p(this,_,new h.Z(u(this,v),"lg")),this._setupSelect(),this._setupSelectListener())}_setupListener(){var t;null===(t=document.querySelector(`#${u(this,f)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_getOptions(){return`${u(this,b).sort((0,n.MR)(["name"])).map((t=>`<option value="${t.name}">${t.name}</option>;`)).join("")}`}_setupSelect(){p(this,y,new d.Z(u(this,m),u(this,_).baseIdSelects,{noneSelectedText:"Select building"},this._getOptions(),!1)),p(this,g,u(this,_).selectsSel.select("label")),u(this,g).attr("class","ps-2")}_setupSelectListener(){u(this,y).select$.on("change",(()=>{this._buildingSelected()}))}_getBuildingData(t){return u(this,b).find((e=>e.name===t))}_getProductText(t){let e="";return t.result&&(t.result.length>1?(u(this,g).text(""),e+='<table class="table table-sm table-hover text-table"><tbody>',e+=`${t.result.map((t=>`<tr><td>${t.name}</td></tr>`)).join("")}`,e+="</tbody></table>"):(u(this,g).text(`produces ${t.result[0].name}`),t.result[0].price&&(e+='<table class="table table-sm table-hover text-table"><tbody>',e+=`<tr><td>${(0,l.PK)(t.result[0].price)} per unit</td></tr>`,t.batch&&(e+=`<tr><td>${t.batch.labour} labour hour${t.batch.labour>1?"s":""} per unit</td></tr>`),e+="</tbody></table>"))),e}_getRequirementText(t){let e="";if(e+='<table class="table table-sm table-hover"><thead>',t.levels[0].materials.length>0){e+="<tr><th>Level</th><th>Level build materials</th><th>Build price (reales)</th></tr>",e+="</thead><tbody>";for(const a of t.levels){e+=`<tr><td>${t.levels.indexOf(a)+1}</td><td>`,e+=a.materials.map((t=>`${(0,o.yI)(t.amount)} ${t.item}`)).join("<br>"),e+="</td>",e+=`<td>${(0,o.yI)(a.price)}</td>`,e+="</tr>"}}else{e+="<tr><th>Level</th><th>Production</th><th>Labour<br>cost (%)</th><th>Storage</th><th>Build price<br>(reales)</th></tr>",e+="</thead><tbody>";for(const a of t.levels){e+=`<tr><td>${t.levels.indexOf(a)+1}</td><td>${(0,o.yI)(a.production)}</td><td>${(0,o.yI)(-100*a.labourDiscount)}</td><td>${(0,o.yI)(a.maxStorage)}</td><td>${(0,o.yI)(a.price)}</td></tr>`}}return e+="</tbody></table>",e}_getText(t){const e=this._getBuildingData(t);let a='<div class="row no-gutters card-deck">';return a+='<div class="card col-4">',a+='<div class="card-body">',a+=this._getProductText(e),a+="</div></div>",a+='<div class="card col-8">',a+='<div class="card-body">',a+=this._getRequirementText(e),a+="</div></div>",a+="</div>",a}_buildingSelected(){const t=String(u(this,y).getValues()),e=u(this,_).outputSel;e.select("div").remove(),e.append("div").classed("mt-4",!0).html(this._getText(t))}}var k=a(8471),$=a.n(k);function M(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function x(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,T(t,e,"get"))}function W(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,T(t,e,"set"),a),a}function T(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var D=new WeakMap,L=new WeakMap,j=new WeakMap,I=new WeakMap,C=new WeakMap,A=new WeakMap,P=new WeakMap,E=new WeakMap,O=new WeakMap,R=new WeakMap,N=new WeakMap,Z=new WeakMap,q=new WeakMap,B=new WeakMap;class F{constructor(){M(this,D,{writable:!0,value:void 0}),M(this,L,{writable:!0,value:"List of cannons"}),M(this,j,{writable:!0,value:void 0}),M(this,I,{writable:!0,value:["name","damage","penetration","generic","family"]}),M(this,C,{writable:!0,value:{group:new Map,element:new Set}}),M(this,A,{writable:!0,value:void 0}),M(this,P,{writable:!0,value:{}}),M(this,E,{writable:!0,value:{}}),M(this,O,{writable:!0,value:{}}),M(this,R,{writable:!0,value:{}}),M(this,N,{writable:!0,value:{}}),M(this,Z,{writable:!0,value:void 0}),M(this,q,{writable:!0,value:{}}),M(this,B,{writable:!0,value:{}}),W(this,D,(0,r.MF)(x(this,L))),W(this,A,`menu-${x(this,D)}`),W(this,j,`checkbox-${x(this,D)}`),this._setupListener()}async _loadAndSetupData(){const t=(await a.e(945).then(a.t.bind(a,7412,19))).default;this._setupData(t)}_getFormattedName(t){let e=t;const a=t.split(" "),i=`c${a[0].padStart(3,"0")}`,s=a[1]?a[1][1]:"0";return a.length>1&&(e=`${a[0]} <em>${a[1]}</em>`),{value:`${i}${s}`,formattedValue:e}}_setupData(t){const e=Object.entries(t.long[0]).sort(((t,e)=>x(this,I).indexOf(t[0])-x(this,I).indexOf(e[0])));for(const[t,a]of e)if("name"===t)x(this,C).group.set("",1),x(this,C).element.add("Lb");else if("family"!==t){x(this,C).group.set((0,n.fm)(t),Object.entries(a).length);for(const t of Object.keys(a))x(this,C).element.add((0,n.fm)(t))}for(const e of n.qg)x(this,N)[e]=t[e].map((t=>{const e=[],a=Object.entries(t).sort(((t,e)=>x(this,I).indexOf(t[0])-x(this,I).indexOf(e[0])));for(const[t,i]of a)if("name"===t)e.push(this._getFormattedName(i));else if("family"!==t)for(const[,t]of Object.entries(i))t&&e.push({value:t.value,formattedValue:0===t.value?"":(0,o.QM)(t.value,(null==t?void 0:t.digits)??0)});return{family:t.family,data:e}}))}async _menuClicked(){(0,s.KS)("Tools",x(this,L)),x(this,Z)?x(this,Z).show():(await this._loadAndSetupData(),W(this,Z,new h.Z(x(this,L),"xl")),this._injectTab())}_setupListener(){var t;null===(t=document.querySelector(`#${x(this,A)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_sortRows(t,e,a=!0){a&&x(this,B)[t]===e&&(x(this,q)[t]=!x(this,q)[t]),x(this,B)[t]=e;const i=x(this,q)[t]?1:-1;x(this,P)[t].sort(((t,a)=>0===e?t[e].value.localeCompare(a[e].value)*i:(t[e].value-a[e].value)*i))}_getTabId(){return`${x(this,D)}-tab`}_getTabItemId(t){return`${this._getTabId()}-${t}-item`}_getTabContentId(t){return`${this._getTabId()}-${t}-content`}_getListId(t){return`${this._getTabId()}-${t}-list`}_addNavPills(t){const e=t.append("ul").attr("id",this._getTabId()).attr("class","nav nav-tabs").attr("role","tablist");for(const[t,a]of n.qg.entries()){const i=e.append("li").attr("class","nav-item").attr("role","presentation").append("button").attr("class","nav-link").attr("id",this._getTabItemId(a)).attr("data-bs-target",`#${this._getTabContentId(a)}`).attr("data-bs-toggle","tab").attr("role","tab").text((0,n.fm)(a));0===t&&i.attr("class","nav-link active").attr("aria-current","page")}}_injectSwitches(t,e){const a=t.append("div").attr("class","mb-3");for(const t of n.kK[e]){const i=a.append("div").attr("class","form-check form-check-inline form-switch");i.append("input").attr("id",`${x(this,j)}-${e}-${t}`).attr("name",`${x(this,j)}-${e}`).attr("class","form-check-input").attr("type","checkbox").property("checked",!0),i.append("label").attr("for",`${x(this,j)}-${e}-${t}`).attr("class","form-check-label").text((0,n.fm)(t))}x(this,E)[e]=[...document.querySelectorAll(`input[name=${x(this,j)}-${e}]`)];for(const t of x(this,E)[e])t.addEventListener("change",(t=>{t.preventDefault(),this._cannonFamilySelected(e)}))}_injectTableStructure(t,e){x(this,q)[e]=!0,x(this,O)[e]=t.append("table").attr("class","table table-sm table-sort table-striped table-hover");const a=x(this,O)[e].append("thead");a.append("tr").attr("class","thead-group").selectAll("th").data([...x(this,C).group]).join("th").classed("border-bottom-0",((t,e)=>0===e)).classed("text-center",((t,e)=>0!==e)).attr("colspan",(t=>`${t[1]}`)).attr("scope","col").text((t=>t[0])),a.append("tr").selectAll("th").data([...x(this,C).element]).join("th").datum(((t,e)=>({data:t,index:e}))).classed("border-top-0",((t,e)=>0===e)).classed("text-end",((t,e)=>0!==e)).text((t=>t.data)).on("click",((t,a)=>{this._sortRows(e,a.index)})),x(this,O)[e].append("tbody")}_insertTabContent(t,e,a){x(this,q)[e]=!0;const i=t.append("div").attr("class","tab-pane fade"+(0===a?" show active":"")).attr("id",this._getTabContentId(e)).attr("role","tabpanel").attr("aria-labelledby",this._getTabItemId(e)).append("div").attr("id",this._getListId(e));this._injectSwitches(i,e),this._injectTableStructure(i,e)}_injectTab(){const t=x(this,Z).outputSel;this._addNavPills(t);const e=t.append("div").attr("class","tab-content pt-2");for(const[t,a]of n.qg.entries())x(this,B)[a]=0,this._insertTabContent(e,a,t),this._cannonFamilySelected(a);const a=document.querySelector(`#${this._getTabId()} li:first-child button`);new($())(a).show()}_updateTable(t){x(this,P)[t]=x(this,O)[t].select("tbody").selectAll("tr").data(x(this,R)[t],(t=>t[0].formattedValue)).join((t=>t.append("tr"))),x(this,P)[t].selectAll("td").data((t=>t)).join((t=>t.append("td").html((t=>t.formattedValue))))}_cannonFamilySelected(t){const e=new Set;for(const a of x(this,E)[t])if(a.checked){const i=a.id.replace(`${x(this,j)}-${t}-`,"");e.add(i)}x(this,R)[t]=x(this,N)[t].filter((t=>e.has(t.family))).map((t=>t.data)),this._updateTable(t),this._sortRows(t,x(this,B)[t],!1)}}var z=a(7484),K=a.n(z),V=(a(9517),a(4110)),H=a.n(V),U=a(178),Q=a.n(U),J=a(4194),G=a(3389);function Y(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function X(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,et(t,e,"get"))}function tt(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,et(t,e,"set"),a),a}function et(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}K().extend(H()),K().extend(Q()),K().locale("en-gb");var at=new WeakMap,it=new WeakMap,st=new WeakMap,nt=new WeakMap,rt=new WeakMap,ot=new WeakMap,lt=new WeakMap,ht=new WeakMap,dt=new WeakMap,ct=new WeakMap,ut=new WeakMap,pt=new WeakMap,wt=new WeakMap,mt=new WeakMap,vt=new WeakMap,ft=new WeakMap;class bt{constructor(t){Y(this,at,{writable:!0,value:void 0}),Y(this,it,{writable:!0,value:"List of conquest flags"}),Y(this,st,{writable:!0,value:void 0}),Y(this,nt,{writable:!0,value:void 0}),Y(this,rt,{writable:!0,value:void 0}),Y(this,ot,{writable:!0,value:[]}),Y(this,lt,{writable:!0,value:{}}),Y(this,ht,{writable:!0,value:[]}),Y(this,dt,{writable:!0,value:[]}),Y(this,ct,{writable:!0,value:[]}),Y(this,ut,{writable:!0,value:void 0}),Y(this,pt,{writable:!0,value:{}}),Y(this,wt,{writable:!0,value:!0}),Y(this,mt,{writable:!0,value:0}),Y(this,vt,{writable:!0,value:{}}),Y(this,ft,{writable:!0,value:{}}),tt(this,rt,t),tt(this,at,(0,r.MF)(X(this,it))),tt(this,nt,`menu-${X(this,at)}`),tt(this,st,`${X(this,at)}-input`),"eu1"===t?this._setupListener():this._removeMenu()}_removeMenu(){document.querySelector(`#${X(this,nt)}`).remove()}async _loadData(){tt(this,ct,await(0,r.qP)(`${X(this,rt)}-flags.json`))}_setupData(){for(const t of X(this,ct))for(const e of t.flags)X(this,dt).push([e.expire,t.nation,this._fromNow(e.expire),this._getDate(e.expire),this._getTime(e.expire),e.number])}async _loadAndSetupData(){await this._loadData(),this._setupData()}async _menuClicked(){(0,s.KS)("Tools",X(this,it)),X(this,ut)?X(this,ut).show():(await this._loadAndSetupData(),tt(this,ut,new h.Z(X(this,it),"lg")),this._listSelected())}_setupListener(){var t;null===(t=document.querySelector(`#${X(this,nt)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_sortRows(t,e=!0){let a=0;3===t&&(a=5),e&&X(this,mt)===a&&tt(this,wt,!X(this,wt)),tt(this,mt,a);const i=X(this,wt)?1:-1;X(this,pt).sort(((e,s)=>3===t?(e[a]-s[a])*i:e[a].localeCompare(s[a])*i))}_initTable(){tt(this,wt,!0),X(this,vt).append("thead").append("tr").selectAll("th").data(["Expires in","Date","Time","Flags"]).join("th").datum(((t,e)=>({data:t,index:e}))).classed("text-start",((t,e)=>e<=1)).attr("scope","col").text((t=>t.data)).on("click",((t,e)=>{this._sortRows(e.index)})),X(this,vt).append("tbody")}_fromNow(t){return`${K().utc(t).fromNow().replace("in ","").replace("a ","1 ")}`}_getDate(t){return`${K().utc(t).format("dddd, D MMM")}`}_getTime(t){const e=K().utc(t).local(),a=K().utc(t),i=a===e?"":` (${e.format("H.mm")} local)`;return`${a.format("H.mm")} ${i}`}_updateTable(){tt(this,pt,X(this,vt).select("tbody").selectAll("tr").data(X(this,ht),(t=>t[0])).join((t=>t.append("tr")))),X(this,pt).selectAll("td").data((t=>t.slice(2))).join((t=>t.append("td").classed("text-start",((t,e)=>e<=1)).text((t=>t))))}_getActiveNation(){return Number(X(this,ft).get())}_injectToggleButtons(){const t=n.nU.filter((t=>!("NT"===t.short||"FT"===t.short))).sort(((t,e)=>t.sortName.localeCompare(e.sortName)));tt(this,ot,t.map((t=>String(t.id))));const e=X(this,ut).selectsSel.append("div").attr("id",X(this,st)).attr("class","d-flex flex-wrap justify-content-between mb-3");for(const a of t)e.append("input").attr("type","radio").attr("class","btn-check").attr("name",X(this,st)).attr("id",`${X(this,st)}-${a.id}`).attr("value",a.id).attr("autocomplete","off"),e.append("label").attr("for",`${X(this,st)}-${a.id}`).attr("class","btn btn-toggle").attr("title",a.name).append("i").attr("class",`flag-icon-${a.short} flag-icon-button`).attr("role","img")}_showSelected(){const t=this._getActiveNation();tt(this,ht,X(this,dt).filter((e=>e[1]===t))),X(this,lt).set(String(t)),this._updateTable(),this._sortRows(0,!1)}_setupButtonListener(){var t;null===(t=document.querySelector(`#${X(this,st)}`))||void 0===t||t.addEventListener("change",(async()=>{this._showSelected()}))}_listSelected(){tt(this,vt,X(this,ut).outputSel.append("table").attr("class","table table-sm table-striped table-hover table-sort text-table mt-3")),this._initTable(),this._injectToggleButtons(),tt(this,ft,new J.Z(X(this,st),X(this,ot))),tt(this,lt,new G.Z({id:X(this,st),values:X(this,ot)})),X(this,ft).set(X(this,lt).get()),this._setupButtonListener(),this._showSelected()}}var gt=a(3824),_t=a.n(gt),yt=a(1198);function St(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function kt(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Mt(t,e,"get"))}function $t(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,Mt(t,e,"set"),a),a}function Mt(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var xt=new WeakMap,Wt=new WeakMap,Tt=new WeakMap,Dt=new WeakMap,Lt=new WeakMap,jt=new WeakMap;class It{constructor(){St(this,xt,{writable:!0,value:[]}),St(this,Wt,{writable:!0,value:void 0}),St(this,Tt,{writable:!0,value:[]}),St(this,Dt,{writable:!0,value:void 0}),St(this,Lt,{writable:!0,value:"List of recipe ingredients"}),St(this,jt,{writable:!0,value:void 0}),$t(this,Dt,(0,r.MF)(kt(this,Lt))),$t(this,jt,`menu-${kt(this,Dt)}`),this._setupListener()}async _loadAndSetupData(){$t(this,Tt,(await a.e(303).then(a.t.bind(a,3092,19))).default),$t(this,xt,(await a.e(757).then(a.t.bind(a,7002,19))).default.ingredient)}async _menuClicked(){(0,s.KS)("Tools",kt(this,Lt)),kt(this,Wt)?kt(this,Wt).show():(await this._loadAndSetupData(),$t(this,Wt,new h.Z(kt(this,Lt),"xl")),this._ingredientListSelected())}_setupListener(){var t;null===(t=document.querySelector(`#${kt(this,jt)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_getProperties(t){let e,a="",i="";for(const e of kt(this,Tt)){const s=e[1].sort((0,n.MR)(["name"])).filter((e=>e.name===t));for(const t of s)a=e[0],i=`${t.properties.map((t=>{const e=t.isPercentage?(0,o.QO)(t.amount/100).replace(/"/g,"'"):(0,o.IH)(t.amount);return`<tr><td class='text-start pe-3'>${t.modifier}</td><td>${e}</td></tr>`})).join("")}`}return e=`<h6 class='text-muted'>${a}</h6>`,e+=`<table class='table table-striped w-auto'><tbody>${i}</tbody></table>`,i?e:""}_getRows(){return kt(this,xt).map((t=>`<tr><td>${t.name}</td><td>${t.recipeNames.map((t=>{const e=this._getProperties(t);return e?`<a data-bs-toggle="tooltip" title="${e}">${t}</a>`:t})).join("<br>")}</td></tr>`))}_getText(){const t=this._getRows(),e=(0,yt.xp)(t,2);let a="";for(const t of Array.from({length:e.length}).keys())a+=`<div class="col-md-${Math.floor(12/e.length)}">`,a+='<table class="table table-sm table-striped table-hover text-table text-start"><thead>',a+="<tr><th>Ingredient</th><th>Recipes</th></tr></thead><tbody>",a+=e[t].join(""),a+="</tbody></table></div>";return a}_ingredientListSelected(){const t=kt(this,Wt).outputSel;t.select("div").remove(),t.append("div").attr("class","row").html(this._getText());Array.prototype.slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(t){return new(_t())(t,{html:!0,placement:"auto",sanitize:!1})}))}}var Ct=a(6400),At=a(5619),Pt=a(4332);function Et(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function Ot(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Nt(t,e,"get"))}function Rt(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,Nt(t,e,"set"),a),a}function Nt(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}const Zt=At.Z.bind(Ct.h);var qt=new WeakMap,Bt=new WeakMap,Ft=new WeakMap,zt=new WeakMap,Kt=new WeakMap,Vt=new WeakMap,Ht=new WeakMap,Ut=new WeakMap,Qt=new WeakMap,Jt=new WeakMap,Gt=new WeakMap,Yt=new WeakMap;class Xt{constructor(){Et(this,qt,{writable:!0,value:{}}),Et(this,Bt,{writable:!0,value:new Map}),Et(this,Ft,{writable:!0,value:void 0}),Et(this,zt,{writable:!0,value:new Map}),Et(this,Kt,{writable:!0,value:{}}),Et(this,Vt,{writable:!0,value:0}),Et(this,Ht,{writable:!0,value:""}),Et(this,Ut,{writable:!0,value:void 0}),Et(this,Qt,{writable:!0,value:"List of loot and chests"}),Et(this,Jt,{writable:!0,value:void 0}),Et(this,Gt,{writable:!0,value:new Set(["chest","fish","loot"])}),Et(this,Yt,{writable:!0,value:Pt.tJ}),Rt(this,Ut,(0,r.MF)(Ot(this,Qt))),Rt(this,Jt,`menu-${Ot(this,Ut)}`),this._setupListener()}static _printAmount(t){return t.min===t.max?(0,o.yI)(t.min):`${(0,o.yI)(t.min)} – ${(0,o.yI)(t.max)}`}static _printChance(t){return(0,o.yI)(100*(1-t))}async _loadAndSetupData(){const t=(await a.e(393).then(a.t.bind(a,5530,19))).default;for(const e of Ot(this,Yt))Ot(this,qt)[e]=t[e]}async _menuClicked(){(0,s.KS)("Tools",Ot(this,Qt)),Ot(this,Ft)?Ot(this,Ft).show():(await this._loadAndSetupData(),Rt(this,Ft,new h.Z(Ot(this,Qt),"md")),this._setupSelect(),this._setupSelectListener())}_setupListener(){var t;null===(t=document.querySelector(`#${Ot(this,Jt)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_getTypeOptions(t){return Ot(this,qt)[t].sort((0,n.MR)(["name"])).map((t=>`<option value="${t.id}">${t.name}</option>`)).join("")}_setOptionItems(t,e,a){const i=new Map([[t.id,{id:t.id,name:t.name,chance:a,amount:e.amount}]]);Ot(this,zt).set(e.id,{name:e.name,sources:Ot(this,zt).has(e.id)?new Map([...Ot(this,zt).get(e.id).sources,...i]):i})}_getItemsOptions(){for(const t of[...Ot(this,qt).loot,...Ot(this,qt).fish]){const{items:e}=t;for(const a of e)this._setOptionItems(t,a,a.chance)}for(const t of Ot(this,qt).chest)for(const e of t.itemGroup){const{chance:a,items:i}=e;for(const e of i)this._setOptionItems(t,e,a)}return Rt(this,Bt,new Map([...Ot(this,zt).entries()].sort(((t,e)=>t[1].name.localeCompare(e[1].name))))),[...Ot(this,Bt)].map((t=>`<option value="${t[0]}">${t[1].name}</option>`)).join("")}_getOptions(t){let e="";return Ot(this,Gt).has(t)?e=this._getTypeOptions(t):"item"===t&&(e=this._getItemsOptions()),e}_setupSelect(){Ot(this,Ft).selectsSel.attr("class","d-flex flex-wrap mb-3");for(const t of Ot(this,Yt)){const e={dropupAuto:!1,liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",title:`Select ${"loot"===t?"ship loot":"fish"===t?"fishing region":t}`,virtualScroll:!0};"item"===t&&(e.width="440px"),Ot(this,Kt)[t]=new d.Z(`${Ot(this,Ut)}-${t}`,Ot(this,Ft).baseIdSelects,e,this._getOptions(t))}}_setupSelectListener(){for(const t of Ot(this,Yt))Ot(this,Kt)[t].select$.on("change",(()=>{Rt(this,Ht,t),this._itemSelected()}))}_getLootItemsText(t,e,a=!0){return Zt`
            <table class="table table-sm table-striped table-hover">
                <thead>
                    <tr>
                        <th scope="col" class="text-start">${e}</th>
                        ${a?Zt`<th scope="col">Chance<br />(0 − 100)</th>`:""}
                        <th scope="col">Amount</th>
                    </tr>
                </thead>
                <tbody>
                    ${t.map((t=>Zt`
                                <tr>
                                    <td class="text-start">${t.name}</td>
                                    ${a?Zt` <td>${Xt._printChance(t.chance)}</td>`:""}
                                    <td>${Xt._printAmount(t.amount)}</td>
                                </tr>
                            `))}
                </tbody>
            </table>
        `}_getSourceText(){const t=Ot(this,Bt).get(Ot(this,Vt));if(t){const e=[...t.sources].map((t=>t[1])).sort((0,n.MR)(["chance","name"]));return Zt`${this._getLootItemsText(e,"Source")}`}return Zt``}_getChestsText(){const t=Ot(this,qt).chest.find((t=>t.id===Ot(this,Vt)));return t?Zt`
                <p>
                    Weight ${(0,o.yI)(t.weight)} tons<br />Lifetime ${(0,o.yI)(t.lifetime)}
                    hours
                </p>
                ${t.itemGroup.map((t=>Zt` <h5>Group chance: ${Xt._printChance(t.chance)}</h5>
                        ${this._getLootItemsText(t.items.sort((0,n.MR)(["name"])),"Item",!1)}`))}
            `:Zt``}_getLootText(){const t=Ot(this,qt)[Ot(this,Ht)].find((t=>t.id===Ot(this,Vt)));if(t){const e=t.items.sort((0,n.MR)(["chance","name"]));return Zt`${this._getLootItemsText(e,"Item")}`}return Zt``}_getText(){return"item"===Ot(this,Ht)?this._getSourceText():"chest"===Ot(this,Ht)?this._getChestsText():this._getLootText()}_getTable(){return Zt`<div class="mt-4">${this._getText()}</div>`}_resetOtherSelects(){const t=Ot(this,Yt).filter((t=>t!==Ot(this,Ht)));for(const e of t)Ot(this,Kt)[e].reset()}_itemSelected(){Rt(this,Vt,Number(Ot(this,Kt)[Ot(this,Ht)].getValues()));const t=Ot(this,Ft).outputSel;this._resetOtherSelects(),(0,Ct.sY)(this._getTable(),t.node())}}var te=a(393);function ee(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function ae(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,se(t,e,"get"))}function ie(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,se(t,e,"set"),a),a}function se(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var ne=new WeakMap,re=new WeakMap,oe=new WeakMap,le=new WeakMap,he=new WeakMap,de=new WeakMap;class ce{constructor(){ee(this,ne,{writable:!0,value:void 0}),ee(this,re,{writable:!0,value:"List of modules"}),ee(this,oe,{writable:!0,value:void 0}),ee(this,le,{writable:!0,value:void 0}),ee(this,he,{writable:!0,value:{}}),ee(this,de,{writable:!0,value:{}}),ie(this,ne,(0,r.MF)(ae(this,re))),ie(this,oe,`menu-${ae(this,ne)}`),this._setupListener()}async _loadAndSetupData(){ie(this,de,(await a.e(303).then(a.t.bind(a,3092,19))).default)}async _menuClicked(){(0,s.KS)("Tools",ae(this,re)),ae(this,le)?ae(this,le).show():(await this._loadAndSetupData(),ie(this,le,new h.Z(ae(this,re),"xl")),this._setupSelect(),this._setupSelectListener())}_setupListener(){var t;null===(t=document.querySelector(`#${ae(this,oe)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_getOptions(){return`${ae(this,de).map((t=>`<option value="${t[0]}">${t[0]}</option>`)).join("")}`}_setupSelect(){ie(this,he,new d.Z(ae(this,ne),ae(this,le).baseIdSelects,{noneSelectedText:"Select module category",width:"fit"},this._getOptions()))}_setupSelectListener(){ae(this,he).select$.on("change",(()=>{this._moduleSelected()}))}_getRows(t){const e=new Map([["L",`${(0,te.hi)(1)} – ${(0,te.hi)(3)}`],["M",`${(0,te.hi)(4)} – ${(0,te.hi)(5)}`],["S",`${(0,te.hi)(6)} – ${(0,te.hi)(7)}`]]),a=t=>"U"===t?"":`${e.get(t)??""}`,i=(t,e)=>void 0!==e&&t.name===e.name&&JSON.stringify(t.properties)===JSON.stringify(e.properties);let s="";const r=[];for(const e of ae(this,de))if(e[0]===t)for(const[t,l]of e[1].sort((0,n.MR)(["name"])).entries())s=a(l.moduleLevel),i(l,e[1][t+1])&&(e[1][t+1].hasSamePropertiesAsPrevious=!0,s+=`<br>${a(e[1][t+1].moduleLevel)}`),i(l,e[1][t+2])&&(e[1][t+2].hasSamePropertiesAsPrevious=!0,s=""),void 0!==l.hasSamePropertiesAsPrevious&&l.hasSamePropertiesAsPrevious||r.push(`<tr><td class="pe-2">${l.name}<br>${s}</td><td><table class="table table-sm table-hover text-table text-start mb-0"><tbody>${l.properties.map((t=>{let e;return e=t.isPercentage?(0,o.QO)(t.amount/100):t.amount<1&&t.amount>0?(0,o.nM)(t.amount,1):(0,o.IH)(t.amount),`<tr><td>${t.modifier}</td><td>${e}</td></tr>`})).join("")}</tbody></table></td></tr>`);return r}_getText(t){const e=this._getRows(t),a=(0,yt.xp)(e,3);let i="";for(const t of Array.from({length:a.length}).keys())i+=`<div class="col-md-${Math.floor(12/a.length)}">`,i+='<table class="table table-sm table-striped table-hover text-table text-start"><thead>',i+='<tr><th class="pe-2">Module</th><th>Modifier</th></tr></thead><tbody>',i+=a[t].join(""),i+="</tbody></table></div>";return i}_moduleSelected(){const t=String(ae(this,he).getValues()),e=ae(this,le).outputSel;e.select("div").remove(),e.append("div").classed("row mt-4",!0).html(this._getText(t))}}var ue=a(285),pe=a.n(ue);function we(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function me(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function ve(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,be(t,e,"get"))}function fe(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,be(t,e,"set"),a),a}function be(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}K().extend(pe()),K().extend(H()),K().extend(Q()),K().locale("en-gb");var ge=new WeakMap,_e=new WeakMap,ye=new WeakMap,Se=new WeakMap,ke=new WeakMap,$e=new WeakMap,Me=new WeakMap,xe=new WeakMap,We=new WeakMap,Te=new WeakMap,De=new WeakMap;class Le{constructor(t){me(this,ge,{writable:!0,value:[]}),me(this,_e,{writable:!0,value:void 0}),me(this,ye,{writable:!0,value:{}}),me(this,Se,{writable:!0,value:!0}),me(this,ke,{writable:!0,value:0}),me(this,$e,{writable:!0,value:{}}),me(this,Me,{writable:!0,value:void 0}),me(this,xe,{writable:!0,value:void 0}),me(this,We,{writable:!0,value:"List of port battles"}),me(this,Te,{writable:!0,value:void 0}),me(this,De,{writable:!0,value:void 0}),we(this,"_compareTime",((t,e,a)=>t[4].localeCompare(e[4])*a)),we(this,"_getNationSortName",(t=>{var e,a;const i=(null===(e=/flag-icon-(\w{2})/.exec(t))||void 0===e?void 0:e[1])??"";return(null===(a=(0,n.$i)(i))||void 0===a?void 0:a.sortName)??""})),fe(this,De,t),fe(this,xe,(0,r.MF)(ve(this,We))),fe(this,Te,`menu-${ve(this,xe)}`),fe(this,Me,`${ve(this,xe)}-table`),this._setupListener()}async _loadAndSetupData(){const t=await(0,r.qP)(`${ve(this,De)}-pb.json`);fe(this,ge,t.filter((t=>1===t.attackHostility)).map((t=>{var e,a;const i=K().utc(t.portBattle).local(),s=K().utc(t.portBattle),r=s===i?"":` (${i.format("H.mm")} local)`,o=`<span class="flag-icon-${t.nation} flag-icon-small me-1" role="img" title="${(null===(e=(0,n.$i)(t.nation))||void 0===e?void 0:e.sortName)??""}"></span>`,l=t.capturer&&"RAIDER"!==t.capturer?`${(0,yt.Mo)(t.capturer)}`:"",h=`<span class="flag-icon-${t.attackerNation} flag-icon-small me-1" role="img" title="${(null===(a=(0,n.$i)(t.attackerNation))||void 0===a?void 0:a.sortName)??""}"></span>`,d=`${(0,yt.Mo)((null==t?void 0:t.attackerClan)??"")}`;return{sort:t.portBattle??"",data:[`${(0,n.fm)(s.fromNow())} at ${s.format("H.mm")} ${r}`,t.name,h+d,o+l,s.toISOString()]}})))}async _menuClicked(){(0,s.KS)("Tools",ve(this,We)),ve(this,_e)?ve(this,_e).show():(await this._loadAndSetupData(),fe(this,_e,new h.Z(ve(this,We),"lg")),this._pbListSelected())}_setupListener(){var t;null===(t=document.querySelector(`#${ve(this,Te)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_sortRows(t,e=!0){e&&ve(this,ke)===t&&fe(this,Se,!ve(this,Se)),fe(this,ke,t);const a=ve(this,Se)?1:-1;ve(this,ye).sort(((e,i)=>{if(0===t)return this._compareTime(e.data,i.data,a);const s=this._getNationSortName(e.data[t]),n=this._getNationSortName(i.data[t]);let r=s.localeCompare(n)*a;return 1===t||0===r&&(r=this._compareTime(e.data,i.data,1)),r}))}_initTable(){ve(this,$e).append("thead").append("tr").selectAll("th").data(["Time","Port","Attacker","Defender"]).join("th").datum(((t,e)=>({data:t,index:e}))).attr("scope","col").text((t=>t.data)).on("click",((t,e)=>{this._sortRows(e.index)})),ve(this,$e).append("tbody")}_updateTable(){fe(this,ye,ve(this,$e).select("tbody").selectAll("tr").data(ve(this,ge),(t=>t.sort)).join((t=>t.append("tr")))),ve(this,ye).selectAll("td").data((t=>t.data.slice(0,-1))).join((t=>t.append("td").html((t=>t))))}_pbListSelected(){fe(this,$e,ve(this,_e).outputSel.append("table").attr("class","table table-sm table-striped table-hover text-table table-sort")),this._initTable(),this._updateTable(),this._sortRows(0,!1)}}var je=a(2255);function Ie(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function Ce(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Pe(t,e,"get"))}function Ae(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,Pe(t,e,"set"),a),a}function Pe(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var Ee=new WeakMap,Oe=new WeakMap,Re=new WeakMap,Ne=new WeakMap,Ze=new WeakMap,qe=new WeakMap,Be=new WeakMap,Fe=new WeakMap,ze=new WeakMap,Ke=new WeakMap,Ve=new WeakMap,He=new WeakMap,Ue=new WeakMap;class Qe{constructor(t){Ie(this,Ee,{writable:!0,value:void 0}),Ie(this,Oe,{writable:!0,value:"List of port bonuses"}),Ie(this,Re,{writable:!0,value:void 0}),Ie(this,Ne,{writable:!0,value:void 0}),Ie(this,Ze,{writable:!0,value:void 0}),Ie(this,qe,{writable:!0,value:[]}),Ie(this,Be,{writable:!0,value:[]}),Ie(this,Fe,{writable:!0,value:[]}),Ie(this,ze,{writable:!0,value:[]}),Ie(this,Ke,{writable:!0,value:{}}),Ie(this,Ve,{writable:!0,value:!0}),Ie(this,He,{writable:!0,value:0}),Ie(this,Ue,{writable:!0,value:{}}),Ae(this,Ze,t),Ae(this,Ee,(0,r.MF)(Ce(this,Oe))),Ae(this,Re,`menu-${Ce(this,Ee)}`),"eu1"===t?this._setupListener():this._removeMenu()}_removeMenu(){document.querySelector(`#${Ce(this,Re)}`).remove()}async _loadData(){Ae(this,qe,await(0,r.qP)(`${Ce(this,Ze)}-ports.json`)),Ae(this,Fe,await(0,r.qP)(`${Ce(this,Ze)}-pb.json`)),Ae(this,Be,(await a.e(462).then(a.t.bind(a,9131,19))).default)}_setupData(){const t=[0,1,3,7,15],e={};for(const t of Pt.y7)e[t]=0;const a=new Map(Ce(this,Be).map((t=>[t.id,{name:t.name,points:t.portPoints}]))),i=new Map(Ce(this,Fe).map((t=>[t.id,t.nation])));Ae(this,ze,Ce(this,qe).filter((t=>t.portBonus)).map((s=>{var n,r;return{id:s.id,name:(null===(n=a.get(s.id))||void 0===n?void 0:n.name)??"",nation:i.get(s.id)??"",portBonusLevel:Object.values({...e,...s.portBonus}),points:(null===(r=a.get(s.id))||void 0===r?void 0:r.points)??0,pointsInvested:(0,je.Z)(Object.values(s.portBonus).map((e=>t[e])))}})))}async _loadAndSetupData(){await this._loadData(),this._setupData()}async _menuClicked(){(0,s.KS)("Tools",Ce(this,Oe)),Ce(this,Ne)?Ce(this,Ne).show():(await this._loadAndSetupData(),Ae(this,Ne,new h.Z(Ce(this,Oe),"lg")),this._listSelected())}_setupListener(){var t;null===(t=document.querySelector(`#${Ce(this,Re)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_sortRows(t,e=!0){e&&Ce(this,He)===t&&Ae(this,Ve,!Ce(this,Ve)),Ae(this,He,t);const a=Ce(this,Ve)?1:-1;Ce(this,Ke).sort(((e,i)=>{if(0===t)return e.name.localeCompare(i.name)*a;if(1===t){var s,r;const t=(null===(s=(0,n.$i)(e.nation))||void 0===s?void 0:s.sortName)??"",o=(null===(r=(0,n.$i)(i.nation))||void 0===r?void 0:r.sortName)??"";return t.localeCompare(o)*a}return 7===t?(e.points-i.points)*a:8===t?(e.pointsInvested-i.pointsInvested)*a:(e.portBonusLevel[t-2]-i.portBonusLevel[t-2])*a}))}_initTable(){Ae(this,Ve,!0),Ce(this,Ue).append("thead").append("tr").selectAll("th").data(["Port","Nation",...Pt.y7,"Port points","Points invested"]).join("th").datum(((t,e)=>({data:t,index:e}))).classed("text-start",((t,e)=>e<=1)).attr("scope","col").style("width",((t,e)=>e>=2?"4rem":"")).text((t=>(0,n.fm)(t.data))).on("click",((t,e)=>{this._sortRows(e.index)})),Ce(this,Ue).append("tbody")}_updateTable(){Ae(this,Ke,Ce(this,Ue).select("tbody").selectAll("tr").data(Ce(this,ze),(t=>t.id)).join((t=>t.append("tr")))),Ce(this,Ke).selectAll("td").data((t=>[t.name,t.nation,...t.portBonusLevel,t.points,t.pointsInvested])).join((t=>t.append("td").classed("text-start",((t,e)=>e<=1)).html(((t,e)=>{var a;return 0===t?"":1===e?`<span class="flag-icon-${String(t)} flag-icon-small" role="img" title="${(null===(a=(0,n.$i)(String(t)))||void 0===a?void 0:a.sortName)??""}"></span>`:String(t)}))))}_listSelected(){Ae(this,Ue,Ce(this,Ne).outputSel.append("table").attr("class","table table-sm small table-striped table-hover table-sort")),this._initTable(),this._updateTable(),this._sortRows(0,!1)}}var Je=a(3838),Ge=a(1460);function Ye(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function Xe(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,ea(t,e,"get"))}function ta(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,ea(t,e,"set"),a),a}function ea(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}const aa=(t,e,a)=>`${(0,te.hi)(e)} – ${(0,te.hi)(a)}`;var ia=new WeakMap,sa=new WeakMap,na=new WeakMap,ra=new WeakMap,oa=new WeakMap,la=new WeakMap,ha=new WeakMap,da=new WeakMap,ca=new WeakMap;class ua{constructor(t){Ye(this,ia,{writable:!0,value:void 0}),Ye(this,sa,{writable:!0,value:"List of admiralty items and recipes"}),Ye(this,na,{writable:!0,value:void 0}),Ye(this,ra,{writable:!0,value:void 0}),Ye(this,oa,{writable:!0,value:void 0}),Ye(this,la,{writable:!0,value:{}}),Ye(this,ha,{writable:!0,value:[]}),Ye(this,da,{writable:!0,value:[]}),Ye(this,ca,{writable:!0,value:void 0}),ta(this,ra,(0,Ge.Oy)(t)),ta(this,ia,(0,r.MF)(Xe(this,sa))),ta(this,na,`menu-${Xe(this,ia)}`),this._setupListener()}async _loadAndSetupData(){ta(this,ha,(await a.e(303).then(a.t.bind(a,3092,19))).default),ta(this,da,(await a.e(757).then(a.t.bind(a,7002,19))).default.recipe),ta(this,ca,new Map(Xe(this,da).flatMap((t=>t.recipes.map((t=>[t.id,t]))))))}async _menuClicked(){(0,s.KS)("Tools",Xe(this,sa)),Xe(this,oa)?Xe(this,oa).show():(await this._loadAndSetupData(),ta(this,oa,new h.Z(Xe(this,sa),"lg")),this._setupSelect(),this._setupSelectListener())}_setupListener(){var t;null===(t=document.querySelector(`#${Xe(this,na)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_getOptions(){return Xe(this,da).map((t=>`<optgroup label="${t.group}">${t.recipes.filter((t=>"Any"===t.serverType||t.serverType===Xe(this,ra))).sort((0,n.MR)(["name"])).map((t=>`<option value="${t.id}">${t.name.replace(/(\d)-(\d)(st|rd|th)/,aa)}</option>`)).join("")}</optgroup>`)).join("")}_setupSelect(){ta(this,la,new d.Z(Xe(this,ia),Xe(this,oa).baseIdSelects,{dropupAuto:!1,liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",title:"Select item",virtualScroll:!0,width:"fit"},this._getOptions())),(0,Je.Z)(`#${Xe(this,oa).baseIdSelects} label`).attr("class","text-muted ps-2").text("Items listed here may not be available in the game (yet).")}_setupSelectListener(){Xe(this,la).select$.on("change",(()=>{this._recipeSelected()}))}_getRecipeData(t){return Xe(this,ca).get(t)}_getRequirementText(t){let e='<table class="table table-sm table-hover text-table"><tbody>';return t.labourPrice&&(e+=`<tr><td>${t.labourPrice} labour hours</td></tr>`),t.goldPrice&&(e+=`<tr><td>${(0,l.PK)(t.goldPrice)}</td></tr>`),t.itemRequirements.length>0&&(e+=`${t.itemRequirements.map((t=>`<tr><td>${t.amount} ${t.name}</td></tr>`)).join("")}`),e+="</tbody></table>",e}_getPropertiesText(t){let e="",a="",i="";for(const e of Xe(this,ha)){const s=e[1].filter((e=>e.id===t.result.id));for(const t of s)[a]=e,i=`<tr><td>${t.properties.map((t=>{const e=t.isPercentage?(0,o.QO)(t.amount/100):t.amount;return`${t.modifier} ${e}`})).join("</td></tr><tr><td>")}</td></tr>`}return i?(e+=`<h6 class="card-subtitle mb-2 text-muted">${a}</h6>`,e+=`<table class="table table-sm table-hover text-table"><tbody>${i}</tbody></table>`):e+=`<p>${(0,o.yI)(t.result.amount)} ${t.result.name}</p>`,e}_getText(t){const e=this._getRecipeData(t);let a='<div class="card-group">';return a+='<div class="card"><div class="card-body">',a+='<h5 class="card-title">Item</h5>',a+=this._getRequirementText(e),a+="</div></div>",a+='<div class="card"><div class="card-body">',a+='<h5 class="card-title">Result</h5>',a+=this._getPropertiesText(e),a+="</div></div>",a+="</div></div>",a}_recipeSelected(){const t=Number(Xe(this,la).getValues()),e=Xe(this,oa).outputSel;e.select("div").remove(),e.append("div").classed("mt-4",!0).html(this._getText(t))}}function pa(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function wa(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,va(t,e,"get"))}function ma(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,va(t,e,"set"),a),a}function va(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var fa=new WeakMap,ba=new WeakMap,ga=new WeakMap,_a=new WeakMap,ya=new WeakMap,Sa=new WeakMap,ka=new WeakMap,$a=new WeakMap,Ma=new WeakMap;class xa{constructor(){pa(this,fa,{writable:!0,value:void 0}),pa(this,ba,{writable:!0,value:{}}),pa(this,ga,{writable:!0,value:[]}),pa(this,_a,{writable:!0,value:!0}),pa(this,ya,{writable:!0,value:0}),pa(this,Sa,{writable:!0,value:{}}),pa(this,ka,{writable:!0,value:void 0}),pa(this,$a,{writable:!0,value:"List of ships"}),pa(this,Ma,{writable:!0,value:void 0}),ma(this,ka,(0,r.MF)(wa(this,$a))),ma(this,Ma,`menu-${wa(this,ka)}`),this._setupListener()}async _loadAndSetupData(){const t=(await a.e(228).then(a.t.bind(a,8422,19))).default.sort((0,n.MR)(["class","-battleRating","name"]));ma(this,ga,t.map((t=>[[t.class,String(t.class)],[t.name,(0,l.Y8)(t.name)],[t.guns.total,String(t.guns.total)],[t.guns.damage.cannons,(0,o.yI)(t.guns.damage.cannons)],[t.battleRating,(0,o.yI)(t.battleRating)],[t.crew.max,(0,o.yI)(t.crew.max)],[t.ship.maxSpeed,(0,o.QM)(t.ship.maxSpeed,1)],[t.ship.turnSpeed,(0,o.QM)(t.ship.turnSpeed,1)],[t.guns.gunsPerDeck[4].amount,t.guns.gunsPerDeck[4].amount?String(t.guns.gunsPerDeck[4].amount):""],[t.guns.gunsPerDeck[5].amount,t.guns.gunsPerDeck[5].amount?String(t.guns.gunsPerDeck[5].amount):""],[t.sides.armour,`${(0,o.yI)(t.sides.armour)} <span class="badge badge-highlight">${t.sides.thickness}</span>`]])))}async _menuClicked(){(0,s.KS)("Tools",wa(this,$a)),wa(this,fa)?wa(this,fa).show():(await this._loadAndSetupData(),ma(this,fa,new h.Z(wa(this,$a),"lg")),this._shipListSelected())}_setupListener(){var t;null===(t=document.querySelector(`#${wa(this,Ma)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_sortRows(t,e=!0){e&&wa(this,ya)===t&&ma(this,_a,!wa(this,_a)),ma(this,ya,t);const a=wa(this,_a)?1:-1;wa(this,ba).sort(((e,i)=>1===t?e[t][0].localeCompare(i[t][0])*a:(e[t][0]-i[t][0])*a))}_initTable(){const t={group:new Map([["dummy1",2],["Guns",2],["dummy2",1],["Speed",2],["dummy3",1],["Chasers",2],["dummy4",1]]),element:new Set(["","Name","No.","Damage","<span class='caps'>br</span>","Crew","Max","Turn","Bow","Stern","Sides"])},e=wa(this,Sa).append("thead");e.append("tr").attr("class","thead-group").selectAll("th").data([...t.group]).join("th").classed("border-bottom-0",(t=>t[0].startsWith("dummy"))).classed("text-center",!0).attr("colspan",(t=>t[1])).attr("scope","col").text((t=>t[0].startsWith("dummy")?"":t[0])),e.append("tr").selectAll("th").data([...t.element]).join("th").datum(((t,e)=>({data:t,index:e}))).classed("text-start",((t,e)=>1===e)).classed("pe-1",((t,e)=>1!==e)).html((t=>t.data)).on("click",((t,e)=>{this._sortRows(e.index)})),wa(this,Sa).append("tbody")}_updateTable(){ma(this,ba,wa(this,Sa).select("tbody").selectAll("tr").data(wa(this,ga),(t=>t[1][0])).join((t=>t.append("tr")))),wa(this,ba).selectAll("td").data((t=>t)).join((t=>t.append("td").classed("pe-1",((t,e)=>1!==e)).classed("text-start",((t,e)=>1===e)).html((t=>t[1]))))}_shipListSelected(){ma(this,Sa,wa(this,fa).outputSel.append("table").attr("class","table table-sm table-striped table-hover table-sort")),this._initTable(),this._updateTable(),this._sortRows(0,!1)}}var Wa=a(4695);function Ta(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function Da(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,ja(t,e,"get"))}function La(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,ja(t,e,"set"),a),a}function ja(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}const Ia=["Resources","Extra","Materials"];var Ca=new WeakMap,Aa=new WeakMap,Pa=new WeakMap,Ea=new WeakMap,Oa=new WeakMap,Ra=new WeakMap,Na=new WeakMap,Za=new WeakMap,qa=new WeakMap,Ba=new WeakMap,Fa=new WeakMap,za=new WeakMap,Ka=new WeakMap;class Va{constructor(){var t,e,a;Ta(this,Ca,{writable:!0,value:void 0}),Ta(this,Aa,{writable:!0,value:[]}),Ta(this,Pa,{writable:!0,value:{}}),Ta(this,Ea,{writable:!0,value:{}}),Ta(this,Oa,{writable:!0,value:{}}),Ta(this,Ra,{writable:!0,value:void 0}),Ta(this,Na,{writable:!0,value:{}}),Ta(this,Za,{writable:!0,value:{}}),Ta(this,qa,{writable:!0,value:{}}),Ta(this,Ba,{writable:!0,value:{}}),Ta(this,Fa,{writable:!0,value:void 0}),Ta(this,za,{writable:!0,value:"List of ship blueprints"}),Ta(this,Ka,{writable:!0,value:void 0}),a=t=>{var e;return(null===(e=Da(this,Ea).wood.find((e=>e.name===t)))||void 0===e?void 0:e.amount)??0},(e="_getResourceAmount")in(t=this)?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,La(this,Fa,(0,r.MF)(Da(this,za))),La(this,Ka,`menu-${Da(this,Fa)}`),this._setupListener()}async _setupWoodData(){La(this,Ba,new Wa.J(Da(this,Fa))),await Da(this,Ba).init()}async _loadAndSetupData(){La(this,Aa,(await a.e(263).then(a.t.bind(a,2830,19))).default);const t=(await a.e(263).then(a.t.bind(a,4845,19))).default;La(this,Oa,new Map(t.standard.map((t=>[t.name,{reales:t.reales,labour:(null==t?void 0:t.labour)??0}])))),La(this,Pa,new Map(t.seasoned.map((t=>[t.name,{reales:t.reales,labour:t.labour,doubloon:t.doubloon,tool:t.tool}])))),await this._setupWoodData()}async _menuClicked(){(0,s.KS)("Tools",Da(this,za)),Da(this,Ra)?Da(this,Ra).show():(await this._loadAndSetupData(),La(this,Ra,new h.Z(Da(this,za),"lg")),this._setupSelects(),this._setupShipSelectListener(),this._setupWoodSelectListener())}_setupListener(){var t;null===(t=document.querySelector(`#${Da(this,Ka)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_getOptions(){return`${Da(this,Aa).sort((0,n.MR)(["name"])).map((t=>`<option value="${t.name}">${t.name}</option>;`)).join("")}`}_setupShipSelect(){La(this,Na,new d.Z(Da(this,Fa),Da(this,Ra).baseIdSelects,{noneSelectedText:"Select blueprint"},this._getOptions()))}_setupWoodSelects(){for(const t of Pt.Kf){const e={noneSelectedText:`Select ${t}`};Da(this,Za)[t]=new d.Z(`${Da(this,Fa)}-wood-${t}`,Da(this,Ra).baseIdSelects,e,Da(this,Ba).getOptions(t)),Da(this,Za)[t].disable()}}_setupSelects(){Da(this,Ra).selectsSel.attr("class","d-flex justify-content-between"),this._setupShipSelect(),this._setupWoodSelects()}_enableWoodSelects(){for(const t of Pt.Kf)Da(this,Za)[t].enable()}_setDefaultWoods(){const t={frame:Da(this,Ba).findWoodId("frame","Fir"),trim:Da(this,Ba).findWoodId("trim","Crew Space")};for(const e of Pt.Kf)Da(this,Za)[e].reset(t[e])}_setupShipSelectListener(){Da(this,Na).select$.one("change",(()=>{this._enableWoodSelects(),this._setDefaultWoods(),this._initOutput()})).on("change",(()=>{La(this,Ca,String(Da(this,Na).getValues())),La(this,Ea,this._getBlueprintData(Da(this,Ca))),this._updateText()}))}_setupWoodSelectListener(){for(const t of Pt.Kf)Da(this,Za)[t].select$.on("change",(()=>{this._updateText()}))}_updateTable(t,e){t.select("tbody").selectAll("tr").data(e).join((t=>t.append("tr"))).selectAll("td").data((t=>t)).join((t=>t.append("td"))).classed("text-start",((t,e)=>0===e)).html((t=>t))}_updateText(){let t=Da(this,Ea).resources.map((t=>[t.name,t.amount]));const e=e=>t.findIndex((t=>t[0]===e))??0,a=Da(this,Ba).getWoodName(Number(Da(this,Za).trim.getValues())),i=Da(this,Ba).getWoodName(Number(Da(this,Za).frame.getValues()));let s=!1,n=!1,r=0,l=0;if("Crew Space"===a){const a=this._getResourceAmount("Crew Space"),i=e("Hemp");t[i][1]=t[i][1]+a}else if(l=this._getResourceAmount("Planking"),a===i)r+=l;else{const i=e(a);i>=0?t[i][1]=t[i][1]+l:(n=!0,t.push([a,l]))}r+=this._getResourceAmount("Frame");const h=e(i);if(h>=0?t[h][1]=t[h][1]+r:(s=!0,t.push([i,r])),s&&n){const e=t.length-1;[t[e],t[e-1]]=[t[e-1],t[e]]}let d=[];Da(this,Ea).price&&d.push(["Reales",Da(this,Ea).price]),d.push(["Provisions",Da(this,Ea).provisions]),Da(this,Ea).permit&&d.push(["Permit",Da(this,Ea).permit]),d.push(["Craft level",Da(this,Ea).craftLevel],["Shipyard level",Da(this,Ea).shipyardLevel],["Labour hours",Da(this,Ea).labourHours],["Craft experience",Da(this,Ea).craftXP]);const c=[];let u=0,p=0;const w=t=>{var e;return((null===(e=Da(this,Oa).get(t[0]))||void 0===e?void 0:e.reales)??0)*t[1]},m=t=>{var e;return((null===(e=Da(this,Oa).get(t[0]))||void 0===e?void 0:e.labour)??0)*t[1]},v=t=>{for(const e of t.filter((t=>Da(this,Oa).has(t[0]))))u+=w(e),p+=m(e)};v(t),v(d),u&&c.push(["Reales",(0,o.yI)(u)],["Labour hours",(0,o.yI)(p)]);let f=0,b=0,g=0,_=0;for(const t of Pt.Kf){const e=Da(this,Pa).get(String(Da(this,Za)[t].getValues()));e&&(f+=(e.reales??0)*r,b+=(e.labour??0)*r,g+=(e.doubloon??0)*r,_+=(e.tool??0)*r)}f&&c.push(["(S) reales",(0,o.yI)(f)]),b&&c.push(["(S) labour hours",(0,o.yI)(b)]),g&&c.push(["(S) doubloons",(0,o.yI)(g)]),_&&c.push(["(S) tools",(0,o.yI)(_)]),t=t.map((t=>[t[0],(0,o.yI)(t[1])])),d=d.map((t=>[t[0],(0,o.yI)(t[1])])),this._updateTable(Da(this,qa).Resources,t),this._updateTable(Da(this,qa).Extra,d),this._updateTable(Da(this,qa).Materials,c)}_getBlueprintData(t){return Da(this,Aa).find((e=>e.name===t))??{}}_initOutput(){const t=Da(this,Ra).outputSel.append("div").attr("class","card-group mt-3"),e=e=>{const a=t.append("div").attr("class","card").append("div").attr("class","card-body");a.append("h5").attr("class","card-title").text(e),Da(this,qa)[e]=a.append("table").attr("class","table table-sm table-striped table-hover"),Da(this,qa)[e].append("thead"),Da(this,qa)[e].append("tbody")};for(const t of Ia)e(t)}}function Ha(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Ua(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function Qa(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Ga(t,e,"get"))}function Ja(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,Ga(t,e,"set"),a),a}function Ga(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var Ya=new WeakMap,Xa=new WeakMap,ti=new WeakMap,ei=new WeakMap,ai=new WeakMap;class ii{constructor(){Ua(this,Ya,{writable:!0,value:void 0}),Ua(this,Xa,{writable:!0,value:void 0}),Ua(this,ti,{writable:!0,value:"List of woods"}),Ua(this,ei,{writable:!0,value:void 0}),Ua(this,ai,{writable:!0,value:void 0}),Ha(this,"_modifiers",{}),Ha(this,"_rows",{}),Ha(this,"_sortAscending",{}),Ha(this,"_sortIndex",{}),Ha(this,"_switchesSel",void 0),Ha(this,"_tables",{}),Ha(this,"_woodData",{}),Ha(this,"_woodDataDefault",{}),Ha(this,"_modifiersNotUsed",new Set(["Ship material","Boarding morale"])),Ja(this,Xa,(0,r.MF)(Qa(this,ti))),Ja(this,ai,`menu-${Qa(this,Xa)}`),Ja(this,ei,`checkbox-${Qa(this,Xa)}`),this._setupListener()}async _menuClicked(){(0,s.KS)("Tools",Qa(this,ti)),Qa(this,Ya)?Qa(this,Ya).show():(await this._loadAndSetupData(),Ja(this,Ya,new h.Z(Qa(this,ti),"xl")),this._injectBody(),this._woodFamilySelected())}_setupListener(){var t;null===(t=document.querySelector(`#${Qa(this,ai)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_getModifiers(t){const e=new Set;for(const a of this._woodDataDefault[t])for(const t of a.properties.filter((t=>!this._modifiersNotUsed.has(t.modifier))))e.add(t.modifier);return[...e].sort(n.I4)}async _loadData(){this._woodDataDefault=(await a.e(799).then(a.t.bind(a,1258,19))).default}_setupData(){for(const t of Pt.Kf){this._modifiers[t]=new Set(this._getModifiers(t));for(const e of this._woodDataDefault[t]){const a=new Set(e.properties.map((t=>t.modifier)));for(const i of this._modifiers[t])a.has(i)||e.properties.push({modifier:i,amount:0,isPercentage:!1});e.properties.sort(((t,e)=>t.modifier.localeCompare(e.modifier)))}}this._woodData={...this._woodDataDefault}}async _loadAndSetupData(){await this._loadData(),this._setupData()}_sortRows(t,e,a=!0){a&&this._sortIndex[t]===e&&(this._sortAscending[t]=!this._sortAscending[t]),this._sortIndex[t]=e;const i=this._sortAscending[t]?1:-1;this._rows[t].sort(((t,a)=>0===e?t.name.localeCompare(a.name)*i:(t.properties[e-1].amount-a.properties[e-1].amount)*i))}_initTable(t){this._sortAscending[t]=!0,this._tables[t].append("thead").append("tr").selectAll("th").data(["Wood",...this._modifiers[t]]).join("th").datum(((t,e)=>({data:t,index:e}))).classed("text-start",((t,e)=>0===e)).attr("role","columnheader").html((t=>t.data.replace(" ","<br>"))).on("click",((e,a)=>{this._sortRows(t,a.index)})),this._tables[t].append("tbody")}_injectBody(){const t=Qa(this,Ya).outputSel,e=t.append("div").attr("class","mb-3");for(const t of Pt.pe){const a=e.append("div").attr("class","form-check form-check-inline form-switch");a.append("input").attr("id",`${Qa(this,ei)}-${t}`).attr("name",`${Qa(this,ei)}`).attr("class","form-check-input").attr("type","checkbox").property("checked",!0),a.append("label").attr("for",`${Qa(this,ei)}-${t}`).attr("class","form-check-label").text((0,n.fm)(t))}this._switchesSel=[...document.querySelectorAll(`input[name=${Qa(this,ei)}]`)];for(const t of this._switchesSel)t.addEventListener("change",(t=>{t.preventDefault(),this._woodFamilySelected()}));for(const e of Pt.Kf)t.append("h5").text((0,n.fm)(`${e}s`)),this._tables[e]=t.append("table").attr("class","table table-sm table-striped table-hover table-sort"),this._initTable(e),this._updateTable(e),this._sortRows(e,0,!1)}_getFormattedAmount(t){let e;return e="Repair amount"===t.modifier&&t.amount?(0,o.nM)(t.amount,1):t.amount?(0,o.QM)(t.amount):"",e}_updateTable(t){this._rows[t]=this._tables[t].select("tbody").selectAll("tr").data(this._woodData[t],(t=>t.id)).join((t=>t.append("tr"))),this._rows[t].selectAll("td").data((t=>[t.name,...t.properties.filter((t=>!this._modifiersNotUsed.has(t.modifier))).map((t=>this._getFormattedAmount(t)))])).join((t=>t.append("td").classed("text-start",((t,e)=>0===e)).html((t=>t))))}_woodFamilySelected(){const t=new Set;for(const e of this._switchesSel)if(e.checked){const a=e.id.replace(`${Qa(this,ei)}-`,"");t.add(a)}for(const e of Pt.Kf)this._woodData[e]=this._woodDataDefault[e].filter((e=>t.has(e.family))),this._updateTable(e),this._sortRows(e,this._sortIndex[e],!1)}}var si=a(8398),ni=a(8776),ri=a(2474),oi=a(7995),li=a(8973),hi=a(9937),di=a(9714),ci=a(6377),ui=a.n(ci);function pi(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function wi(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,vi(t,e,"get"))}function mi(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,vi(t,e,"set"),a),a}function vi(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var fi=new WeakMap,bi=new WeakMap,gi=new WeakMap,_i=new WeakMap,yi=new WeakMap,Si=new WeakMap,ki=new WeakMap,$i=new WeakMap,Mi=new WeakMap,xi=new WeakMap,Wi=new WeakMap,Ti=new WeakMap,Di=new WeakMap,Li=new WeakMap,ji=new WeakMap;class Ii{constructor(t){pi(this,fi,{writable:!0,value:{}}),pi(this,bi,{writable:!0,value:0}),pi(this,gi,{writable:!0,value:{}}),pi(this,_i,{writable:!0,value:{}}),pi(this,yi,{writable:!0,value:void 0}),pi(this,Si,{writable:!0,value:{}}),pi(this,ki,{writable:!0,value:void 0}),pi(this,$i,{writable:!0,value:{}}),pi(this,Mi,{writable:!0,value:void 0}),pi(this,xi,{writable:!0,value:{}}),pi(this,Wi,{writable:!0,value:0}),pi(this,Ti,{writable:!0,value:void 0}),pi(this,Di,{writable:!0,value:"Net income"}),pi(this,Li,{writable:!0,value:void 0}),pi(this,ji,{writable:!0,value:void 0}),mi(this,ki,t),mi(this,Ti,`show-${(0,r.MF)(wi(this,Di))}`),mi(this,ji,`menu-${wi(this,Ti)}`),mi(this,Li,(0,li.Z)().domain(n.nU.map((t=>t.short))).range(n.nU.map((t=>t.colours[0])))),this._setupListener()}static getHeight(){return Math.floor(.75*top.innerHeight)}_getWidth(){return Math.floor(wi(this,gi).node().offsetWidth)??0}_setupData(t){const e=t.ports.map((e=>{const a=t.server.find((t=>t.id===e.id))??{},i=t.pb.find((t=>t.id===e.id))??{};return{...e,...a,...i}})),a=(0,si.Z)(e,(t=>t.netIncome))??0,i=(0,ni.Z)(e,(t=>t.netIncome))??0;mi(this,fi,(0,hi.Z)().domain([a,i]).range([8,32]).clamp(!0));const s=new Set(["NT","FT"]),r=new Set,o=[...e.filter((t=>t.netIncome>0&&!s.has(t.nation))).map((t=>(r.add(t.nation),{id:t.name,value:t.netIncome,parentId:t.nation}))),...n.nU.filter((t=>r.has(t.short))).map((t=>({id:t.short,value:0,parentId:"World"}))),{id:"World",value:0,parentId:void 0}];mi(this,Si,(0,ri.Z)()(o)),mi(this,xi,(0,oi.ZP)(wi(this,Si)).sum((t=>t.data.value)))}async _loadData(){const t=[{fileName:`${wi(this,ki)}-ports.json`,name:"server"},{fileName:`${wi(this,ki)}-pb.json`,name:"pb"}],e={};return e.ports=(await a.e(462).then(a.t.bind(a,9131,19))).default,await(0,r.EZ)(t,e),e}async _loadAndSetupData(){(0,r.dM)();const t=await this._loadData();this._setupData(t),(0,r.V4)()}async _menuClicked(){(0,s.KS)("Tools",wi(this,Di)),wi(this,yi)?wi(this,yi).show():(await this._loadAndSetupData(),mi(this,yi,new h.Z(wi(this,Di),"xl")),mi(this,gi,wi(this,yi).outputSel),this._initTreemap(),this._drawTreemap())}_setupListener(){var t;null===(t=document.querySelector(`#${wi(this,ji)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_drawLegend(){const t=Math.floor(20*te.L9),e=.8*t,a=Math.floor(2*te.L9),i=Math.floor(5*te.L9),s=(wi(this,xi).children??[]).sort(((t,e)=>e.value-t.value)),n=160+2*i,r=s.length*n-2*i,h=Math.ceil(r/wi(this,Wi)),d=Math.ceil(s.length/h),c=Math.ceil(wi(this,Wi)/d-2*i);wi(this,gi).append("div").attr("class","d-flex flex-wrap justify-content-between mt-3").selectAll(".legend").data(s).join((s=>{const n=s.append("div").attr("class","legend mt-3"),r=n.append("svg").attr("width",c).attr("height",2*t+a);return r.append("rect").attr("width",c).attr("height",t).style("fill",(t=>wi(this,Li).call(this,t.data.id))),r.append("rect").attr("x",i).attr("y","5%").attr("width",4*e/3).attr("height",e).attr("fill",(t=>`url(#${t.data.id})`)),r.append("text").attr("x",c-i).attr("y","25%").text((t=>t.data.id)).attr("class","text-end").style("fill",(t=>(0,l.IF)(wi(this,Li).call(this,t.data.id)))),r.append("rect").attr("class","opacity-low").attr("y",t+a).attr("width",c).attr("height",t).style("fill",(t=>wi(this,Li).call(this,t.data.id))),r.append("rect").attr("y",t+a).attr("width",(t=>{var e;return c*(t.value/((null===(e=t.parent)||void 0===e?void 0:e.value)??1))})).attr("height",t).style("fill",(t=>wi(this,Li).call(this,t.data.id))),r.append("text").attr("x",c-i).attr("y","75%").html((t=>(0,o.Dw)(t.value,!0))).style("text-anchor","end"),n}))}_getTooltipText(t){var e,a,i,s,n;return`\n            <div class="d-flex justify-content-between align-items-center">\n            <div class="d-flex flex-column text-start mt-1 me-3 p-0">\n                <div><i class="flag-icon-${null===(e=t.parent)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.id} flag-icon-small me-2" role="img"></i><span class="x-large">${t.data.id??""}</span></div>\n            </div>\n            <div class="d-flex flex-column text-start mt-1 p-0">\n                <div class="me-3">\n                    ${(0,o.Dw)(t.data.data.value)}<br />\n                    <span class="des">Port</span>\n                </div>\n                <div class="me-3">\n                    ${(0,o.me)(t.data.data.value/((null===(i=t.parent)||void 0===i?void 0:i.value)??1))}<br />\n                    <span class="des">Nation</span>\n                </div>\n                <div class="me-3">\n                    ${(0,o.me)(t.data.data.value/((null===(s=t.parent)||void 0===s||null===(n=s.parent)||void 0===n?void 0:n.value)??1))}<br />\n                    <span class="des">World</span>\n                </div>\n            </div>\n            </div>`}_hideDetails(){void 0!==wi(this,Mi)&&(wi(this,Mi).dispose(),mi(this,Mi,void 0))}_showDetails(t,e){const a=t.currentTarget;this._hideDetails(),mi(this,Mi,new(_t())(a,{html:!0,template:'<div class="tooltip  bs-tooltip-top" role="tooltip"><div class="tooltip-block tooltip-inner tooltip-inner-smaller"></div></div>',title:this._getTooltipText(e),trigger:"manual",sanitize:!1})),wi(this,Mi).show()}_drawCells(t){wi(this,_i).append("g").attr("class","cells").selectAll(".cell").data(t).join((t=>t.append("path").attr("class","cell").attr("d",(t=>`M${t.polygon.join(",")}z`)).style("fill",(t=>{var e;return wi(this,Li).call(this,(null===(e=t.parent)||void 0===e?void 0:e.data.id)??"")}))))}_drawLabels(t){const e=wi(this,_i).append("g").attr("class","labels").selectAll(".label").data(t).join((t=>t.append("g").attr("class","label").attr("transform",(t=>`translate(${t.polygon.site.x},${t.polygon.site.y})`)).style("font-size",(t=>`${wi(this,fi).call(this,t.data.data.value)}px`)).style("fill",(t=>{var e;return(0,l.IF)(wi(this,Li).call(this,(null===(e=t.parent)||void 0===e?void 0:e.data.id)??""))}))));e.append("text").attr("class","name").text((t=>t.data.data.id)),e.append("text").attr("class","value").html((t=>(0,o.Pj)(t.data.data.value,!0)))}_drawHover(t){wi(this,_i).append("g").selectAll(".hoverer").data(t).join((t=>t.append("path").attr("class","hoverer").attr("d",(t=>`M${t.polygon.join(",")}z`)).on("mouseover",((t,e)=>{this._showDetails(t,e)})).on("mouseleave",(()=>{this._hideDetails()}))))}_drawTreemap(){const t=wi(this,xi).leaves();this._drawCells(t),this._drawLabels(t),this._drawHover(t),this._drawLegend()}_initTreemap(){mi(this,bi,Ii.getHeight()),mi(this,Wi,this._getWidth()),mi(this,$i,wi(this,gi).append("svg").attr("class","voronoi").attr("width",wi(this,Wi)).attr("height",wi(this,bi))),mi(this,_i,wi(this,$i).append("g").attr("class","drawingArea")),(0,di.voronoiTreemap)().clip([[0,0],[0,wi(this,bi)],[wi(this,Wi),wi(this,bi)],[wi(this,Wi),0]]).minWeightRatio(1e-10).prng(ui()(wi(this,Ti)))(wi(this,xi))}}var Ci=a(1316),Ai=a(9089),Pi=a(4752),Ei=a(6437),Oi=a(259),Ri=a(4038),Ni=a(3419),Zi=a(8990),qi=a(7454);function Bi(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Fi(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function zi(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Vi(t,e,"get"))}function Ki(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,Vi(t,e,"set"),a),a}function Vi(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var Hi=new WeakMap,Ui=new WeakMap,Qi=new WeakMap,Ji=new WeakMap,Gi=new WeakMap,Yi=new WeakMap,Xi=new WeakMap,ts=new WeakMap,es=new WeakMap,as=new WeakMap;class is{constructor(t){Fi(this,Hi,{writable:!0,value:void 0}),Fi(this,Ui,{writable:!0,value:{}}),Fi(this,Qi,{writable:!0,value:void 0}),Fi(this,Ji,{writable:!0,value:{}}),Fi(this,Gi,{writable:!0,value:{}}),Fi(this,Yi,{writable:!0,value:{}}),Fi(this,Xi,{writable:!0,value:{}}),Fi(this,ts,{writable:!0,value:void 0}),Fi(this,es,{writable:!0,value:"Ownership overview"}),Fi(this,as,{writable:!0,value:void 0}),Bi(this,"_ownershipData",{}),Bi(this,"_nationData",{}),Bi(this,"_colourScale",void 0),Ki(this,Qi,t),Ki(this,ts,`show-${(0,r.MF)(zi(this,es))}`),Ki(this,as,`menu-${zi(this,ts)}`),this._colourScale=(0,li.Z)().range(r.q4),this._setupListener()}static getHeight(){return Math.floor(.75*top.innerHeight)}_getWidth(){return Math.floor(zi(this,Ji).node().offsetWidth)??0}async _loadAndSetupData(){(0,r.dM)(),this._nationData=await(0,r.qP)(`${zi(this,Qi)}-nation.json`),this._ownershipData=await(0,r.qP)(`${zi(this,Qi)}-ownership.json`),(0,r.V4)()}async _menuClicked(){(0,s.KS)("Tools",zi(this,es)),zi(this,Hi)?zi(this,Hi).show():(await this._loadAndSetupData(),Ki(this,Hi,new h.Z(zi(this,es),"xl")),this._setupOutput(),this._setupTextures(),this._setupSelect(),this._setupSelectListener(),this._injectArea())}_setupListener(){var t;null===(t=document.querySelector(`#${zi(this,as)}`))||void 0===t||t.addEventListener("click",(()=>{this._menuClicked()}))}_setupOutput(){Ki(this,Ji,zi(this,Hi).outputSel),Ki(this,Gi,zi(this,Ji).append("div")),Ki(this,Yi,zi(this,Ji).append("svg").attr("class","area"))}_setupTextures(){const t=["2/8","4/8","6/8"];let e=0;for(const{short:a,colours:i}of n.nU)1===i.length?zi(this,Xi)[a]=qi.Z.lines().stroke(i[0]).background(i[0]).id(`texture-${a}`):2===i.length?(zi(this,Xi)[a]=qi.Z.lines().orientation(t[e]).size(40).strokeWidth(20).stroke(i[0]).background(i[1]).id(`texture-${a}`),e=(e+1)%t.length):zi(this,Xi)[a]=qi.Z.circles().radius(5).strokeWidth(3).stroke(i[1]).fill(i[2]).background(i[0]).id(`texture-${a}`),zi(this,Yi).call(zi(this,Xi)[a])}_getOptions(){return`${this._ownershipData.map((t=>`<option value="${t.region}">${t.region}</option>;`)).join("")}`}_setupSelect(){Ki(this,Ui,new d.Z(zi(this,ts),zi(this,Hi).baseIdSelects,{noneSelectedText:"Select region"},this._getOptions()))}_setupSelectListener(){zi(this,Ui).select$.on("change",(()=>{this._regionSelected()}))}_injectArea(){const t=this._getWidth(),e=Math.min(1e3,is.getHeight()),a=0,i=32,s=0,o=n.nU.filter((t=>9!==t.id)).map((t=>t.short)),h=this._nationData;h.keys=o;const d=(0,Oi.Z)().offset(Ri.Z).keys(o)(h);zi(this,Yi).attr("width",t).attr("height",e),(()=>{const c=(()=>{const n=(0,hi.Z)().domain((0,Ai.Z)(h,(t=>new Date(t.date)))).range([s,t-a]),r=(0,hi.Z)().domain([(0,si.Z)(d[0],(t=>t[0])),(0,ni.Z)(d[d.length-1],(t=>t[1]))]).range([e-i,0]);return(0,Ni.Z)().x((t=>n(new Date(t.data.date))??0)).y0((t=>r(t[0])??0)).y1((t=>r(t[1])??0)).curve(Zi.ZP)})(),u=new Map(n.nU.map((t=>[t.short,t.name])));this._colourScale.domain(o),zi(this,Yi).selectAll("path.nation").data(d).join((t=>t.append("path").attr("class","nation").attr("fill",(t=>zi(this,Xi)[t.key].url())).attr("stroke",r.Om).attr("stroke-width","3px").attr("d",c))),zi(this,Yi).selectAll(".area-label").data(d).join((t=>t.append("text").attr("class","area-label text-shadow").text((t=>u.get(t.key))).attr("fill",(t=>{var e;return(0,l.IF)((null===(e=(0,n.$i)(t.key))||void 0===e?void 0:e.colours[0])??"")})).attr("transform",(0,Ci.areaLabel)(c))))})(),zi(this,Yi).append("g").call((n=>{const r=(0,Ei.Z)().domain((0,Ai.Z)(h,(t=>new Date(t.date)))).range([s,t-a]);n.attr("transform",`translate(0,${e-i})`).call((0,Pi.LL)(r).ticks(t/80).tickSizeOuter(0)),n.attr("font-size",".8rem").attr("font-family","")}))}async _injectChart(t){(await a.e(782).then(a.bind(a,5405))).default().data(t).enableAnimations(!1).timeFormat("%-d %B %Y").zQualitative(!0).zColorScale(this._colourScale).width(this._getWidth())(zi(this,Gi).node())}_regionSelected(){const t=String(zi(this,Ui).getValues());zi(this,Gi).selectAll("*").remove();const e=this._ownershipData.filter((e=>e.region===t)).map((t=>t.data))[0];this._injectChart(e)}}function ss(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function ns(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,rs(t,e,"set"),a),a}function rs(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var os=new WeakMap;class ls extends h.Z{constructor(t,e){super(t,"xl"),ss(this,os,{writable:!0,value:void 0}),ns(this,os,e),this._init()}getBaseIdSelects(t){return`${super.baseIdSelects}-${t}`}getBaseIdOutput(t){return`${super.baseIdOutput}-${t}`}_init(){this._injectModal()}_injectModal(){const t=super.bodySel.append("div").attr("class","container-fluid").append("div").attr("class","row wood");for(const a of function(t,e){return e.get?e.get.call(t):e.value}(e=this,rs(e,os,"get"))){const e=t.append("div").attr("class","col-md-3 ms-auto pt-2 "+("base"===a?"column-base":"column-comp bg-paper"));e.append("div").attr("id",`${this.getBaseIdSelects(a)}`),e.append("div").attr("id",`${this.getBaseIdOutput(a)}`)}var e}}function hs(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function ds(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,us(t,e,"get"))}function cs(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,us(t,e,"set"),a),a}function us(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var ps=new WeakMap,ws=new WeakMap;class ms{constructor(t,e){hs(this,ps,{writable:!0,value:void 0}),hs(this,ws,{writable:!0,value:void 0}),cs(this,ps,(0,Je.Z)(`#${t}`)),cs(this,ws,e),this._setupMainDiv()}get div(){return ds(this,ps)}get woodData(){return ds(this,ws)}_setupMainDiv(){ds(this,ps).select("div").remove(),ds(this,ps).append("div")}getProperty(t,e){const a=(null==t?void 0:t.properties.find((t=>t.modifier===e)))??{};return{amount:(null==a?void 0:a.amount)??0,isPercentage:(null==a?void 0:a.isPercentage)??!1}}}function vs(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function fs(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,gs(t,e,"get"))}function bs(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,gs(t,e,"set"),a),a}function gs(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var _s=new WeakMap;class ys extends ms{constructor(t,e,a){super(t,e),vs(this,_s,{writable:!0,value:void 0}),bs(this,_s,a),this._printText()}_getPropertySum(t){const e=super.getProperty(fs(this,_s).frame,t),a=super.getProperty(fs(this,_s).trim,t);return{amount:e.amount+a.amount,isPercentage:a.isPercentage}}_getText(t){let e='<table class="table table-striped table-hover text-table mt-4"><thead>';e+='<tr><th scope="col">Property</th><th scope="col">Change</th></tr></thead><tbody>';for(const[a,i]of t){if(e+=`<tr><td>${a}</td><td>${i.isPercentage?(0,o.ub)(i.amount/100):(0,o.$1)(i.amount)}`,e+='<span class="rate">',i.amount>0){e+='<span class="bar neutral" style="width:50%;"></span>',e+=`<span class="bar pos diff" style="width:${i.amount/i.max*50}%;"></span>`}else if(i.amount<0){const t=i.amount/i.min*50;e+=`<span class="bar neutral" style="width:${50-t}%;"></span>`,e+=`<span class="bar neg diff" style="width:${t}%;"></span>`}else e+='<span class="bar neutral"></span>';e+="</span></td></tr>"}return e+="</tbody></table>",e}_printText(){const t=new Map;for(const e of super.woodData.modifierNames){const a=this._getPropertySum(e);t.set(e,{amount:a.amount,isPercentage:a.isPercentage,min:super.woodData.getMinProperty(e),max:super.woodData.getMaxProperty(e)})}super.div.html(this._getText(t))}}function Ss(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function ks(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Ms(t,e,"get"))}function $s(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,Ms(t,e,"set"),a),a}function Ms(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var xs=new WeakMap,Ws=new WeakMap;class Ts extends ms{constructor(t,e,a,i){super(t,e),Ss(this,xs,{writable:!0,value:void 0}),Ss(this,Ws,{writable:!0,value:void 0}),$s(this,xs,a),$s(this,Ws,i),this._printTextComparison()}static _getDiff(t,e,a,i=1){const s=Number.parseFloat((t-e).toFixed(i));return`${a?(0,o.ub)(t/100,i):(0,o.$1)(t)} <span class="badge bg-white text-dark">${(0,o.LQ)(s)}</span>`}_getBasePropertySum(t){const e=super.getProperty(ks(this,xs).frame,t),a=super.getProperty(ks(this,xs).trim,t);return{amount:e.amount+a.amount,isPercentage:a.isPercentage}}_getComparePropertySum(t){const e=super.getProperty(ks(this,Ws).frame,t),a=super.getProperty(ks(this,Ws).trim,t);return{amount:e.amount+a.amount,isPercentage:e.isPercentage&&a.isPercentage}}_getText(t){const e=50;let a=0,i=0,s=0,n="",r='<table class="table table-striped table-hover text-table mt-4"><thead>';r+='<tr><th scope="col">Property</th><th scope="col">Change</th></tr></thead><tbody>';for(const[o,l]of t)r+=`<tr><td>${o}</td><td>${Ts._getDiff(l.compare,l.base,l.isPercentage)}`,r+='<span class="rate">',l.compare>=0?(l.base>=0?l.compare>l.base?(a=l.base,i=l.compare-l.base,n="pos"):(a=l.compare,i=l.base-l.compare,n="neg"):(a=0,i=l.compare,n="pos"),r+='<span class="bar neutral" style="width:50%;"></span>',r+=`<span class="bar pos diff" style="width:${a/l.max*e}%;"></span>`,r+=`<span class="bar ${n}" style="width:${i/l.max*e}%;"></span>`):l.compare<0?(l.base<0?l.compare>=l.base?(a=l.compare,i=l.base-l.compare,s=-l.base,n="pos"):(a=l.base,i=l.compare-l.base,s=-l.compare,n="neg"):(a=0,i=l.compare,s=-l.compare,n="neg"),r+=`<span class="bar neutral" style="width:${e+s/l.min*e}%;"></span>`,r+=`<span class="bar ${n}" style="width:${i/l.min*e}%;"></span>`,r+=`<span class="bar neg diff" style="width:${a/l.min*e}%;"></span>`):r+='<span class="bar neutral"></span>',r+="</span></td></tr>";return r+="</tbody></table>",r}_printTextComparison(){const t=new Map;for(const e of super.woodData.modifierNames){const a=this._getBasePropertySum(e),i=this._getComparePropertySum(e);t.set(e,{base:a.amount,compare:i.amount,isPercentage:a.isPercentage,min:super.woodData.getMinProperty(e),max:super.woodData.getMaxProperty(e)})}super.div.html(this._getText(t))}}function Ds(t,e,a){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,a)}function Ls(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,Is(t,e,"get"))}function js(t,e,a){return function(t,e,a){if(e.set)e.set.call(t,a);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=a}}(t,Is(t,e,"set"),a),a}function Is(t,e,a){if(!e.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return e.get(t)}var Cs=new WeakMap,As=new WeakMap,Ps=new WeakMap,Es=new WeakMap,Os=new WeakMap,Rs=new WeakMap,Ns=new WeakMap,Zs=new WeakMap,qs=new WeakMap;class Bs{constructor(t="compare-wood"){Ds(this,Cs,{writable:!0,value:{}}),Ds(this,As,{writable:!0,value:{}}),Ds(this,Ps,{writable:!0,value:{}}),Ds(this,Es,{writable:!0,value:void 0}),Ds(this,Os,{writable:!0,value:{}}),Ds(this,Rs,{writable:!0,value:{}}),Ds(this,Ns,{writable:!0,value:void 0}),Ds(this,Zs,{writable:!0,value:void 0}),Ds(this,qs,{writable:!0,value:void 0}),js(this,Zs,t),js(this,Ns,"compare-wood"===Ls(this,Zs)?"Compare woods":Ls(this,Zs)),js(this,qs,`menu-${Ls(this,Zs)}`),"compare-wood"===Ls(this,Zs)&&this._setupMenuListener(),this._setupData()}_enableSelects(t){for(const e of Pt.Kf)Ls(this,Os)[t][e].enable()}_disableSelects(t){for(const e of Pt.Kf)Ls(this,Os)[t][e].disable()}initSelects(t,e){Ls(this,Os)[t]={};for(const a of Pt.Kf)Ls(this,Os)[t][a]=new d.Z(`${Ls(this,Zs)}-${t}-${a}`,e,{title:`Select ${a}`},Ls(this,Rs).getOptions(a))}async init(){js(this,Rs,new Wa.J(Ls(this,Zs))),await Ls(this,Rs).init();for(const t of Ls(this,Cs))Ls(this,Ps)[t]=!1,"compare-wood"===Ls(this,Zs)&&(this.initSelects(t,Ls(this,Es).getBaseIdSelects(t)),this._setupSelectListener(t),"base"!==t&&this._disableSelects(t))}_setupData(){"compare-wood"===Ls(this,Zs)?js(this,As,["c1","c2","c3"]):"ship-journey"===Ls(this,Zs)?js(this,As,[]):"compare-ship"===Ls(this,Zs)&&js(this,As,["c1","c2"]),js(this,Cs,[...Ls(this,As)]),Ls(this,Cs).unshift("base")}_setupMenuListener(){document.querySelector(`#${Ls(this,qs)}`).addEventListener("click",(()=>{this._menuClicked()}))}async _menuClicked(){(0,s.KS)("Menu",Ls(this,Ns)),Ls(this,Es)?Ls(this,Es).show():(js(this,Es,new ls(Ls(this,Ns),Ls(this,Cs))),await this.init())}_setColumns(t){if("base"===t){Ls(this,Ps)[t]=!0,new ys(Ls(this,Es).getBaseIdOutput(t),Ls(this,Rs),this._getWoodData("base"));for(const t of Ls(this,As))"compare-wood"===Ls(this,Zs)&&this._enableSelects(t),Ls(this,Ps)[t]&&(Ls(this,Ps)[t]=!0,new Ts(Ls(this,Es).getBaseIdOutput(t),Ls(this,Rs),this._getWoodData("base"),this._getWoodData(t)))}else Ls(this,Ps)[t]=!0,new Ts(Ls(this,Es).getBaseIdOutput(t),Ls(this,Rs),this._getWoodData("base"),this._getWoodData(t))}_setOtherSelect(t,e){const a="frame"===e?"trim":"frame";0===Number(Ls(this,Os)[t][a].getValues())&&Ls(this,Os)[t][a].reset(Ls(this,Rs).defaultWoodId[a])}woodSelected(t,e){this._setOtherSelect(t,e),"compare-wood"===Ls(this,Zs)&&this._setColumns(t)}_setupSelectListener(t){for(const e of Pt.Kf){const{select$:a}=Ls(this,Os)[t][e];a.on("change",(()=>{this.woodSelected(t,e)}))}}_getWoodData(t){const e=Number(Ls(this,Os)[t].frame.getValues()),a=Number(Ls(this,Os)[t].trim.getValues());return{frame:Ls(this,Rs).getWoodTypeData(e),trim:Ls(this,Rs).getWoodTypeData(a)}}}const Fs=(t,e)=>{(0,i.V4)(e),new Bs,new ii,new S,new F,new bt(t),new It,new Xt,new ce,new Le(t),new Qe(t),new ua(t),new xa,new Va,new Ii(t),new is(t)}},5042:()=>{}}]);