(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(t,e,a){"use strict";function i(t){var e=["th","st","nd","rd"],a=t%100;return t+(e[(a-20)%10]||e[a]||e[0])}function r(t){return 0===Object.getOwnPropertyNames(t).length&&t.constructor===Object}function n(t){return 200<=t.status&&300>t.status?Promise.resolve(t):Promise.reject(new Error(t.statusText))}function s(t,e,a){if(void 0===a&&(a=!0),2>e)return[t];var i,r=t.length,n=[],s=0;if(0==r%e)for(i=d(r/e);s<r;)n.push(t.slice(s,s+=i));else if(a)for(;s<r;)i=Math.ceil((r-s)/e--),n.push(t.slice(s,s+=i));else{for(0==r%(i=d(r/(e-=1)))&&(i-=1);s<i*e;)n.push(t.slice(s,s+=i));n.push(t.slice(i*e))}return n}var o=Math.pow,c=Math.PI,d=Math.floor,h=Math.round;a.d(e,"k",function(){return b}),a.d(e,"l",function(){return v}),a.d(e,"j",function(){return y}),a.d(e,"m",function(){return S}),a.d(e,"o",function(){return w}),a.d(e,"n",function(){return D}),a.d(e,"p",function(){return j}),a.d(e,"r",function(){return i}),a.d(e,"w",function(){return C}),a.d(e,"s",function(){return r}),a.d(e,"e",function(){return k}),a.d(e,"f",function(){return x}),a.d(e,"g",function(){return I}),a.d(e,"a",function(){return O}),a.d(e,"h",function(){return P}),a.d(e,"v",function(){return T}),a.d(e,"i",function(){return B}),a.d(e,"t",function(){return L}),a.d(e,"c",function(){return n}),a.d(e,"q",function(){return M}),a.d(e,"u",function(){return N}),a.d(e,"b",function(){return A}),a.d(e,"d",function(){return s});var u=a(92),p=(a.n(u),a(69)),l=(a.n(p),a(54)),m=(a.n(l),a(55)),_=(a.n(m),a(10)),f=Object(_.b)({decimal:".",thousands:" ",grouping:[3],currency:[""," reals"],percent:" %"}),g=Object(_.c)(",.0",1e3),b=function(t,e){return void 0===e&&(e=2),f.format(",."+e+"~r")(t).replace("-","− ")},v=function(t,e){return void 0===e&&(e=2),f.format("."+e+"f")(t).replace("-","− ").replace(".00",'<span class="hidden">.00</span>').replace(/\.(\d)0/g,'.$1<span class="hidden">0</span>')},y=function(t){return g(-1*t).replace("-","− ")},S=function(t){return f.format(",d")(t).replace("-","− ")},w=function(t){return f.format(",.2s")(t).replace(".0","").replace("-","− ")},D=function(t,e){return void 0===e&&(e=1),f.format("."+e+"%")(t).replace(".0","").replace("-","− ")},j=function(t){return f.format("+.1%")(t).replace(".0","").replace("-","− ").replace("+","＋ ")},C=function(t){return function(t,e){return void 0===e&&(e=0),+(h(t+"e"+e)+"e-"+e)}(t,3)},k=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"],x=function(t){var e=360/k.length;return k.indexOf(t)*e},I=function(t){var e=d(t/22.5+.5);return k[e%16]},O=function(t,e,a,i){var r=Math.min.apply(Math,[e,a]),n=Math.max.apply(Math,[e,a]);return i?t>=r&&t<=n:t>r&&t<n},P=function(t){return c/180*(t-90)},T=function(t,e){var a=Math.atan2(e.y-t.y,e.x-t.x),i=function(t){return 180*t/c}(a-=c/2);return 0>i&&(i+=360),i},B=function(t,e){return Math.sqrt(o(t.x-e.x,2)+o(t.y-e.y,2))},L=function(t){return o(2,h(Math.log2(t)))},M=function(t){return t.json()},N=function(t){console.error("Request failed --\x3e",t)},A=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},11:function(t){t.exports=jQuery},121:function(t,e,a){"use strict";var i=Math.ceil,r=Math.log2,n=Math.pow,s=Math.max,o=Math.min,c=Math.floor,d=Math.round;(function(t){function h(t,e){for(var a,i=0;i<e.length;i++)(a=e[i]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}a.d(e,"a",function(){return Z});var u=a(90),p=(a.n(u),a(69)),l=(a.n(p),a(148)),m=(a.n(l),a(92)),_=(a.n(m),a(24)),f=(a.n(_),a(26)),g=(a.n(f),a(19)),b=(a.n(g),a(106)),v=(a.n(b),a(160)),y=(a.n(v),a(2)),S=a(0),w=a(29),D=a(48),j=a(13),C=a.n(j),k=a(4),x=a(1),I=a(122),O=a(123),P=a(124),T=a(125),B=a(126),L=a(127),M=a(128),N=a(129),A=a(130),R=a(132),E=a(135),z=a(136),F=a(57),W=a(137),H=a(41),G=a(138),J=a(7),Z=function(){function e(t){this._serverName=t,this._dataSource=[{fileName:t+".json",name:"ports"},{fileName:t+"-pb.json",name:"pb"},{fileName:"pb.json",name:"pbZones"},{fileName:"ships.json",name:"ships"},{fileName:"cannons.json",name:"cannons"},{fileName:"woods.json",name:"woods"},{fileName:"modules.json",name:"modules"},{fileName:"recipes.json",name:"recipes"},{fileName:"buildings.json",name:"buildings"},{fileName:"ownership.json",name:"ownership"},{fileName:"nations.json",name:"nations"}],this.rem=k.j,this._navbarBrandPaddingLeft=c(1.618*this.rem),this.xGridBackgroundHeight=c(3*this.rem),this.yGridBackgroundWidth=c(4*this.rem),this.coord={min:0,max:8192},this._currentTranslate={},this._navbarSelector=document.querySelector(".navbar"),this._tileSize=256,this._maxScale=8,this._wheelDelta=.5,this._PBZoneZoomThreshold=1.5,this._labelZoomThreshold=.5,this._doubleClickActionCookieName="na-map--double-click",this._doubleClickActionDefault="compass",this._doubleClickAction=this._getDoubleClickAction(),this._showLayerCookieName="na-map--show-layer",this._showLayerDefault="grid",this._showLayer=this._getShowLayer(),this._setHeightWidth(),this._setupScale(),this._setupSvg(),this._setSvgSize(),this._setupListener(),this._setupProps(),this._readData()}var a=e.prototype;return a._getDoubleClickAction=function(){var t=C.a.get(this._doubleClickActionCookieName);return t=void 0===t?this._doubleClickActionDefault:t},a._getShowLayer=function(){var t=C.a.get(this._showLayerCookieName);return t=void 0===t?this._showLayerDefault:t},a._setupData=function(t){function e(t){return t.filter(function(t){return i.includes(t.id)}).map(function(t){return{type:"Feature",id:t.id,geometry:t.geometry}})}var a=Object(D.a)(t.ports,t.ports.objects.ports),i=a.features.filter(function(t){return!t.properties.nonCapturable}).map(function(t){return t.id});this._f11=new P.a(this,this.coord),this._ports=new R.a(a.features,t.pb,this);var r=Object(D.a)(t.pbZones,t.pbZones.objects.pbCircles);r=e(r.features);var n=Object(D.a)(t.pbZones,t.pbZones.objects.forts);n=e(n.features);var s=Object(D.a)(t.pbZones,t.pbZones.objects.towers);s=e(s.features);var o=Object(D.a)(t.pbZones,t.pbZones.objects.joinCircles);o=e(o.features),this._pbZone=new N.a(r,n,s,o,this._ports);var c=JSON.parse(JSON.stringify(t.woods));this._woodCompare=new H.a(c,"wood"),this._woodList=new G.a(c);var d=JSON.parse(JSON.stringify(t.ships.shipData));this._shipCompare=new F.a(d,c);var h=JSON.parse(JSON.stringify(t.cannons));this._cannonList=new O.a(h);var u=JSON.parse(JSON.stringify(t.ownership)),p=JSON.parse(JSON.stringify(t.nations));this._ownershipList=new A.a(u,p);var l=JSON.parse(JSON.stringify(t.modules));this._moduleList=new M.a(l);var m=JSON.parse(JSON.stringify(t.recipes.recipe));this._recipeList=new z.a(m,l);var _=JSON.parse(JSON.stringify(t.recipes.ingredient));this._ingredientList=new B.a(_,l);var f=JSON.parse(JSON.stringify(t.buildings));this._buildingList=new I.a(f),this._journey=new L.a(d,c,this.rem),this._portSelect=new E.a(this._ports,this._pbZone),this._windPrediction=new W.a,this._grid=new T.a(this),this._init()},a._readData=function(){var t=this,e=[],a={};this._dataSource.forEach(function(t,a){e[a]=fetch(t.fileName).then(x.c).then(x.q)}),Promise.all(e).then(function(e){e.forEach(function(i,r){a[t._dataSource[r].name]=e[r]}),t._setupData(a)}).catch(x.u)},a._setupListener=function(){var e=this;this.svg.on("dblclick.zoom",null).on("click",function(){S.event.defaultPrevented&&S.event.stopPropagation()},!0).on("dblclick",function(t,a,i){return e._doDoubleClickAction(i[a])}),t("#reset").on("click",function(){e._clearMap()}),t("#propertyDropdown").on("click",function(){Object(J.b)("Menu","Select port on property")}),t("#settingsDropdown").on("click",function(){Object(J.b)("Menu","Settings")}),t("#button-download-pb-calc").on("click",function(){Object(J.b)("Tools","Download pb calculator")}),t("#doubleClick-action").change(function(){return e._doubleClickSelected()}),t("#show-layer").change(function(){return e._showLayerSelected()}),t("#about").on("click",function(){e._showAbout()})},a._setupScale=function(){this._minScale=Object(x.t)(o(this.width/this.coord.max,this.height/this.coord.max)),this._currentScale=this._minScale},a._setupSvg=function(){var t=this;this._zoom=Object(w.a)().wheelDelta(function(){return-t._wheelDelta*Math.sign(S.event.deltaY)}).translateExtent([[this.coord.min-this.yGridBackgroundWidth*this._minScale,this.coord.min-this.xGridBackgroundHeight*this._minScale],[this.coord.max,this.coord.max]]).scaleExtent([this._minScale,this._maxScale]).on("zoom",function(){return t._naZoomed()}),this.svg=Object(S.select)("#na-map").append("svg").attr("id","na-svg").call(this._zoom),this.svg.append("defs"),this._gMap=this.svg.append("g").classed("map",!0)},a._setupProps=function(){t("#doubleClick-action-"+this._doubleClickAction).prop("checked",!0),t("#show-layer-"+this._showLayer).prop("checked",!0)},a._storeDoubleClickActionSetting=function(){this._doubleClickAction===this._doubleClickActionDefault?C.a.remove(this._doubleClickActionCookieName):C.a.set(this._doubleClickActionCookieName,this._doubleClickAction)},a._doubleClickSelected=function(){this._doubleClickAction=t("input[name='doubleClickAction']:checked").val(),this._storeDoubleClickActionSetting(),this._clearMap()},a._storeShowLayerSetting=function(){this._showLayer===this._showLayerDefault?C.a.remove(this._showLayerCookieName):C.a.set(this._showLayerCookieName,this._showLayer)},a._showLayerSelected=function(){this._showLayer=t("input[name='showLayer']:checked").val(),this._storeShowLayerSetting(),this._refreshLayer()},a._refreshLayer=function(){var t="grid"===this._showLayer;this._grid.show=t,this._grid.update()},a._displayMap=function(t){var e=t.x,a=t.y,h=t.k,u=r(this._tileSize),p=r(this.coord.max)-u,l=this.coord.max*h,m=this.width,_=this.height,f=c(l<this.width?this.width-2*e:l),g=c(l<this.height?this.height-2*a:l),b=r(h),v=o(p,i(r(s(f,g)))-u),S=d(10*(v-b-p))/10,D=n(this._wheelDelta,S),j=this._tileSize*D,C=l<this.width?e:0,k=l<this.height?a:0,I=Object(y.range)(s(0,c((0-e)/j)),s(0,o(i((m-e-C)/j),n(2,v)))),O=[];Object(y.range)(s(0,c((0-a)/j)),s(0,o(i((_-a-k)/j),n(2,v)))).forEach(function(t){I.forEach(function(e){O.push({z:v,row:t,col:e,id:v.toString()+"-"+t.toString()+"-"+e.toString()})})}),O.transform=w.b.translate(e,a).scale(Object(x.w)(D)),this._updateMap(O)},a._updateMap=function(t){var e=this,a=this._gMap.attr("transform",t.transform).selectAll("image").data(t,function(t){return t.id});a.exit().remove(),a.enter().append("image").attr("xlink:href",function(t){return"images/map/"+t.z+"/"+t.row+"/"+t.col+".jpg"}).attr("x",function(t){return t.col*e._tileSize}).attr("y",function(t){return t.row*e._tileSize}).attr("width",this._tileSize).attr("height",this._tileSize)},a._clearMap=function(){this._windPrediction.clearMap(),this._journey.clearMap(),this._f11.clearMap(),this._ports.clearMap(),this._portSelect.clearMap(),t(".selectpicker").val("default").selectpicker("refresh")},a._showAbout=function(){var e="modal-about";document.getElementById(e)||function(t){Object(k.n)(t,k.b+' <span class="text-primary small">v'+k.c+"</span>",""),Object(S.select)("#"+t+" .modal-body").html("<p>"+k.a+' Please check the <a href="https://forum.game-labs.net/topic/23980-yet-another-map-naval-action-map/"> Game-Labs forum post</a> for further details. Feedback is very welcome.</p><p>Designed by iB aka Felix Victor, clan <a href="https://bccnavalaction.freeforums.net/">British Captains’ Club (BCC)</a>.</p>')}(e),t("#"+e).modal("show")},a._doDoubleClickAction=function(t){var e=Object(S.mouse)(t),a=Object(w.c)(t),i=e[0],r=e[1],n=a.k,s=(i-a.x)/n,o=(r-a.y)/n;"f11"===this._doubleClickAction?this._f11.printCoord(s,o):this._journey.plotCourse(s,o),this.zoomAndPan(s,o,1)},a._updateCurrent=function(){this._pbZone.refresh(),this._grid.update(),this._ports.update(this._currentScale)},a._setZoomLevelAndData=function(){S.event.transform.k!==this._currentScale&&(this._currentScale=S.event.transform.k,this._currentScale>this._PBZoneZoomThreshold?"pbZone"!==this._zoomLevel&&(this.zoomLevel="pbZone"):this._currentScale>this._labelZoomThreshold?"portLabel"!==this._zoomLevel&&(this.zoomLevel="portLabel"):"initial"!==this._zoomLevel&&(this.zoomLevel="initial"),this._updateCurrent())},a._naZoomed=function(){this._setZoomLevelAndData(),this._currentTranslate.x=c(S.event.transform.x),this._currentTranslate.y=c(S.event.transform.y);var t=w.b.translate(this._currentTranslate.x,this._currentTranslate.y).scale(Object(x.w)(S.event.transform.k));this._displayMap(t),this._grid.transform(t),this._ports.transform(t),this._journey.transform(t),this._pbZone.transform(t),this._f11.transform(t)},a._init=function(){this.zoomLevel="initial",this.initialZoomAndPan(),this._refreshLayer(),this._ports.clearMap(this._minScale),this._f11.checkF11Coord()},a.resize=function(){var t=w.b.translate(this._currentTranslate.x,this._currentTranslate.y).scale(this._currentScale);this._setHeightWidth(),this._setSvgSize(),this._displayMap(t),this._grid.update()},a._getDimensions=function(){return document.getElementById("na-map").getBoundingClientRect()},a._getWidth=function(){var t=this._getDimensions().width;return c(t)},a._getHeight=function(){var t=this._getDimensions().top,e=document.documentElement.clientHeight-this.rem;return c(e-t)},a._setHeightWidth=function(){this.width=this._getWidth(),this.height=this._getHeight()},a._setSvgSize=function(){this.svg.attr("width",this.width).attr("height",this.height).call(this._zoom)},a.initialZoomAndPan=function(){this.svg.call(this._zoom.scaleTo,this._minScale)},a.zoomAndPan=function(t,e,a){var i=w.b.scale(a).translate(d(-t+this.width/2/a),d(-e+this.height/2/a));this.svg.call(this._zoom.transform,i)},a.goToPort=function(){"0"===this._ports.currentPort.id?this.initialZoomAndPan():this.zoomAndPan(this._ports.currentPort.coord.x,this._ports.currentPort.coord.y,2)},function(t,e,a){e&&h(t.prototype,e),a&&h(t,a)}(e,[{key:"zoomLevel",set:function(t){this._zoomLevel=t,this._ports.zoomLevel=t,this._grid.zoomLevel=t}}]),e}()}).call(this,a(11))},122:function(t,e,a){"use strict";(function(t){a.d(e,"a",function(){return d});var i=a(31),r=(a.n(i),a(19)),n=(a.n(r),a(0)),s=a(1),o=a(7),c=a(4),d=function(){function e(t){this._buildingData=t,this._baseName="List buildings",this._baseId="building-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}var a=e.prototype;return a._setupListener=function(){var e=this;t("#"+this._buttonId).on("click",function(t){Object(o.b)("Tools",e._baseName),t.stopPropagation(),e._buildingListSelected()})},a._injectModal=function(){Object(c.n)(this._modalId,this._baseName);var t=this._baseId+"-select",e=Object(n.select)("#"+this._modalId+" .modal-body");e.append("label").attr("for",t),e.append("select").attr("name",t).attr("id",t),e.append("div").attr("id",""+this._baseId).attr("class","container-fluid")},a._getOptions=function(){return""+this._buildingData.map(function(t){return'<option value="'+t.name+'">'+t.name+"</option>;"}).join("")},a._setupSelect=function(){var e=t("#"+this._baseId+"-select"),a=this._getOptions();e.append(a)},a._setupSelectListener=function(){var e=this;t("#"+this._baseId+"-select").addClass("selectpicker").on("change",function(t){return e._buildingSelected(t)}).selectpicker({noneSelectedText:"Select building"}).val("default").selectpicker("refresh")},a._initModal=function(){this._injectModal(),this._setupSelect(),this._setupSelectListener()},a._buildingListSelected=function(){document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")},a._getBuildingData=function(t){return this._buildingData.filter(function(e){return e.name===t})[0]},a._getProductText=function(t){var e="";return Array.isArray(t.resource)?(e+='<table class="table table-sm"><tbody>',e+="<tr><td>"+t.resource.map(function(t){return t.name}).join("</td></tr><tr><td>")+"</td></tr>",e+="</tbody></table>"):(e+='<h5 class="card-title">'+t.resource.name+"</h5>",t.resource.price&&(e+='<table class="table table-sm"><tbody>',e+="<tr><td>"+Object(c.k)(t.resource.price)+" per unit</td></tr>",void 0!==t.batch&&(e+="<tr><td>Batch of "+t.batch.amount+" units at "+Object(c.k)(t.batch.price)+"</td></tr>"),e+="</tbody></table>")),e},a._getRequirementText=function(t){var e="";return e+='<table class="table table-sm"><thead>',t.levels[0].materials.length?(e+="<tr><th>Level</th><th>Level build materials</th></tr>",e+="</thead><tbody>",t.levels.forEach(function(t,a){e+="<tr><td>"+a+'</td><td class="text-left">',e+=t.materials.map(function(t){return Object(s.m)(t.amount)+" "+t.item}).join("<br>"),e+="</td></tr>"})):(e+="<tr><th>Level</th><th>Production (units)</th><th>Labour cost (%)</th><th>Storage (units)</th><th>Build price (reals)</th></tr>",e+="</thead><tbody>",t.levels.forEach(function(t,a){e+="<tr><td>"+a+"</td><td>"+Object(s.m)(t.production)+"</td><td>"+Object(s.m)(-100*t.labourDiscount)+"</td><td>"+Object(s.m)(t.maxStorage)+"</td><td>"+Object(s.m)(t.price)+"</td></tr>"})),e+="</tbody></table>"},a._getText=function(t){var e=this._getBuildingData(t),a='<div class="row no-gutters card-deck">';return a+='<div class="card col-4"><div class="card-header">Product</div>',a+='<div class="card-body product">',a+=this._getProductText(e),a+="</div></div>",a+='<div class="card col-8"><div class="card-header">Requirements</div>',a+='<div class="card-body px-0 requirements">',a+=this._getRequirementText(e),a+="</div></div>",a+="</div>"},a._buildingSelected=function(e){var a=t(e.currentTarget).find(":selected").val();Object(n.select)("#"+this._baseId+" div").remove(),Object(n.select)("#"+this._baseId).append("div").classed("buildings mt-4",!0),Object(n.select)("#"+this._baseId+" div").html(this._getText(a))},e}()}).call(this,a(11))},123:function(t,e,a){"use strict";var i=Number.isNaN;(function(t){a.d(e,"a",function(){return S});var r=a(39),n=(a.n(r),a(40)),s=(a.n(n),a(172)),o=(a.n(s),a(24)),c=(a.n(o),a(26)),d=(a.n(c),a(84)),h=(a.n(d),a(113)),u=(a.n(h),a(54)),p=(a.n(u),a(19)),l=(a.n(p),a(114)),m=(a.n(l),a(55)),_=(a.n(m),a(0)),f=a(46),g=a.n(f),b=a(4),v=a(1),y=a(7);String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"g"),e)};var S=function(){function e(t){this._cannonData=t,this._baseName="List cannons",this._baseId="cannon-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._groups=["damage","dispersion","generic","crew"],this._setupListener()}var a=e.prototype;return a._setupListener=function(){var e=this;t("#"+this._buttonId).on("click",function(t){Object(y.b)("Tools",e._baseName),t.stopPropagation(),e._cannonListSelected()})},a._injectModal=function(){Object(b.n)(this._modalId,this._baseName);var t=Object(_.select)("#"+this._modalId+" .modal-body");["medium","long","carronade"].forEach(function(e){t.append("h5").text(Object(v.b)(e)),t.append("div").attr("id",e+"-list").attr("class","modules")})},a._initTablesort=function(){var t=function(t){return t.replace(/[^\-?0-9.]/g,"")},e=function(t,e){var a=parseFloat(t),r=parseFloat(e);return(a=i(a)?0:a)-(r=i(r)?0:r)};g.a.extend("number",function(t){return t.match(/^[-+]?[£\x24Û¢´€]?\d+\s*([,.]\d{0,2})/)||t.match(/^[-+]?\d+\s*([,.]\d{0,2})?[£\x24Û¢´€]/)||t.match(/^[-+]?(\d)*-?([,.])?-?(\d)+([E,e][-+][\d]+)?%?$/)},function(a,i){var r=t(a),n=t(i);return e(n,r)})},a._initModal=function(){var t=this;this._initTablesort(),this._injectModal(),["medium","long","carronade"].forEach(function(e){t._injectList(e)})},a._cannonListSelected=function(){document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")},a._injectList=function(e){t("#"+e+"-list").append(this._getList(e));var a=document.getElementById("table-"+e+"-list");new g.a(a)},a._getModifiers=function(t){var e=this,a=new Set;return this._cannonData[t].forEach(function(t){e._groups.forEach(function(e){Object.entries(t[e]).forEach(function(t){var i=t[0];a.add(e+" "+i)})})}),Array.from(a).sort()},a._getList=function(t){var e=this,a=this._getModifiers(t),i="";return i+='<table id="table-'+t+'-list" class="table table-sm small tablesort"><thead><tr><th data-sort-default>Pounds</th>',a.forEach(function(t){var e=Object(v.b)(t.replace("generic ","").replace("damage basic","damage").replace("damage penetration","penetration"));i+="<th>"+e+"</th>"}),i+="</tr></thead><tbody>",this._cannonData[t].forEach(function(t){var r=t.name.replace(" (","<br>(").replaceAll(" "," ");i+='<tr><td class="text-right" data-sort="'+parseInt(t.name,10)+'">'+r+"</td>",a.forEach(function(a){e._groups.forEach(function(e){Object.entries(t[e]).forEach(function(t){var r=t[0],n=t[1];e+" "+r===a&&(i+='<td class="text-right" data-sort="'+(n||0)+'">'+(n?Object(v.l)(n):"")+"</td>")})})}),i+="</tr>"}),i+="</tbody></table>"},e}()}).call(this,a(11))},124:function(t,e,a){"use strict";var i=Number.isNaN;(function(t){a.d(e,"a",function(){return d});var r=a(54),n=(a.n(r),a(0)),s=a(1),o=a(4),c=a(7),d=(a(57),a(41),function(){function e(t,e){this._map=t,this._coord=e,this._baseName="Go to F11",this._baseId="go-to-f11",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._formId="form-"+this._baseId,this._xInputId="input-x-"+this._baseId,this._zInputId="input-z-"+this._baseId,this._copyButtonId="copy-coord-"+this._baseId,this._submitButtonId="submit-"+this._baseId,this._setupSvg(),this._setupListener()}var a=e.prototype;return a._setupSvg=function(){this._g=Object(n.select)("#na-svg").append("g").classed("f11",!0)},a._navbarClick=function(t){Object(c.b)("Menu","Go to F11"),t.stopPropagation(),this._f11Selected()},a._setupListener=function(){var t=this;document.getElementById(""+this._buttonId).addEventListener("click",function(e){return t._navbarClick(e)}),window.onkeydown=function(e){"F11"===e.code&&e.shiftKey&&t._navbarClick(e)}},a._injectModal=function(){Object(o.n)(this._modalId,this._baseName,"sm");var t=Object(n.select)("#"+this._modalId+" .modal-body").append("form").attr("id",this._formId).attr("role","form");t.append("div").classed("alert alert-primary",!0).text("Use F11 in open world.");var e=t.append("div").classed("form-group",!0).append("div").classed("input-group",!0);e.append("label").attr("for",this._xInputId),e.append("input").classed("form-control",!0).attr("id",this._xInputId).attr("type","number").attr("required","").attr("placeholder","X coordinate").attr("min","-819").attr("max","819").attr("step","1").attr("tabindex","1"),e.append("div").classed("input-group-append",!0).append("span").classed("input-group-text",!0).text("k");var a=t.append("div").classed("form-group",!0).append("div").classed("input-group",!0);a.append("label").attr("for",this._zInputId),a.append("input").classed("form-control",!0).attr("id",this._zInputId).attr("type","number").attr("required","").attr("placeholder","Z coordinate").attr("step","1").attr("min","-819").attr("max","819").attr("tabindex","2"),a.append("div").classed("input-group-append",!0).append("span").classed("input-group-text",!0).text("k"),t.append("div").classed("alert alert-primary",!0).append("small").html("In k units (divide by 1,000).<br>Example: <em>43</em> for value of <em>43,162.5</em>.");var i=t.append("div").classed("float-right btn-group",!0).attr("role","group");i.append("button").classed("btn btn-outline-secondary",!0).attr("id",this._copyButtonId).attr("title","Copy to clipboard (ctrl-c)").attr("type","button").append("i").classed("far fa-copy",!0),i.append("button").classed("btn btn-outline-secondary",!0).attr("id",this._submitButtonId).attr("title","Go to").attr("type","submit").text("Go to"),Object(n.select)("#"+this._modalId+" .modal-footer").remove()},a._initModal=function(){this._injectModal()},a._f11Selected=function(){var e=this;document.getElementById(this._modalId)||(this._initModal(),document.getElementById(this._formId).onsubmit=function(a){t("#"+e._modalId).modal("hide"),a.preventDefault(),e._useUserInput()},document.getElementById(this._modalId).onkeydown=function(t){"KeyC"===t.code&&t.ctrlKey&&e._copyCoordClicked()},document.getElementById(this._copyButtonId).addEventListener("click",function(){e._copyCoordClicked()})),t("#"+this._modalId).modal("show");var a=document.getElementById(this._xInputId);a.focus(),a.select()},a._getInputValue=function(t){var e=document.getElementById(t).value;return e=""===e?1/0:+e},a._getXCoord=function(){return this._getInputValue(this._xInputId)},a._getZCoord=function(){return this._getInputValue(this._zInputId)},a._useUserInput=function(){var t=-1e3*this._getXCoord(),e=-1e3*this._getZCoord();t!=-1/0&&e!=-1/0&&this._goToF11(t,e)},a._copyCoordClicked=function(){Object(c.b)("Menu","Copy F11 coordinates"),event.preventDefault();var t=this._getXCoord(),e=this._getZCoord();if(!i(t)&&t!==1/0&&!i(e)&&e!==1/0){var a=new URL(window.location);a.searchParams.set("x",t),a.searchParams.set("z",e),function(t){navigator.permissions.query({name:"clipboard-write"}).then(function(e){("granted"==e.state||"prompt"==e.state)&&navigator.clipboard.writeText(t).then(function(){},function(){console.error("Cannot copy "+t+" to clipboard",err)})})}(a)}},a._printF11Coord=function(t,e,a,i){var r=this._g.append("g").attr("transform","translate("+t+","+e+")");r.append("circle").attr("r",10),r.append("text").attr("dx","-.6em").attr("dy","-.5em").text(Object(s.j)(a)),r.append("text").attr("dx","-.6em").attr("dy",".5em").text(Object(s.j)(i))},a._goToF11=function(t,e){var a=+t,i=+e,r=Object(o.e)(a,i),n=Object(o.f)(a,i);Object(s.a)(r,this._coord.min,this._coord.max,!0)&&Object(s.a)(n,this._coord.min,this._coord.max,!0)&&(this._printF11Coord(r,n,a,i),this._map.zoomAndPan(r,n,1))},a.checkF11Coord=function(){var t=new URL(document.location).searchParams;if(t.has("x")&&t.has("z")){var e=-1e3*+t.get("x"),a=-1e3*+t.get("z");Object(c.b)("Menu","Paste F11 coordinates"),this._goToF11(e,a)}else history.pushState("","",window.location.pathname)},a.printCoord=function(t,e){var a=Object(o.g)(t,e),i=Object(o.h)(t,e);this._printF11Coord(t,e,a,i)},a.transform=function(t){this._g.attr("transform",t)},a.clearMap=function(){this._g.selectAll("*").remove()},e}())}).call(this,a(11))},125:function(t,e,a){"use strict";function i(t,e){for(var a,i=0;i<e.length;i++)(a=e[i]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}var r=Math.round;a.d(e,"a",function(){return h});var n=a(21),s=a(0),o=a(9),c=a(1),d=a(4),h=function(){function t(t){this._map=t,this._isShown=!0,this._minCoord=this._map.coord.min,this._maxCoord=this._map.coord.max,this._height=this._map.height,this._width=this._map.width,this._defaultFontSize=this._map.rem,this._textPadding=this._defaultFontSize/2,this._xBackgroundHeight=this._map.xGridBackgroundHeight,this._yBackgroundWidth=this._map.yGridBackgroundWidth,this._setupSvg()}var e=t.prototype;return e._setupSvg=function(){this._setupScale(),this._setupAxis()},e._setupScale=function(){this._xScale=Object(o.scaleLinear)().clamp(!0).domain([Object(d.g)(this._minCoord,this._minCoord),Object(d.g)(this._maxCoord,this._maxCoord)]).range([this._minCoord,this._maxCoord]),this._yScale=Object(o.scaleLinear)().clamp(!0).domain([Object(d.h)(this._minCoord,this._minCoord),Object(d.h)(this._maxCoord,this._maxCoord)]).range([this._minCoord,this._maxCoord])},e._setupAxis=function(){var t=this._getTicks(65);this._xAxis=Object(n.a)(this._xScale).tickFormat(c.j).tickValues(t).tickSize(this._maxCoord),this._yAxis=Object(n.c)(this._yScale).tickFormat(c.j).tickValues(t).tickSize(this._maxCoord),this._gAxis=this._map.svg.append("g").classed("axis d-none",!0),this._gXAxis=this._gAxis.append("g").classed("axis-x",!0),this._gYAxis=this._gAxis.append("g").classed("axis-y",!0),this._setupBackground(),this._displayAxis(),this._setupXAxis(),this._setupYAxis()},e._getTicks=function(t){for(var e=r(Object(d.h)(this._minCoord,this._minCoord)),a=r(Object(d.h)(this._maxCoord,this._maxCoord)),i=(a-e)/(t-1),n=[],s=i;s<a;s+=i)n.push(r(s));n.push(a);var o=n.slice(0).reverse().map(function(t){return-t});return o.push(0),o.concat(n)},e._setupXAxis=function(){this._gXAxis.selectAll(".tick text").attr("dx","-0.3em").attr("dy","2em"),this._gXAxis.attr("text-anchor","end").attr("fill",null).attr("font-family",null)},e._setupYAxis=function(){this._gYAxis.attr("text-anchor","end").attr("fill",null).attr("font-family",null),this._gYAxis.selectAll(".tick text").attr("dx","3.5em").attr("dy","-.3em")},e._displayAxis=function(){this._displayXAxis(),this._displayYAxis()},e._displayXAxis=function(){var t=s.event?s.event.transform.k:1,e=s.event?s.event.transform.y:0,a=e/t<this._width?e/t:0;this._gXAxis.call(this._xAxis.tickPadding(-this._maxCoord-a)),this._gXAxis.attr("font-size",Object(c.w)(this._defaultFontSize/t)).attr("stroke-width",Object(c.w)(1/t)),this._gXAxis.select(".domain").remove()},e._displayYAxis=function(){var t=s.event?s.event.transform.k:1,e=s.event?s.event.transform.x:0,a=e/t<this._height?e/t:0;this._gYAxis.call(this._yAxis.tickPadding(-this._maxCoord-a)),this._gYAxis.attr("font-size",Object(c.w)(this._defaultFontSize/t)).attr("stroke-width",Object(c.w)(1/t)),this._gYAxis.select(".domain").remove()},e._setupBackground=function(){this._gBackground=this._map.svg.insert("g","g.axis").classed("grid-background d-none",!0),this._gBackground.append("rect").attr("height",this._xBackgroundHeight).attr("width",this._width),this._gBackground.append("rect").attr("height",this._height).attr("width",this._yBackgroundWidth)},e.update=function(){var t=!1,e=0;this._isShown&&"initial"!==this._zoomLevel&&(t=!0,e=this._xBackgroundHeight),this._gAxis.classed("d-none",!t),this._gBackground.classed("d-none",!t),Object(s.select)("#port-summary").style("margin-top",e+"px"),Object(s.select)("#journey-summary").style("margin-top",e+"px")},e.transform=function(t){this._gAxis.attr("transform",t),this._displayAxis()},function(t,e,a){e&&i(t.prototype,e),a&&i(t,a)}(t,[{key:"show",set:function(t){this._isShown=t}},{key:"zoomLevel",set:function(t){this._zoomLevel=t}}]),t}()},126:function(t,e,a){"use strict";(function(t){a.d(e,"a",function(){return u});var i=a(24),r=(a.n(i),a(26)),n=(a.n(r),a(39)),s=(a.n(n),a(19)),o=(a.n(s),a(0)),c=a(1),d=a(7),h=a(4),u=function(){function e(t,e){this._ingredientData=t,this._moduleData=e,this._baseName="List recipe ingredients",this._baseId="ingredient-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}var a=e.prototype;return a._setupListener=function(){var e=this;t("#"+this._buttonId).on("click",function(t){Object(d.b)("Tools",e._baseName),t.stopPropagation(),e._ingredientListSelected()})},a._injectModal=function(){Object(h.n)(this._modalId,this._baseName),Object(o.select)("#"+this._modalId+" .modal-body").append("div").attr("id",""+this._baseId).attr("class","container-fluid")},a._initModal=function(){this._injectModal(),this._injectList()},a._ingredientListSelected=function(){document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")},a._getProperties=function(t){var e="",a="",i="";return this._moduleData.forEach(function(e){e[1].filter(function(e){return e.name===t}).forEach(function(t){a=e[0],i="<tr><td>"+t.properties.map(function(t){var e=t.absolute?t.amount:Object(c.p)(t.amount/100);return t.modifier+" "+e}).join("</td></tr><tr><td>")+"</td></tr>"})}),e="<h6 class='text-muted text-left'>"+a+"</h6>",e+="<table class='table table-sm'><tbody>"+i+"</tbody></table>"},a._getRows=function(){var t=this;return this._ingredientData.map(function(e){return"<tr><td>"+e.name+"</td><td>"+e.recipe.map(function(e){return'<a data-toggle="tooltip" data-html="true" title="'+t._getProperties(e)+'">'+e+"</a>"}).join("<br>")+"</td></tr>"})},a._getText=function(){var t=this._getRows(),e=Object(c.d)(t,2),a="";return Array.from(Array(e.length).keys()).forEach(function(t){a+='<div class="col-md-'+Math.floor(12/e.length)+'">',a+='<table class="table table-sm"><thead>',a+="<tr><th>Ingredient</th><th>Recipe</th></tr></thead><tbody>",a+=e[t].join(""),a+="</tbody></table></div>"}),a},a._injectList=function(){Object(o.select)("#"+this._baseId+" div").remove(),Object(o.select)("#"+this._baseId).append("div").classed("row ingredients",!0),Object(o.select)("#"+this._baseId+" div").html(this._getText()),t('[data-toggle="tooltip"]').tooltip()},e}()}).call(this,a(11))},127:function(t,e,a){"use strict";var i=Math.max,r=Math.round;(function(t){a.d(e,"a",function(){return x});var n=a(86),s=(a.n(n),a(115)),o=(a.n(s),a(26)),c=(a.n(o),a(39)),d=(a.n(c),a(19)),h=(a.n(d),a(65)),u=(a.n(h),a(2)),p=a(34),l=a(9),m=a(0),_=a(12),f=a(29),g=a(8),b=a.n(g),v=a(87),y=(a.n(v),a(116)),S=(a.n(y),a(117)),w=(a.n(S),a(1)),D=a(7),j=a(57),C=a(41),k=a(4),x=function(){function e(t,e,a){var i=this;this._shipData=t,this._woodData=e,this._fontSize=a,this._compassSize=200,this._line=Object(_.f)().x(function(t){return t[0]}).y(function(t){return t[1]}),this._drag=Object(p.a)().on("start",function(t,e,a){i._removeLabels(),Object(m.select)(a[e]).classed("drag-active",!0)}).on("drag",function(t,e,a){0===e&&i._compass.attr("x",t.position[0]+m.event.dx).attr("y",t.position[1]+m.event.dy),Object(m.select)(a[e]).attr("cx",m.event.x).attr("cy",m.event.y),t.position=[t.position[0]+m.event.dx,t.position[1]+m.event.dy],i._printLines()}).on("end",function(t,e,a){Object(m.select)(a[e]).classed("drag-active",!1),i._printJourney()}),this._labelPadding=20,this._minutesForFullCircle=48,this._fullCircle=360,this._degreesPerMinute=this._fullCircle/this._minutesForFullCircle,this._degreesSegment=15,this._minOWSpeed=2,this._owSpeedFactor=2,this._speedScale=Object(l.scaleLinear)().domain(Object(u.range)(0,this._fullCircle,this._degreesSegment)),this._defaultShipName="None",this._defaultShipSpeed=19,this._defaultStartWindDegrees=0,this._baseName="Make journey",this._baseId="make-journey",this._buttonId="button-"+this._baseId,this._deleteLastLegButtonId="button-delete-leg-"+this._baseId,this._modalId="modal-"+this._baseId,this._sliderId="slider-"+this._baseId,this._shipId="ship-journey",this._woodId="wood-journey",this._setupSummary(),this._setupSvg(),this._initJourney(),this._setupListener()}var a=e.prototype;return a._setupSvg=function(){this._g=Object(m.select)("#na-svg").insert("g","g.pb").classed("coord",!0),Object(m.select)("#na-svg defs").append("marker").attr("id","course-arrow").attr("viewBox","0 -5 10 10").attr("refX",8).attr("refY",0).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("class","course-head")},a._initJourney=function(){this._journey={shipName:this._defaultShipName,woodNames:"",startWindDegrees:this._defaultStartWindDegrees,currentWindDegrees:this._defaultStartWindDegrees,totalDistance:0,totalMinutes:0,segment:[{position:[null,null],label:""}]}},a._resetJourney=function(){this._journey.startWindDegrees=this._getStartWind(),this._journey.currentWindDegrees=this._journey.startWindDegrees,this._journey.totalDistance=0,this._journey.totalMinutes=0},a._navbarClick=function(t){Object(D.b)("Menu","Journey"),t.stopPropagation(),this._journeySelected()},a._setupListener=function(){var t=this;document.getElementById(""+this._buttonId).addEventListener("click",function(e){return t._navbarClick(e)}),document.getElementById(this._deleteLastLegButtonId).addEventListener("click",function(){return t._deleteLastLeg()})},a._setupWindInput=function(){var e=t.fn.roundSlider.prototype._getTooltipPos;t.fn.roundSlider.prototype._getTooltipPos=function(){this.tooltip.is(":visible")||t("body").append(this.tooltip);var a=e.call(this);return this.container.append(this.tooltip),a},window.tooltip=function(t){return Object(w.g)(t.value)},t("#"+this._sliderId).roundSlider({sliderType:"default",handleSize:"+1",startAngle:90,width:20,radius:110,min:0,max:359,step:360/w.e.length,editableTooltip:!1,tooltipFormat:"tooltip",create:function(){this.control.css("display","block")},change:function(){this._currentWind=t("#"+this._sliderId).roundSlider("getValue")}})},a._injectModal=function(){var t=this;Object(k.n)(this._modalId,this._baseName,"sm");var e=Object(m.select)("#"+this._modalId+" .modal-body").append("form").append("div").attr("class","form-group"),a=e.append("div").classed("alert alert-primary",!0).attr("role","alert");a.append("label").attr("for",this._sliderId).text("Current in-game wind"),a.append("div").attr("id",this._sliderId).attr("class","rslider");var i=this._shipId+"-Base-select",r=e.append("div").classed("alert alert-primary",!0).attr("role","alert").append("div").attr("class","d-flex flex-column");r.append("label").attr("for",i).text("Ship and woods (optional)"),r.append("select").attr("name",i).attr("id",i),["frame","trim"].forEach(function(e){var a=t._woodId+"-"+e+"-Base-select";r.append("label").attr("for",a),r.append("select").attr("name",a).attr("id",a)})},a._initModal=function(){this._injectModal(),this._setupWindInput(),this._shipCompare=new j.a(this._shipData,this._woodData,this._shipId),this._woodCompare=new C.a(this._woodData,this._woodId)},a._useUserInput=function(){this._journey.startWindDegrees=this._getStartWind(),this._setShipName(),this._printSummary(),this._printJourney()},a._journeySelected=function(){var e=this;document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show").on("hidden.bs.modal",function(){e._useUserInput()})},a._printCompass=function(){var t=this._journey.segment[0].position[0],e=this._journey.segment[0].position[1];this._compass=this._g.append("image").classed("compass",!0).attr("x",t).attr("y",e).attr("transform","translate("+-this._compassSize/2+","+-this._compassSize/2+")").attr("height",this._compassSize).attr("width",this._compassSize).attr("xlink:href","icons/compass.svg"),this._gJourneyPath=this._g.append("path")},a._getSpeedAtDegrees=function(t){return i(this._speedScale(t),this._minOWSpeed)},a._calculateDistanceForSection=function(t,e){var a=(this._fullCircle-t+e)%this._fullCircle;return this._getSpeedAtDegrees(a)*this._owSpeedFactor*k.p},a._getStartWind=function(){var e=t("#"+this._sliderId).roundSlider("getValue");return t("#"+this._sliderId).length?+e:0},a._setShipSpeed=function(){var t;t=this._journey.shipName===this._defaultShipName?Array.from(Array(24).fill(this._defaultShipSpeed/2)):this._shipCompare._singleShipData.speedDegrees,this._speedScale.range(t)},a._calculateMinutesForSegment=function(t,e,a){var i=a,r=e,n=0;for(this._setShipSpeed();0<i;){var s=this._calculateDistanceForSection(t,r);i>s?(i-=s,n+=1):(n+=i/s,i=0),r=(this._fullCircle+r-this._degreesPerMinute)%this._fullCircle}return this._journey.currentWindDegrees=r,n},a._setShipName=function(){void 0!==this._shipCompare&&void 0!==this._shipCompare._singleShipData&&void 0!==this._shipCompare._singleShipData.name?(this._journey.shipName=""+this._shipCompare._singleShipData.name,this._journey.woodNames=this._shipCompare._woodCompare._woodsSelected.Base.frame+"/"+this._shipCompare._woodCompare._woodsSelected.Base.trim):(this._journey.shipName=this._defaultShipName,this._journey.woodNames="")},a._removeLabels=function(){var t=this._g.selectAll("g.coord g.label");t.select("text").remove(),t.select("rect").remove()},a._correctJourney=function(){var t=Object(f.c)(Object(m.select)("#na-svg").node()),e=i(1,t.k),a=this._fontSize/e,r=this._compassSize/e,n=f.b.translate(20/e,20/e),s=this._labelPadding/e;this._g.selectAll("g.coord g.label").each(function(t,i,r){var o=Object(m.select)(r[i]),c=o.select("text"),d=t.label.split("|");c.text("").attr("dy",0).attr("transform",n).style("font-size",a+"px"),d.forEach(function(t,e){var i=c.append("tspan").text(t);0<e&&i.attr("x",0).attr("dy",1.3*a)});var h=c.node().getBBox(),u=t.label?h.width+2*s:0,p=t.label?h.height+s:0;o.select("rect").attr("width",u).attr("height",p);var l=o.select("circle").attr("r",10/e).attr("class","");o.append(function(){return l.remove().node()}),(0===i||i===r.length-1)&&l.attr("r",20).attr("class","drag-hidden")}),this._gJourneyPath&&this._gJourneyPath.style("stroke-width",5/e+"px"),this._compass&&this._compass.attr("transform","translate("+-r/2+","+-r/2+")").attr("height",r).attr("width",r)},a._printLabels=function(){var t=this,e=Object(h.layoutTextLabel)().padding(this._labelPadding).value(function(t){var e=t.label.split("|");return e[e.reduce(function(t,e,a,i){return i[t].length>e.length?t:a},0)]}),a=Object(h.layoutAnnealing)(),i=Object(h.layoutLabel)(a).size(function(e,a,i){var r=e.label.split("|").length,n=i[a].getElementsByTagName("text")[0].getBBox();return[n.width+2*t._labelPadding,n.height*r+2*t._labelPadding]}).position(function(t){return t.position}).component(e);this._g.datum(this._journey.segment.map(function(t){return t})).call(i)},a._setupSummary=function(){this._divJourneySummary=Object(m.select)("main").append("div").attr("id","journey-summary").classed("journey-summary overlay d-none",!0);var t=this._divJourneySummary.append("div").classed("d-flex justify-content-around align-items-end",!0);this._journeySummaryShip=t.append("div").classed("block",!0),this._journeySummaryTextWoods=this._journeySummaryShip.append("div"),this._journeySummaryTextShip=this._journeySummaryShip.append("div"),this._journeySummaryShip.append("div").classed("des",!0).text("selected ship"),this._journeySummaryWind=t.append("div").classed("block",!0),this._journeySummaryTextWind=this._journeySummaryWind.append("div"),this._journeySummaryWind.append("div").classed("des",!0).text("wind direction"),t.append("button").attr("id",this._deleteLastLegButtonId).classed("btn btn-primary btn-sm",!0).attr("role","button").text("Delete last leg")},a._displaySummary=function(t){this._divJourneySummary.classed("d-none",!t),Object(m.select)("#port-summary").classed("d-none",t)},a._showSummary=function(){this._displaySummary(!0)},a._hideSummary=function(){this._displaySummary(!1)},a._printSummaryShip=function(){this._journeySummaryTextWoods.text(this._journey.woodNames),this._journeySummaryTextShip.text(this._journey.shipName)},a._printSummaryWind=function(){this._journeySummaryTextWind.text("From "+Object(w.g)(this._journey.startWindDegrees))},a._printSummary=function(){this._printSummaryWind(),this._printSummaryShip()},a._printLines=function(){this._gJourneyPath&&this._gJourneyPath.datum(1<this._journey.segment.length?this._journey.segment.map(function(t){return t.position}):[[null,null]]).attr("marker-end","url(#course-arrow)").attr("d",this._line)},a._getTextDirection=function(t,e,a){return t+" ("+r(e)+"°) ☆ F11: "+Object(w.j)(Object(k.g)(a.x,a.y))+" / "+Object(w.j)(Object(k.h)(a.x,a.y))},a._getTextDistance=function(t,e,a){function i(t){function e(t,e){return t+" "+e+(1===t?"":"s")}b.a.locale("en-gb");var a=Math.floor(t/60),i=r(t%60),n="in ";if(1>t)n+="less than a minute";else{var s=0===a?"":e(a,"hour"),o=0===i?"":e(i,"minute");n+=s+(""===s?"":" ")+o}return n}var n=r(t)+"k "+i(e);return a&&(n+=" ☆ total "+r(this._journey.totalDistance)+"k "+i(this._journey.totalMinutes)),n},a._setSegmentLabel=function(t){void 0===t&&(t=this._journey.segment.length-1);var e={x:this._journey.segment[t].position[0],y:this._journey.segment[t].position[1]},a={x:this._journey.segment[t-1].position[0],y:this._journey.segment[t-1].position[1]},i=Object(w.v)(e,a),r=Object(k.l)(e,a),n=Object(w.g)(i),s=this._calculateMinutesForSegment(i,this._journey.currentWindDegrees,1e3*r);this._journey.totalDistance+=r,this._journey.totalMinutes+=s;var o=this._getTextDirection(n,i,e),c=this._getTextDistance(r,s,1<t);this._journey.segment[t].label=o+"|"+c},a._printSegment=function(){this._printLines(),this._setSegmentLabel(),this._printLabels(),this._correctJourney(),this._g.selectAll("g.coord g.label circle").call(this._drag)},a._printJourney=function(){var t=this;this._printLines(),this._resetJourney(),this._journey.segment.forEach(function(e,a){a<t._journey.segment.length-1&&t._setSegmentLabel(a+1)}),this._printLabels(),this._correctJourney(),this._g.selectAll("g.coord g.label circle").call(this._drag)},a._deleteLastLeg=function(){this._journey.segment.pop(),this._journey.segment.length?this._printJourney():this.clearMap()},a.setSummaryPosition=function(t,e){this._divJourneySummary.style("top",t+"px").style("right",e+"px")},a.plotCourse=function(t,e){this._journey.segment[0].position[0]?(this._journey.segment.push({position:[t,e],label:""}),this._printSegment()):(this.clearMap(),this._journey.segment[0]={position:[t,e],label:""},this._resetJourney(),this._showSummary(),this._printSummary(),this._printCompass())},a.transform=function(t){this._g.attr("transform",t),this._correctJourney()},a.clearMap=function(){this._initJourney(),this._hideSummary(),this._g.selectAll("*").remove()},e}()}).call(this,a(11))},128:function(t,e,a){"use strict";(function(t){a.d(e,"a",function(){return l});var i=a(31),r=(a.n(i),a(39)),n=(a.n(r),a(19)),s=(a.n(n),a(24)),o=(a.n(s),a(26)),c=(a.n(o),a(56)),d=(a.n(c),a(0)),h=a(1),u=a(7),p=a(4),l=function(){function e(t){this._moduleData=t,this._baseName="List modules",this._baseId="module-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}var a=e.prototype;return a._setupListener=function(){var e=this;t("#"+this._buttonId).on("click",function(t){Object(u.b)("Tools",e._baseName),t.stopPropagation(),e._moduleListSelected()})},a._injectModal=function(){Object(p.n)(this._modalId,this._baseName);var t=this._baseId+"-select",e=Object(d.select)("#"+this._modalId+" .modal-body");e.append("label").attr("for",t),e.append("select").attr("name",t).attr("id",t),e.append("div").attr("id",""+this._baseId).attr("class","container-fluid")},a._getOptions=function(){return""+this._moduleData.map(function(t){return'<option value="'+t[0]+'"">'+t[0]+"</option>;"}).join("")},a._setupSelect=function(){var e=t("#"+this._baseId+"-select"),a=this._getOptions();e.append(a)},a._setupSelectListener=function(){var e=this;t("#"+this._baseId+"-select").addClass("selectpicker").on("change",function(t){return e._moduleSelected(t)}).selectpicker({noneSelectedText:"Select module category"}).val("default").selectpicker("refresh")},a._initModal=function(){this._injectModal(),this._setupSelect(),this._setupSelectListener()},a._moduleListSelected=function(){document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")},a._getRows=function(t){function e(t){return"U"===t?"":" "+a.get(t)}var a=new Map([["L",Object(h.r)(1)+" – "+Object(h.r)(3)],["M",Object(h.r)(4)+" – "+Object(h.r)(5)],["S",Object(h.r)(6)+" – "+Object(h.r)(7)]]),i="",r=[];return this._moduleData.forEach(function(a){a[0]===t&&a[1].forEach(function(t,n){function s(e){return e<a[1].length&&t.name===a[1][e].name&&JSON.stringify(t.properties)===JSON.stringify(a[1][e].properties)}i=e(t.moduleLevel),s(n+1)&&(a[1][n+1].hasSamePropertiesAsPrevious=!0,i+="<br>"+e(a[1][n+1].moduleLevel)),s(n+2)&&(a[1][n+2].hasSamePropertiesAsPrevious=!0,i=""),void 0!==t.hasSamePropertiesAsPrevious&&t.hasSamePropertiesAsPrevious||r.push('<tr><td><span class="name">'+t.name+"</span><br>"+i+"</td><td>"+t.properties.map(function(t){var e=t.absolute?t.amount:Object(h.p)(t.amount/100);return t.modifier+" "+e}).join("<br>")+"</td></tr>")})}),r},a._getText=function(t){var e=this._getRows(t),a=Object(h.d)(e,3),i="";return Array.from(Array(a.length).keys()).forEach(function(t){i+='<div class="col-md-'+Math.floor(12/a.length)+'">',i+='<table class="table table-sm small"><thead>',i+="<tr><th>Module</th><th>Modifier</th></tr></thead><tbody>",i+=a[t].join(""),i+="</tbody></table></div>"}),i},a._moduleSelected=function(e){var a=t(e.currentTarget).find(":selected").val();Object(d.select)("#"+this._baseId+" div").remove(),Object(d.select)("#"+this._baseId).append("div").classed("row modules mt-4",!0),Object(d.select)("#"+this._baseId+" div").html(this._getText(a))},e}()}).call(this,a(11))},129:function(t,e,a){"use strict";(function(t){a.d(e,"a",function(){return o});var i=a(47),r=a(0),n=a(13),s=a.n(n),o=function(){function e(t,e,a,i,r){this._ports=r,this._pbCircleDataDefault=t,this._pbCircleData=t,this._fortDataDefault=e,this._fortData=e,this._towerDataDefault=a,this._towerData=a,this._joinCircleDataDefault=i,this._joinCircleData=i,this._showPBCookieName="na-map--show-pb",this._showPBDefault="all",this._showPB=this._getShowPBSetting(),this._setupSvg(),this._setupListener()}var a=e.prototype;return a._setupSvg=function(){this._g=Object(r.select)("#na-svg").insert("g","g.ports").classed("pb",!0),this._gJoinCirclesInner=this._g.append("path").classed("join-circle",!0),this._gJoinCirclesOuter=this._g.append("path").classed("join-circle",!0),this._gPBCircles=this._g.append("path").classed("pb-circle",!0),this._gTowers=this._g.append("path").classed("tower",!0),this._gForts=this._g.append("path").classed("fort",!0)},a._setupListener=function(){var e=this;t("#show-pb").change(function(){return e._showPBZonesSelected()})},a._getShowPBSetting=function(){var e=s.a.get(this._showPBCookieName);return e=void 0===e?this._showPBDefault:e,t("#show-pb-"+e).prop("checked",!0),e},a._storeShowPBSetting=function(){this._showPB===this._showPBDefault?s.a.remove(this._showPBCookieName):s.a.set(this._showPBCookieName,this._showPB)},a._refreshPBZones=function(){this.refresh(),this._ports.updateTexts()},a._showPBZonesSelected=function(){this._showPB=t("input[name='showPB']:checked").val(),this._storeShowPBSetting(),this._refreshPBZones()},a._update=function(){this._gPBCircles.datum(this._pbCircleData).attr("d",Object(i.a)().pointRadius(3.5)),this._gTowers.datum(this._towerData).attr("d",Object(i.a)().pointRadius(1.5)),this._gForts.datum(this._fortData).attr("d",Object(i.a)().pointRadius(2)),this._gJoinCirclesInner.datum(this._joinCircleData).attr("d",Object(i.a)().pointRadius(14)),this._gJoinCirclesOuter.datum(this._joinCircleData).attr("d",Object(i.a)().pointRadius(28))},a._isPortIn=function(t){return"all"===this._showPB||"single"===this._showPB&&t.id===this._ports.currentPort.id},a._setData=function(){var t=this;"pbZone"===this._ports.zoomLevel&&"noShow"!==this._showPB?(this._pbCircleData={type:"FeatureCollection",features:this._pbCircleDataDefault.filter(function(e){return t._isPortIn(e)})},this._fortData={type:"FeatureCollection",features:this._fortDataDefault.filter(function(e){return t._isPortIn(e)})},this._towerData={type:"FeatureCollection",features:this._towerDataDefault.filter(function(e){return t._isPortIn(e)})},this._joinCircleData={type:"FeatureCollection",features:this._joinCircleDataDefault.filter(function(e){return t._isPortIn(e)})}):(this._pbCircleData={},this._fortData={},this._towerData={},this._joinCircleData={})},a.refresh=function(){this._setData(),this._update()},a.transform=function(t){this._g.attr("transform",t)},e}()}).call(this,a(11))},130:function(t,e,a){"use strict";var i=Math.floor;(function(t){a.d(e,"a",function(){return y});var r=a(31),n=(a.n(r),a(26)),s=(a.n(n),a(56)),o=(a.n(s),a(19)),c=(a.n(o),a(24)),d=(a.n(c),a(114)),h=(a.n(d),a(55)),u=(a.n(h),a(131)),p=(a.n(u),a(2)),l=a(21),m=a(9),_=a(0),f=a(12),g=a(139),b=a(7),v=a(4);String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"g"),e)};var y=function(){function e(t,e){this._ownershipData=t,this._nationData=e,this._baseName="Port ownership",this._baseId="ownership-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._colourScale=Object(m.scaleOrdinal)().range(["#72823a","#825fc8","#78b642","#cd47a3","#50b187","#d34253","#628bcc","#cb9f3d","#cc88c9","#ca5b2b","#b55576","#c27b58"]),this._setupListener()}var a=e.prototype;return a._setupListener=function(){var e=this;t("#"+this._buttonId).on("click",function(t){Object(b.b)("Tools",e._baseName),t.stopPropagation(),e._ownershipListSelected()})},a._injectModal=function(){Object(v.n)(this._modalId,this._baseName);var t=this._baseId+"-select",e=Object(_.select)("#"+this._modalId+" .modal-body");e.append("label").append("select").attr("name",t).attr("id",t);var a=e.append("div").attr("id",""+this._baseId);this._div=a.append("div"),this._svg=a.append("svg").attr("class","area")},a._getOptions=function(){return""+this._ownershipData.map(function(t){return'<option value="'+t.region+'">'+t.region+"</option>;"}).join("")},a._setupSelect=function(){var e=t("#"+this._baseId+"-select"),a=this._getOptions();e.append(a)},a._setupSelectListener=function(){var e=this;t("#"+this._baseId+"-select").addClass("selectpicker").on("change",function(t){return e._regionSelected(t)}).selectpicker({noneSelectedText:"Select region"}).val("default").selectpicker("refresh")},a._initModal=function(){this._injectModal(),this._setupSelect(),this._setupSelectListener()},a._ownershipListSelected=function(){var e=this,a=!1;document.getElementById(this._modalId)||(a=!0,this._initModal()),t("#"+this._modalId).on("shown.bs.modal",function(){a&&(e._injectArea(),a=!1)}).modal("show")},e.getHeight=function(){return i(.75*top.innerHeight)},a._getWidth=function(){return i(document.getElementById(this._baseId).offsetWidth)},a._injectArea=function(){var t=this,a=function(t){return new Date(t.date)},i=this._getWidth(),r=Math.min(1e3,e.getHeight()),n=32,s=32,o=32,c=v.o.filter(function(t){return 9!==t.id}).map(function(t){return t.short}),d=this._nationData;d.keys=c;var h=Object(f.i)().offset(f.j).keys(d.keys)(d),_=function(){var t=Object(m.scaleLinear)().domain(Object(p.extent)(d,function(t){return a(t)})).range([o,i-n]),e=Object(m.scaleLinear)().domain([Object(p.min)(h[0],function(t){return t[0]}),Object(p.max)(h[h.length-1],function(t){return t[1]})]).range([r-s,0]);return Object(f.b)().x(function(e){return t(a(e.data))}).y0(function(t){return e(t[0])}).y1(function(t){return e(t[1])}).curve(f.c)};this._svg.attr("width",i).attr("height",r),function(){var e=_(),a=new Map(v.o.map(function(t){return[t.short,t.name]}));t._colourScale.domain(d.keys),t._svg.selectAll("path").data(h).enter().append("path").attr("fill",function(e){return t._colourScale(e.key)}).attr("stroke",function(e){return t._colourScale(e.key)}).attr("d",e),t._svg.selectAll(".area-label").data(h).enter().append("text").attr("class","area-label").text(function(t){return a.get(t.key)}).attr("transform",Object(u.areaLabel)(e))}(),this._svg.append("g").call(function(t){var e=Object(m.scaleTime)().domain(Object(p.extent)(d,function(t){return a(t)})).range([o,i-n]);t.attr("transform","translate(0,"+(r-s)+")").call(Object(l.a)(e).ticks(i/80).tickSizeOuter(0))})},a._injectChart=function(t){Object(g.a)().data(t).enableAnimations(!1).timeFormat("%-d %B %Y").zQualitative(!0).zColorScale(this._colourScale).width(this._getWidth())(this._div.node())},a._regionSelected=function(e){var a=t(e.currentTarget).find(":selected").val();this._div.selectAll("*").remove();var i=this._ownershipData.filter(function(t){return t.region===a}).map(function(t){return t.data})[0];this._injectChart(i)},e}()}).call(this,a(11))},132:function(t,e,a){"use strict";var i=Math.abs,r=Math.log2,n=Math.pow,s=Math.round;(function(t){function o(t,e){for(var a,i=0;i<e.length;i++)(a=e[i]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}a.d(e,"a",function(){return j});var c=a(24),d=(a.n(c),a(178)),h=(a.n(d),a(69)),u=(a.n(h),a(40)),p=(a.n(u),a(19)),l=(a.n(p),a(2)),m=a(9),_=a(0),f=a(13),g=a.n(f),b=a(8),v=a.n(b),y=a(87),S=(a.n(y),a(4)),w=a(1),D=a(133),j=function(){function e(t,e,a){this._portDataDefault=t,this._portData=t,this._pbData=e,this._map=a,this._serverName=this._map._serverName,this._minScale=this._map._minScale,this._scale=this._minScale,this.f11=this._map._f11,this.showCurrentGood=!1,this.showTradePortPartners=!1,this._currentPort={id:"366",coord:{x:4396,y:2494}},this._zoomLevel="initial",this._showPBZones="all",this._highlightId=null,this._highlightDuration=200,this._iconSize=48,this._fontSize=S.j,this._circleSize=S.i,this._showRadius="attack",this._taxIncomeRadius=Object(m.scaleLinear)(),this._netIncomeRadius=Object(m.scaleLinear)(),this._attackRadius=Object(m.scaleLinear)().domain([0,1]),this._colourScale=Object(m.scaleLinear)().domain([0,.1,.5,1]).range(["#eaeded","#8b989c","#6b7478","#a62e39"]),this._minRadiusFactor=1,this._maxRadiusFactor=6,this._showRadiusCookieName="na-map--show-radius",this._showRadiusDefault="attack",this._showRadius=this._getShowRadiusSetting(),this._setupListener(),this._setupSvg(),this._setupCounties(),this._setupRegions(),this._setupSummary(),this._setupFlags(),this._trilateratePosition=new D.a(this)}var a=e.prototype;return a._setupListener=function(){var e=this;t("#show-radius").change(function(){return e._showRadiusSelected()})},a._getShowRadiusSetting=function(){var e=g.a.get(this._showRadiusCookieName);return e=void 0===e?this._showRadiusDefault:e,t("#show-radius-"+e).prop("checked",!0),e},a._storeShowRadiusSetting=function(){this._showRadius===this._showRadiusDefault?g.a.remove(this._showRadiusCookieName):g.a.set(this._showRadiusCookieName,this._showRadius)},a._showRadiusSelected=function(){this._showRadius=t("input[name='showRadius']:checked").val(),this._storeShowRadiusSetting(),this.update()},a._setupSvg=function(){this._gPort=Object(_.select)("#na-svg").insert("g","g.f11").classed("ports",!0),this._gRegion=this._gPort.append("g").classed("region",!0),this._gCounty=this._gPort.append("g").classed("county",!0),this._gPortCircle=this._gPort.append("g").classed("port-circles",!0),this._gIcon=this._gPort.append("g").classed("port",!0),this._gText=this._gPort.append("g").classed("port-names",!0)},a._setupCounties=function(){this._countyPolygon=[{name:"Abaco",centroid:[4500,1953],angle:0},{name:"Andros",centroid:[3870,2350],angle:0},{name:"Apalache",centroid:[2800,1330],angle:0},{name:"Bacalar",centroid:[2050,3646],angle:0},{name:"Baracoa",centroid:[4750,3320],angle:25},{name:"Basse-Terre",centroid:[7540,4450],angle:0},{name:"Belize",centroid:[1900,4300],angle:0},{name:"Benedenwinds",centroid:[6187,5340],angle:0},{name:"Bermuda",centroid:[7550,210],angle:0},{name:"Bovenwinds",centroid:[7280,4180],angle:350},{name:"Campeche",centroid:[980,3791],angle:0},{name:"Cap-Français",centroid:[5270,3480],angle:0},{name:"Caracas",centroid:[6430,5750],angle:0},{name:"Cartagena",centroid:[4450,6024],angle:0},{name:"Caymans",centroid:[3116,3811],angle:0},{name:"Cayos del Golfo",centroid:[1240,3120],angle:0},{name:"Comayaqua",centroid:[1920,4500],angle:0},{name:"Cornwall",centroid:[4100,3845],angle:0},{name:"Costa de los Calos",centroid:[2850,1928],angle:0},{name:"Costa del Fuego",centroid:[3700,1670],angle:70},{name:"Costa Rica",centroid:[3140,5920],angle:0},{name:"Crooked",centroid:[4925,2950],angle:0},{name:"Cuidad de Cuba",centroid:[4500,3495],angle:0},{name:"Cumaná",centroid:[7280,5770],angle:0},{name:"Dominica",centroid:[7640,4602],angle:0},{name:"Exuma",centroid:[4700,2560],angle:0},{name:"Filipina",centroid:[2850,3100],angle:340},{name:"Florida Occidental",centroid:[2172,1200],angle:0},{name:"Georgia",centroid:[3670,747],angle:0},{name:"Golfo de Maracaibo",centroid:[5635,5601],angle:0},{name:"Grand Bahama",centroid:[3950,1850],angle:320},{name:"Grande-Terre",centroid:[8e3,4400],angle:35},{name:"Gustavia",centroid:[7720,3990],angle:0},{name:"Inagua",centroid:[4970,3220],angle:0},{name:"Isla de Pinos",centroid:[3150,3300],angle:0},{name:"Kidd’s Island",centroid:[5950,1120],angle:0},{name:"La Habana",centroid:[2850,2800],angle:340},{name:"La Vega",centroid:[5830,3530],angle:20},{name:"Lago de Maracaibo",centroid:[5550,6040],angle:0},{name:"Leeward Islands",centroid:[7850,4150],angle:0},{name:"Les Cayes",centroid:[5145,4050],angle:0},{name:"Los Llanos",centroid:[3640,2770],angle:30},{name:"Los Martires",centroid:[3300,2360],angle:0},{name:"Louisiane",centroid:[1420,1480],angle:0},{name:"Margarita",centroid:[7150,5584],angle:0},{name:"Martinique",centroid:[7700,4783],angle:0},{name:"Mérida",centroid:[1858,3140],angle:0},{name:"New Providence",centroid:[4500,2330],angle:0},{name:"North Carolina",centroid:[4580,150],angle:0},{name:"North Mosquito",centroid:[2420,4480],angle:0},{name:"Nuevitas del Principe",centroid:[4350,3050],angle:35},{name:"Nuevo Santander",centroid:[450,2594],angle:0},{name:"Orinoco",centroid:[7620,6e3],angle:0},{name:"Ponce",centroid:[6720,4040],angle:0},{name:"Port-au-Prince",centroid:[5e3,3800],angle:0},{name:"Portobelo",centroid:[3825,5990],angle:0},{name:"Providencia",centroid:[3436,5033],angle:0},{name:"Quatro Villas",centroid:[3780,3100],angle:35},{name:"Royal Mosquito",centroid:[3130,4840],angle:0},{name:"Sainte-Lucie",centroid:[7720,4959],angle:0},{name:"San Juan",centroid:[6760,3800],angle:0},{name:"Santa Marta",centroid:[5150,5500],angle:340},{name:"Santo Domingo",centroid:[5880,4e3],angle:350},{name:"South Carolina",centroid:[4200,416],angle:0},{name:"South Cays",centroid:[4170,4361],angle:0},{name:"South Mosquito",centroid:[3080,5540],angle:0},{name:"Surrey",centroid:[4350,4100],angle:0},{name:"Texas",centroid:[750,1454],angle:0},{name:"Timucua",centroid:[3620,1220],angle:0},{name:"Trinidad",centroid:[7880,5660],angle:350},{name:"Turks and Caicos",centroid:[5515,3145],angle:0},{name:"Vera Cruz",centroid:[520,3779],angle:0},{name:"Vestindiske Øer",centroid:[7090,4030],angle:350},{name:"Virgin Islands",centroid:[7220,3840],angle:350},{name:"Windward Isles",centroid:[7800,5244],angle:0}]},a._setupRegions=function(){this._regionPolygon=[{name:"Atlantic Coast",centroid:[4200,970],angle:0},{name:"Atlantic",centroid:[6401,684],angle:0},{name:"Bahamas",centroid:[5100,2400],angle:0},{name:"Central America",centroid:[3e3,5100],angle:0},{name:"Central Antilles",centroid:[6900,4500],angle:0},{name:"East Cuba",centroid:[4454,3400],angle:20},{name:"Gulf",centroid:[1602,2328],angle:0},{name:"Hispaniola",centroid:[5477,4200],angle:0},{name:"Jamaica",centroid:[3500,3985],angle:0},{name:"Lower Antilles",centroid:[7100,5173],angle:0},{name:"Puerto Rico",centroid:[6900,3750],angle:0},{name:"South America",centroid:[6400,6100],angle:0},{name:"Upper Antilles",centroid:[6850,4250],angle:0},{name:"West Cuba",centroid:[3300,3100],angle:20},{name:"Yucatan",centroid:[1462,3550],angle:0}]},a._setupSummary=function(){this._divPortSummary=Object(_.select)("main").append("div").attr("id","port-summary").attr("class","port-summary overlay");var t=this._divPortSummary.append("div").attr("class","d-flex justify-content-around align-items-end");this._portSummaryNumPorts=t.append("div").classed("block",!0),this._portSummaryTextNumPorts=this._portSummaryNumPorts.append("div"),this._portSummaryNumPorts.append("div").classed("des",!0).text("selected ports"),this._portSummaryTaxIncome=t.append("div").classed("block",!0),this._portSummaryTextTaxIncome=this._portSummaryTaxIncome.append("div"),this._portSummaryTaxIncome.append("div").classed("des",!0).text("tax income"),this._portSummaryNetIncome=t.append("div").classed("block",!0),this._portSummaryTextNetIncome=this._portSummaryNetIncome.append("div"),this._portSummaryNetIncome.append("div").classed("des",!0).text("net income")},a._setupFlags=function(){var t=this,e=Object(_.select)("#na-svg defs");S.o.map(function(t){return t.short}).forEach(function(a){var i=e.append("pattern").attr("id",a).attr("width","133%").attr("height","100%").attr("viewBox","6 6 "+t._iconSize+" "+.75*t._iconSize);i.append("image").attr("height",t._iconSize).attr("width",t._iconSize).attr("href","icons/"+a+".svg"),i.append("rect").attr("height",t._iconSize).attr("width",t._iconSize).attr("class","nation");var r=e.append("pattern").attr("id",a+"a").attr("width","133%").attr("height","100%").attr("viewBox","6 6 "+t._iconSize+" "+.75*t._iconSize);r.append("image").attr("height",t._iconSize).attr("width",t._iconSize).attr("href","icons/"+a+".svg"),r.append("rect").attr("height",t._iconSize).attr("width",t._iconSize).attr("class","all")});var a=e.append("filter").attr("id","drop-shadow").attr("width","200%").attr("height","200%");a.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",5).attr("result","blur"),a.append("feOffset").attr("dx",2).attr("dy",4).attr("result","offsetblur1"),a.append("feOffset").attr("dx",3).attr("dy",6).attr("result","offsetblur2").attr("in","blur"),a.append("feComponentTransfer").attr("result","shadow1").attr("in","offsetblur1").append("feFuncA").attr("type","linear").attr("slope","0.1"),a.append("feComponentTransfer").attr("result","shadow2").attr("in","offsetblur2").append("feFuncA").attr("type","linear").attr("slope","0.1"),a.append("feComposite").attr("in2","offsetblur1").attr("operator","in");var i=a.append("feMerge");i.append("feMergeNode").attr("in","shadow1"),i.append("feMergeNode").attr("in","shadow2"),i.append("feMergeNode").attr("in","SourceGraphic")},a._getPortName=function(t){return this._portDataDefault.filter(function(e){return e.id===t}).map(function(t){return t.properties.name})[0]},a._getText=function(t,e){v.a.locale("en-gb");var a=this._pbData.ports.filter(function(e){return e.id===t})[0],i=v.a.utc(a.portBattle).local(),r=v.a.utc(a.portBattle),n={name:e.name,icon:a.nation,availableForAll:e.availableForAll?"(accessible to all nations)":"",depth:e.shallow?"Shallow":"Deep",county:(""===e.county?"":e.county+" / ")+e.region,countyCapital:e.countyCapital?" (county capital)":"",nonCapturable:e.nonCapturable,captured:a.capturer?" captured by "+a.capturer+" "+v.a.utc(a.lastPortBattle).fromNow():"",lastPortBattle:a.lastPortBattle,attack:a.attackHostility?a.attackerClan+" ("+a.attackerNation+") attack"+(a.portBattle.length?(r.isAfter(v.a.utc())?"s":"ed")+" "+r.fromNow()+" at "+r.format("H.mm")+(r===i?"":" ("+i.format("H.mm")+" local)"):"s: "+Object(w.n)(a.attackHostility)+" hostility"):"",pbTimeRange:e.nonCapturable?"":e.portBattleStartTime?(e.portBattleStartTime+10)%24+".00 – "+(e.portBattleStartTime+13)%24+".00":"11.00 – 8.00",brLimit:Object(w.m)(e.brLimit),conquestMarksPension:e.conquestMarksPension,taxIncome:Object(w.o)(e.taxIncome),portTax:Object(w.n)(e.portTax),netIncome:Object(w.o)(e.netIncome),tradingCompany:e.tradingCompany?", trading company level "+e.tradingCompany:"",laborHoursDiscount:e.laborHoursDiscount?", labor hours discount level "+e.laborHoursDiscount:"",dropsTrading:e.dropsTrading?e.dropsTrading.map(function(t){return t.name}).sort().join(", "):"",consumesTrading:e.consumesTrading?e.consumesTrading.map(function(t){return t.name}).sort().join(", "):"",producesNonTrading:e.producesNonTrading?e.producesNonTrading.map(function(t){return t.name}).sort().join(", "):"",dropsNonTrading:e.dropsNonTrading?e.dropsNonTrading.map(function(t){return t.name}).sort().join(", "):"",tradePort:this._getPortName(this.tradePortId),goodsToSellInTradePort:e.goodsToSellInTradePort?e.goodsToSellInTradePort.join(", "):"",goodsToBuyInTradePort:e.goodsToBuyInTradePort?e.goodsToBuyInTradePort.join(", "):""};switch(e.portBattleType){case"Large":n.pbType="1<sup>st</sup>";break;case"Medium":n.pbType="4<sup>th</sup>";break;default:n.pbType="6<sup>th</sup>"}return n},a._showDetails=function(e,a,i){var r=this,n=Object(_.select)(i[a]),s=function(t){var e='<table><tbody><tr><td><i class="flag-icon '+t.icon+'"></i></td>';return e+='<td><span class="port-name">'+t.name+"</span>",e+=" "+t.county+" "+t.availableForAll,e+="</td></tr></tbody></table>",t.attack.length&&(e+='<div class="alert alert-danger mt-2" role="alert">'+t.attack+"</div>"),e+="<p>"+t.depth+" water port "+t.countyCapital+t.captured+"<br>",t.nonCapturable?(e+="Not capturable",e+="<br>"+t.portTax+" tax"):(e+="Port battle "+t.pbTimeRange+", "+t.brLimit+" BR, ",e+=t.pbType+" rate AI, ",e+=t.conquestMarksPension+" conquest point",e+=1<t.conquestMarksPension?"s":"",e+="<br>Tax income "+t.taxIncome+" ("+t.portTax+"), net income "+t.netIncome,e+=t.tradingCompany,e+=t.laborHoursDiscount),e+="</p>",e+="<table class='table table-sm'>",t.producesNonTrading.length&&(e+="<tr><td>Produces </td><td>",e+='<span class="non-trading">'+t.producesNonTrading+"</span>",e+="</td></tr>"),t.consumesTrading.length&&(e+="<tr><td>Consumes </td><td>",e+=t.consumesTrading,e+="</td></tr>"),(t.dropsTrading.length||t.dropsNonTrading.length)&&(e+="<tr><td>Drops "+(t.dropsNonTrading.length?" ":"")+"</td><td>",t.dropsNonTrading.length&&(e+='<span class="non-trading">'+t.dropsNonTrading+"</span>",t.dropsTrading.length&&(e+="<br>")),t.dropsTrading.length&&(e+=""+t.dropsTrading),e+="</td></tr>"),r.showTradePortPartners&&(t.goodsToSellInTradePort.length&&(e+="<tr><td>Sell in "+t.tradePort+"</td><td>"+t.goodsToSellInTradePort+"</td></tr>"),t.goodsToBuyInTradePort.length&&(e+="<tr><td>Buy in "+t.tradePort+"</td><td>"+t.goodsToBuyInTradePort+"</td></tr>")),e+="</table>"}(this._getText(e.id,e.properties));n.attr("data-toggle","tooltip"),t(n._groups[0]).tooltip({delay:{show:this._highlightDuration,hide:this._highlightDuration},html:!0,placement:"auto",title:s,trigger:"manual"}).tooltip("show")},a._updateIcons=function(){var e=this,a=n(2,r(i(this._minScale)+this._scale)),s=Object(w.w)(this._circleSize/a),o=this._portData.filter(function(t){return e._pbData.ports.some(function(e){return t.id===e.id})}).map(function(t){return t.properties.nation=e._pbData.ports.filter(function(e){return t.id===e.id}).map(function(t){return t.nation})[0],t}),c=this._gIcon.selectAll("circle").data(o,function(t){return t.id});c.exit().remove();var d=c.enter().append("circle").attr("fill",function(t){return"url(#"+(t.properties.availableForAll?t.properties.nation+"a":t.properties.nation)+")"}).attr("cx",function(t){return t.geometry.coordinates[0]}).attr("cy",function(t){return t.geometry.coordinates[1]}).on("click",function(t,a,i){return e._showDetails(t,a,i)}).on("mouseout",function(e,a,i){t(Object(_.select)(i[a])._groups[0]).tooltip("hide")});c.merge(d).attr("r",function(t){return t.id===e._highlightId?2*s:s})},a._updatePortCircles=function(){var t=this,e=function(e){var a="";return e.id===t.tradePortId?a="here":e.properties.sellInTradePort&&e.properties.buyInTradePort?a="both":e.properties.sellInTradePort?a="pos":e.properties.buyInTradePort&&(a="neg"),a},a=n(2,r(i(this._minScale)+this._scale)),s=Object(w.w)(this._circleSize/a*this._minRadiusFactor),o=Object(w.w)(this._circleSize/a*this._maxRadiusFactor),c={},d=0;if("tax"===this._showRadius||"net"===this._showRadius)c=this._portData.filter(function(t){return!t.properties.nonCapturable});else if(this.showTradePortPartners)c=this._portData;else if("position"===this._showRadius)c=this._portData;else if("attack"===this._showRadius){var h=this._pbData.ports.filter(function(t){return t.attackHostility}).map(function(t){return{id:t.id,attackHostility:t.attackHostility}});c=this._portData.filter(function(t){return h.some(function(e){return t.id===e.id})}).map(function(t){return t.properties.attackHostility=h.filter(function(e){return t.id===e.id}).map(function(t){return t.attackHostility})[0],t})}else if("green"===this._showRadius){d=Object(w.w)(Object(S.l)({x:Object(S.e)(-63400,18800),y:Object(S.f)(-63400,18800)},{x:Object(S.e)(-79696,10642),y:Object(S.f)(-79696,10642)}))*S.d;var u=this._pbData.ports.filter(function(t){return"FT"!==t.nation}).map(function(t){return t.id});c=this._portData.filter(function(t){return u.some(function(e){return t.id===e})&&t.properties.nonCapturable})}else this.showCurrentGood&&(c=this._portData,o/=2);var p=this._gPortCircle.selectAll("circle").data(c,function(t){return t.id});p.exit().remove();var m=p.enter().append("circle").attr("cx",function(t){return t.geometry.coordinates[0]}).attr("cy",function(t){return t.geometry.coordinates[1]}),_=p.merge(m);if("tax"===this._showRadius){var f=Object(l.min)(c,function(t){return t.properties.taxIncome}),g=Object(l.max)(c,function(t){return t.properties.taxIncome});this._taxIncomeRadius.domain([f,g]),this._taxIncomeRadius.range([s,o]),_.attr("class","bubble pos").attr("r",function(e){return t._taxIncomeRadius(i(e.properties.taxIncome))})}else if("net"===this._showRadius){var b=Object(l.min)(c,function(t){return t.properties.netIncome}),v=Object(l.max)(c,function(t){return t.properties.netIncome});this._netIncomeRadius.domain([b,v]).range([s,o]),_.attr("class",function(t){return"bubble "+(0>t.properties.netIncome?"neg":"pos")}).attr("r",function(e){return t._netIncomeRadius(i(e.properties.netIncome))})}else this.showTradePortPartners?_.attr("class",function(t){return"bubble "+e(t)}).attr("r",function(e){return e.id===t.tradePortId?o:o/2}):"attack"===this._showRadius?(this._attackRadius.range([s,o]),_.attr("class","bubble").attr("fill",function(e){return t._colourScale(e.properties.attackHostility)}).attr("r",function(e){return t._attackRadius(e.properties.attackHostility)})):"position"===this._showRadius?_.attr("class","position").attr("r",function(t){return t.properties.distance}):"green"===this._showRadius?_.attr("class","bubble pos").attr("r",d):this.showCurrentGood&&_.attr("class",function(t){return"bubble "+(t.properties.isSource?"pos":"neg")}).attr("r",o)},a._updateTextsX=function(t,e){return"pbZone"===this._zoomLevel&&("all"===this._showPBZones||"single"===this._showPBZones&&t.id===this.currentPort.id)?t.geometry.coordinates[0]+s(1.2*e*Math.cos(Object(w.h)(t.properties.angle))):t.geometry.coordinates[0]},a._updateTextsY=function(t,e,a){var i=e+1.2*a;if("pbZone"!==this._zoomLevel)return t.id===this._highlightId?t.geometry.coordinates[1]+(2*e+2*a):t.geometry.coordinates[1]+i;var r=90<t.properties.angle&&270>t.properties.angle?a:0;return"all"===this._showPBZones||"single"===this._showPBZones&&t.id===this.currentPort.id?t.geometry.coordinates[1]+s(1.2*e*Math.sin(Object(w.h)(t.properties.angle)))+r:t.geometry.coordinates[1]+i},a._updateTextsAnchor=function(t){return"pbZone"===this._zoomLevel&&("all"===this._showPBZones||"single"===this._showPBZones&&t.id===this.currentPort.id)?t.properties.textAnchor:"middle"},a.updateTexts=function(){var t=this;if("initial"===this._zoomLevel)this._gText.attr("display","none");else{this._gText.attr("display","inherit");var e=n(2,r(i(this._minScale)+this._scale)),a=Object(w.w)(this._circleSize/e),s=n(2,r(.9*(i(this._minScale)+this._scale))),o=Object(w.w)(this._fontSize/s),c=this._gText.selectAll("text").data(this._portData,function(t){return t.id});c.exit().remove();var d=c.enter().append("text").text(function(t){return t.properties.name});c.merge(d).attr("x",function(e){return t._updateTextsX(e,a)}).attr("y",function(e){return t._updateTextsY(e,a,o)}).attr("font-size",function(e){return e.id===t._highlightId?2*o+"px":o+"px"}).attr("text-anchor",function(e){return t._updateTextsAnchor(e)})}},a._updateSummary=function(){var t=Object.keys(this._portData).length,e=0,a=0;t&&(e=this._portData.map(function(t){return t.properties.taxIncome}).reduce(function(t,e){return t+e}),a=this._portData.map(function(t){return t.properties.netIncome}).reduce(function(t,e){return t+e})),this._portSummaryTextNumPorts.text(""+t),this._portSummaryTextTaxIncome.text(""+Object(w.o)(e)),this._portSummaryTextNetIncome.text(""+Object(w.o)(a))},a._updateCounties=function(){if("portLabel"!==this._zoomLevel)this._gCounty.attr("display","none");else{this._gCounty.attr("display","inherit");var t=this._countyPolygon,e=this._gCounty.selectAll("text").data(t);e.exit().remove(),e.enter().append("text").attr("transform",function(t){return"translate("+t.centroid[0]+","+t.centroid[1]+")rotate("+t.angle+")"}).text(function(t){return t.name})}},a._updateRegions=function(){if("initial"!==this._zoomLevel)this._gRegion.attr("display","none");else{this._gRegion.attr("display","inherit");var t=this._regionPolygon,e=this._gRegion.selectAll("text").data(t);e.exit().remove(),e.enter().append("text").attr("transform",function(t){return"translate("+t.centroid[0]+","+t.centroid[1]+")rotate("+t.angle+")"}).text(function(t){return t.name})}},a.update=function(t){void 0===t&&(t=null),this._scale=t||this._scale,this._updateIcons(),this._updatePortCircles(),this.updateTexts(),this._updateSummary(),this._updateCounties(),this._updateRegions()},a._showSummary=function(){this._divPortSummary.classed("hidden",!1)},a.hideSummary=function(){this._divPortSummary.classed("hidden",!0)},a.transform=function(t){this._gPort.attr("transform",t)},a.clearMap=function(t){"position"===this._showRadius&&(this._showRadius="off"),this._trilateratePosition.clearMap(),this._showSummary(),this._portData=this._portDataDefault,this.showCurrentGood=!1,this.showTradePortPartners=!1,this.update(t)},function(t,e,a){e&&o(t.prototype,e),a&&o(t,a)}(e,[{key:"highlightId",set:function(t){this._highlightId=t}},{key:"portDataDefault",set:function(t){this._portDataDefault=t},get:function(){return this._portDataDefault}},{key:"portData",set:function(t){this._portData=t},get:function(){return this._portData}},{key:"pbData",set:function(t){this._pbData=t},get:function(){return this._pbData}},{key:"showRadiusSetting",set:function(e){this._showRadius=e,t("#show-radius-"+e).prop("checked",!0),this._storeShowRadiusSetting()}},{key:"currentPort",set:function(t){this._currentPort=t},get:function(){return this._currentPort}},{key:"zoomLevel",set:function(t){this._zoomLevel=t},get:function(){return this._zoomLevel}}]),e}()}).call(this,a(11))},133:function(t,e,a){"use strict";var i=Math.atan2,r=Math.floor;(function(t){a.d(e,"a",function(){return g});var n=a(31),s=(a.n(n),a(56)),o=(a.n(s),a(40)),c=(a.n(o),a(24)),d=(a.n(c),a(26)),h=(a.n(d),a(39)),u=(a.n(h),a(19)),p=(a.n(u),a(12)),l=a(0),m=a(134),_=a(7),f=a(4),g=function(){function e(t){this._ports=t,this._inputs=4,this._baseName="Get position",this._baseId="get-position",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupSvg(),this._setupListener()}var a=e.prototype;return a._setupSvg=function(){this._gPosition=Object(l.select)("g.ports").append("g").classed("position",!0)},a._navbarClick=function(t){Object(_.b)("Menu","Get position"),t.stopPropagation(),this._positionSelected()},a._setupListener=function(){var t=this;document.getElementById(""+this._buttonId).addEventListener("click",function(e){return t._navbarClick(e)})},a._injectModal=function(){var t=this;Object(f.n)(this._modalId,this._baseName,"","Go");var e=Object(l.select)("#"+this._modalId+" .modal-body");e.append("div").classed("alert alert-primary",!0).attr("role","alert").text("Use in-game trader tool.");var a=e.append("form"),i=a.append("datalist").attr("id","defaultDistances");[5,10,15,20,30,50,100,200].forEach(function(t){i.append("option").attr("value",t)}),Array.from(Array(this._inputs).keys()).forEach(function(e){var i=t._baseId+"-"+e+"-select",r=t._baseId+"-"+e+"-input",n=a.append("div").classed("form-row",!0);n.append("div").classed("col-md-6",!0).append("label").append("select").attr("name",i).attr("id",i),n.append("div").classed("col-md-6",!0).append("input").attr("id",r).attr("name",r).attr("type","number").classed("form-control",!0).attr("placeholder","Distance in k").attr("step",1).attr("list","defaultDistances").attr("min",0).attr("max",1e3)})},a._setupSelects=function(){var e=this,a=JSON.parse(JSON.stringify({noneSelectedText:"",dropupAuto:!1}));a.liveSearch=!0,a.liveSearchPlaceholder="Search ...",a.liveSearchNormalize=!0,a.noneSelectedText="Select port";var i=""+this._ports.portDataDefault.map(function(t){return{id:t.id,coord:[t.geometry.coordinates[0],t.geometry.coordinates[1]],name:t.properties.name,nation:e._ports.pbData.ports.filter(function(e){return e.id===t.id}).map(function(t){return t.nation})}}).sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}).map(function(t){return'<option data-subtext="'+t.nation+'" value="'+t.coord+'" data-id="'+t.id+'">'+t.name+"</option>"}).join("");Array.from(Array(this._inputs).keys()).forEach(function(r){var n=e._baseId+"-"+r+"-select",s=document.getElementById(n),o=t("#"+n);s.insertAdjacentHTML("beforeend",i),o.selectpicker(a).val("default").selectpicker("refresh")})},a._initModal=function(){this._injectModal(),this._setupSelects()},a._useUserInput=function(){var e=this,a=new Map;Array.from(Array(this._inputs).keys()).forEach(function(i){var r=e._baseId+"-"+i+"-select",n=t("#"+r),s=e._baseId+"-"+i+"-input",o=t("#"+s),c=n.find(":selected")[0]?n.find(":selected")[0].text:"",d=+o.val();d&&""!==c&&a.set(c,1.05*d*f.d)}),2<=a.size?(this._ports.showRadiusSetting="position",this._ports.portData=this._ports.portDataDefault.filter(function(t){return a.has(t.properties.name)}).map(function(t){return t.properties.distance=a.get(t.properties.name),t}),this._ports.update(),function(){var t=function(t){var e=[];return t.arcs.forEach(function(t){var a=t.p1,n=t.p2,s=t.circle,o=i(a.x-s.x,a.y-s.y),c=i(n.x-s.x,n.y-s.y),d=c-o;0>d&&(d+=2*Math.PI);var h=d/32;Array.from(Array(32).keys()).forEach(function(t){var a=c-h*t,i={x:s.x+s.radius*Math.sin(a),y:s.y+s.radius*Math.cos(a)};e.push([r(i.x),r(i.y)])})}),e},a=function(){var t=e._ports.portData.map(function(t){return{x:t.geometry.coordinates[0],y:t.geometry.coordinates[1],radius:t.properties.distance}}),a={};return Object(m.a)(t,a),a}();if(a.innerPoints.length){!function(a){var i=t(a),r=Object(p.f)().curve(p.c);e._gPosition.append("path").attr("d",r(i))}(a);var n=e._gPosition.select("path").node().getBBox(),s={x:n.x+n.width/2,y:n.y+n.height/2};e._ports._map._f11.printCoord(s.x,s.y),e._ports._map.zoomAndPan(s.x,s.y,1)}else console.error("Get position: no intersection found.")}()):console.error("Get position: not enough data.")},a._positionSelected=function(){var e=this;document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show").on("hidden.bs.modal",function(){e._useUserInput()})},a.clearMap=function(){this._gPosition.selectAll("*").remove()},e}()}).call(this,a(11))},135:function(t,e,a){"use strict";(function(t){a.d(e,"a",function(){return y});var i=a(90),r=(a.n(i),a(86)),n=(a.n(r),a(31)),s=(a.n(n),a(106)),o=(a.n(s),a(39)),c=(a.n(o),a(24)),d=(a.n(c),a(26)),h=(a.n(d),a(84)),u=(a.n(h),a(40)),p=(a.n(u),a(19)),l=(a.n(p),a(180)),m=(a.n(l),a(8)),_=a.n(m),f=a(118),g=(a.n(f),a(119)),b=(a.n(g),a(7)),v=a(4),y=(a(1),function(){function e(e,a){this._ports=e,this._pbZone=a,this._dateFormat="D MMM",this._timeFormat="HH.00",this._portNamesId="port-names-select",this._portNamesSelector=document.getElementById(this._portNamesId),this._portNames$=t("#"+this._portNamesId),this._buyGoodsId="buy-goods-select",this._buyGoodsSelector=document.getElementById(this._buyGoodsId),this._buyGoods$=t("#"+this._buyGoodsId),this._propNationId="prop-nation-select",this._propNationSelector=document.getElementById(this._propNationId),this._propNation$=t("#"+this._propNationId),this._propClanId="prop-clan-select",this._propClanSelector=document.getElementById(this._propClanId),this._propClan$=t("#"+this._propClanId),this._propCMId="prop-cm-select",this._propCMSelector=document.getElementById(this._propCMId),this._propCM$=t("#"+this._propCMId),this._setupSelects(),this._setupListener()}var a=e.prototype;return a._setupSelects=function(){this._setupPortSelect(),this._setupGoodSelect(),this._setupNationSelect(),this._setupClanSelect(),this._setupCMSelect()},a._resetOtherSelects=function(t){var e=this;[this._portNames$,this._buyGoods$,this._propNation$,this._propClan$,this._propCM$].forEach(function(a){a===t||a===e._propClan$&&t===e._propNation$||a===e._propNation$&&t===e._propClan$||a.val("default").selectpicker("refresh")})},a._setupListener=function(){var e=this;this._portNamesSelector.classList.add("selectpicker"),this._buyGoodsSelector.classList.add("selectpicker"),this._propNationSelector.classList.add("selectpicker"),this._propClanSelector.classList.add("selectpicker"),this._propCMSelector.classList.add("selectpicker");var a={noneSelectedText:"",dropupAuto:!1},i=JSON.parse(JSON.stringify(a));i.liveSearch=!0,i.liveSearchPlaceholder="Search ...",i.liveSearchNormalize=!0,i.noneSelectedText="Select single port",this._portNamesSelector.addEventListener("change",function(t){Object(b.b)("Menu","Move to port"),e._resetOtherSelects(e._portNames$),e._portSelected(t)}),this._portNames$.selectpicker(i),i.noneSelectedText="Select good",this._buyGoodsSelector.addEventListener("change",function(t){Object(b.b)("Menu","Select good"),e._resetOtherSelects(e._buyGoods$),e._goodSelected(t)}),this._buyGoods$.selectpicker(i),a.noneSelectedText="Select nation",this._propNationSelector.addEventListener("change",function(t){e._resetOtherSelects(e._propNation$),e._nationSelected(t)}),this._propNation$.selectpicker(a),a.noneSelectedText="Select clan",this._propClanSelector.addEventListener("change",function(t){e._resetOtherSelects(e._propClan$),e._clanSelected(t)}),this._propClan$.selectpicker(a),a.noneSelectedText="Select",this._propCMSelector.addEventListener("change",function(t){e._resetOtherSelects(e._propCM$),e._CMSelected(t)}),this._propCM$.selectpicker(a),document.getElementById("menu-prop-deep").addEventListener("click",function(){return e._depthSelected("deep")}),document.getElementById("menu-prop-shallow").addEventListener("click",function(){return e._depthSelected("shallow")}),document.getElementById("menu-prop-all").addEventListener("click",function(){return e._allSelected()}),document.getElementById("menu-prop-green").addEventListener("click",function(){return e._greenZoneSelected()}),document.getElementById("menu-prop-large").addEventListener("click",function(){return e._portSizeSelected("Large")}),document.getElementById("menu-prop-medium").addEventListener("click",function(){return e._portSizeSelected("Medium")}),document.getElementById("menu-prop-small").addEventListener("click",function(){return e._portSizeSelected("Small")}),t.fn.datetimepicker.Constructor.Default=t.extend({},t.fn.datetimepicker.Constructor.Default,{icons:{time:"far fa-clock",date:"far fa-calendar",up:"fas fa-arrow-up",down:"fas fa-arrow-down",previous:"fas fa-chevron-left",next:"fas fa-chevron-right",today:"far fa-calendar-check",clear:"fas fa-trash",close:"fas fa-times"},timeZone:"UTC"}),t("#prop-pb-from").datetimepicker({format:this._timeFormat}),t("#prop-pb-to").datetimepicker({format:this._timeFormat}),t("#prop-pb-range").submit(function(a){e._capturePBRange(),t("#propertyDropdown").dropdown("toggle"),a.preventDefault()}),document.getElementById("menu-prop-today").addEventListener("click",function(){return e._capturedToday()}),document.getElementById("menu-prop-yesterday").addEventListener("click",function(){return e._capturedYesterday()}),document.getElementById("menu-prop-this-week").addEventListener("click",function(){return e._capturedThisWeek()}),document.getElementById("menu-prop-last-week").addEventListener("click",function(){return e._capturedLastWeek()});var r=t("#prop-from"),n=t("#prop-to");r.datetimepicker({format:this._dateFormat}),n.datetimepicker({format:this._dateFormat,useCurrent:!1}),r.on("change.datetimepicker",function(t){return n.datetimepicker("minDate",t.date)}),n.on("change.datetimepicker",function(t){return r.datetimepicker("maxDate",t.date)}),t("#prop-range").submit(function(a){e._captureRange(),t("#propertyDropdown").dropdown("toggle"),a.preventDefault()}),Object(v.m)("selectPortNavbar"),t(".selectpicker").val("default").selectpicker("refresh")},a._setupPortSelect=function(){var t=this,e=""+this._ports.portDataDefault.map(function(e){return{id:e.id,coord:[e.geometry.coordinates[0],e.geometry.coordinates[1]],name:e.properties.name,nation:t._ports.pbData.ports.filter(function(t){return t.id===e.id}).map(function(t){return t.nation})}}).sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}).map(function(t){return'<option data-subtext="'+t.nation+'" value="'+t.coord+'" data-id="'+t.id+'">'+t.name+"</option>"}).join("");this._portNamesSelector.insertAdjacentHTML("beforeend",e)},a._setupGoodSelect=function(){var t=new Set;this._ports.portDataDefault.forEach(function(e){["consumesTrading","dropsTrading","dropsNonTrading","producesNonTrading"].forEach(function(a){e.properties[a]&&e.properties[a].forEach(function(e){return t.add(e.name)})})});var e=""+Array.from(t).sort().map(function(t){return"<option>"+t+"</option>"}).join("");this._buyGoodsSelector.insertAdjacentHTML("beforeend",e)},a._setupNationSelect=function(){var t=""+v.o.sort(function(t,e){return t.sortName<e.sortName?-1:t.sortName>e.sortName?1:0}).map(function(t){return'<option value="'+t.short+'">'+t.name+"</option>"}).join("");this._propNationSelector.insertAdjacentHTML("beforeend",t)},a._setupClanSelect=function(){this._propClanSelector.innerHTML="";var t=new Set,e=new Set;this._ports.portData.forEach(function(t){return e.add(t.id)}),this._ports.pbData.ports.filter(function(t){return t.capturer&&e.has(t.id)}).forEach(function(e){return t.add(e.capturer)});var a=""+Array.from(t).sort().map(function(t){return'<option value="'+t+'">'+t+"</option>"}).join("");a?(this._propClanSelector.insertAdjacentHTML("beforeend",a),this._propClanSelector.disabled=!1,this._propClan$.val("default").selectpicker("refresh")):(this._propClanSelector.disabled=!0,this._propClan$.append("<option></option>").selectpicker("refresh"))},a._setupCMSelect=function(){var e=this,a=new Set;this._ports.portData.forEach(function(t){return a.add(t.properties.conquestMarksPension)}),a.forEach(function(a){e._propCM$.append("beforeend",t("<option>",{value:a,text:a}))})},a._setTradePortPartners=function(){var t=this,e=[],a=[];this._ports.portDataDefault.filter(function(e){return e.id===t._ports.tradePortId}).forEach(function(t){t.properties.consumesTrading&&t.properties.consumesTrading.forEach(function(t){return e.push(t.name)}),t.properties.dropsTrading&&t.properties.dropsTrading.forEach(function(t){return a.push(t.name)})}),this._ports.portData=this._ports.portDataDefault.map(function(t){return t.properties.goodsToSellInTradePort=[],t.properties.sellInTradePort=!1,t.properties.goodsToBuyInTradePort=[],t.properties.buyInTradePort=!1,t.properties.consumesTrading&&t.properties.consumesTrading.forEach(function(e){a.includes(e.name)&&(t.properties.goodsToBuyInTradePort.push(e.name),t.properties.buyInTradePort=!0)}),t.properties.dropsTrading&&t.properties.dropsTrading.forEach(function(a){e.includes(a.name)&&(t.properties.goodsToSellInTradePort.push(a.name),t.properties.sellInTradePort=!0)}),t}).filter(function(e){return e.id===t._ports.tradePortId||e.properties.sellInTradePort||e.properties.buyInTradePort})},a._portSelected=function(e){var a=t(e.currentTarget).find(":selected"),i=a.val().split(","),r=a.data("id").toString();this._ports.currentPort={id:r,coord:{x:+i[0],y:+i[1]}},this._ports.tradePortId=r,this._setTradePortPartners(),this._pbZone._showPBZones&&this._pbZone.refresh(),this._ports.showTradePortPartners=!0,this._ports.showCurrentGood=!1,this._ports.update(),this._ports._map.initialZoomAndPan()},a._goodSelected=function(e){var a=t(e.currentTarget).find(":selected")[0].text,i=this._ports.portDataDefault.filter(function(t){return t.properties.dropsTrading&&t.properties.dropsTrading.some(function(t){return t.name===a})||t.properties.dropsNonTrading&&t.properties.dropsNonTrading.some(function(t){return t.name===a})||t.properties.producesNonTrading&&t.properties.producesNonTrading.some(function(t){return t.name===a})}).map(function(t){return t.properties.isSource=!0,t}),r=this._ports.portDataDefault.filter(function(t){return t.properties.consumesTrading&&t.properties.consumesTrading.some(function(t){return t.name===a})}).map(function(t){return t.properties.isSource=!1,t});this._ports.showRadiusSetting="off",this._ports.portData=i.concat(r),this._ports.showCurrentGood=!0,this._ports.showTradePortPartners=!1,this._ports.update()},a._nationSelected=function(e){var a=this,i=new Set;this._nation=t(e.currentTarget).val(),t("#propertyDropdown").dropdown("toggle"),this._ports.pbData.ports.filter(function(t){return t.nation===a._nation}).forEach(function(t){return i.add(t.id)}),this._ports.portData=this._ports.portDataDefault.filter(function(t){return i.has(t.id)}),this._ports.showCurrentGood=!1,this._ports.showTradePortPartners=!1,this._ports.update(),this._setupClanSelect()},a._clanSelected=function(e){var a=this,i=new Set,r=t(e.currentTarget).val();t("#propertyDropdown").dropdown("toggle"),0===r?this._nation&&this._ports.pbData.ports.filter(function(t){return t.nation===a._nation}).forEach(function(t){return i.add(t.id)}):this._ports.pbData.ports.filter(function(t){return r===t.capturer}).forEach(function(t){return i.add(t.id)}),this._ports.portData=this._ports.portDataDefault.filter(function(t){return i.has(t.id)}),this._ports.showCurrentGood=!1,this._ports.showTradePortPartners=!1,this._ports.update()},a._depthSelected=function(t){var e=this._ports.portDataDefault.filter(function(e){return"shallow"===t?e.properties.shallow:!e.properties.shallow});this._ports.portData=e,this._ports.showCurrentGood=!1,this._ports.showTradePortPartners=!1,this._ports.update()},a._allSelected=function(){var t=this._ports.portDataDefault.filter(function(t){return t.properties.availableForAll});this._ports.portData=t,this._ports.showCurrentGood=!1,this._ports.showTradePortPartners=!1,this._ports.update()},a._greenZoneSelected=function(){var t=this._ports.portDataDefault.filter(function(t){return t.properties.nonCapturable&&"FT"!==t.properties.nation});this._ports.portData=t,this._ports.showCurrentGood=!1,this._ports.showTradePortPartners=!1,this._ports.update()},a._portSizeSelected=function(t){var e=this._ports.portDataDefault.filter(function(e){return t===e.properties.portBattleType});this._ports.portData=e,this._ports.showCurrentGood=!1,this._ports.showTradePortPartners=!1,this._ports.update()},a._capturePBRange=function(){var e=[8,9,10],a=24-(e.length+1),i=new Set,r=_()(t("#prop-pb-from-input").val(),this._timeFormat).hour(),n=_()(t("#prop-pb-to-input").val(),this._timeFormat).hour();if(!(e.includes(r)&&e.includes(n)&&r<=n)){i.add(0),n<r&&(n+=24);for(var s=r-2;s<=n-3;s+=1)i.add((s-10)%a)}var o=this._ports.portDataDefault.filter(function(t){return!t.properties.nonCapturable&&"FT"!==t.properties.nation&&i.has(t.properties.portBattleStartTime)});this._ports.portData=o,this._ports.showCurrentGood=!1,this._ports.showTradePortPartners=!1,this._ports.update()},a._filterCaptured=function(t,e){var a=new Set;this._ports.pbData.ports.filter(function(a){return _()(a.lastPortBattle).isBetween(t,e,null,"(]")}).forEach(function(t){return a.add(t.id)});var i=this._ports.portDataDefault.filter(function(t){return a.has(t.id)});this._ports.portData=i,this._ports.showCurrentGood=!1,this._ports.showTradePortPartners=!1,this._ports.update()},a._capturedToday=function(){var t=_.a.utc(),e=_()().utc().hour(11).minute(0);t.hour()<e.hour()&&(e=e.subtract(1,"day")),this._filterCaptured(e,_.a.utc(e).add(1,"day"))},a._capturedYesterday=function(){var t=_.a.utc(),e=_()().utc().hour(11).minute(0).subtract(1,"day");t.hour()<e.hour()&&(e=e.subtract(1,"day")),this._filterCaptured(e,_.a.utc(e).add(1,"day"))},a._capturedThisWeek=function(){var t=_()().utc().startOf("week"),e=t.hour(11),a=_()(t).add(7,"day").hour(11);this._filterCaptured(e,a)},a._capturedLastWeek=function(){var t=_()().utc().startOf("week"),e=_()(t).subtract(7,"day").hour(11),a=t.hour(11);this._filterCaptured(e,a)},a._captureRange=function(){var e=_()(t("#prop-from-input").val(),this._dateFormat).hour(11),a=_()(t("#prop-to-input").val(),this._dateFormat).add(1,"day").hour(11);this._filterCaptured(e,a)},a._CMSelected=function(){var e,a=parseInt(this._propCM$.val(),10);e=0===a?this._ports.portDataDefault:this._ports.portDataDefault.filter(function(t){return a===t.properties.conquestMarksPension}),t("#propertyDropdown").dropdown("toggle"),this._ports.portData=e,this._ports.showTradePortPartners=!1,this._ports.update()},a.clearMap=function(){this._setupClanSelect()},e}())}).call(this,a(11))},136:function(t,e,a){"use strict";(function(t){a.d(e,"a",function(){return h});var i=a(31),r=(a.n(i),a(19)),n=(a.n(r),a(55)),s=(a.n(n),a(0)),o=a(1),c=a(7),d=a(4),h=function(){function e(t,e){this._recipeData=t.map(function(t){return t.name=t.name.replace(" Blueprint",""),t}),this._moduleData=e,this._baseName="List recipes",this._baseId="recipe-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}var a=e.prototype;return a._setupListener=function(){var e=this;t("#"+this._buttonId).on("click",function(t){Object(c.b)("Tools",e._baseName),t.stopPropagation(),e._recipeListSelected()})},a._injectModal=function(){Object(d.n)(this._modalId,this._baseName);var t=this._baseId+"-select",e=Object(s.select)("#"+this._modalId+" .modal-body");e.append("label").attr("for",t),e.append("select").attr("name",t).attr("id",t),e.append("div").attr("id",""+this._baseId).attr("class","container-fluid")},a._getOptions=function(){return""+this._recipeData.map(function(t){return'<option value="'+t.name+'">'+t.name+"</option>;"}).join("")},a._setupSelect=function(){var e=t("#"+this._baseId+"-select"),a=this._getOptions();e.append(a)},a._setupSelectListener=function(){var e=this;t("#"+this._baseId+"-select").addClass("selectpicker").on("change",function(t){return e._recipeSelected(t)}).selectpicker({noneSelectedText:"Select recipe"}).val("default").selectpicker("refresh")},a._initModal=function(){this._injectModal(),this._setupSelect(),this._setupSelectListener()},a._recipeListSelected=function(){document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")},a._getRecipeData=function(t){return this._recipeData.filter(function(e){return e.name===t})[0]},a._getRequirementText=function(t){var e='<table class="table table-sm"><tbody>';return t.laborPrice&&(e+="<tr><td>"+t.laborPrice+" labour hours</td></tr>"),t.goldPrice&&(e+="<tr><td>"+Object(d.k)(t.goldPrice)+"</td></tr>"),t.itemRequirements.length&&(e+="<tr><td>"+t.itemRequirements.map(function(t){return t.amount+" "+t.name}).join("</td></tr><tr><td>")+"</td></tr>"),e+="</tbody></table>"},a._getModuleText=function(t){var e="",a="",i="";return this._moduleData.forEach(function(e){e[1].filter(function(e){return e.name===t}).forEach(function(t){a=e[0],i="<tr><td>"+t.properties.map(function(t){var e=t.absolute?t.amount:Object(o.p)(t.amount/100);return t.modifier+" "+e}).join("</td></tr><tr><td>")+"</td></tr>"})}),e='<h6 class="card-subtitle mb-2 text-muted">'+a+"</h6>",e+='<table class="table table-sm"><tbody>'+i+"</tbody></table>"},a._getText=function(t){var e=this._getRecipeData(t),a=e.module?e.module:e.name,i='<div class="row no-gutters card-deck">';return i+='<div class="card col-4"><div class="card-header">Recipe</div>',i+='<div class="card-body"><h5 class="card-title">Requirements</h5>',i+=this._getRequirementText(e),i+="</div></div>",i+='<div class="card col-4"><div class="card-header">Resulting module</div>',i+='<div class="card-body"><h5 class="card-title">Properties</h5>',i+=this._getModuleText(a),i+="</div></div>",i+="</div></div>"},a._recipeSelected=function(e){var a=t(e.currentTarget).find(":selected").val();Object(s.select)("#"+this._baseId+" div").remove(),Object(s.select)("#"+this._baseId).append("div").classed("recipes mt-4",!0),Object(s.select)("#"+this._baseId+" div").html(this._getText(a))},e}()}).call(this,a(11))},137:function(t,e,a){"use strict";var i=Math.max,r=Math.round;(function(t){a.d(e,"a",function(){return b});var n=a(54),s=(a.n(n),a(0)),o=a(12),c=a(8),d=a.n(c),h=a(87),u=(a.n(h),a(116)),p=(a.n(u),a(117)),l=(a.n(p),a(118)),m=(a.n(l),a(119)),_=(a.n(m),a(1)),f=a(7),g=a(4),b=function(){function e(){this._compassSize=180,this._height=300,this._width=300,this._line=Object(o.f)(),this._baseName="Predict wind",this._baseId="predict-wind",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._formId="form-"+this._baseId,this._sliderId="slider-"+this._baseId,this._timeGroupId="input-group-"+this._baseId,this._timeInputId="input-"+this._baseId,this._setupSvg(),this.constructor._setupArrow(),this._setupListener()}var a=e.prototype;return a._setupSvg=function(){this._svg=Object(s.select)("body").append("div").attr("id","wind").append("svg").style("position","absolute").classed("coord",!0)},e._setupArrow=function(){Object(s.select)("#na-svg defs").append("marker").attr("id","wind-arrow").attr("viewBox","0 -5 10 10").attr("refX",5).attr("refY",0).attr("markerWidth",4).attr("markerHeight",4).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").classed("wind-head",!0)},a._navbarClick=function(t){Object(f.b)("Menu","Predict wind"),t.stopPropagation(),this._windSelected()},a._setupListener=function(){var t=this;document.getElementById(""+this._buttonId).addEventListener("click",function(e){return t._navbarClick(e)})},a._setupWindInput=function(){var e=t.fn.roundSlider.prototype._getTooltipPos;t.fn.roundSlider.prototype._getTooltipPos=function(){this.tooltip.is(":visible")||t("body").append(this.tooltip);var a=e.call(this);return this.container.append(this.tooltip),a},window.tooltip=function(t){return Object(_.g)(t.value)},t("#"+this._sliderId).roundSlider({sliderType:"default",handleSize:"+1",startAngle:90,width:20,radius:110,min:0,max:359,step:360/_.e.length,editableTooltip:!1,tooltipFormat:"tooltip",create:function(){this.control.css("display","block")},change:function(){this._currentWind=t("#"+this._sliderId).roundSlider("getValue")}})},a._injectModal=function(){d.a.locale("en-gb"),Object(g.n)(this._modalId,this._baseName,"sm");var e=Object(s.select)("#"+this._modalId+" .modal-body").append("form").attr("id",this._formId),a=e.append("div").attr("class","form-group").append("div").classed("alert alert-primary",!0);a.append("label").attr("for",this._sliderId).text("Current in-game wind"),a.append("div").attr("id",this._sliderId).attr("class","rslider");var i=e.append("div").attr("class","form-group").append("div").classed("alert alert-primary",!0);i.append("label").attr("for",this._timeInputId).text("Predict time (server time)");var r=i.append("div").classed("input-group date",!0).attr("id",this._timeGroupId).attr("data-target-input","nearest");r.append("input").classed("form-control datetimepicker-input",!0).attr("type","text").attr("id",this._timeInputId).attr("data-target","#"+this._timeGroupId).attr("aria-label",this._timeGroupId).attr("required",""),r.append("div").classed("input-group-append",!0).attr("data-target","#"+this._timeGroupId).attr("data-toggle","datetimepicker").append("span").classed("input-group-text",!0).append("i").classed("far fa-clock",!0),t("#"+this._timeGroupId).datetimepicker({defaultDate:d.a.utc(),format:"LT"})},a._initModal=function(){this._injectModal(),this._setupWindInput()},a._windSelected=function(){var e=this;document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show").on("hidden.bs.modal",function(){e._useUserInput()})},a._useUserInput=function(){var e=t("#"+this._sliderId).roundSlider("getValue"),a=t("#"+this._timeInputId).val().trim();this._predictWind(e,a)},a._predictWind=function(t,e){d.a.locale("en-gb");var a,i="H.mm",r=/(\d+)[\s:.](\d+)/.exec(e),n=parseInt(r[1],10),s=parseInt(r[2],10);a=Number.isNaN(+t)?Object(_.f)(t):+t;var o=d()().utc().seconds(0).milliseconds(0),c=d()(o).hour(n).minutes(s);c.isBefore(o)&&c.add(1,"day");var h=360+(a-.125*c.diff(o,"seconds"))%360;this._printPredictedWind(h,c.format(i),Object(_.g)(t),o.format(i))},a._printCompass=function(t){var e=this._width/2,a=this._height/3,i=Math.PI/180*(t-90),n=1*this._compassSize,s=n*Math.cos(i),o=n*Math.sin(i),c=[[r(e+s/2),r(a+o/2)],[r(e-s/2),r(a-o/2)]];this._svg.attr("height",this._height).attr("width",this._width),this._svg.append("image").classed("compass",!0).attr("x",e-this._compassSize/2).attr("y",a-this._compassSize/2).attr("height",this._compassSize).attr("width",this._compassSize).attr("xlink:href","icons/compass.svg"),this._svg.append("path").datum(c).attr("d",this._line).classed("wind",!0).attr("marker-end","url(#wind-arrow)")},a._printText=function(t,e,a,r){var n=Object(_.g)(t),s=parseInt(window.getComputedStyle(document.getElementById("wind")).getPropertyValue("line-height"),10),o=this._svg.append("svg"),c=o.append("text").attr("x","50%").attr("y","33%").attr("class","wind-text").text("From "+n+" at "+e),d=o.append("text").attr("x","50%").attr("y","66%").attr("class","wind-text-current").text("Currently at "+r+" from "+a),h=c.node().getBoundingClientRect(),u=d.node().getBoundingClientRect(),p=2*i(h.height,u.height)+s,l=i(h.width,u.width)+s;o.attr("x",(this._width-l)/2).attr("y","66%").attr("height",p).attr("width",l)},a._addBackground=function(){this._svg.insert("rect",":first-child").attr("x",0).attr("y",0).attr("height",this._height).attr("width",this._width)},a._printPredictedWind=function(t,e,a,i){this.clearMap(),this._printCompass(t),this._printText(t,e,a,i),this._addBackground()},a.setPosition=function(t,e){this._svg.style("left",e+"px").style("top",t+"px")},a.clearMap=function(){this._svg.selectAll("*").remove()},e}()}).call(this,a(11))},138:function(t,e,a){"use strict";var i=Number.isNaN;(function(t){a.d(e,"a",function(){return v});var r=a(39),n=(a.n(r),a(40)),s=(a.n(n),a(19)),o=(a.n(s),a(24)),c=(a.n(o),a(26)),d=(a.n(c),a(84)),h=(a.n(d),a(113)),u=(a.n(h),a(54)),p=(a.n(u),a(55)),l=(a.n(p),a(0)),m=a(46),_=a.n(m),f=a(4),g=a(1),b=a(7),v=function(){function e(t){this._woodData=t,this._baseName="List woods",this._baseId="wood-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}var a=e.prototype;return a._setupListener=function(){var e=this;t("#"+this._buttonId).on("click",function(t){Object(b.b)("Tools",e._baseName),t.stopPropagation(),e._woodListSelected()})},a._injectModal=function(){Object(f.n)(this._modalId,this._baseName);var t=Object(l.select)("#"+this._modalId+" .modal-body");t.append("h5").text("Frames"),t.append("div").attr("id","frame-list").attr("class","modules"),t.append("h5").text("Trims"),t.append("div").attr("id","trim-list").attr("class","modules")},a._initTablesort=function(){var t=function(t){return t.replace(/[^\-?0-9.]/g,"")},e=function(t,e){var a=parseFloat(t),r=parseFloat(e);return(a=i(a)?0:a)-(r=i(r)?0:r)};_.a.extend("number",function(t){return t.match(/^[-+]?[£\x24Û¢´€]?\d+\s*([,.]\d{0,2})/)||t.match(/^[-+]?\d+\s*([,.]\d{0,2})?[£\x24Û¢´€]/)||t.match(/^[-+]?(\d)*-?([,.])?-?(\d)+([E,e][-+][\d]+)?%?$/)},function(a,i){var r=t(a),n=t(i);return e(n,r)})},a._initModal=function(){this._initTablesort(),this._injectModal(),this._injectList("frame"),this._injectList("trim")},a._woodListSelected=function(){document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")},a._injectList=function(e){t("#"+e+"-list").append(this._getList(e));var a=document.getElementById("table-"+e+"-list");new _.a(a)},a._getModifiers=function(t){var e=new Set;return this._woodData[t].forEach(function(t){t.properties.forEach(function(t){"Ship material"!==t.modifier&&"Boarding morale"!==t.modifier&&e.add(t.modifier)})}),Array.from(e).sort()},a._getList=function(t){var e=this._getModifiers(t),a="";return a+='<table id="table-'+t+'-list" class="table table-sm small tablesort"><thead><tr><th data-sort-default>Wood</thdata-sort-default>',e.forEach(function(t){a+="<th>"+t+"</th>"}),a+="</tr></thead><tbody>",this._woodData[t].forEach(function(t){a+="<tr><td>"+t.name+"</td>",e.forEach(function(e){var i=t.properties.filter(function(t){return t.modifier===e}).map(function(t){return t.amount})[0];a+='<td class="text-right" data-sort="'+(i||0)+'">'+(i?Object(g.l)(i):"")+"</td>"}),a+="</tr>"}),a+="</tbody></table>"},e}()}).call(this,a(11))},140:function(t,e,a){a(141),t.exports=a(89)},141:function(t,e,a){"use strict";a.r(e),function(t){var e=a(49),i=(a.n(e),a(142)),r=(a.n(i),a(143)),n=(a.n(r),a(144)),s=(a.n(n),a(145)),o=(a.n(s),a(146)),c=(a.n(o),a(120)),d=a(58),h=a(35),u=a(13),p=a.n(u),l=a(7),m=a(89),_=(a.n(m),a(121));!function(){function e(){(r=t("input[name='serverName']:checked").val())===i?p.a.remove(a):p.a.set(a,r),document.location.reload()}var a="na-map--server-name",i="eu1",r=function(){var e=p.a.get(a);return t("#server-name-"+(e=void 0===e?i:e)).prop("checked",!0),e}();c.a.library.add(d.a,d.b,d.c,d.d,h.a,h.b,h.c,h.d,h.e,h.f,h.g),Object(l.a)(),Object(l.c)("Homepage","/"),p.a.defaults={expires:365},t("#server-name").change(function(){return e()}),t(".dropdown-submenu > a").on("click",function(e){var a=t(e.currentTarget);t(".dropdown-submenu .dropdown-menu").removeClass("show"),a.next(".dropdown-menu").addClass("show"),e.stopPropagation()}),t(".dropdown").on("hidden.bs.dropdown",function(){t(".dropdown-menu.show").not(".inner").removeClass("show")});var n=new _.a(r);window.onresize=function(){n.resize()}}()}.call(this,a(11))},4:function(t,e,a){"use strict";(function(t){function i(t,e){var a={x:v(t.x,t.y),y:y(t.x,t.y)},i={x:v(e.x,e.y),y:y(e.x,e.y)};return Object(c.i)(a,i)/(2.63*j)}function r(t,e,a,i){void 0===a&&(a="lg"),void 0===i&&(i="Close");var r=Object(o.select)("#modal-section").append("div").attr("id",t).attr("class","modal").attr("tabindex","-1").attr("role","dialog").attr("aria-labelledby","title-"+t).attr("aria-hidden","true").append("div").attr("class","modal-dialog"+("lg"===a||"sm"===a?" modal-"+a:"")).attr("role","document").append("div").attr("class","modal-content");r.append("header").attr("class","modal-header").append("h5").attr("class","modal-title").attr("id","title-"+t).html(e),r.append("div").attr("class","modal-body"),r.append("footer").attr("class","modal-footer").append("button").text(i).attr("type","button").attr("class","btn btn-secondary").attr("data-dismiss","modal")}function n(e){t("#"+e+" .dropdown-menu .bootstrap-select .dropdown-toggle").on("click",function(e){var a=t(e.currentTarget);return a.next(".dropdown-menu").toggleClass("show"),a.parent("li").toggleClass("show"),a.parents("li.nav-item.dropdown.show").on("hidden.bs.dropdown",function(e){t(e.currentTarget).find(".dropdown-menu.show").not(".inner").removeClass("show")}),!1}),t("#"+e+" div.dropdown.bootstrap-select").on("hidden",function(e){t(e.currentTarget).find(".dropdown-menu.show").not(".inner").removeClass("show")})}a.d(e,"e",function(){return g}),a.d(e,"f",function(){return b}),a.d(e,"g",function(){return v}),a.d(e,"h",function(){return y}),a.d(e,"o",function(){return S}),a.d(e,"j",function(){return w}),a.d(e,"i",function(){return D}),a.d(e,"p",function(){return j}),a.d(e,"l",function(){return i}),a.d(e,"n",function(){return r}),a.d(e,"m",function(){return n}),a.d(e,"k",function(){return C}),a.d(e,"a",function(){return k}),a.d(e,"b",function(){return x}),a.d(e,"c",function(){return I}),a.d(e,"d",function(){return O});var s=a(31),o=(a.n(s),a(0)),c=a(1),d=-.00499866779363828,h=-2.1464254980645e-7,u=4096.88635151897,p=4096.90282787469,l=-200.053302087577,m=-.00859027897636011,_=819630.836437126,f=-819563.745651571,g=function(t,e){return d*t+h*e+u},b=function(t,e){return h*t-d*e+p},v=function(t,e){return l*t+m*e+_},y=function(t,e){return m*t-l*e+f},S=[{id:0,short:"NT",name:"Neutral",sortName:"Neutral"},{id:1,short:"PR",name:"Pirates",sortName:"Pirates"},{id:2,short:"ES",name:"España",sortName:"España"},{id:3,short:"FR",name:"France",sortName:"France"},{id:4,short:"GB",name:"Great Britain",sortName:"Great Britain"},{id:5,short:"VP",name:"Verenigde Provinciën",sortName:"Verenigde Provinciën"},{id:6,short:"DK",name:"Danmark-Norge",sortName:"Danmark-Norge"},{id:7,short:"SE",name:"Sverige",sortName:"Sverige"},{id:8,short:"US",name:"United States",sortName:"United States"},{id:9,short:"FT",name:"Free Town",sortName:"Free Town"},{id:10,short:"RU",name:"Russian Empire",sortName:"Russian Empire"},{id:11,short:"DE",name:"Kingdom of Prussia",sortName:"Prussia"},{id:12,short:"PL",name:"Commonwealth of Poland",sortName:"Poland"}],w=16,D=16,j=390,C=function(t){return t+" real"+(1<+t?"s":"")},k="Yet another map with in-game map, F11 coordinates, resources, ship and wood comparison. Port data is updated constantly from twitter and daily after maintenance.",x="Naval Action map",I="7",O=5}).call(this,a(11))},41:function(t,e,a){"use strict";(function(t){function i(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}a.d(e,"a",function(){return b});var r=a(40),n=(a.n(r),a(31)),s=(a.n(n),a(24)),o=(a.n(s),a(26)),c=(a.n(o),a(56)),d=(a.n(c),a(19)),h=(a.n(d),a(2)),u=a(0),p=a(1),l=a(7),m=a(4),_=function(){function t(t,e){this._id=t,this._woodCompare=e,this._select="#"+this._woodCompare._baseFunction+"-"+this._id,this._setupMainDiv(),this._g=Object(u.select)(this._select).select("g")}return t.prototype._setupMainDiv=function(){Object(u.select)(this._select+" div").remove(),Object(u.select)(this._select).append("div")},t}(),f=function(e){function a(t,a,i){var r;return(r=e.call(this,t,i)||this)._woodData=a,r._woodCompare=i,r._printText(),r}i(a,e);var r=a.prototype;return r._getProperty=function(t,e){var a=this._woodData[e].properties.filter(function(e){return e.modifier===t}).map(function(t){return t.amount})[0];return void 0===a?0:a/100},r._getPropertySum=function(t){return this._getProperty(t,"frame")+this._getProperty(t,"trim")},r._getText=function(t){var e=this,a='<table class="table table-sm table-striped small mt-4"><thead>';return a+="<tr>",a+="<tr><th><em>Property</em></th><th><em>Change in %</em></th></tr></thead><tbody>",t.properties.forEach(function(t,i){if(a+="<tr><td>"+i+"</td><td>"+Object(p.k)(100*t),a+='<span class="rate">',0<t){var r=t/e._woodCompare._minMaxProperty.get(i).max*100*50;a+='<span class="bar neutral" style="width:50%;"></span>',a+='<span class="bar pos diff" style="width:'+r+'%;"></span>'}else if(0>t){var n=t/e._woodCompare._minMaxProperty.get(i).min*100*50;a+='<span class="bar neutral" style="width:'+(50-n)+'%;"></span>',a+='<span class="bar neg diff" style="width:'+n+'%;"></span>'}else a+='<span class="bar neutral"></span>';a+="</span></td></tr>"}),a+="</tbody></table>"},r._printText=function(){var e=this,a={frame:this._woodData.frame.name,trim:this._woodData.trim.name};a.properties=new Map,this._woodCompare._properties.forEach(function(t){a.properties.set(t,e._getPropertySum(t))}),t(""+this._select).find("div").append(this._getText(a))},a}(_),g=function(e){function a(t,a,i,r){var n;return(n=e.call(this,t,r)||this)._baseData=a,n._compareData=i,n._woodCompare=r,n._printTextComparison(),n}i(a,e);var r=a.prototype;return r._getBaseProperty=function(t,e){var a=this._baseData[e].properties.filter(function(e){return e.modifier===t}).map(function(t){return t.amount})[0];return void 0===a?0:a/100},r._getBasePropertySum=function(t){return this._getBaseProperty(t,"frame")+this._getBaseProperty(t,"trim")},r._getCompareProperty=function(t,e){var a=this._compareData[e].properties.filter(function(e){return e.modifier===t}).map(function(t){return t.amount})[0];return void 0===a?0:a/100},r._getComparePropertySum=function(t){return this._getCompareProperty(t,"frame")+this._getCompareProperty(t,"trim")},r._getText=function(t){var e=this,a=50,i=0,r=0,n=0,s="",o='<table class="table table-sm table-striped small wood mt-4"><thead>';return o+="<tr>",o+="<tr><th><em>Property</em></th><th><em>Change in %</em></th></tr></thead><tbody>",t.properties.forEach(function(t,c){o+="<tr><td>"+c+"</td><td>"+function(t,e,a){void 0===a&&(a=1);var i=parseFloat((100*(t-e)).toFixed(a));return 0>i?Object(p.k)(100*t)+' <span class="badge badge-light">'+Object(p.k)(i)+"</span>":0<i?Object(p.k)(100*t)+' <span class="badge badge-light">+ '+Object(p.k)(i)+"</span>":Object(p.k)(100*t)}(t.compare,t.base),o+='<span class="rate">',0<=t.compare?(0<=t.base?t.compare>t.base?(i=t.base,r=t.compare-t.base,s="pos"):(i=t.compare,r=t.base-t.compare,s="neg"):(i=0,r=t.compare,s="pos"),o+='<span class="bar neutral" style="width:50%;"></span>',o+='<span class="bar pos diff" style="width:'+i/e._woodCompare._minMaxProperty.get(c).max*100*a+'%;"></span>',o+='<span class="bar '+s+'" style="width:'+r/e._woodCompare._minMaxProperty.get(c).max*100*a+'%;"></span>'):0>t.compare?(0>t.base?t.compare>=t.base?(i=t.compare,r=t.base-t.compare,n=-t.base,s="pos"):(i=t.base,r=t.compare-t.base,n=-t.compare,s="neg"):(i=0,r=t.compare,n=-t.compare,s="neg"),o+='<span class="bar neutral" style="width:'+(a+n/e._woodCompare._minMaxProperty.get(c).min*100*a)+'%;"></span>',o+='<span class="bar '+s+'" style="width:'+r/e._woodCompare._minMaxProperty.get(c).min*100*a+'%;"></span>',o+='<span class="bar neg diff" style="width:'+i/e._woodCompare._minMaxProperty.get(c).min*100*a+'%;"></span>'):o+='<span class="bar neutral"></span>',o+="</span></td></tr>"}),o+="</tbody></table>"},r._printTextComparison=function(){var e=this,a={frame:this._compareData.frame.name,trim:this._compareData.trim.name};a.properties=new Map,this._woodCompare._properties.forEach(function(t){a.properties.set(t,{base:e._getBasePropertySum(t),compare:e._getComparePropertySum(t)})}),t(""+this._select).find("div").append(this._getText(a))},a}(_),b=function(){function e(t,e){this._woodData=t,this._baseFunction=e,this._baseName="Compare woods",this._baseId=this._baseFunction+"-compare",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,"wood"===this._baseFunction?(this._defaultWood={frame:"Fir",trim:"Crew Space"},this._columnsCompare=["C1","C2","C3"]):"wood-journey"===this._baseFunction?(this._defaultWood={frame:"Oak",trim:"Oak"},this._columnsCompare=[]):(this._defaultWood={frame:"Oak",trim:"Oak"},this._columnsCompare=["C1","C2"]),this._columns=this._columnsCompare.slice(),this._columns.unshift("Base"),this._woodsSelected=[],this._instances=[],this._properties=["Thickness","Hull strength","Side armour","Mast thickness","Ship speed","Acceleration","Rudder speed","Turn speed","Crew","Crew protection","Grog morale bonus","Fire resistance","Leak resistance"],this._options={},this._minMaxProperty=new Map,this._setupListener()}var a=e.prototype;return a._setupListener=function(){var e=this;t("#"+this._buttonId).on("click",function(t){Object(l.b)("Tools",e._baseName),t.stopPropagation(),e._woodCompareSelected()})},a._woodCompareSelected=function(){document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")},a._setupData=function(){var t=this;this._frameSelectData=this._woodData.frame.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}),this._trimSelectData=this._woodData.trim.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}),this._setOption(this._frameSelectData.map(function(t){return'<option value="'+t.name+'">'+t.name+"</option>"}),this._trimSelectData.map(function(t){return'<option value="'+t.name+'">'+t.name+"</option>"})),this._properties.forEach(function(e){var a=t._woodData.frame.map(function(t){return t.properties.filter(function(t){return t.modifier===e}).map(function(t){return t.amount})[0]}).concat(),i=t._woodData.trim.map(function(t){return t.properties.filter(function(t){return t.modifier===e}).map(function(t){return t.amount})[0]}).concat(),r=Object(h.min)(a)||0,n=Object(h.max)(a)||0,s=Object(h.min)(i)||0,o=Object(h.max)(i)||0;t._addMinMaxProperty(e,{min:0<=r+s?0:r+s,max:n+o})})},a._injectModal=function(){var t=this;Object(m.n)(this._modalId,this._baseName);var e=Object(u.select)("#"+this._modalId+" .modal-body").append("div").attr("class","container-fluid").append("div").attr("class","row wood");this._columns.forEach(function(a){var i=e.append("div").attr("class","col-md-3 ml-auto pt-2 "+("Base"===a?"columnA":"columnC"));["frame","trim"].forEach(function(e){var r=t._baseFunction+"-"+e+"-"+a+"-select";i.append("label").attr("for",r),i.append("select").attr("name",r).attr("id",r)}),i.append("div").attr("id",t._baseFunction+"-"+a)})},a._initModal=function(){var e=this;this._setupData(),this._injectModal(),this._columns.forEach(function(a){["frame","trim"].forEach(function(i){var r=t("#"+e._baseFunction+"-"+i+"-"+a+"-select");e._setupWoodSelects(a,i,r),e._setupSelectListener(a,i,r)})})},a._setWoodsSelected=function(t,e,a){void 0===this._woodsSelected[t]&&(this._woodsSelected[t]={}),this._woodsSelected[t][e]=a},a._setupWoodSelects=function(t,e,a){this._setWoodsSelected(t,e,this._defaultWood[e]),a.append(this._options[e]),("wood"!==this._baseFunction||"Base"!==t&&"wood"===this._baseFunction)&&a.attr("disabled","disabled")},a._setOtherSelect=function(e,a){var i="frame"===a?"trim":"frame";this._getWoodSelected(e)[i]===this._defaultWood[i]&&t("#"+this._baseFunction+"-"+i+"-"+e+"-select").val(this._defaultWood[i]).selectpicker("refresh")},a.enableSelects=function(e){var a=this;["frame","trim"].forEach(function(i){t("#"+a._baseFunction+"-"+i+"-"+e+"-select").removeAttr("disabled").selectpicker("refresh")})},a._woodSelected=function(t,e,a){var i=this,r=a.val();this._setWoodsSelected(t,e,r),this._setOtherSelect(t,e),"Base"===t?(this._addInstance(t,new f("Base",this._getWoodData("Base"),this)),this._columnsCompare.forEach(function(t){"wood"===i._baseFunction&&i.enableSelects(t),void 0!==i._instances[t]&&i._addInstance(t,new g(t,i._getWoodData("Base"),i._getWoodData(t),i))})):this._addInstance(t,new g(t,this._getWoodData("Base"),this._getWoodData(t),this))},a._setupSelectListener=function(t,e,a){var i=this;a.addClass("selectpicker").on("change",function(){return i._woodSelected(t,e,a)}).selectpicker({noneSelectedText:"Select "+e}).val("default").selectpicker("refresh")},a._getWoodTypeData=function(t,e){return this._woodData[t].filter(function(t){return t.name===e})[0]},a._getWoodData=function(t){return{frame:this._getWoodTypeData("frame",this._getWoodSelected(t).frame),trim:this._getWoodTypeData("trim",this._getWoodSelected(t).trim)}},a._getWoodSelected=function(t){return this._woodsSelected[t]},a._addMinMaxProperty=function(t,e){this._minMaxProperty.set(t,e)},a._setOption=function(t,e){this._options.frame=t,this._options.trim=e},a._addInstance=function(t,e){this._instances[t]=e},e}()}).call(this,a(11))},57:function(t,e,a){"use strict";var i=Math.sin,r=Math.cos,n=Math.PI,s=Math.min,o=Math.floor,c=Math.round;(function(t){function d(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function h(t,e){for(var a,i=0;i<e.length;i++)(a=e[i]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}function u(t,e,a){return e&&h(t.prototype,e),a&&h(t,a),t}a.d(e,"a",function(){return A});var p=a(86),l=(a.n(p),a(24)),m=(a.n(l),a(26)),_=(a.n(m),a(56)),f=(a.n(_),a(19)),g=(a.n(f),a(31)),b=(a.n(g),a(40)),v=(a.n(b),a(115)),y=(a.n(v),a(2)),S=a(20),w=a(5),D=a(9),j=a(0),C=a(12),k=a(1),x=a(7),I=a(41),O=a(4),P=2*n/24,T=500,B=400,L=function(){function t(t,e){this._id=t,this._shipData=e,this._select="#ship-compare-"+this._id,this._setupSvg(),this._g=Object(j.select)(this._select).select("g"),this._setCompass()}var e=t.prototype;return e._setupSvg=function(){var t=Object(j.select)(this.select);Object(j.select)(this.select+" svg").remove(),t.append("svg").attr("width",this.shipData.svgWidth).attr("height",this.shipData.svgHeight).attr("class","profile").attr("fill","none").append("g").attr("transform","translate("+this.shipData.svgWidth/2+", "+this.shipData.svgHeight/2+")"),Object(j.select)(this.select+" div").remove(),t.append("div").classed("block",!0)},e._setCompass=function(){var t=Array(12);t.fill(1,0);var e=Object(C.g)().sort(null).value(1)(t),a=Object(C.a)().outerRadius(this.shipData.radiusScaleAbsolute(12)).innerRadius(this.shipData.innerRadius);this.g.selectAll(".compass-arc").data(e).enter().append("g").attr("class","compass-arc").append("path").attr("d",a),this.g.append("line").attr("x1",0).attr("y1",-160).attr("x2",0).attr("y2",-79).attr("marker-end","url(#course-arrow)")},t.pd=function(t){var e='<span class="badge badge-light">'+t[0]+" / ";return e+=t[1]?""+t[1]:"–",e+=" pd</span>"},t.getCannonsPerDeck=function(e,a){for(var i=a[0]+" "+t.pd(e[0]),r="",n=1;4>n;n+=1)a[n]?i=a[n]+" "+t.pd(e[n])+" <br>"+i:r+="<br>";return[i,r]},t.getText=function(t){function e(t){return'<div class="row small '+((i+=1)%2?"light":"")+'"><div class="col-3">'+t+"</div>"}function a(e,a,i){void 0===i&&(i=6);var r="",n="";if("cannonsPerDeck"===e){var s=t[e];r=s[0],n="<br>"+(n=s[1])}else r=""===e?"":t[e];return'<div class="col-'+i+'">'+r+'<br><span class="des">'+a+"</span>"+n+"</div>"}var i=0,r="";return r+=e(t.shipRating),r+='<div class="col-9"><div class="row no-gutters">',r+=a("battleRating","Battle rating"),r+=a("guns","Cannons"),r+=a("upgradeXP","Knowledge XP"),r+=a("waterlineHeight","Water line"),r+="</div></div></div>",r+=e(t.decks),r+='<div class="col-9"><div class="row no-gutters">',r+=a("cannonsPerDeck","Gun decks"),r+=a("firezoneHorizontalWidth","Firezone horizontal width"),r+="</div></div></div>",r+=e("Broadside (pd)"),r+='<div class="col-9"><div class="row no-gutters">',r+=a("cannonBroadside","Cannons"),r+=a("carroBroadside","Carronades"),r+="</div></div></div>",r+=e("Chasers"),r+='<div class="col-9"><div class="row no-gutters">',r+=a("gunsFront","Bow"),r+=a("gunsBack","Stern"),r+="</div></div></div>",r+=e("Speed"),r+='<div class="col-9"><div class="row no-gutters">',r+=a("maxSpeed","Maximum"),r+=a("",""),r+=a("acceleration","Acceleration"),r+=a("deceleration","Deceleration"),r+=a("maxTurningSpeed","Turn speed"),r+=a("halfturnTime","Rudder half time"),r+="</div></div></div>",r+=e('Armour <span class="badge badge-light">Thickness</span>'),r+='<div class="col-9"><div class="row no-gutters">',r+=a("sideArmor","Sides"),r+=a("structure","Hull"),r+=a("frontArmor","Bow"),r+=a("backArmor","Stern"),r+=a("pump","Pump"),r+=a("rudder","Rudder"),r+="</div></div></div>",r+=e('Masts <span class="badge badge-light">Thickness</span>'),r+='<div class="col-9"><div class="row no-gutters">',r+=a("sails","Sails"),r+=a("mastBottomArmor","Bottom"),r+=a("mastMiddleArmor","Middle"),r+=a("mastTopArmor","Top"),r+="</div></div></div>",r+=e("Crew"),r+='<div class="col-9"><div class="row no-gutters">',r+=a("minCrew","Minimum",4),r+=a("sailingCrew","Sailing",4),r+=a("maxCrew","Maximum",4),r+="</div></div></div>",r+=e("Resistance"),r+='<div class="col-9"><div class="row no-gutters">',r+=a("fireResistance","Fire",3),r+=a("leakResistance","Leaks",3),r+=a("crewProtection","Crew Protection",6),r+="</div></div></div>",r+=e("Repairs needed"),r+='<div class="col-9"><div class="row no-gutters">',r+=a("hullRepair","Hull",4),r+=a("rigRepair","Rig",4),r+=a("rumRepair","Rum",4),r+="</div></div></div>",r+=e("Repair time"),r+='<div class="col-9"><div class="row no-gutters">',r+=a("sidesRepair","Sides",4),r+=a("structureRepair","Hull",4),r+=a("bowRepair","Bow",4),r+=a("sternRepair","Stern",4),r+=a("sailsRepair","Sails",4),r+=a("rudderRepair","Rudder",4),r+="</div></div></div>",r+=e("Hold"),r+='<div class="col-9"><div class="row no-gutters">',r+=a("maxWeight","Tons"),r+=a("holdSize","Cargo slots"),r+="</div></div></div>",r+="</div>"},u(t,[{key:"id",get:function(){return this._id}},{key:"shipData",get:function(){return this._shipData}},{key:"select",get:function(){return this._select}},{key:"g",get:function(){return this._g}}]),t}(),M=function(e){function a(t,a,i){var r;return(r=e.call(this,t,i)||this)._shipData=a,r._shipCompareData=i,r._setBackground(),r._setBackgroundGradient(),r._drawProfile(),r._printText(),r}d(a,e);var s=a.prototype;return s._setBackground=function(){var t=this,e=Object(C.a)().outerRadius(function(e){return t.shipCompareData.radiusScaleAbsolute(e)+2}).innerRadius(function(e){return t.shipCompareData.radiusScaleAbsolute(e)+1}).startAngle(-n/2).endAngle(n/2),a=[12,8,4,0],i=["12 knots","8 knots","4 knots","0 knots"];this.g.selectAll(".circle").data(a).enter().append("circle").attr("class","knots-circle").attr("r",function(e){return t.shipCompareData.radiusScaleAbsolute(e)}),this.g.selectAll(".label").data(a).enter().append("path").attr("d",e).attr("id",function(t,e){return"tick"+e}),this.g.selectAll(".label").data(a).enter().append("text").attr("class","knots-text").append("textPath").attr("href",function(t,e){return"#tick"+e}).text(function(t,e){return i[e]}).attr("startOffset","16%")},s._setBackgroundGradient=function(){var t=this,e=Object(D.scaleLinear)().domain([this.shipData.speed.min,this.shipData.speed.max]).range([0,this.shipCompareData.svgWidth]),a=e.domain();a[2]=a[1]-a[0];for(var i=[],r=0;r<30;r+=1)i.push(r*a[2]/29+a[0]);this.g.append("defs").append("radialGradient").attr("id","gradient").attr("cx",.5).attr("cy",.25).attr("r",.5).selectAll("stop").data(Object(y.range)(30)).enter().append("stop").attr("offset",function(a,r){return e(i[r])/t.shipCompareData.svgWidth}).attr("stop-color",function(e,a){return t.shipCompareData.colorScale(i[a])})},s._drawCompassHelperFunction=function(){var t=175,e=Object(D.scaleLinear)().domain([0,1,2,3]).range([70,105,140,t]),a=[3,0,0,1,0,0,1,0,0,2,0,0,1,0,0,1,0,0,3,0,0,1,0,0,1,0,0,2,0,0,1,0,0,1,0,0,3,0,0,1,0,0,1,0,0,2,0,0,1,0,0,1,0,0,3,0,0,1,0,0,1,0,0,2,0,0,1,0,0,1,0,0],i=a.length,r=Object(C.g)().sort(null).value(1),s=C.e,o=r(a),c=Object(C.h)().angle(function(t,e){return e*(2*n/i)}).radius(function(t){return e(t.data)}).curve(s);console.log(o,c),this.g.append("path").style("fill","blueviolet").attr("d",c(o)),this.g.append("circle").attr("r",.35*t).style("fill","red")},s._drawProfile=function(){var t=this,e=Object(C.g)().sort(null).value(1)(this.shipData.speedDegrees),a=C.d,n=Object(C.h)().angle(function(t,e){return e*P}).radius(function(e){return t.shipCompareData.radiusScaleAbsolute(e.data)}).curve(a),s=this.g.append("path").classed("base",!0),o=this.g.append("g").classed("markers",!0);s.attr("d",n(e)),o.selectAll("circle").data(e).enter().append("circle").attr("r",5).attr("cy",function(e,a){return r(a*P)*-t.shipCompareData.radiusScaleAbsolute(e.data)}).attr("cx",function(e,a){return i(a*P)*t.shipCompareData.radiusScaleAbsolute(e.data)}).attr("fill",function(e){return t.shipCompareData.colorScale(e.data)}).append("title").text(function(t){return c(10*t.data)/10+" knots"})},s._printText=function(){var e=L.getCannonsPerDeck(this.shipData.deckClassLimit,this.shipData.gunsPerDeck),a={shipRating:Object(k.r)(this.shipData.class)+" rate",battleRating:this.shipData.battleRating,guns:this.shipData.guns,decks:this.shipData.decks+" deck"+(1<this.shipData.decks?"s":""),additionalRow:4>this.shipData.decks?"<br> ":"",cannonsPerDeck:e,cannonBroadside:Object(k.m)(this.shipData.broadside.cannons),carroBroadside:Object(k.m)(this.shipData.broadside.carronades),gunsFront:this.shipData.gunsPerDeck[4],limitFront:this.shipData.deckClassLimit[4],gunsBack:this.shipData.gunsPerDeck[5],limitBack:this.shipData.deckClassLimit[5],firezoneHorizontalWidth:this.shipData.ship.firezoneHorizontalWidth,waterlineHeight:Object(k.k)(this.shipData.ship.waterlineHeight),maxSpeed:Object(k.k)(this.shipData.speed.max,3),acceleration:Object(k.k)(this.shipData.ship.acceleration),deceleration:Object(k.k)(this.shipData.ship.deceleration),maxTurningSpeed:Object(k.k)(this.shipData.rudder.turnSpeed),halfturnTime:Object(k.k)(this.shipData.rudder.halfturnTime),sideArmor:Object(k.m)(this.shipData.sides.armour)+' <span class="badge badge-light">'+Object(k.m)(this.shipData.sides.thickness)+"</span>",frontArmor:Object(k.m)(this.shipData.bow.armour)+' <span class="badge badge-light">'+Object(k.m)(this.shipData.bow.thickness)+"</span>",pump:Object(k.m)(this.shipData.pump.armour),sails:Object(k.m)(this.shipData.sails.armour),structure:Object(k.m)(this.shipData.structure.armour),backArmor:Object(k.m)(this.shipData.stern.armour)+' <span class="badge badge-light">'+Object(k.m)(this.shipData.stern.thickness)+"</span>",rudder:Object(k.m)(this.shipData.rudder.armour)+' <span class="badge badge-light">'+Object(k.m)(this.shipData.rudder.thickness)+"</span>",minCrew:Object(k.m)(this.shipData.crew.min),maxCrew:Object(k.m)(this.shipData.crew.max),sailingCrew:Object(k.m)(this.shipData.crew.sailing),maxWeight:Object(k.m)(this.shipData.maxWeight),holdSize:Object(k.m)(this.shipData.holdSize),upgradeXP:Object(k.m)(this.shipData.upgradeXP),sternRepair:Object(k.m)(this.shipData.repairTime.stern),bowRepair:Object(k.m)(this.shipData.repairTime.bow),sidesRepair:Object(k.m)(this.shipData.repairTime.sides),rudderRepair:Object(k.m)(this.shipData.repairTime.rudder),sailsRepair:Object(k.m)(this.shipData.repairTime.sails),structureRepair:Object(k.m)(this.shipData.repairTime.structure),hullRepair:""+Object(k.m)(this.shipData.sides.armour/T),rigRepair:""+Object(k.m)(this.shipData.sails.armour/B),rumRepair:""+Object(k.m)(this.shipData.crew.max/4),fireResistance:Object(k.m)(this.shipData.resistance.fire),leakResistance:Object(k.m)(this.shipData.resistance.leaks),crewProtection:Object(k.m)(this.shipData.resistance.crew),mastBottomArmor:Object(k.m)(this.shipData.mast.bottomArmour)+' <span class="badge badge-light">'+Object(k.m)(this.shipData.mast.bottomThickness)+"</span>",mastMiddleArmor:Object(k.m)(this.shipData.mast.middleArmour)+' <span class="badge badge-light">'+Object(k.m)(this.shipData.mast.middleThickness)+"</span>",mastTopArmor:Object(k.m)(this.shipData.mast.topArmour)+' <span class="badge badge-light">'+Object(k.m)(this.shipData.mast.topThickness)+"</span>"};a.gunsFront?a.gunsFront+=" "+L.pd(a.limitFront):a.gunsFront="–",a.gunsBack?a.gunsBack+=" "+L.pd(a.limitBack):a.gunsBack="–",t(""+this.select).find("div").append(L.getText(a))},u(a,[{key:"shipData",get:function(){return this._shipData}},{key:"shipCompareData",get:function(){return this._shipCompareData}}]),a}(L),N=function(e){function a(t,a,i,r){var n;return(n=e.call(this,t,r)||this)._shipBaseData=a,n._shipCompareData=i,n._shipCompare=r,n._drawDifferenceProfile(),n._injectTextComparison(),n}d(a,e);var n=a.prototype;return n._drawDifferenceProfile=function(){var t=this,e=Object(C.g)().sort(null).value(1),a=e(this.shipCompareData.speedDegrees),n=e(this.shipBaseData.speedDegrees),s=C.d,o=Object(C.h)().angle(function(t,e){return e*P}).radius(function(e){return t.shipCompare.radiusScaleAbsolute(e.data)}).curve(s),d=this.g.append("path"),h=this.g.append("path"),u=this.g.append("g").attr("class","markers"),p=[];this.shipCompareData.speedDegrees.forEach(function(e,a){p.push(Object(k.w)(e-t.shipBaseData.speedDegrees[a]))});var l=this._shipCompare._minSpeed,m=this._shipCompare._maxSpeed,_=Object(D.scaleLinear)().domain([l,-1,0,1,m]).range(["#782129","#a62e39","#fbf8f5","#419f57","#2a6739"]).interpolate(w.c);d.attr("d",o(a)).classed("comp",!0),u.selectAll("circle").data(a).enter().append("circle").attr("r",5).attr("cy",function(e,a){return r(a*P)*-t.shipCompare.radiusScaleAbsolute(e.data)}).attr("cx",function(e,a){return i(a*P)*t.shipCompare.radiusScaleAbsolute(e.data)}).attr("fill",function(t,e){return _(p[e])}).append("title").text(function(t){return c(10*t.data)/10+" knots"}),h.attr("d",o(n)).classed("base",!0)},n._injectTextComparison=function(){function e(t,e,a){void 0===a&&(a=0);var i=parseFloat((t-e).toFixed(a));return 0>i?'<span class="badge badge-danger">'+Object(k.k)(Math.abs(i))+"</span>":0<i?'<span class="badge badge-success">'+Object(k.k)(i)+"</span>":""}var a={shipRating:Object(k.r)(this.shipCompareData.class)+" rate",battleRating:this.shipCompareData.battleRating+" "+e(this.shipCompareData.battleRating,this.shipBaseData.battleRating),guns:this.shipCompareData.guns+" "+e(this.shipCompareData.guns,this.shipBaseData.guns),decks:this.shipCompareData.decks+" deck"+(1<this.shipCompareData.decks?"s":"")+" "+e(this.shipCompareData.decks,this.shipBaseData.decks),additionalRow:4>this.shipCompareData.decks?"<br> ":"",cannonsPerDeck:L.getCannonsPerDeck(this.shipCompareData.deckClassLimit,this.shipCompareData.gunsPerDeck),cannonBroadside:this.shipCompareData.broadside.cannons+" "+e(this.shipCompareData.broadside.cannons,this.shipBaseData.broadside.cannons),carroBroadside:this.shipCompareData.broadside.carronades+" "+e(this.shipCompareData.broadside.carronades,this.shipBaseData.broadside.carronades),gunsFront:this.shipCompareData.gunsPerDeck[4],limitFront:this.shipCompareData.deckClassLimit[4],gunsBack:this.shipCompareData.gunsPerDeck[5],limitBack:this.shipCompareData.deckClassLimit[5],minSpeed:Object(k.k)(this.shipCompareData.speed.min)+" "+e(this.shipCompareData.speed.min,this.shipBaseData.speed.min,2),maxSpeed:Object(k.k)(this.shipCompareData.speed.max,3)+" "+e(this.shipCompareData.speed.max,this.shipBaseData.speed.max,2),maxTurningSpeed:Object(k.k)(this.shipCompareData.rudder.turnSpeed)+" "+e(this.shipCompareData.rudder.turnSpeed,this.shipBaseData.rudder.turnSpeed,2),firezoneHorizontalWidth:this.shipCompareData.ship.firezoneHorizontalWidth+" "+e(this.shipCompareData.ship.firezoneHorizontalWidth,this.shipBaseData.ship.firezoneHorizontalWidth),waterlineHeight:Object(k.k)(this.shipCompareData.ship.waterlineHeight)+" "+e(this.shipCompareData.ship.waterlineHeight,this.shipBaseData.ship.waterlineHeight,2),acceleration:Object(k.k)(this.shipCompareData.ship.acceleration)+" "+e(this.shipCompareData.ship.acceleration,this.shipBaseData.ship.acceleration,2),deceleration:Object(k.k)(this.shipCompareData.ship.deceleration)+" "+e(this.shipCompareData.ship.deceleration,this.shipBaseData.ship.deceleration,2),halfturnTime:Object(k.k)(this.shipCompareData.rudder.halfturnTime)+" "+e(this.shipCompareData.rudder.halfturnTime,this.shipBaseData.rudder.halfturnTime),sideArmor:Object(k.m)(this.shipCompareData.sides.armour)+" "+e(this.shipCompareData.sides.armour,this.shipBaseData.sides.armour)+' <span class="badge badge-light">'+Object(k.m)(this.shipCompareData.sides.thickness)+"</span>"+e(this.shipCompareData.sides.thickness,this.shipBaseData.sides.thickness),frontArmor:Object(k.m)(this.shipCompareData.bow.armour)+" "+e(this.shipCompareData.bow.armour,this.shipBaseData.bow.armour)+' <span class="badge badge-light">'+Object(k.m)(this.shipCompareData.bow.thickness)+"</span>"+e(this.shipCompareData.bow.thickness,this.shipBaseData.bow.thickness),backArmor:Object(k.m)(this.shipCompareData.stern.armour)+" "+e(this.shipCompareData.stern.armour,this.shipBaseData.stern.armour)+' <span class="badge badge-light">'+Object(k.m)(this.shipCompareData.stern.thickness)+"</span>"+e(this.shipCompareData.stern.thickness,this.shipBaseData.stern.thickness),pump:Object(k.m)(this.shipCompareData.pump.armour)+" "+e(this.shipCompareData.pump.armour,this.shipBaseData.pump.armour),sails:Object(k.m)(this.shipCompareData.sails.armour)+" "+e(this.shipCompareData.sails.armour,this.shipBaseData.sails.armour),structure:Object(k.m)(this.shipCompareData.structure.armour)+" "+e(this.shipCompareData.structure.armour,this.shipBaseData.structure.armour),rudder:Object(k.m)(this.shipCompareData.rudder.armour)+" "+e(this.shipCompareData.rudder.armour,this.shipBaseData.rudder.armour)+' <span class="badge badge-light">'+Object(k.m)(this.shipCompareData.rudder.thickness)+"</span>"+e(this.shipCompareData.rudder.thickness,this.shipBaseData.rudder.thickness),minCrew:Object(k.m)(this.shipCompareData.crew.min)+" "+e(this.shipCompareData.crew.min,this.shipBaseData.crew.min),maxCrew:Object(k.m)(this.shipCompareData.crew.max)+" "+e(this.shipCompareData.crew.max,this.shipBaseData.crew.max),sailingCrew:Object(k.m)(this.shipCompareData.crew.sailing)+" "+e(this.shipCompareData.crew.sailing,this.shipBaseData.crew.sailing),maxWeight:Object(k.m)(this.shipCompareData.maxWeight)+" "+e(this.shipCompareData.maxWeight,this.shipBaseData.maxWeight),holdSize:Object(k.m)(this.shipCompareData.holdSize)+" "+e(this.shipCompareData.holdSize,this.shipBaseData.holdSize),upgradeXP:Object(k.m)(this.shipCompareData.upgradeXP)+" "+e(this.shipCompareData.upgradeXP,this.shipBaseData.upgradeXP),sternRepair:Object(k.m)(this.shipCompareData.repairTime.stern)+" "+e(this.shipCompareData.repairTime.stern,this.shipBaseData.repairTime.stern),bowRepair:Object(k.m)(this.shipCompareData.repairTime.bow)+" "+e(this.shipCompareData.repairTime.bow,this.shipBaseData.repairTime.bow),sidesRepair:Object(k.m)(this.shipCompareData.repairTime.sides)+" "+e(this.shipCompareData.repairTime.sides,this.shipBaseData.repairTime.sides),rudderRepair:Object(k.m)(this.shipCompareData.repairTime.rudder)+" "+e(this.shipCompareData.repairTime.rudder,this.shipBaseData.repairTime.rudder),sailsRepair:Object(k.m)(this.shipCompareData.repairTime.sails)+" "+e(this.shipCompareData.repairTime.sails,this.shipBaseData.repairTime.sails),structureRepair:Object(k.m)(this.shipCompareData.repairTime.structure)+" "+e(this.shipCompareData.repairTime.structure,this.shipBaseData.repairTime.structure),hullRepair:Object(k.m)(this.shipCompareData.sides.armour/T)+" "+e(this.shipCompareData.sides.armour/T,this.shipBaseData.sides.armour/T),rigRepair:Object(k.m)(this.shipCompareData.sails.armour/B)+" "+e(this.shipCompareData.sails.armour/B,this.shipBaseData.sails.armour/B),rumRepair:Object(k.m)(this.shipCompareData.crew.max/4)+" "+e(this.shipCompareData.crew.max/4,this.shipBaseData.crew.max/4),fireResistance:Object(k.m)(this.shipCompareData.resistance.fire)+" "+e(this.shipCompareData.resistance.fire,this.shipBaseData.resistance.fire),leakResistance:Object(k.m)(this.shipCompareData.resistance.leaks)+" "+e(this.shipCompareData.resistance.leaks,this.shipBaseData.resistance.leaks),crewProtection:Object(k.m)(this.shipCompareData.resistance.crew)+" "+e(this.shipCompareData.resistance.crew,this.shipBaseData.resistance.crew),mastBottomArmor:Object(k.m)(this.shipCompareData.mast.bottomArmour)+" "+e(this.shipCompareData.mast.bottomArmour,this.shipBaseData.mast.bottomArmour)+' <span class="badge badge-light">'+Object(k.m)(this.shipCompareData.mast.bottomThickness)+"</span>"+e(this.shipCompareData.mast.bottomThickness,this.shipBaseData.mast.bottomThickness),mastMiddleArmor:Object(k.m)(this.shipCompareData.mast.middleArmour)+" "+e(this.shipCompareData.mast.middleArmour,this.shipBaseData.mast.middleArmour)+' <span class="badge badge-light">'+Object(k.m)(this.shipCompareData.mast.middleThickness)+"</span>"+e(this.shipCompareData.mast.middleThickness,this.shipBaseData.mast.middleThickness),mastTopArmor:Object(k.m)(this.shipCompareData.mast.topArmour)+" "+e(this.shipCompareData.mast.topArmour,this.shipBaseData.mast.topArmour)+' <span class="badge badge-light">'+Object(k.m)(this.shipCompareData.mast.topThickness)+"</span>"+e(this.shipCompareData.mast.topThickness,this.shipBaseData.mast.topThickness)};a.gunsFront?a.gunsFront+=" "+L.pd(a.limitFront):a.gunsFront="–",a.gunsBack?a.gunsBack+=" "+L.pd(a.limitBack):a.gunsBack="–",t(""+this.select).find("div").append(L.getText(a))},u(a,[{key:"shipBaseData",get:function(){return this._shipBaseData}},{key:"shipCompareData",get:function(){return this._shipCompareData}},{key:"shipCompare",get:function(){return this._shipCompare}}]),a}(L),A=function(){function e(t,e,a){void 0===a&&(a="ship-compare"),this._shipData=t,this._baseId=a,this._baseName="Compare ships",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._columnsCompare="ship-compare"===this._baseId?["C1","C2"]:[],this._columns=this._columnsCompare.slice(),this._columns.unshift("Base"),this._ships={Base:{},C1:{},C2:{}};var i=1.2*Object(y.min)(this._shipData,function(t){return t.speed.min});this._minSpeed=i,this._maxSpeed=15.5,this._colorScale=Object(D.scaleLinear)().domain([this._minSpeed,0,12,this._maxSpeed]).range(["#a62e39","#fbf8f5","#419f57","#58bb6f"]).interpolate(w.c),this._woodChanges=new Map([["Hull strength",["structure.armour"]],["Side armour",["bow.armour","sides.armour","sails.armour","structure.armour","stern.armour"]],["Thickness",["sides.thickness","bow.thickness","stern.thickness"]],["Ship speed",["speed.max"]],["Acceleration",["ship.acceleration"]],["Turn speed",["rudder.turnSpeed"]],["Rudder speed",["rudder.halfturnTime"]],["Fire resistance",["resistance.fire"]],["Leak resistance",["resistance.leaks"]],["Crew protection",["resistance.crew"]],["Crew",["crew.max"]]]),this._woodId="ship-journey"===this._baseId?"wood-journey":"wood-ship",this._woodCompare=new I.a(e,this._woodId),"ship-journey"===this._baseId?(this._initData(),this._initWoodSelect()):this._setupListener()}var a=e.prototype;return a._setupListener=function(){var e=this;t("#"+this._buttonId).on("click",function(t){Object(x.b)("Tools",e._baseName),t.stopPropagation(),e._shipCompareSelected()})},a._setGraphicsParameters=function(){this.svgWidth=parseInt(t("#"+this._modalId+" .columnA").width(),10),this.svgHeight=this.svgWidth,this.outerRadius=o(s(this.svgWidth,this.svgHeight)/2),this.innerRadius=o(.3*this.outerRadius),this.radiusScaleAbsolute=Object(D.scaleLinear)().domain([this.minSpeed,0,this.maxSpeed]).range([10,this.innerRadius,this.outerRadius])},a._shipCompareSelected=function(){document.getElementById(this._modalId)||this._initModal(),t("#"+this._modalId).modal("show"),this._setGraphicsParameters()},a._setupData=function(){this.shipSelectData=Object(S.b)().key(function(t){return t.class}).sortKeys(y.ascending).entries(this._shipData.map(function(t){return{id:t.id,name:t.name,class:t.class,battleRating:t.battleRating,guns:t.guns}}).sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}))},a._injectModal=function(){var t=this;Object(O.n)(this._modalId,this._baseName);var e=Object(j.select)("#"+this._modalId+" .modal-body").append("div").attr("class","container-fluid").append("div").attr("class","row");this._columns.forEach(function(a){var i=e.append("div").attr("class","col-md-4 ml-auto pt-2 "+("Base"===a?"columnA":"columnC")),r=t._baseId+"-"+a+"-select";i.append("label").append("select").attr("name",r).attr("id",r),["frame","trim"].forEach(function(e){var r=t._woodId+"-"+e+"-"+a+"-select";i.append("label").append("select").attr("name",r).attr("id",r)}),i.append("div").attr("id",t._baseId+"-"+a).attr("class","Base"===a?"ship-base":"ship-compare")})},a._initData=function(){this._setupData(),this.woodCompare._setupData()},a._initWoodSelect=function(){var e=this;this._columns.forEach(function(a){e._setupShipSelect(a),["frame","trim"].forEach(function(i){var r=t("#"+e._woodId+"-"+i+"-"+a+"-select");e.woodCompare._setupWoodSelects(a,i,r)}),e._setupSelectListener(a)})},a._initModal=function(){this._initData(),this._injectModal(),this._initWoodSelect()},a._getOptions=function(){return this.shipSelectData.map(function(t){return'<optgroup label="'+Object(k.r)(t.key)+' rate">'+t.values.map(function(t){return'<option data-subtext="'+t.battleRating+'" value="'+t.id+'">'+t.name+" ("+t.guns+")"}).join("</option>")}).join("</optgroup>")},a._setupShipSelect=function(e){var a=t("#"+this._baseId+"-"+e+"-select"),i=this._getOptions();a.append(i),"Base"!==e&&a.attr("disabled","disabled")},a._getShipData=function(t,e){var a=this._shipData.filter(function(e){return e.id===t})[0];return a=this._addWoodData(a,e)},a._addWoodData=function(t,e){var a=this,i=JSON.parse(JSON.stringify(t));if(i.resistance={},i.resistance.fire=0,i.resistance.leaks=0,i.resistance.crew=0,void 0!==this.woodCompare._instances[e]){var r="_woodData";"Base"!==e&&(r="_compareData");var n=new Map;["frame","trim"].forEach(function(t){a.woodCompare._instances[e][r][t].properties.forEach(function(t){a._woodChanges.has(t.modifier)&&n.set(t.modifier,n.has(t.modifier)?n.get(t.modifier)+t.amount:t.amount)})}),n.forEach(function(t,e){a._woodChanges.get(e).forEach(function(t){var a=t.split("."),r=1+n.get(e)/100;1<a.length?i[a[0]][a[1]]?i[a[0]][a[1]]*=r:i[a[0]][a[1]]=n.get(e):i[a[0]]?i[a[0]]*=r:i[a[0]]=n.get(e)})}),i.speedDegrees=i.speedDegrees.map(function(t){var e=1+n.get("Ship speed")/100;return Math.max(s(t*e,a._maxSpeed),a._minSpeed)})}return i},a._refreshShips=function(e,a){var i=this,r=this._getShipData(e,a);"ship-journey"===this._baseId?this._singleShipData=r:"Base"===a?(this._setShip(a,new M(a,r,this)),this._columnsCompare.forEach(function(e){t("#"+i._baseId+"-"+e+"-select").removeAttr("disabled").selectpicker("refresh"),Object(k.s)(i.ships[e])||i._setShip(e,new N(e,r,i.ships[e]._shipCompareData,i))})):this._setShip(a,new N(a,this.ships.Base._shipData,r,this))},a._enableCompareSelects=function(){var e=this;this._columnsCompare.forEach(function(a){t("#"+e._baseId+"-"+a+"-select").removeAttr("disabled").selectpicker("refresh")})},a._setupSelectListener=function(e){var a=this,i=t("#"+this._baseId+"-"+e+"-select");i.addClass("selectpicker").on("changed.bs.select",function(t){t.preventDefault();var r=+i.val();a._refreshShips(r,e),"Base"===e&&"ship-journey"!==a._baseId&&a._enableCompareSelects(),a.woodCompare.enableSelects(e)}).selectpicker({noneSelectedText:"Select ship"}).val("default").selectpicker("refresh"),["frame","trim"].forEach(function(r){var n=t("#"+a._woodId+"-"+r+"-"+e+"-select");n.addClass("selectpicker").on("changed.bs.select",function(){a.woodCompare._woodSelected(e,r,n);var t=+i.val();a._refreshShips(t,e)}).selectpicker({noneSelectedText:"Select "+r}).val("default").selectpicker("refresh")})},a._setShip=function(t,e){this._ships[t]=e},u(e,[{key:"woodCompare",get:function(){return this._woodCompare}},{key:"ships",get:function(){return this._ships}},{key:"minSpeed",get:function(){return this._minSpeed}},{key:"maxSpeed",get:function(){return this._maxSpeed}},{key:"colorScale",get:function(){return this._colorScale}},{key:"svgWidth",set:function(t){this._svgWidth=t},get:function(){return this._svgWidth}},{key:"svgHeight",set:function(t){this._svgHeight=t},get:function(){return this._svgHeight}},{key:"outerRadius",set:function(t){this._outerRadius=t},get:function(){return this._outerRadius}},{key:"innerRadius",set:function(t){this._innerRadius=t},get:function(){return this._innerRadius}},{key:"radiusScaleAbsolute",set:function(t){this._radiusScaleAbsolute=t},get:function(){return this._radiusScaleAbsolute}}]),e}()}).call(this,a(11))},7:function(t,e,a){"use strict";function i(){window.dataLayer.push(arguments)}function r(t,e){void 0!==window.google_tag_manager&&window.google_tag_manager.dataLayer.gtmLoad&&i("event","click",{event_category:t,event_label:e})}function n(t,e){void 0!==window.google_tag_manager&&window.google_tag_manager.dataLayer.gtmLoad&&i("config",o,{page_title:t,page_path:e})}function s(){i("js",new Date),i("config",o)}a.d(e,"b",function(){return r}),a.d(e,"c",function(){return n}),a.d(e,"a",function(){return s});var o="UA-109520372-1";window.dataLayer=window.dataLayer||[]},88:function(t){t.exports=Popper},89:function(){}},[[140,1,2]]]);