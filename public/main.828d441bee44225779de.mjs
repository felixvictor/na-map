/*! For license information please see main.828d441bee44225779de.mjs.LICENSE.txt */
(self.webpackChunkna_map=self.webpackChunkna_map||[]).push([[179],{2855:(e,t,a)=>{a.d(t,{KS:()=>r,de:()=>o,uF:()=>n});var s=a(9022),i=a(9949);window.ga=function(){ga.q.push(arguments)},ga.q=[];const r=(e,t,a=1)=>{ga("send",{hitType:"event",eventCategory:e,eventLabel:t,eventValue:a})},o=e=>{ga("send",{hitType:"pageview",title:e})},n=()=>{ga.l=Date.now(),ga("create",i.vt,"auto"),ga("set","anonymizeIp",!0),ga("set","transport","beacon"),ga("send","pageview"),window.addEventListener("error",(e=>{const t=[`Message: ${e.message} @ ${e.filename}-${e.lineno}:${e.colno}`,`Error object: ${JSON.stringify(e.error)}`].join(" - ");return ga("send","exception",{exDescription:t,exFatal:!1,appName:s.DJ,appVersion:s.f4}),!1}))}},9492:(e,t,a)=>{a.d(t,{V4:()=>kt,hY:()=>$t,Ms:()=>Mt});var s=a(3824),i=a.n(s),r=a(9157),o=a(8398),n=a(8776),h=a(577),p=a(9937),l=a(2855),d=a(2157),c=a(9022),u=a(7015),m=a(5923),g=a(393);const f=new Map([["Cannon horizontal dispersion",{properties:["gunnery.dispersionHorizontal"],isBaseValueAbsolute:!0}],["Cannon vertical dispersion",{properties:["gunnery.dispersionVertical"],isBaseValueAbsolute:!0}],["Cannon reload time",{properties:["gunnery.reload"],isBaseValueAbsolute:!0}],["Cannon ball penetration",{properties:["gunnery.penetration"],isBaseValueAbsolute:!0}],["Cannon side traverse",{properties:["gunnery.traverseSide"],isBaseValueAbsolute:!0}],["Cannon up/down traverse",{properties:["gunnery.traverseUpDown"],isBaseValueAbsolute:!0}],["Morale",{properties:["boarding.morale"],isBaseValueAbsolute:!0}],["Muskets accuracy",{properties:["boarding.musketsAccuracy"],isBaseValueAbsolute:!1}],["Preparation",{properties:["boarding.prepPerRound"],isBaseValueAbsolute:!0}],["Initial preparation",{properties:["boarding.prepInitial"],isBaseValueAbsolute:!0}],["Melee attack",{properties:["boarding.attack"],isBaseValueAbsolute:!1}],["Melee defense",{properties:["boarding.defense"],isBaseValueAbsolute:!1}],["Disengage time",{properties:["boarding.disengageTime"],isBaseValueAbsolute:!0}],["Crew with muskets",{properties:["boarding.musketsCrew"],isBaseValueAbsolute:!0}],["Boarding cannons accuracy",{properties:["boarding.cannonsAccuracy"],isBaseValueAbsolute:!1}],["Acceleration",{properties:["ship.acceleration"],isBaseValueAbsolute:!0}],["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],isBaseValueAbsolute:!0}],["Armour hit points",{properties:["bow.armour","sides.armour","stern.armour"],isBaseValueAbsolute:!0}],["Armour repair amount (perk)",{properties:["repairAmount.armourPerk"],isBaseValueAbsolute:!0}],["Back armour thickness",{properties:["stern.thickness"],isBaseValueAbsolute:!0}],["Cannon crew",{properties:["crew.cannons"],isBaseValueAbsolute:!0}],["Carronade crew",{properties:["crew.carronades"],isBaseValueAbsolute:!0}],["Crew",{properties:["crew.max"],isBaseValueAbsolute:!0}],["Deceleration",{properties:["ship.deceleration"],isBaseValueAbsolute:!0}],["Front armour thickness",{properties:["bow.thickness"],isBaseValueAbsolute:!0}],["Hold weight",{properties:["maxWeight"],isBaseValueAbsolute:!0}],["Hull hit points",{properties:["structure.armour"],isBaseValueAbsolute:!0}],["Sail hit points",{properties:["sails.armour"],isBaseValueAbsolute:!0}],["Mast hit points",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],isBaseValueAbsolute:!0}],["Leak resistance",{properties:["resistance.leaks"],isBaseValueAbsolute:!1}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],isBaseValueAbsolute:!0}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],isBaseValueAbsolute:!0}],["Max speed",{properties:["speed.max"],isBaseValueAbsolute:!0}],["Repair amount",{properties:["repairAmount.armour"],isBaseValueAbsolute:!0}],["Repair time",{properties:["repairTime.sides"],isBaseValueAbsolute:!0}],["Roll angle",{properties:["ship.rollAngle"],isBaseValueAbsolute:!0}],["Rudder health",{properties:["rudder.armour"],isBaseValueAbsolute:!0}],["Rudder speed",{properties:["rudder.halfturnTime"],isBaseValueAbsolute:!0}],["Sail repair amount (perk)",{properties:["repairAmount.sailsPerk"],isBaseValueAbsolute:!0}],["Sailing crew",{properties:["crew.sailing"],isBaseValueAbsolute:!0}],["Splinter resistance",{properties:["resistance.splinter"],isBaseValueAbsolute:!1}],["Turn acceleration",{properties:["ship.turnAcceleration"],isBaseValueAbsolute:!0}],["Turn speed",{properties:["ship.turnSpeed"],isBaseValueAbsolute:!0}],["Water pump health",{properties:["pump.armour"],isBaseValueAbsolute:!0}]]),v=new Map([["Armor thickness",{properties:["sides.thickness"],cap:{amount:1,isPercentage:!0}}],["Armour hit points",{properties:["bow.armour","sides.armour","stern.armour"],cap:{amount:1,isPercentage:!0}}],["Structure hit points",{properties:["structure.armour"],cap:{amount:1,isPercentage:!0}}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],cap:{amount:1,isPercentage:!0}}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],cap:{amount:1,isPercentage:!0}}],["Max speed",{properties:["speed.max"],cap:{amount:20,isPercentage:!1}}],["Turn rate",{properties:["rudder.turnSpeed"],cap:{amount:.25,isPercentage:!0}}]]);var w=a(4332),b=a(9843);function D(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function y(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,C(e,t,"get"))}function S(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,C(e,t,"set"),a),a}function C(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var _=new WeakMap,$=new WeakMap,M=new WeakMap,k=new WeakMap,x=new WeakMap,I=new WeakMap,T=new WeakMap;class A extends b.Z{constructor(e,t,a){super(e,"xl"),D(this,_,{writable:!0,value:{}}),D(this,$,{writable:!0,value:void 0}),D(this,M,{writable:!0,value:void 0}),D(this,k,{writable:!0,value:void 0}),D(this,x,{writable:!0,value:void 0}),D(this,I,{writable:!0,value:void 0}),D(this,T,{writable:!0,value:void 0}),S(this,k,t),S(this,T,a),S(this,x,`${super.baseId}-button-copy`),S(this,$,`${super.baseId}-button-clone-left`),S(this,M,`${super.baseId}-button-clone-right`),S(this,I,`${super.baseId}-button-image`),this._init()}get buttonMakeImage(){return y(this,_)}get imageButtonId(){return y(this,I)}get copyButtonId(){return y(this,x)}getCloneLeftButtonId(e){return`${y(this,$)}-${e}`}getCloneRightButtonId(e){return`${y(this,M)}-${e}`}getBaseId(e){return`${super.baseId}-${e}`}getBaseIdSelectsShip(e){return`${this.getBaseIdSelects(e)}-ship`}getBaseIdSelects(e){return`${super.baseIdSelects}-${e}`}getBaseIdOutput(e){return`${super.baseIdOutput}-${e}`}_init(){this._injectModal()}_injectModal(){const e=super.bodySel;e.selectAll("*").remove();const t=e.append("div").attr("class","row");for(const e of y(this,k)){const a=t.append("div").attr("id",this.getBaseId(e)).attr("class","col-md-4 "+("base"===e?"column-base":"column-comp bg-paper")),s=a.append("div").attr("class","input-group justify-content-between flex-nowrap mt-1");e!==y(this,k)[0]&&s.append("button").attr("class","btn btn-default icon-outline-button").attr("id",this.getCloneLeftButtonId(e)).attr("title","Clone ship to left").attr("type","button").append("i").attr("class","icon icon-clone-left"),s.append("div").attr("id",this.getBaseIdSelectsShip(e)),e!==y(this,T)&&s.append("button").attr("class","btn btn-default icon-outline-button").attr("id",this.getCloneRightButtonId(e)).attr("title","Clone ship to right").attr("type","button").append("i").attr("class","icon icon-clone-right"),a.append("div").attr("id",this.getBaseIdSelects(e)).attr("class","input-group justify-content-between"),a.append("div").attr("id",this.getBaseIdOutput(e)).attr("class",""+("base"===e?"ship-base":"ship-compare"))}const a=super.footer;a.insert("button","button").attr("class","btn btn-outline-secondary icon-outline-button").attr("id",y(this,x)).attr("title","Copy to clipboard (ctrl-c)").attr("type","button").append("i").attr("class","icon icon-copy"),S(this,_,a.insert("button","button").attr("class","btn btn-outline-secondary icon-outline-button").attr("id",y(this,I)).attr("title","Make image").attr("type","button")),y(this,_).append("i").attr("class","icon icon-image")}}var B=a(1120),P=a.n(B),W=a(3838),R=a(7484),N=a.n(R),H=a(178),V=a.n(H);function Z(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function z(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,L(e,t,"get"))}function E(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,L(e,t,"set"),a),a}function L(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}N().extend(V());var O=new WeakMap,j=new WeakMap,F=new WeakMap;class X{constructor(e,t,a){Z(this,O,{writable:!0,value:void 0}),Z(this,j,{writable:!0,value:void 0}),Z(this,F,{writable:!0,value:void 0}),E(this,O,e),E(this,j,t),E(this,F,a)}static _saveCanvasAsImage(e){const t=`na-map ship compare ${N().utc().format("YYYY-MM-DD HH-mm-ss")}.png`,a=document.createElement("a");a.href=e,a.download=t,document.body.append(a),a.click(),a.remove()}_printSelectedData(e,t,a){var s;const i=e.querySelector(`#${z(this,F).getBaseIdSelectsShip(a)}`),r=null==i?void 0:i.parentNode,o=null==r?void 0:r.parentNode;r.remove(),null===(s=e.querySelector(`#${z(this,F).getBaseIdSelects(a)}`))||void 0===s||s.remove();const n=(0,W.Z)(o).insert("div",":first-child").style("height","5rem");t.ship&&n.append("div").style("margin-bottom","5px").style("line-height","1.1").text(t.ship),""!==t.wood[0]&&n.append("div").style("font-size","smaller").style("margin-bottom","5px").style("line-height","1.1").text(t.wood.join(" | "));for(const[e,a]of t.moduleData)""!==a&&n.append("div").style("font-size","small").style("margin-bottom","5px").style("line-height","1.1").html(`<em>${e}</em>: ${a}`)}_replaceSelectsWithText(e){for(const[t,a]of Object.entries(z(this,j)))this._printSelectedData(e,a,t)}async _save(e){if(e){const t=await P()(e,{allowTaint:!0,foreignObjectRendering:!0,ignoreElements:e=>e.classList.contains("central")||e.classList.contains("overlay")||e.classList.contains("navbar"),logging:!0,onclone:e=>{this._replaceSelectsWithText(e)},x:0,y:0});X._saveCanvasAsImage(t.toDataURL())}}async init(){(0,c.dM)(),await this._save(z(this,F).getModalNode()),(0,c.V4)()}}var Y=a(1198),q=a(5148);function G(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function U(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Q(e,t,"get"))}function K(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,Q(e,t,"set"),a),a}function Q(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var J=new WeakMap;class ee extends q.u{constructor(e,t){super(),G(this,J,{writable:!0,value:void 0}),super.moduleTypes=t,K(this,J,e),this._addVersion(),this._addShipsAndWoods(),this._addModules()}getSearchParam(){return super.getUrl()}_addVersion(){super.setVersion()}_addShipsAndWoods(){let e=[];for(const t of Mt)U(this,J)[t]&&(e=[...e,U(this,J)[t].ship,...U(this,J)[t].wood.values()]);super.setShipsAndWoodIds(e)}_addModules(){for(const[e,t]of Mt.entries())if(U(this,J)[t])for(const[a,s]of[...super.moduleTypes].entries()){const i=U(this,J)[t].modules.get(s)??[];i.length>0&&super.setModuleIds(e,a,i)}}}const te=(e,t,a)=>{(0,l.KS)("Menu","Copy ship compare");const s=new ee(e,t).getSearchParam();(0,Y.vQ)(s,a)};var ae=a(4695),se=a(29);function ie(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function re(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function oe(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,he(e,t,"get"))}function ne(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,he(e,t,"set"),a),a}function he(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var pe=new WeakMap,le=new WeakMap,de=new WeakMap,ce=new WeakMap,ue=new WeakMap,me=new WeakMap,ge=new WeakMap;class fe{constructor(e,t,a){re(this,pe,{writable:!0,value:void 0}),re(this,le,{writable:!0,value:{}}),re(this,de,{writable:!0,value:{}}),re(this,ce,{writable:!0,value:{}}),re(this,ue,{writable:!0,value:void 0}),re(this,me,{writable:!0,value:void 0}),re(this,ge,{writable:!0,value:void 0}),ie(this,"getShip$",(e=>oe(this,de)[e].select$)),ie(this,"getWood$",((e,t)=>oe(this,ce)[e][t].select$)),ie(this,"getModule$",((e,t)=>oe(this,le)[e][t].select$)),ie(this,"hasModuleSelects",(e=>!(0,d.xb)(oe(this,le)[e]))),ie(this,"getSelectedShipId",(e=>Number(oe(this,de)[e].getValues())??void 0)),ie(this,"getSelectedWoodId",((e,t)=>Number(oe(this,ce)[e][t].getValues())??0)),ne(this,ue,e),ne(this,me,t),ne(this,ge,a),ne(this,pe,oe(this,me).slice(1));for(const e of oe(this,me))oe(this,le)[e]={}}setShip(e,t){oe(this,de)[e].setSelectValues(t),"base"===e&&this.enableShipCompareSelects()}setWood(e,t,a){oe(this,ce)[e][t].setSelectValues(a)}setWoods(e,t){for(const[a,s]of t)this.setWood(e,a,s),this.enableWoodSelects(e)}setModulesPerType(e,t,a){oe(this,le)[e][t].setSelectValues(a)}setModules(e,t){for(const[a,s]of t)this.setModulesPerType(e,a,s)}getSelectedWoodIds(e){const t=new Map;for(const a of w.Kf){const s=this.getSelectedWoodId(e,a);t.set(a,s)}return t}getSelectedModuleIds(e,t){const a=new Map;for(const s of t){const t=this.getSelectedModuleIdsPerType(e,s);a.set(s,t)}return a}resetWoodSelect(e,t,a){oe(this,ce)[e][t].setSelectValues(a)}enableWoodSelects(e){for(const t of w.Kf)oe(this,ce)[e][t].enable()}enableShipSelect(e){oe(this,de)[e].enable()}enableShipCompareSelects(){for(const e of oe(this,pe))this.enableShipSelect(e)}getSelectedModuleIdsPerType(e,t){return se.Z.getSelectValueAsNumberArray(oe(this,le)[e][t].getValues())}initModuleSelects(e,t,a){const s=oe(this,ge).getBaseId(e),i={actionsBox:!0,countSelectedText:e=>`${e} ${t.toLowerCase()}s selected`,deselectAllText:"Clear",liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",maxOptions:t.startsWith("Ship trim")?6:5,selectedTextFormat:"count > 1",title:`${t}`,width:"170px"};oe(this,le)[e][t]=new se.Z(`${s}-${t.replace(/\s/,"")}`,oe(this,ge).getBaseIdSelects(e),i,a,!0)}_initShipSelect(e,t,a){const s=oe(this,ge).getBaseIdSelectsShip(e);oe(this,de)[e]=new se.Z(`${t}-ship`,s,{title:"Ship"},a),"base"!==e&&oe(this,de)[e].disable()}_initWoodSelects(e,t,a){const s=oe(this,ge).getBaseIdSelects(e);oe(this,ce)[e]={};for(const i of w.Kf)oe(this,ce)[e][i]=new se.Z(`${t}-${i}`,s,{title:`Wood ${i}`,width:"170px"},a.getOptions(i)),oe(this,ce)[e][i].disable()}initShipAndWoodSelects(e,t){for(const a of oe(this,me)){const s=oe(this,ge).getBaseId(a);this._initShipSelect(a,s,e),this._initWoodSelects(a,s,t)}}}var ve=a(9875),we=a(6348),be=a(741),De=a(1678),ye=a(9679);a(8903);function Se(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ce(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function _e(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Me(e,t,"get"))}function $e(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,Me(e,t,"set"),a),a}function Me(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var ke=new WeakMap,xe=new WeakMap,Ie=new WeakMap;class Te{constructor(e,t){Ce(this,ke,{writable:!0,value:void 0}),Ce(this,xe,{writable:!0,value:{}}),Ce(this,Ie,{writable:!0,value:{}}),Se(this,"ticksSpeed",void 0),Se(this,"ticksSpeedLabels",void 0),Se(this,"_shipCompare",void 0),$e(this,ke,(0,W.Z)(`#${e}`)),this._shipCompare=t,this.ticksSpeed=[12,8,4,0],this.ticksSpeedLabels=this.ticksSpeed.map((e=>`${e} knots`)),this._setupSvg(),this._setCompass()}get mainDiv(){return _e(this,xe)}get mainG(){return _e(this,Ie)}get outputDivSel(){return _e(this,ke)}static pd(e){let t=`<span class="badge badge-highlight">${e.maxCannonLb} / `;return e.maxCarroLb?t+=`${e.maxCarroLb}`:t+="–",t+=" lb</span>",t}static getCannonsPerDeck(e){let t=`${e.gunsPerDeck[0].amount} ${Te.pd(e.gunsPerDeck[0])}`,a="";for(let s=1;s<4;s+=1)e.gunsPerDeck[s].amount?t=`${e.gunsPerDeck[s].amount} ${Te.pd(e.gunsPerDeck[s])} <br>${t}`:a=`${a}<br>`;return[t,a]}static displaySecondBlock(){return'<div class="col-9 row">'}static getText(e){let t=0;function a(e){return t+=1,`<div class="row py-1 ${t%2?" row-light":""}"><div class="col-3">${e}</div>`}function s(t,a,s=6){let i,r="";"cannonsPerDeck"===t?([i,r]=e[t],r=`<br>${r}`):i=""===t?"":String(e[t]);let o="col-6";return 4===s&&(o="col-4"),`<div class="${o}">${i}<br><span class="des">${a}</span>${r}</div>`}let i="";return i+=a(e.shipRating),i+=Te.displaySecondBlock(),i+=s("battleRating","Battle rating"),i+=s("guns","Cannons"),i+=s("upgradeXP","Knowledge XP"),i+=s("rollAngle","Roll angle"),i+="</div></div></div>",i+=a(e.decks),i+=Te.displaySecondBlock(),i+=s("cannonsPerDeck","Gun decks"),i+=s("firezoneHorizontalWidth","Firezone horizontal width"),i+="</div></div></div>",i+=a("Broadside damage"),i+=Te.displaySecondBlock(),i+=s("cannonBroadsideDamage","Cannons"),i+=s("carroBroadsideDamage","Carronades"),i+="</div></div></div>",i+=a("Chasers"),i+=Te.displaySecondBlock(),i+=s("gunsFront","Bow"),i+=s("gunsBack","Stern"),i+="</div></div></div>",i+=a("Speed"),i+=Te.displaySecondBlock(),i+=s("maxSpeed","Maximum"),i+=s("halfturnTime","Rudder half time"),i+=s("acceleration","Acceleration"),i+=s("deceleration","Deceleration"),i+=s("turnSpeed","Turn speed"),i+=s("turnAcceleration","Turn acceleration"),i+="</div></div></div>",i+=a('Hit points <span class="badge badge-highlight">Thickness</span>'),i+=Te.displaySecondBlock(),i+=s("sideArmor","Sides"),i+=s("structure","Hull"),i+=s("frontArmor","Bow"),i+=s("backArmor","Stern"),i+="</div></div></div>",i+=a('Masts <span class="badge badge-highlight">Thickness</span>'),i+=Te.displaySecondBlock(),i+=s("sails","Sails"),i+=s("mastBottomArmor","Bottom"),i+=s("mastMiddleArmor","Middle"),i+=s("mastTopArmor","Top"),i+="</div></div></div>",i+=a("Crew"),i+=Te.displaySecondBlock(),i+=s("minCrew","Minimum",4),i+=s("sailingCrew","Sailing",4),i+=s("maxCrew","Maximum",4),i+=s("cannonCrew","Cannon",4),i+=s("carroCrew","Carronades",4),i+="</div></div></div>",i+=a("Gunnery"),i+=Te.displaySecondBlock(),i+=s("reload","Reload %",4),i+=s("dispersionHorizontal","Horizontal dispersion %",4),i+=s("dispersionVertical","Vertical dispersion %",4),i+=s("penetration","Ball penetration %",4),i+=s("traverseUpDown","Up/down traverse %",4),i+=s("traverseSide","Side traverse %",4),i+="</div></div></div>",i+=a("Boarding"),i+=Te.displaySecondBlock(),i+=s("morale","Morale",4),i+=s("attack","Attack",4),i+=s("defense","Defense",4),i+=s("musketsCrew","Crew with muskets",4),i+=s("musketsAccuracy","Musket accuracy %",4),i+=s("cannonsAccuracy","Cannon accuracy %",4),i+=s("prepPerRound","Preparation per round",4),i+=s("prepInitial","Initial preparation",4),i+=s("disengageTime","Rounds to disengage",4),i+="</div></div></div>",i+=a("Resistance"),i+=Te.displaySecondBlock(),i+=s("leakResistance","Leak %"),i+=s("splinterResistance","Splinter %"),i+="</div></div></div>",i+=a('Repairs needed <span class="badge badge-highlight">Set of 5</span>'),i+=Te.displaySecondBlock(),i+=s("hullRepairsNeeded","Hull",4),i+=s("rigRepairsNeeded","Rig",4),i+=s("rumRepairsNeeded","Rum",4),i+="</div></div></div>",i+=a("Repair"),i+=Te.displaySecondBlock(),i+=s("hullRepairAmount","Hull %",4),i+=s("rigRepairAmount","Rig %",4),i+=s("repairTime","Time (sec)",4),i+="</div></div></div>",i+=a("Hold"),i+=Te.displaySecondBlock(),i+=s("holdSize","Cargo slots"),i+=s("maxWeight","Tons"),i+="</div></div></div>",i+=a("Weight"),i+=Te.displaySecondBlock(),i+=s("cannonWeight","Cannons",4),i+=s("carroWeight","Carronades",4),i+=s("repairWeight","Repair Set",4),i+="</div></div></div>",i+="</div>",i}_setupSvg(){_e(this,ke).selectAll("*").remove();const e=_e(this,ke).append("div").attr("class","").append("svg").attr("width",this._shipCompare.svgWidth).attr("height",this._shipCompare.svgHeight).attr("data-ui-component","sailing-profile").attr("fill","none");$e(this,Ie,e.append("g").attr("transform",`translate(${this._shipCompare.svgWidth/2},${this._shipCompare.svgHeight/2})`)),$e(this,xe,_e(this,ke).append("div").attr("class","compress"))}_setCompass(){const e=Array.from({length:c.f7/2},(()=>1)),t=(0,be.Z)().sort(null).value(1)(e),a=(0,we.Z)().outerRadius(this._shipCompare.radiusSpeedScale(12)??0).innerRadius(this._shipCompare.innerRadius);_e(this,Ie).append("g").attr("class","compass-arc").selectAll("path").data(t).join((e=>e.append("path").attr("d",a))),_e(this,Ie).append("g").attr("class","speed-circle").selectAll("circle").data(this.ticksSpeed).join((e=>e.append("circle").attr("r",(e=>this._shipCompare.radiusSpeedScale(e)??0))))}}var Ae=a(1273);function Be(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Pe extends Te{constructor(e,t,a){super(e,a),Be(this,"shipData",void 0),Be(this,"_speedScale",void 0),Be(this,"_shipRotate",void 0),Be(this,"_speedText",void 0),Be(this,"_drag",void 0),this.shipData=t,this._setBackground(),this._setupDrag(),this._setupShipOutline(),this._drawWindProfile(),this._printText()}_setBackground(){const e=(0,we.Z)().outerRadius((e=>(this._shipCompare.radiusSpeedScale(e)??0)+2)).innerRadius((e=>(this._shipCompare.radiusSpeedScale(e)??0)+1)).startAngle(-Math.PI/2).endAngle(Math.PI/2);super.mainG.append("g").attr("data-ui-component","speed-textpath").selectAll("path").data(this.ticksSpeed).join((t=>t.append("path").attr("d",e).attr("id",((e,t)=>`tick${t}`)))),super.mainG.append("g").attr("class","speed-text").selectAll("text").data(this.ticksSpeed).join((e=>e.append("text").append("textPath").attr("href",((e,t)=>`#tick${t}`)).text(((e,t)=>this.ticksSpeedLabels[t])).attr("startOffset","10%")))}_getHeadingInDegrees(e,t){let a=e-t-180;return a<0&&(a+=360),a}_getSpeed(e){return(0,u.$1)(this._speedScale(Math.abs(e))??0)}_getHeadingInCompass(e){return(0,g.tT)(e)}_updateCompareWindProfiles(){for(const e of this._shipCompare.columnsCompare)this._shipCompare.activeColumns[e]&&this._shipCompare.activeColumns[e].updateWindProfileRotation()}_setupDrag(){const e=this.shipData.speedDegrees.length,t=360/e,a=Array.from({length:e+1},((e,a)=>a*t));this._speedScale=(0,p.Z)().domain(a).range([...this.shipData.speedDegrees,this.shipData.speedDegrees[0]]).clamp(!0);const s=(e,t)=>{const{x:a,y:s}=e;t.rotate=this._getHeadingInDegrees((0,Y.Fq)({x:t.initX,y:t.initY},{x:a,y:s}),t.correctionValueDegrees),(()=>{t.this.attr("transform",(e=>`rotate(${e.rotate})`)),t.compassText.attr("transform",(e=>`rotate(${-e.rotate},${e.compassTextX},${e.compassTextY})`)).text((e=>this._getHeadingInCompass(e.rotate))),"ship"===t.type?this._shipRotate=t.rotate:"windProfile"===t.type&&(this._shipCompare.windProfileRotate=t.rotate),this._speedText.attr("transform",`rotate(${-this._shipRotate})`).text(this._getSpeed(this._shipCompare.windProfileRotate-this._shipRotate))})(),"windProfile"===t.type&&this._updateCompareWindProfiles()};this._drag=(0,ve.Z)().on("drag",((e,t)=>{s(e,t)})).container((()=>super.mainG.node()))}_setupShipOutline(){this._shipRotate=0;const{shipMass:e}=this.shipData,t=this._shipCompare.shipMassScale(e)??0,a=t,s=this._shipCompare.svgHeight/2-40,i={initX:0,initY:0,initRotate:this._shipRotate,correctionValueDegrees:180,compassTextX:0,compassTextY:s,speedTextX:0,speedTextY:0,type:"ship"},r=super.mainG.append("g").datum(i).attr("class","ship-outline");r.append("line").attr("x1",(e=>e.initX)).attr("y1",s-20).attr("x2",(e=>e.initX)).attr("y2",(e=>e.initY)),r.append("image").attr("height",t).attr("width",a).attr("x",-t/2).attr("y",-a/2).attr("xlink:href",Ae),r.append("circle").attr("cx",(e=>e.compassTextX)).attr("cy",(e=>e.compassTextY)).attr("r",20).call(this._drag);const o=r.append("text").attr("x",(e=>e.compassTextX)).attr("y",(e=>e.compassTextY)).attr("transform",(e=>`rotate(${-e.initRotate},${e.compassTextX},${e.compassTextY})`)).text((e=>this._getHeadingInCompass(e.initRotate)));this._speedText=r.append("text").attr("x",(e=>e.speedTextX)).attr("y",(e=>e.speedTextY)).attr("transform",(e=>`rotate(${-e.initRotate})`)).text((e=>this._getSpeed(e.initRotate))),i.this=r,i.compassText=o,r.datum(i).attr("transform",(e=>`rotate(${e.initRotate-90})`)),r.transition().duration(1e3).delay(500).attr("transform",(e=>`rotate(${e.initRotate})`))}_drawWindProfile(){const e=(0,be.Z)().sort(null).value(1)(this.shipData.speedDegrees),t=De.Z,a=(0,ye.Z)().angle(((e,t)=>t*c.P)).radius((e=>this._shipCompare.radiusSpeedScale(e.data)??0)).curve(t);this._shipCompare.windProfileRotate=0;const s=this._shipCompare.svgHeight/2-20,i={initX:0,initY:0,initRotate:this._shipCompare.windProfileRotate,correctionValueDegrees:0,compassTextX:0,compassTextY:-s,type:"windProfile"},r=super.mainG.append("g").datum(i).attr("class","wind-profile");r.append("path").attr("d",(e=>String((0,Y.GZ)(e.compassTextX,e.compassTextY,20))+(0,Y.wo)(e.compassTextX,e.compassTextY,-e.compassTextY/2))).attr("class","wind-profile-arrow").attr("marker-end","url(#wind-profile-arrow-head)").call(this._drag),r.append("circle").attr("cx",(e=>e.compassTextX)).attr("cy",(e=>e.compassTextY)).attr("r",20);const o=r.append("text").attr("x",(e=>e.compassTextX)).attr("y",(e=>e.compassTextY)).attr("transform",(e=>`rotate(${-e.initRotate},${e.compassTextX},${e.compassTextY})`)).text((e=>this._getHeadingInCompass(e.initRotate)));r.append("path").attr("class","base-profile").attr("d",a(e)),r.append("g").attr("data-ui-component","speed-markers").selectAll("circle").data(e).join((e=>e.append("circle").attr("r",5).attr("cy",((e,t)=>Math.cos(t*c.P)*-(this._shipCompare.radiusSpeedScale(e.data)??0))).attr("cx",((e,t)=>Math.sin(t*c.P)*(this._shipCompare.radiusSpeedScale(e.data)??0))).attr("fill",(e=>this._shipCompare.colorScale(e.data)??0)).attr("fill",(e=>this._shipCompare.colorScale(e.data)??0)).append("title").text((e=>Math.round(10*e.data)/10+" knots")))),i.this=r,i.compassText=o,r.datum(i).attr("transform",(e=>`rotate(${e.initRotate+90})`)),r.transition().duration(1e3).delay(500).attr("transform",(e=>`rotate(${e.initRotate})`))}_printText(){const e=Te.getCannonsPerDeck(this.shipData.guns),t=Math.round(this.shipData.sides.armour*this.shipData.repairAmount.armour/m.q4),a=Math.round(this.shipData.sails.armour*this.shipData.repairAmount.sails/m.l9),s=Math.round(this.shipData.crew.max*m.C4),i={attack:(0,u.LQ)(this.shipData.boarding.attack,2),cannonsAccuracy:(0,u.IH)(100*this.shipData.boarding.cannonsAccuracy),defense:(0,u.LQ)(this.shipData.boarding.defense,2),disengageTime:(0,u.yI)(this.shipData.boarding.disengageTime),morale:(0,u.yI)(this.shipData.boarding.morale),musketsAccuracy:(0,u.IH)(100*this.shipData.boarding.musketsAccuracy),musketsCrew:(0,u.yI)(this.shipData.boarding.musketsCrew/100*this.shipData.crew.max),prepPerRound:(0,u.yI)(this.shipData.boarding.prepPerRound),prepInitial:(0,u.yI)(this.shipData.boarding.prepInitial),reload:(0,u.IH)(100*this.shipData.gunnery.reload),penetration:(0,u.IH)(100*this.shipData.gunnery.penetration),dispersionHorizontal:(0,u.IH)(100*this.shipData.gunnery.dispersionHorizontal),dispersionVertical:(0,u.IH)(100*this.shipData.gunnery.dispersionVertical),traverseUpDown:(0,u.IH)(100*this.shipData.gunnery.traverseUpDown),traverseSide:(0,u.IH)(100*this.shipData.gunnery.traverseSide),acceleration:(0,u.$1)(this.shipData.ship.acceleration),additionalRow:""+(this.shipData.guns.decks<4?"<br> ":""),backArmor:`${(0,u.yI)(this.shipData.stern.armour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipData.stern.thickness)}</span>`,battleRating:String(this.shipData.battleRating),bowRepair:`${(0,u.yI)(this.shipData.repairTime.bow)}`,cannonBroadsideDamage:(0,u.yI)(this.shipData.guns.damage.cannons),cannonsPerDeck:e,carroBroadsideDamage:(0,u.yI)(this.shipData.guns.damage.carronades),deceleration:(0,u.$1)(this.shipData.ship.deceleration),decks:(0,c.gY)(this.shipData.guns.decks,"deck"),firezoneHorizontalWidth:String(this.shipData.ship.firezoneHorizontalWidth),frontArmor:`${(0,u.yI)(this.shipData.bow.armour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipData.bow.thickness)}</span>`,guns:String(this.shipData.guns.total),gunsBack:this.shipData.guns.gunsPerDeck[5].amount,gunsFront:this.shipData.guns.gunsPerDeck[4].amount,halfturnTime:(0,u.$1)(this.shipData.rudder.halfturnTime,4),holdSize:(0,u.yI)(this.shipData.holdSize),hullRepairAmount:`${(0,u.yI)(100*(this.shipData.repairAmount.armour+this.shipData.repairAmount.armourPerk))}`,hullRepairsNeeded:`${(0,u.yI)(t)} <span class="badge badge-highlight">${(0,u.yI)(t*m.XI)}</span>`,leakResistance:(0,u.IH)(100*this.shipData.resistance.leaks),limitBack:this.shipData.guns.gunsPerDeck[5],limitFront:this.shipData.guns.gunsPerDeck[4],mastBottomArmor:`${(0,u.yI)(this.shipData.mast.bottomArmour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipData.mast.bottomThickness)}</span>`,mastMiddleArmor:`${(0,u.yI)(this.shipData.mast.middleArmour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipData.mast.middleThickness)}</span>`,mastTopArmor:`${(0,u.yI)(this.shipData.mast.topArmour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipData.mast.topThickness)}</span>`,maxCrew:(0,u.yI)(this.shipData.crew.max),maxSpeed:(0,u.$1)(this.shipData.speed.max,3),maxWeight:(0,u.yI)(this.shipData.maxWeight),minCrew:(0,u.yI)(this.shipData.crew.min),cannonCrew:(0,u.yI)(this.shipData.crew.cannons),carroCrew:(0,u.yI)(this.shipData.crew.carronades),pump:(0,u.yI)(this.shipData.pump.armour),repairTime:`${(0,u.yI)(this.shipData.repairTime.sides)}`,rigRepairAmount:`${(0,u.yI)(100*(this.shipData.repairAmount.sails+this.shipData.repairAmount.sailsPerk))}`,rigRepairsNeeded:`${(0,u.yI)(a)} <span class="badge badge-highlight">${(0,u.yI)(a*m.XI)}</span>`,rollAngle:(0,u.yI)(this.shipData.ship.rollAngle),rudder:`${(0,u.yI)(this.shipData.rudder.armour)} <span class="badge badge-highlight">${(0,u.yI)(this.shipData.rudder.thickness)}</span>`,rumRepairsNeeded:`${(0,u.yI)(s)} <span class="badge badge-highlight">${(0,u.yI)(s*m.XI)}</span>`,sailingCrew:(0,u.yI)(this.shipData.crew.sailing??0),sails:(0,u.yI)(this.shipData.sails.armour),shipRating:`${(0,g.hi)(this.shipData.class)} rate`,sideArmor:`${(0,u.yI)(this.shipData.sides.armour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipData.sides.thickness)}</span>`,splinterResistance:(0,u.IH)(100*this.shipData.resistance.splinter),sternRepair:`${(0,u.yI)(this.shipData.repairTime.stern)}`,structure:(0,u.yI)(this.shipData.structure.armour),turnAcceleration:(0,u.$1)(this.shipData.ship.turnAcceleration,4),turnSpeed:(0,u.$1)(this.shipData.ship.turnSpeed,3),upgradeXP:(0,u.yI)(this.shipData.upgradeXP),waterlineHeight:(0,u.$1)(this.shipData.ship.waterlineHeight),cannonWeight:(0,u.yI)(this.shipData.guns.weight.cannons),carroWeight:(0,u.yI)(this.shipData.guns.weight.carronades)};i.repairWeight=(0,u.yI)((t+a+.1*s)*m.XI),i.gunsFront?i.gunsFront+=` ${Te.pd(i.limitFront)}`:i.gunsFront="–",i.gunsBack?i.gunsBack+=` ${Te.pd(i.limitBack)}`:i.gunsBack="–",super.mainDiv.html(Te.getText(i))}}function We(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Re extends Te{constructor(e,t,a,s){super(e,s),We(this,"shipCompareData",void 0),We(this,"_shipBaseData",void 0),We(this,"_speedScale",void 0),We(this,"_speedDiff",void 0),We(this,"_minSpeedDiff",void 0),We(this,"_maxSpeedDiff",void 0),We(this,"_shipRotate",void 0),We(this,"_speedText",void 0),We(this,"_drag",void 0),We(this,"_windProfile",void 0),We(this,"_gWindProfile",void 0),We(this,"_arcsComp",void 0),this._shipBaseData=t,this.shipCompareData=a,this._setupDrag(),this._setupShipOutline(),this._drawDifferenceProfile(),this._injectTextComparison()}_setColourScale(e,t){const a=Math.min(e,this._shipCompare.colourScaleSpeedDiff.domain()[0]),s=Math.max(t,this._shipCompare.colourScaleSpeedDiff.domain()[this._shipCompare.colourScaleSpeedDiff.domain().length-1]);this._shipCompare.colourScaleSpeedDiff.domain([a,0,s])}_getHeadingInDegrees(e,t){let a=e-t-180;return a<0&&(a+=360),a}_getSpeed(e){return(0,u.$1)(this._speedScale(Math.abs(e))??0)}_getHeadingInCompass(e){return(0,g.tT)(e)}_updateSpeedText(){this._speedText.attr("transform",`rotate(${-this._shipRotate})`).text(this._getSpeed(this._shipCompare.windProfileRotate-this._shipRotate))}_setupDrag(){const e=this.shipCompareData.speedDegrees.length,t=360/e,a=Array.from({length:e+1},((e,a)=>a*t));this._speedScale=(0,p.Z)().domain(a).range([...this.shipCompareData.speedDegrees,this.shipCompareData.speedDegrees[0]]).clamp(!0);const s=(e,t)=>{const{x:a,y:s}=e;t.rotate=this._getHeadingInDegrees((0,Y.Fq)({x:t.initX,y:t.initY},{x:a,y:s}),t.correctionValueDegrees),(()=>{t.this.attr("transform",(e=>`rotate(${e.rotate})`)),t.compassText.attr("transform",(e=>`rotate(${-e.rotate},${e.compassTextX},${e.compassTextY})`)).text((e=>this._getHeadingInCompass(e.rotate))),this._shipRotate=t.rotate,this._updateSpeedText()})()};this._drag=(0,ve.Z)().on("drag",((e,t)=>{s(e,t)})).container((()=>super.mainG.node()))}_setupShipOutline(){this._shipRotate=0;const{shipMass:e}=this.shipCompareData,t=this._shipCompare.shipMassScale(e)??0,a=t,s=this._shipCompare.svgHeight/2-40,i={initX:0,initY:0,initRotate:this._shipRotate,correctionValueDegrees:180,compassTextX:0,compassTextY:s,speedTextX:0,speedTextY:0,type:"ship"},r=super.mainG.append("g").datum(i).attr("class","ship-outline");r.append("line").attr("x1",(e=>e.initX)).attr("y1",s-20).attr("x2",(e=>e.initX)).attr("y2",(e=>e.initY)),r.append("image").attr("height",t).attr("width",a).attr("x",-t/2).attr("y",-a/2).attr("xlink:href",Ae),r.append("circle").attr("cx",(e=>e.compassTextX)).attr("cy",(e=>e.compassTextY)).attr("r",20).call(this._drag);const o=r.append("text").attr("x",(e=>e.compassTextX)).attr("y",(e=>e.compassTextY)).attr("transform",(e=>`rotate(${-e.initRotate},${e.compassTextX},${e.compassTextY})`)).text((e=>this._getHeadingInCompass(e.initRotate)));this._speedText=r.append("text").attr("x",(e=>e.speedTextX)).attr("y",(e=>e.speedTextY)).attr("transform",(e=>`rotate(${-e.initRotate})`)).text((e=>this._getSpeed(this._shipCompare.windProfileRotate-e.initRotate))),i.this=r,i.compassText=o,r.datum(i).attr("transform",(e=>`rotate(${e.initRotate-90})`)),r.transition().duration(1e3).delay(500).attr("transform",(e=>`rotate(${e.initRotate})`))}_drawDifferenceProfile(){const e=(0,be.Z)().sort(null).value(1),t=e(this._shipBaseData.speedDegrees);this._arcsComp=e(this.shipCompareData.speedDegrees),this._speedDiff=this.shipCompareData.speedDegrees.map(((e,t)=>(0,g.qY)(e-this._shipBaseData.speedDegrees[t]))),this._minSpeedDiff=(0,o.Z)(this._speedDiff)??0,this._maxSpeedDiff=(0,n.Z)(this._speedDiff)??0;const a=De.Z,s=(0,ye.Z)().angle(((e,t)=>t*c.P)).radius((e=>this._shipCompare.radiusSpeedScale(e.data)??0)).curve(a),i=this._shipCompare.svgHeight/2-20;this._windProfile={initX:0,initY:0,initRotate:this._shipCompare.windProfileRotate,correctionValueDegrees:0,compassTextX:0,compassTextY:-i,type:"windProfile"},this._gWindProfile=super.mainG.append("g").attr("class","wind-profile").attr("transform",`rotate(${this._windProfile.initRotate})`),this._gWindProfile.append("path").attr("class","base-profile").attr("d",s(t)),this._gWindProfile.append("path").attr("class","comp-profile").attr("d",s(this._arcsComp))}updateWindProfileRotation(){this._gWindProfile.attr("transform",`rotate(${this._shipCompare.windProfileRotate})`),this._updateSpeedText()}updateDifferenceProfile(){this._setColourScale(this._minSpeedDiff,this._maxSpeedDiff),this._gWindProfile.append("g").attr("data-ui-component","speed-markers").selectAll("circle").data(this._arcsComp).join((e=>e.append("circle").attr("r",5).attr("cy",((e,t)=>Math.cos(t*c.P)*-(this._shipCompare.radiusSpeedScale(e.data)??0))).attr("cx",((e,t)=>Math.sin(t*c.P)*(this._shipCompare.radiusSpeedScale(e.data)??0))).attr("fill",((e,t)=>this._shipCompare.colourScaleSpeedDiff(this._speedDiff[t])??0)).append("title").text(((e,t)=>`${Math.round(10*e.data)/10} (${(0,u.LQ)(this._speedDiff[t],1)}) knots`)))).select("circle").attr("fill",((e,t)=>this._shipCompare.colourScaleSpeedDiff(this._speedDiff[t])??c.L$))}_injectTextComparison(){function e(e,t,a=0,s=!1){if(e===t)return"";let i,r,o="bg-danger";return s?(i=100*Number.parseFloat((t-e).toFixed(a)),r=(0,u.$1)(Math.abs(i))):0===e||0===t?(i=t-e,r=(0,u.$1)(Math.abs(i))):(i=1-e/t,r=(0,u.ub)(Math.abs(i),0)),i<0&&(o="bg-success"),`<span class="badge shadow-sm ${o}">${r}</span>`}const t=Math.round(this._shipBaseData.sides.armour*this._shipBaseData.repairAmount.armour/m.q4),a=Math.round(this._shipBaseData.sails.armour*this._shipBaseData.repairAmount.sails/m.l9),s=Math.round(this._shipBaseData.crew.max*m.C4),i=Math.round(this.shipCompareData.sides.armour*this.shipCompareData.repairAmount.armour/m.q4),r=Math.round(this.shipCompareData.sails.armour*this.shipCompareData.repairAmount.sails/m.l9),o=Math.round(this.shipCompareData.crew.max*m.C4),n={morale:`${(0,u.yI)(this.shipCompareData.boarding.morale)} ${e(this.shipCompareData.boarding.morale,this._shipBaseData.boarding.morale)}`,musketsAccuracy:`${(0,u.IH)(100*this.shipCompareData.boarding.musketsAccuracy)} ${e(100*this.shipCompareData.boarding.musketsAccuracy,100*this._shipBaseData.boarding.musketsAccuracy)}`,prepPerRound:`${(0,u.yI)(this.shipCompareData.boarding.prepPerRound)} ${e(this.shipCompareData.boarding.prepPerRound,this._shipBaseData.boarding.prepPerRound)}`,attack:`${(0,u.LQ)(this.shipCompareData.boarding.attack,2)} ${e(this.shipCompareData.boarding.attack/100,this._shipBaseData.boarding.attack/100,3,!0)}`,defense:`${(0,u.LQ)(this.shipCompareData.boarding.defense,2)} ${e(this.shipCompareData.boarding.defense/100,this._shipBaseData.boarding.defense/100,3,!0)}`,disengageTime:`${(0,u.yI)(this.shipCompareData.boarding.disengageTime)} ${e(this._shipBaseData.boarding.disengageTime,this.shipCompareData.boarding.disengageTime)}`,musketsCrew:`${(0,u.yI)(this.shipCompareData.boarding.musketsCrew/100*this.shipCompareData.crew.max)} ${e(this.shipCompareData.boarding.musketsCrew/100*this.shipCompareData.crew.max,this._shipBaseData.boarding.musketsCrew/100*this._shipBaseData.crew.max)}`,prepInitial:`${(0,u.yI)(this.shipCompareData.boarding.prepInitial)} ${e(this.shipCompareData.boarding.prepInitial,this._shipBaseData.boarding.prepInitial)}`,cannonsAccuracy:`${(0,u.IH)(100*this.shipCompareData.boarding.cannonsAccuracy)} ${e(100*this.shipCompareData.boarding.cannonsAccuracy,100*this._shipBaseData.boarding.cannonsAccuracy)}`,reload:`${(0,u.IH)(100*this.shipCompareData.gunnery.reload)} ${e(this._shipBaseData.gunnery.reload,this.shipCompareData.gunnery.reload,3,!0)}`,penetration:`${(0,u.IH)(100*this.shipCompareData.gunnery.penetration)} ${e(this.shipCompareData.gunnery.penetration,this._shipBaseData.gunnery.penetration,3,!0)}`,dispersionHorizontal:`${(0,u.IH)(100*this.shipCompareData.gunnery.dispersionHorizontal)} ${e(this._shipBaseData.gunnery.dispersionHorizontal,this.shipCompareData.gunnery.dispersionHorizontal,3,!0)}`,dispersionVertical:`${(0,u.IH)(100*this.shipCompareData.gunnery.dispersionVertical)} ${e(this._shipBaseData.gunnery.dispersionVertical,this.shipCompareData.gunnery.dispersionVertical,3,!0)}`,traverseUpDown:`${(0,u.IH)(100*this.shipCompareData.gunnery.traverseUpDown)} ${e(this.shipCompareData.gunnery.traverseUpDown,this._shipBaseData.gunnery.traverseUpDown,3,!0)}`,traverseSide:`${(0,u.IH)(100*this.shipCompareData.gunnery.traverseSide)} ${e(this.shipCompareData.gunnery.traverseSide,this._shipBaseData.gunnery.traverseSide,3,!0)}`,acceleration:`${(0,u.$1)(this.shipCompareData.ship.acceleration)} ${e(this.shipCompareData.ship.acceleration,this._shipBaseData.ship.acceleration,2)}`,additionalRow:""+(this.shipCompareData.guns.decks<4?"<br> ":""),backArmor:`${(0,u.yI)(this.shipCompareData.stern.armour)} ${e(this.shipCompareData.stern.armour,this._shipBaseData.stern.armour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipCompareData.stern.thickness)}</span>${e(this.shipCompareData.stern.thickness,this._shipBaseData.stern.thickness)}`,battleRating:`${this.shipCompareData.battleRating} ${e(this.shipCompareData.battleRating,this._shipBaseData.battleRating)}`,cannonBroadsideDamage:`${this.shipCompareData.guns.damage.cannons} ${e(this.shipCompareData.guns.damage.cannons,this._shipBaseData.guns.damage.cannons)}`,cannonsPerDeck:Te.getCannonsPerDeck(this.shipCompareData.guns),carroBroadsideDamage:`${this.shipCompareData.guns.damage.carronades} ${e(this.shipCompareData.guns.damage.carronades,this._shipBaseData.guns.damage.carronades)}`,deceleration:`${(0,u.$1)(this.shipCompareData.ship.deceleration)} ${e(this.shipCompareData.ship.deceleration,this._shipBaseData.ship.deceleration,2)}`,rollAngle:`${(0,u.yI)(this.shipCompareData.ship.rollAngle)} ${e(this._shipBaseData.ship.rollAngle,this.shipCompareData.ship.rollAngle)}`,turnAcceleration:`${(0,u.$1)(this.shipCompareData.ship.turnAcceleration)} ${e(this.shipCompareData.ship.turnAcceleration,this._shipBaseData.ship.turnAcceleration,2)}`,turnSpeed:`${(0,u.$1)(this.shipCompareData.ship.turnSpeed,3)} ${e(this.shipCompareData.ship.turnSpeed,this._shipBaseData.ship.turnSpeed,2)}`,decks:(0,c.gY)(this.shipCompareData.guns.decks,"deck"),firezoneHorizontalWidth:`${this.shipCompareData.ship.firezoneHorizontalWidth} ${e(this.shipCompareData.ship.firezoneHorizontalWidth,this._shipBaseData.ship.firezoneHorizontalWidth)}`,frontArmor:`${(0,u.yI)(this.shipCompareData.bow.armour)} ${e(this.shipCompareData.bow.armour,this._shipBaseData.bow.armour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipCompareData.bow.thickness)}</span>${e(this.shipCompareData.bow.thickness,this._shipBaseData.bow.thickness)}`,guns:`${this.shipCompareData.guns.total} ${e(this.shipCompareData.guns.total,this._shipBaseData.guns.total)}`,gunsBack:this.shipCompareData.guns.gunsPerDeck[5].amount,gunsFront:this.shipCompareData.guns.gunsPerDeck[4].amount,halfturnTime:`${(0,u.$1)(this.shipCompareData.rudder.halfturnTime,4)} ${e(this._shipBaseData.rudder.halfturnTime,this.shipCompareData.rudder.halfturnTime,2)}`,holdSize:`${(0,u.yI)(this.shipCompareData.holdSize)} ${e(this.shipCompareData.holdSize,this._shipBaseData.holdSize)}`,hullRepairAmount:`${(0,u.yI)(100*(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk))} ${e(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk,this._shipBaseData.repairAmount.armour+this._shipBaseData.repairAmount.armourPerk,3,!0)}`,hullRepairsNeeded:`${(0,u.yI)(i)} <span class="badge badge-highlight">${(0,u.yI)(i*m.XI)}</span>`,leakResistance:`${(0,u.IH)(100*this.shipCompareData.resistance.leaks)} ${e(this.shipCompareData.resistance.leaks,this._shipBaseData.resistance.leaks,2,!0)}`,limitBack:this.shipCompareData.guns.gunsPerDeck[5],limitFront:this.shipCompareData.guns.gunsPerDeck[4],mastBottomArmor:`${(0,u.yI)(this.shipCompareData.mast.bottomArmour)} ${e(this.shipCompareData.mast.bottomArmour,this._shipBaseData.mast.bottomArmour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipCompareData.mast.bottomThickness)}</span>${e(this.shipCompareData.mast.bottomThickness,this._shipBaseData.mast.bottomThickness)}`,mastMiddleArmor:`${(0,u.yI)(this.shipCompareData.mast.middleArmour)} ${e(this.shipCompareData.mast.middleArmour,this._shipBaseData.mast.middleArmour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipCompareData.mast.middleThickness)}</span>${e(this.shipCompareData.mast.middleThickness,this._shipBaseData.mast.middleThickness)}`,mastTopArmor:`${(0,u.yI)(this.shipCompareData.mast.topArmour)} ${e(this.shipCompareData.mast.topArmour,this._shipBaseData.mast.topArmour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipCompareData.mast.topThickness)}</span>${e(this.shipCompareData.mast.topThickness,this._shipBaseData.mast.topThickness)}`,maxCrew:`${(0,u.yI)(this.shipCompareData.crew.max)} ${e(this.shipCompareData.crew.max,this._shipBaseData.crew.max)}`,maxSpeed:`${(0,u.$1)(this.shipCompareData.speed.max,3)} ${e(this.shipCompareData.speed.max,this._shipBaseData.speed.max,2)}`,maxWeight:`${(0,u.yI)(this.shipCompareData.maxWeight)} ${e(this.shipCompareData.maxWeight,this._shipBaseData.maxWeight)}`,minCrew:(0,u.yI)(this.shipCompareData.crew.min),cannonCrew:`${(0,u.yI)(this.shipCompareData.crew.cannons)} ${e(this._shipBaseData.crew.cannons,this.shipCompareData.crew.cannons)}`,carroCrew:`${(0,u.yI)(this.shipCompareData.crew.carronades)} ${e(this._shipBaseData.crew.carronades,this.shipCompareData.crew.carronades)}`,minSpeed:`${(0,u.$1)(this.shipCompareData.speed.min)} ${e(this.shipCompareData.speed.min,this._shipBaseData.speed.min,2)}`,repairTime:`${(0,u.yI)(this.shipCompareData.repairTime.sides)} ${e(this._shipBaseData.repairTime.sides,this.shipCompareData.repairTime.sides)}`,rigRepairAmount:`${(0,u.yI)(100*(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk))} ${e(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk,this._shipBaseData.repairAmount.sails+this._shipBaseData.repairAmount.sailsPerk,3,!0)}`,rigRepairsNeeded:`${(0,u.yI)(r)} <span class="badge badge-highlight">${(0,u.yI)(r*m.XI)}</span>`,rumRepairsNeeded:`${(0,u.yI)(o)} <span class="badge badge-highlight">${(0,u.yI)(o*m.XI)}</span>`,sailingCrew:`${(0,u.yI)(this.shipCompareData.crew.sailing)}`,sails:`${(0,u.yI)(this.shipCompareData.sails.armour)} ${e(this.shipCompareData.sails.armour,this._shipBaseData.sails.armour)}`,shipRating:`${(0,g.hi)(this.shipCompareData.class)} rate`,sideArmor:`${(0,u.yI)(this.shipCompareData.sides.armour)} ${e(this.shipCompareData.sides.armour,this._shipBaseData.sides.armour)}</br><span class="badge badge-highlight">${(0,u.yI)(this.shipCompareData.sides.thickness)}</span>${e(this.shipCompareData.sides.thickness,this._shipBaseData.sides.thickness)}`,splinterResistance:`${(0,u.IH)(100*this.shipCompareData.resistance.splinter)} ${e(this.shipCompareData.resistance.splinter,this._shipBaseData.resistance.splinter,2,!0)}`,structure:`${(0,u.yI)(this.shipCompareData.structure.armour)} ${e(this.shipCompareData.structure.armour,this._shipBaseData.structure.armour)}`,upgradeXP:`${(0,u.yI)(this.shipCompareData.upgradeXP)} ${e(this._shipBaseData.upgradeXP,this.shipCompareData.upgradeXP)}`,waterlineHeight:`${(0,u.$1)(this.shipCompareData.ship.waterlineHeight)} ${e(this.shipCompareData.ship.waterlineHeight,this._shipBaseData.ship.waterlineHeight,2)}`,cannonWeight:`${(0,u.yI)(this.shipCompareData.guns.weight.cannons)} ${e(this._shipBaseData.guns.weight.cannons,this.shipCompareData.guns.weight.cannons)}`,carroWeight:`${(0,u.yI)(this.shipCompareData.guns.weight.carronades)} ${e(this._shipBaseData.guns.weight.carronades,this.shipCompareData.guns.weight.carronades)}`};n.repairWeight=`${(0,u.yI)((i+r+.1*o)*m.XI)} ${e((t+a+.1*s)*m.XI,(i+r+.1*o)*m.XI)}`,n.gunsFront?n.gunsFront+=` ${Te.pd(n.limitFront)}`:n.gunsFront="–",n.gunsBack?n.gunsBack+=` ${Te.pd(n.limitBack)}`:n.gunsBack="–",super.mainDiv.html(Te.getText(n))}}function Ne(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function He(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Ze(e,t,"get"))}function Ve(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,Ze(e,t,"set"),a),a}function Ze(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var ze=new WeakMap,Ee=new WeakMap,Le=new WeakMap,Oe=new WeakMap,je=new WeakMap,Fe=new WeakMap,Xe=new WeakMap,Ye=new WeakMap,qe=new WeakMap;class Ge{constructor(e,t,a){Ne(this,ze,{writable:!0,value:{}}),Ne(this,Ee,{writable:!0,value:void 0}),Ne(this,Le,{writable:!0,value:{}}),Ne(this,Oe,{writable:!0,value:void 0}),Ne(this,je,{writable:!0,value:void 0}),Ne(this,Fe,{writable:!0,value:{}}),Ne(this,Xe,{writable:!0,value:f}),Ne(this,Ye,{writable:!0,value:v}),Ne(this,qe,{writable:!0,value:new Set(["Turn acceleration"])}),Ve(this,Ee,e),Ve(this,je,t),Ve(this,Oe,a)}static _adjustAbsolute(e,t){return e?e+t:t}static _adjustPercentage(e,t,a){return a?e?e*(1+t):t:e?e+t:t}_getCappingId(e){return`${He(this,Ee)}-${e}-capping`}_setModifier(e){let t=e.isPercentage?0:e.amount,a=e.isPercentage?e.amount:0;var s,i;He(this,Fe).has(e.modifier)&&(t+=(null===(s=He(this,Fe).get(e.modifier))||void 0===s?void 0:s.absolute)??0,a+=(null===(i=He(this,Fe).get(e.modifier))||void 0===i?void 0:i.percentage)??0);He(this,Fe).set(e.modifier,{absolute:t,percentage:a})}_roundPropertyValue(e,t,a=!1){return Number.isInteger(e)&&!a?Math.round(t):Math.trunc(100*t)/100}_adjustValue(e,t,a){var s,i;let r=e;if(0!==(null===(s=He(this,Fe).get(t))||void 0===s?void 0:s.percentage)){const e=He(this,Fe).get(t).percentage/100;r=Ge._adjustPercentage(r,e,a)}if(0!==(null===(i=He(this,Fe).get(t))||void 0===i?void 0:i.absolute)){const{absolute:e}=He(this,Fe).get(t);r=Ge._adjustAbsolute(r,e)}const o=He(this,qe).has(t)||a||0===e;return this._roundPropertyValue(e,r,o)}_showCappingAdvice(e,t){const a=this._getCappingId(e);let s=document.querySelector(`#${a}`);if(!s){var i;s=document.createElement("p"),s.id=a,s.className="alert alert-warning";const t=document.querySelector(`#${He(this,Ee)}-${e}`);null==t||null===(i=t.firstChild)||void 0===i||i.after(s)}s.innerHTML=`${[...t].join(", ")} capped`}_removeCappingAdvice(e){const t=this._getCappingId(e),a=document.querySelector(`#${t}`);a&&a.remove()}_setModifierAmountWoods(e){for(const[,t]of Object.entries(e))for(const e of(null==t?void 0:t.properties)??[])He(this,Xe).has(e.modifier)&&this._setModifier(e)}_setModifierAmountModules(e){for(const t of e)for(const e of(null==t?void 0:t.properties)??[])He(this,Xe).has(e.modifier)&&this._setModifier(e)}_adjustDataByModifiers(){for(const[t]of He(this,Fe).entries()){var e;if(null!==(e=He(this,Xe).get(t))&&void 0!==e&&e.properties){const{properties:e,isBaseValueAbsolute:a}=He(this,Xe).get(t);for(const s of e){const e=s.split(".");e.length>1?He(this,Le)[e[0]][e[1]]=this._adjustValue(He(this,Le)[e[0]][e[1]],t,a):He(this,Le)[e[0]]=this._adjustValue(He(this,Le)[e[0]],t,a)}}}}_adjustDataByCaps(e){const t={isCapped:!1,modifiers:new Set},a=(e,a,s,{amount:i,isPercentage:r})=>{const o=Math.min(a,r?this._roundPropertyValue(s,s*(1+i)):i);return a>o&&(t.isCapped=!0,t.modifiers.add(e)),o};for(const[e]of He(this,Fe).entries())if(He(this,Ye).has(e)){const{cap:t}=He(this,Ye).get(e);for(const s of He(this,Ye).get(e).properties){const i=s.split(".");i.length>1?He(this,Le)[i[0]][i[1]]&&(He(this,Le)[i[0]][i[1]]=a(e,He(this,Le)[i[0]][i[1]],He(this,ze)[i[0]][i[1]],t)):He(this,Le)[i[0]]&&(He(this,Le)[i[0]]=a(e,He(this,Le)[i[0]],He(this,ze)[i[0]],t))}}t.isCapped?this._showCappingAdvice(e,t.modifiers):this._removeCappingAdvice(e)}_setSpeedDegrees(){He(this,Le).speedDegrees=He(this,Le).speedDegrees.map((e=>{const t=1+He(this,Fe).get("Max speed").percentage/100,a=e>0?e*t:e/t;return Math.max(Math.min(a,He(this,Oe)),He(this,je))}))}addModulesAndWoodData(e,t,a,s,i){return Ve(this,ze,e),Ve(this,Le,JSON.parse(JSON.stringify(t))),Ve(this,Fe,new Map),this._setModifierAmountWoods(s),this._setModifierAmountModules(i),this._adjustDataByModifiers(),this._adjustDataByCaps(a),He(this,Fe).has("Max speed")&&this._setSpeedDegrees(),He(this,Le)}}var Ue=a(5311);function Ke(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Qe(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function Je(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,tt(e,t,"get"))}function et(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,tt(e,t,"set"),a),a}function tt(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var at=new WeakMap,st=new WeakMap,it=new WeakMap,rt=new WeakMap,ot=new WeakMap,nt=new WeakMap,ht=new WeakMap,pt=new WeakMap,lt=new WeakMap,dt=new WeakMap,ct=new WeakMap,ut=new WeakMap,mt=new WeakMap,gt=new WeakMap,ft=new WeakMap,vt=new WeakMap,wt=new WeakMap;class bt{constructor(e="compare-ship"){Qe(this,at,{writable:!0,value:0}),Qe(this,st,{writable:!0,value:0}),Qe(this,it,{writable:!0,value:void 0}),Qe(this,rt,{writable:!0,value:{}}),Qe(this,ot,{writable:!0,value:{}}),Qe(this,nt,{writable:!0,value:{}}),Qe(this,ht,{writable:!0,value:void 0}),Qe(this,pt,{writable:!0,value:void 0}),Qe(this,lt,{writable:!0,value:void 0}),Qe(this,dt,{writable:!0,value:void 0}),Qe(this,ct,{writable:!0,value:v}),Qe(this,ut,{writable:!0,value:f}),Qe(this,mt,{writable:!0,value:void 0}),Qe(this,gt,{writable:!0,value:new Map}),Qe(this,ft,{writable:!0,value:new Map}),Ke(this,"activeColumns",{}),Ke(this,"colorScale",{}),Ke(this,"innerRadius",0),Ke(this,"outerRadius",0),Ke(this,"radiusSpeedScale",{}),Ke(this,"shipMassScale",{}),Ke(this,"singleShipData",{}),Ke(this,"svgHeight",0),Ke(this,"svgWidth",0),Ke(this,"windProfileRotate",0),Ke(this,"colourScaleSpeedDiff",void 0),Ke(this,"columnsCompare",void 0),Qe(this,vt,{writable:!0,value:{}}),Qe(this,wt,{writable:!0,value:{}}),Ke(this,"_getShipClass",(e=>{var t;return(null===(t=Je(this,nt).find((t=>t.id===Je(this,wt).getSelectedShipId(e))))||void 0===t?void 0:t.class)??0})),Ke(this,"_getModuleProperties",(()=>new Map(Je(this,rt).flatMap((e=>e[1].filter((e=>e.properties.some((e=>Je(this,ut).has(e.modifier))))).map((e=>[e.id,e]))))))),Ke(this,"_getModuleTypes",(()=>new Set([...Je(this,gt)].map((e=>e[1].type.replace(/\s\u2013\s[\s/A-Za-z\u25CB]+/,"")))))),Ke(this,"getShipNameAndSpeed",(()=>new Map(Je(this,nt).map((e=>[e.id,{name:e.name,speedDegrees:e.speedDegrees}]))))),et(this,ht,e),et(this,pt,"compare-ship"===Je(this,ht)?"Compare ships":Je(this,ht)),et(this,dt,`menu-${Je(this,ht)}`),this.colourScaleSpeedDiff=(0,p.Z)().range([c.gc,c.L$,c.fy]).interpolate(h.Z),this.columnsCompare="compare-ship"===Je(this,ht)?["c1","c2"]:[],et(this,lt,[...this.columnsCompare]),Je(this,lt).unshift("base");for(const e of Je(this,lt))this.activeColumns[e]=void 0}static _getModuleLevel(e){return e<=3?"L":e<=5?"M":"S"}static _getModifierFromModule(e){return`<p class="mb-0">${e.map((e=>{let t;return t=e.isPercentage?(0,u.QO)(e.amount/100):e.amount<1&&e.amount>0?(0,u.nM)(e.amount,1):(0,u.LQ)(e.amount,2),`${e.modifier} ${t}`})).join("<br>")}</p>`}get columnIds(){return Je(this,lt)}get menuId(){return Je(this,dt)}get modulesAndWoodData(){return Je(this,ot)}get moduleTypes(){return Je(this,mt)}get selects(){return Je(this,wt)}hasShipId(e){return Je(this,nt).some((t=>t.id===e))}_addTooltip(e,t){e.dataset.bsOriginalTitle=bt._getModifierFromModule(t.properties);const a=new(i())(e,{html:!0});e.addEventListener("show.bs.tooltip",(()=>{Je(this,ft).set(t.id,a)})),e.addEventListener("hide.bs.tooltip",(()=>{Je(this,ft).set(t.id,void 0)}))}_getModuleFromName(e){let t;return Je(this,rt).some((a=>(t=a[1].find((t=>t.name===e)),Boolean(t)))),t}_initTooltip(e){for(const t of e.data("selectpicker").selectpicker.current.elements)if(!t.classList.contains("dropdown-divider")&&!t.classList.contains("dropdown-header")){const e=this._getModuleFromName(t.textContent);e&&this._addTooltip(t,e)}}_showModuleTooltip(e){const t=Ue(e.currentTarget),a=t.parent();a.find("button.bs-select-all").remove(),a.find("button.bs-deselect-all").removeClass("btn-light"),a.find("button.bs-deselect-all").addClass("btn-paper"),this._initTooltip(t)}_hideModuleTooltips(){for(const[,e]of Je(this,ft))e&&e.hide();Je(this,ft).clear()}_initModuleSelects(e){const t=this._getShipClass(e);for(const a of Je(this,mt))Je(this,wt).initModuleSelects(e,a,this._getModuleOption(a,t)),Je(this,wt).getModule$(e,a).on("changed.bs.select",(()=>{this._refreshColumn(e)})).on("show.bs.select",(e=>{this._showModuleTooltip(e)})).on("hide.bs.select",(()=>{this._hideModuleTooltips()}))}_cloneWoodData(e,t){if(Je(this,wt).enableWoodSelects(t),Je(this,wt).getSelectedWoodId(e,"frame"))for(const a of w.Kf){const s=Je(this,wt).getSelectedWoodId(e,a);Je(this,wt).setWood(t,a,s)}}_cloneModuleData(e,t){const a=Je(this,wt).getSelectedModuleIds(e,Je(this,mt));Je(this,wt).hasModuleSelects(t)||this._initModuleSelects(t),Je(this,wt).setModules(t,a)}_clone(e,t){const a=Je(this,wt).getSelectedShipId(e);a&&(Je(this,wt).setShip(t,a),this._cloneWoodData(e,t),this._cloneModuleData(e,t),this._refreshColumn(t))}_cloneToLeft(e){const t=Je(this,lt).indexOf(e),a=Je(this,lt)[t-1];this._clone(e,a)}_cloneToRight(e){const t=Je(this,lt).indexOf(e),a=Je(this,lt)[t+1];this._clone(e,a)}_getModuleDataForShipClass(e,t){return[...Je(this,gt)].filter((a=>a[1].type.replace(/\s–\s[\s/A-Za-z\u25CB]+/,"")===e&&("U"===a[1].moduleLevel||a[1].moduleLevel===bt._getModuleLevel(t))))}_getModulesGrouped(e,t){const a=this._getModuleDataForShipClass(e,t);return[...(0,r.ZP)(a,(e=>e[1].type.replace(/[\sA-Za-z]+\s–\s/,"")))].map((([e,t])=>({key:e,values:t.sort(((e,t)=>e[1].name.localeCompare(t[1].name)))}))).sort((0,d.MR)(["key"]))}_getMaxOptions(e,t){return e.has(t.replace(/[\sA-Za-z]+\s–\s/,""))?1:5}_getOption(e){return e.map((e=>`<option value="${e[0]}">${e[1].name}</option>`)).join("")}_getModuleOption(e,t){const a=this._getModulesGrouped(e,t);let s;const i=new Set(["Permanent","Ship trim"]);return s=a.length>1?a.map((t=>`<optgroup label="${t.key}" data-max-options="${this._getMaxOptions(i,e)}">${this._getOption(t.values)}</optgroup>`)).join(""):a.map((e=>`${this._getOption(e.values)}`)).join(""),s}_setOtherWoodSelect(e,t){const a="frame"===t?"trim":"frame";0===Je(this,wt).getSelectedWoodId(e,a)&&Je(this,wt).resetWoodSelect(e,a,Je(this,vt).defaultWoodId[a])}_setupShipAndWoodSelectListener(e){Je(this,wt).getShip$(e).on("changed.bs.select",(()=>{this._initModuleSelects(e),this._refreshColumn(e),"base"===e&&Je(this,wt).enableShipCompareSelects(),Je(this,wt).enableWoodSelects(e)}));for(const t of w.Kf){Je(this,wt).getWood$(e,t).on("changed.bs.select",(()=>{this._setOtherWoodSelect(e,t),this._refreshColumn(e)}))}}async _setupWoodData(){et(this,vt,new ae.J(Je(this,ht))),await Je(this,vt).init()}async _setupData(){var e;const t=1.2*((0,o.Z)(Je(this,nt),(e=>e.speed.min))??0),a=(null===(e=Je(this,ct).get("Max speed"))||void 0===e?void 0:e.cap.amount)??20;et(this,st,t),et(this,at,a),this.colorScale=(0,p.Z)().domain([Je(this,st),0,Je(this,at)]).range([c.gc,c.L$,c.fy]).interpolate(h.Z);const s=(0,o.Z)(Je(this,nt),(e=>e.shipMass))??0,i=(0,n.Z)(Je(this,nt),(e=>e.shipMass))??0;this.shipMassScale=(0,p.Z)().domain([s,i]).range([100,150]),this._setupModuleData(),await this._setupWoodData()}async loadAndSetupData(){et(this,rt,(await a.e(303).then(a.t.bind(a,3092,19))).default),et(this,nt,(await a.e(228).then(a.t.bind(a,8422,19))).default),await this._setupData()}_setGraphicsParameters(){const e=Je(this,it).getModalNode().querySelector(".column-base");this.svgWidth=(0,c.mx)(e)??0,this.svgHeight=this.svgWidth,this.outerRadius=Math.floor(Math.min(this.svgWidth,this.svgHeight)/2),this.innerRadius=Math.floor(.3*this.outerRadius),this.radiusSpeedScale=(0,p.Z)().domain([Je(this,st),0,Je(this,at)]).range([10,this.innerRadius,this.outerRadius])}_initCloneListeners(){for(const e of Je(this,lt))e!==Je(this,lt)[0]&&document.querySelector(`#${Je(this,it).getCloneLeftButtonId(e)}`).addEventListener("click",(()=>{this._cloneToLeft(e)})),e!==this.columnsCompare[this.columnsCompare.length-1]&&document.querySelector(`#${Je(this,it).getCloneRightButtonId(e)}`).addEventListener("click",(()=>{this._cloneToRight(e)}))}_setupModuleData(){et(this,gt,this._getModuleProperties()),et(this,mt,this._getModuleTypes()),et(this,ot,new Ge(Je(this,ht),Je(this,st),Je(this,at)))}_getShipDefaultData(e){return Je(this,nt).find((t=>t.id===Je(this,wt).getSelectedShipId(e)))??{}}_getSelectedModuleData(e){const t=Je(this,wt).getSelectedModuleIds(e,Je(this,mt)),a=[];for(const[,e]of t)for(const t of e)a.push(Je(this,gt).get(t)??{});return a}_getShipData(e){const t=this._getShipDefaultData(e);t.boarding={attack:0,cannonsAccuracy:0,defense:0,disengageTime:4,morale:t.boarding.morale,musketsAccuracy:0,musketsCrew:30,prepInitial:t.boarding.prepInitial,prepPerRound:t.boarding.prepPerRound};let a=t;return a.repairAmount={armour:m.ZT,armourPerk:0,sails:m.i6,sailsPerk:0},a.repairTime={sides:m.OI,default:m.OI},a.resistance={leaks:0,splinter:0},a.gunnery={dispersionHorizontal:0,dispersionVertical:0,penetration:0,reload:0,traverseUpDown:0,traverseSide:0},a=Je(this,ot).addModulesAndWoodData(t,a,e,Je(this,vt).getSelectedWoodData(Je(this,wt).getSelectedWoodIds(e)),this._getSelectedModuleData(e)),a}_updateDifferenceProfileNeeded(e){"base"!==e&&this.activeColumns[e]&&this.activeColumns[e].updateDifferenceProfile()}_updateSailingProfile(e){this._updateDifferenceProfileNeeded(e);for(const t of this.columnsCompare)t!==e&&this._updateDifferenceProfileNeeded(t)}_setSelectedShip(e,t){this.activeColumns[e]=t}getShipOptions(){return[...(0,r.ZP)(Je(this,nt),(e=>e.class))].map((([e,t])=>({key:e,values:t.map((e=>({id:e.id,name:e.name,class:e.class,battleRating:e.battleRating,guns:e.guns.total}))).sort((0,d.MR)(["name"]))}))).sort((0,d.MR)(["key"])).map((e=>`<optgroup label="${(0,g.hi)(Number(e.key),!1)} rate">${e.values.map((e=>`<option data-subtext="${e.battleRating}${(0,m.WP)(e.name)?" Imported":""}" value="${e.id}">${(0,m.td)(e.name)} (${e.guns})</option>`)).join("")}</optgroup>`)).join("")}_initSelectListeners(){for(const e of Je(this,lt))this._setupShipAndWoodSelectListener(e)}_getShipName(e){var t;return(null===(t=Je(this,nt).find((t=>t.id===e)))||void 0===t?void 0:t.name)??""}_getSelectedModuleTexts(e){const t=new Map;for(const a of Je(this,mt)){const s=Je(this,wt).getSelectedModuleIdsPerType(e,a),i=[];for(const e of s){const t=Je(this,gt).get(e);i.push((null==t?void 0:t.name.replace(" Bonus",""))??"")}t.set(a,i.join(", "))}return t}_getSelectedWoodText(e){const t=[];for(const a of w.Kf){const s=Je(this,wt).getSelectedWoodId(e,a);t.push(Je(this,vt).getWoodName(s))}return t}_getSelectedData(){const e={};for(const t of Je(this,lt)){const a=Je(this,wt).getSelectedShipId(t);a&&(e[t]={ship:this._getShipName(a),moduleData:this._getSelectedModuleTexts(t),wood:this._getSelectedWoodText(t)})}return e}_getSelectedIds(){const e={};for(const t of Je(this,lt)){const a=Je(this,wt).getSelectedShipId(t);a&&(e[t]={ship:a,wood:Je(this,wt).getSelectedWoodIds(t),modules:Je(this,wt).getSelectedModuleIds(t,Je(this,mt))})}return e}async menuClicked(){var e,t;((0,l.KS)("Menu",Je(this,pt)),Je(this,it))?Je(this,it).show():(await this.loadAndSetupData(),et(this,it,new A(Je(this,pt),Je(this,lt),this.columnsCompare[this.columnsCompare.length-1])),et(this,wt,new fe(Je(this,ht),Je(this,lt),Je(this,it))),Je(this,wt).initShipAndWoodSelects(this.getShipOptions(),Je(this,vt)),this._initSelectListeners(),this._initCloneListeners(),Je(this,it).getModalNode().addEventListener("keydown",(e=>{"KeyC"===e.key&&e.ctrlKey&&(e.preventDefault(),te(this._getSelectedIds(),Je(this,mt),Je(this,it).getModalNode()))})),null===(e=document.querySelector(`#${Je(this,it).copyButtonId}`))||void 0===e||e.addEventListener("click",(e=>{e.preventDefault(),te(this._getSelectedIds(),Je(this,mt),Je(this,it).getModalNode())})),null===(t=document.querySelector(`#${Je(this,it).imageButtonId}`))||void 0===t||t.addEventListener("click",(async e=>{(0,l.KS)("Menu","Ship compare image"),e.preventDefault();const t=new X(Je(this,ht),this._getSelectedData(),Je(this,it));await t.init()})));this._setGraphicsParameters()}_refreshColumn(e){if("ship-journey"===Je(this,ht))this.singleShipData=this._getShipDefaultData(e);else{const t=this._getShipData(e);if("base"===e){this._setSelectedShip(e,new Pe(Je(this,it).getBaseIdOutput(e),t,this));for(const e of this.columnsCompare)Je(this,wt).enableShipSelect(e),this.activeColumns[e]&&this._setSelectedShip(e,new Re(Je(this,it).getBaseIdOutput(e),t,this.activeColumns[e].shipCompareData,this))}else this._setSelectedShip(e,new Re(Je(this,it).getBaseIdOutput(e),this.activeColumns.base.shipData,t,this));this._updateSailingProfile(e)}}}let Dt;const yt=()=>{const e=document.querySelector("#journey-arrow");if(e){const t=e.cloneNode(!0);if(t.id="wind-profile-arrow-head",t.hasChildNodes())for(const e of t.childNodes)e.classList.replace("fill-contrast-light","wind-profile-arrow-head");const a=document.querySelector("#na-map svg defs");a&&a.append(t)}},St=()=>{document.querySelector(`#${Dt.menuId}`).addEventListener("click",(()=>{Dt.menuClicked()}))};let Ct;const _t=e=>{for(const t of Object.keys(e))Ct.selects.setShip(t,e[t].ship),Ct.selects.setWoods(t,e[t].wood),Ct._initModuleSelects(t),Ct.selects.setModules(t,e[t].modules),Ct._refreshColumn(t)},$t=async()=>{const e="ship-journey",t=new bt(e);await t.loadAndSetupData();return{select:new se.Z(e,e,{title:"Ship"},t.getShipOptions()),shipNameAndSpeed:t.getShipNameAndSpeed()}},Mt=["base","c1","c2"],kt=e=>{void 0===e?(async()=>{Dt=new bt,yt(),St()})():(async e=>{(0,l.KS)("Menu","Paste ship compare"),Ct=new bt,await Ct.loadAndSetupData(),await Ct.menuClicked();const t=e.getSelectedIds(Ct.moduleTypes);_t(t)})(e)}},5148:(e,t,a)=>{a.d(t,{u:()=>u});var s=a(5923),i=a(9022);function r(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function o(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,h(e,t,"set"),a),a}function n(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,h(e,t,"get"))}function h(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var p=new WeakMap,l=new WeakMap,d=new WeakMap,c=new WeakMap;class u{constructor(e){r(this,p,{writable:!0,value:"v"}),r(this,l,{writable:!0,value:"cmp"}),r(this,d,{writable:!0,value:{}}),r(this,c,{writable:!0,value:new URL(window.location.href)}),e&&this._setSearchParams(e)}static getDecodedValue(e){return e?s.PD.decode(e):[]}static _getCodedValue(e){return s.PD.encode(e)}get moduleTypes(){return n(this,d)}set moduleTypes(e){o(this,d,e)}get searchParams(){return n(this,c).searchParams}getUrl(){return n(this,c).href}isCurrentVersion(){if(this._hasVersion()&&this._hasShipWoods()){const e=this._getVersion();if(e&&e.split(".")[0]===i.f4.split(".")[0])return!0}return!1}getModuleIds(e,t){const a=this._getModuleIndex(e,t),s=n(this,c).searchParams.get(a);return[a,u.getDecodedValue(s)]}setModuleIds(e,t,a){const s=this._getModuleIndex(e,t),i=u._getCodedValue(a);n(this,c).searchParams.set(s,i)}getShipsAndWoodIds(){const e=this._getParam(n(this,l));if(e){this._deleteParam(n(this,l));return u.getDecodedValue(e)}return[]}setShipsAndWoodIds(e){const t=u._getCodedValue(e);n(this,c).searchParams.set(n(this,l),t)}setVersion(){const e=encodeURIComponent(i.f4);n(this,c).searchParams.set(n(this,p),e)}_deleteParam(e){n(this,c).searchParams.delete(e)}_getModuleIndex(e,t){return`${e}${t}`}_getParam(e){return n(this,c).searchParams.get(e)??void 0}_getVersion(){if(this._hasVersion()){const e=this._getParam(n(this,p));if(e){this._deleteParam(n(this,p));return decodeURIComponent(e)}}}_hasShipWoods(){return n(this,c).searchParams.has(n(this,p))}_hasVersion(){return n(this,c).searchParams.has(n(this,p))}_setSearchParams(e){for(const[t,a]of e.entries())n(this,c).searchParams.set(t,a)}}},4695:(e,t,a)=>{a.d(t,{J:()=>f});var s=a(8398),i=a(8776),r=a(2157);function o(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function n(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,p(e,t,"get"))}function h(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,p(e,t,"set"),a),a}function p(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var l=new WeakMap,d=new WeakMap,c=new WeakMap,u=new WeakMap,m=new WeakMap,g=new WeakMap;class f{constructor(e){o(this,l,{writable:!0,value:void 0}),o(this,d,{writable:!0,value:{}}),o(this,c,{writable:!0,value:new Map}),o(this,u,{writable:!0,value:{}}),o(this,m,{writable:!0,value:{}}),o(this,g,{writable:!0,value:{}}),h(this,l,e)}get defaultWoodId(){return n(this,d)}get modifierNames(){return n(this,m)}findWoodId(e,t){var a;return(null===(a=[...n(this,g).entries()].find((([,a])=>a.type===e&&a.name===t)))||void 0===a?void 0:a[0])??0}getMaxProperty(e){var t;return(null===(t=n(this,c).get(e))||void 0===t?void 0:t.max)??1}getMinProperty(e){var t;return(null===(t=n(this,c).get(e))||void 0===t?void 0:t.min)??1}getOptions(e){return n(this,u)[e]}getWoodName(e){var t;return(null===(t=n(this,g).get(e))||void 0===t?void 0:t.name)??""}getSelectedWoodData(e){const t={};for(const[a,s]of e)t[a]=this.getWoodTypeData(s);return t}getWoodTypeData(e){return n(this,g).get(e)??{}}_setupData(e){h(this,m,new Set([...e.frame.flatMap((e=>e.properties.map((e=>e.modifier)))),...e.trim.flatMap((e=>e.properties.map((e=>e.modifier))))].sort(r.I4))),h(this,g,new Map([...new Map(e.frame.map((e=>[e.id,e]))),...new Map(e.trim.map((e=>[e.id,e])))])),"compare-wood"===n(this,l)?h(this,d,{frame:this.findWoodId("frame","Fir"),trim:this.findWoodId("trim","Crew Space")}):(n(this,l),h(this,d,{frame:this.findWoodId("frame","Oak"),trim:this.findWoodId("trim","Oak")}))}_setupOption(e){h(this,u,{frame:e.frame.sort((0,r.MR)(["name"])).map((e=>`<option value="${e.id}">${e.name}</option>`)).join(""),trim:e.trim.sort((0,r.MR)(["name"])).map((e=>`<option value="${e.id}">${e.name}</option>`)).join("")})}_setupMinMax(e){for(const t of n(this,m)){const a=[...e.frame.map((e=>{var a;return(null===(a=e.properties.find((e=>e.modifier===t)))||void 0===a?void 0:a.amount)??0}))],r=[...e.trim.map((e=>{var a;return(null===(a=e.properties.find((e=>e.modifier===t)))||void 0===a?void 0:a.amount)??0}))],o=(0,s.Z)(a)??0,h=(0,i.Z)(a)??0,p=(0,s.Z)(r)??0,l=(0,i.Z)(r)??0;n(this,c).set(t,{min:Math.min(0,o+p),max:h+l})}}_setupSelectData(e){this._setupOption(e),this._setupMinMax(e)}async _loadAndSetupData(){const e=(await a.e(799).then(a.t.bind(a,1258,19))).default;this._setupData(e),this._setupSelectData(e)}async init(){await this._loadAndSetupData()}}},4941:(e,t,a)=>{var s=a(2855),i=a(1460),r=a(3389),o=a(4194),n=a(4332),h=a(9492),p=a(5148);function l(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function d(e,t){var a=function(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}(e,t,"get");return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,a)}var c=new WeakMap;class u extends p.u{constructor(...e){super(...e),l(this,c,{writable:!0,value:{}})}getSelectedIds(e){return super.moduleTypes=e,this._getShipsAndWoods(),this._getModules(),d(this,c)}_getShipsAndWoods(){const e=super.getShipsAndWoodIds();let t=0;h.Ms.some((a=>(d(this,c)[a]={},d(this,c)[a].ship=e[t],d(this,c)[a].wood=new Map([[n.Kf[0],e[t+1]],[n.Kf[1],e[t+2]]]),d(this,c)[a].modules=new Map,t+=3,t>=e.length)))}_getModules(){for(const[e,t]of super.searchParams.entries()){const[a,s]=[...e],i=p.u.getDecodedValue(t),r=this._getColumnId(Number(a)),o=this._getModuleType(Number(s));d(this,c)[r].modules.set(o,i)}}_getColumnId(e){return[...Object.keys(d(this,c))][e]}_getModuleType(e){return[...super.moduleTypes][e]}}var m=a(5311);SVGAnimatedString.prototype.indexOf=function(){return this.baseVal.indexOf.apply(this.baseVal,arguments)};const g="server-name",f=i.NH,v=new r.Z({id:g,values:f}),w=new o.Z(g,f),b=()=>{var e;null===(e=document.querySelector(`#${g}`))||void 0===e||e.addEventListener("change",(()=>{(()=>{const e=w.get();v.set(e),document.location.reload()})()})),m(".dropdown-menu [data-bs-toggle='dropdown']").on("click",(e=>{e.preventDefault(),e.stopPropagation();const t=m(e.currentTarget);t.siblings().toggleClass("show"),t.next().hasClass("show")||t.parents(".dropdown-menu").first().find(".show").removeClass("show"),t.parents(".nav-item.dropdown.show").on("hidden.bs.dropdown",(()=>{m(".dropdown-submenu .show").removeClass("show")}))}))},D=async(e,t)=>{(await Promise.all([a.e(240),a.e(639)]).then(a.bind(a,2350))).init(e,t)},y=async()=>{const e=(()=>{const e=v.get();return w.set(e),e})(),t=new URLSearchParams(new URL(document.location.href).search),s=new u(t);history.replaceState("",document.title,window.location.origin+window.location.pathname),await(async(e,t)=>{const s=new((await Promise.all([a.e(223),a.e(589),a.e(842)]).then(a.bind(a,5596))).NAMap)(e,t);await s.MapInit()})(e,t),s.isCurrentVersion()?D(e,s):document.querySelector("#game-tools-dropdown").addEventListener("show.bs.dropdown",(async()=>D(e,void 0)),{once:!0}),document.querySelector("#map-tools-dropdown").addEventListener("show.bs.dropdown",(async()=>(async()=>{(await Promise.all([a.e(223),a.e(674)]).then(a.bind(a,7541))).init()})()),{once:!0})};(0,s.uF)(),(0,s.de)("Homepage"),b(),y()},1198:(e,t,a)=>{a.d(t,{nD:()=>o,Iy:()=>n,Fq:()=>h,xp:()=>p,$G:()=>l,ec:()=>d,Mo:()=>c,vQ:()=>u,A1:()=>m,GZ:()=>g,yb:()=>f,wo:()=>v});var s=a(7808),i=a(9022),r=a(393);a(5311);const o=(e,t=!1)=>{let a;return a=Number.isNaN(Number(e))?e:(0,r.tT)(Number(e)),`<${t?"tspan":"span"} class="caps">${a}</${t?"tspan":"span"}>`},n=(e,t=!1)=>{let a,s;return Number.isNaN(Number(e))?(a=e,s=(0,r.Ri)(a)%r.QF):(s=Number(e),a=(0,r.tT)(s)),`<${t?"tspan":"span"} class="caps">${a}</${t?"tspan":"span"}> (${s}°)`},h=(e,t)=>{let a=Math.atan2(t.y-e.y,t.x-e.x);a-=Math.PI/2;let s=(0,r.vi)(a);return s<0&&(s+=r.QF),s},p=(e,t,a=!0)=>{if(t<2)return[e];const s=e.length,i=[];let r,o=0;if(s%t==0)for(r=Math.floor(s/t);o<s;)i.push(e.slice(o,o+=r));else if(a)for(;o<s;)r=Math.ceil((s-o)/t--),i.push(e.slice(o,o+=r));else{for(t-=1,r=Math.floor(s/t),s%r==0&&(r-=1);o<r*t;)i.push(e.slice(o,o+=r));i.push(e.slice(r*t))}return i},l=({element:e,radius:t})=>{const a=i.f7,o=r.QF/a,n=Math.round(.8*t),h=Array.from({length:a},((e,t)=>(0,r.tT)(t*o))),p=(0,s.Z)().range([0-o/2,r.QF-o/2]).domain(h).align(0);e.append("circle").attr("r",n).style("stroke-width","3px");const l=e.append("text"),d=e.append("g").selectAll("g").data(h).join((e=>e.append("g").attr("transform",(e=>`rotate(${Math.round((p(e)??0)+p.bandwidth()/2-r.bT)})translate(${n},0)`))));d.filter(((e,t)=>t%3!=0)).append("line").attr("x2",9),d.filter(((e,t)=>t%3==0)).append("text").attr("transform",(e=>{let t,a=Math.round((p(e)??0)+p.bandwidth()/2);l.text(e);const s=l.node().getBBox().height??0,i=l.node().getBBox().width??0;return a>=0&&a<=45||315===a?(a=90,t="0,-"+s/2):90===a?(a=0,t=i/2+3+",0"):270===a?(a=180,t=`-${i/2+3},0`):(a=-90,t="0,"+(s/2+3+2)),`rotate(${a})translate(${t})`})).text((e=>e)),l.remove()},d=({element:e,radius:t})=>{const a=i.f7,o=r.QF/a,n=Math.round(.8*t),h=Array.from({length:a},((e,t)=>(0,r.tT)(t*o))),p=(0,s.Z)().range([0-o/2,r.QF-o/2]).domain(h).align(0);e.append("circle").attr("r",n).style("stroke-width","1.5px");e.append("g").selectAll("line").data(h).join((e=>e.append("line").attr("x2",((e,t)=>t%3==0?t%6==0?6:4:2)).attr("transform",(e=>`rotate(${Math.round((p(e)??0)+p.bandwidth()/2)})translate(${n},0)`))))},c=e=>`<span class="caps">${e}</span>`,u=(e,t)=>{navigator.clipboard||((e,t)=>{var a,s;if(null===(a=(s=document).queryCommandSupported)||void 0===a||!a.call(s,"copy"))return console.error(`Insufficient rights to copy ${e} to clipboard`),!1;{const a=document.createElement("input");a.type="text",a.value=e,a.style.position="absolute",a.style.left="-1000px",a.style.top="-1000px",t.append(a),a.select();try{document.execCommand("copy")}catch(e){return console.error("Copy to clipboard failed.",e),!1}finally{a.remove()}}})(e,t),(async e=>{navigator.clipboard.writeText(e).then((()=>!0)).catch((t=>(console.error(`Cannot copy ${e} to clipboard`,t),!1)))})(e)},m=(e,t,a)=>{if(Number.isFinite(e)&&Number.isFinite(t)){const s=new URL(window.location.href);s.searchParams.set("x",String(e)),s.searchParams.set("z",String(t)),u(s.href,a)}},g=(e,t,a)=>`M${e-a},${t}a${a},${a} 0 10${2*a},0a${a},${a} 0 10${2*-a},0`,f=(e,t,a)=>`M${e-a/2},${t-a/2}h${a}v${a}h${-a}z`,v=(e,t,a)=>`M${e},${t}v${a}`},3389:(e,t,a)=>{a.d(t,{Z:()=>f});var s=a(1955),i=a(9022),r=a(7484),o=a.n(r);function n(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function h(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,l(e,t,"get"))}function p(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,l(e,t,"set"),a),a}function l(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var d=new WeakMap,c=new WeakMap,u=new WeakMap,m=new WeakMap,g=new WeakMap;class f{constructor({id:e,values:t=[],expire:a}){n(this,d,{writable:!0,value:void 0}),n(this,c,{writable:!0,value:void 0}),n(this,u,{writable:!0,value:void 0}),n(this,m,{writable:!0,value:void 0}),n(this,g,{writable:!0,value:void 0}),p(this,d,e),p(this,c,a?o()(a).toDate():365),p(this,u,`${i.DJ}--${h(this,d)}`),p(this,m,t),p(this,g,null==t?void 0:t[0])}set(e){e===h(this,g)?this.remove():s.Z.set(h(this,u),e,{expires:h(this,c),sameSite:"strict"})}get(){let e=s.Z.get(h(this,u))??h(this,g);return h(this,g)&&e&&!h(this,m).includes(e)&&(e=h(this,g),this.remove()),e}remove(){s.Z.remove(h(this,u))}}},9843:(e,t,a)=>{a.d(t,{Z:()=>$});var s=a(7424),i=a.n(s),r=a(3838),o=a(9022);function n(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function h(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,l(e,t,"get"))}function p(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,l(e,t,"set"),a),a}function l(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var d=new WeakMap,c=new WeakMap,u=new WeakMap,m=new WeakMap,g=new WeakMap,f=new WeakMap,v=new WeakMap,w=new WeakMap,b=new WeakMap,D=new WeakMap,y=new WeakMap,S=new WeakMap,C=new WeakMap,_=new WeakMap;class ${constructor(e,t,a="Close"){n(this,d,{writable:!0,value:void 0}),n(this,c,{writable:!0,value:void 0}),n(this,u,{writable:!0,value:void 0}),n(this,m,{writable:!0,value:void 0}),n(this,g,{writable:!0,value:void 0}),n(this,f,{writable:!0,value:void 0}),n(this,v,{writable:!0,value:void 0}),n(this,w,{writable:!0,value:void 0}),n(this,b,{writable:!0,value:void 0}),n(this,D,{writable:!0,value:{}}),n(this,y,{writable:!0,value:{}}),n(this,S,{writable:!0,value:{}}),n(this,C,{writable:!0,value:{}}),n(this,_,{writable:!0,value:{}}),p(this,m,e),p(this,d,(0,o.MF)(h(this,m))),p(this,u,`${h(this,d)}-selects`),p(this,c,`${h(this,d)}-output`),p(this,g,`menu-${this.baseId}`),p(this,f,a),p(this,w,`modal-${this.baseId}`),p(this,b,`modal-${t}`),this._inject(),p(this,v,new(i())(h(this,S).node())),this.show()}_inject(){p(this,S,(0,r.Z)("#modal-section").append("div").attr("id",h(this,w)).attr("class","modal").attr("tabindex","-1").attr("aria-labelledby",`title-${h(this,w)}`).attr("aria-hidden","true"));const e=h(this,S).append("div").attr("class",`modal-dialog ${h(this,b)}`).append("div").attr("class","modal-content"),t=e.append("header").attr("class","modal-header");t.append("h5").attr("class","modal-title").attr("id",`title-${h(this,w)}`).html(h(this,m)),t.append("button").attr("type","button").attr("class","btn-close").attr("data-bs-dismiss","modal").attr("aria-label","Close"),p(this,D,e.append("div").attr("class","modal-body")),p(this,_,h(this,D).append("div").attr("id",h(this,u))),p(this,C,h(this,D).append("div").attr("id",h(this,c))),p(this,y,e.append("footer").attr("class","modal-footer")),h(this,y).append("button").attr("type","button").attr("class","btn").attr("data-bs-dismiss","modal").text(h(this,f))}hide(){h(this,v).hide()}show(){h(this,v).show()}getModalNode(){return h(this,S).node()}get baseIdSelects(){return h(this,u)}get baseIdOutput(){return h(this,c)}get bodySel(){return h(this,D)}get footer(){return h(this,y)}get outputSel(){return h(this,C)}get selectsSel(){return h(this,_)}removeFooter(){h(this,y).remove()}get baseId(){return h(this,d)}get id(){return h(this,w)}}},4194:(e,t,a)=>{function s(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function i(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,n(e,t,"get"))}function r(e,t){return function(e,t){if(t.set)return"__destrObj"in t||(t.__destrObj={set value(a){t.set.call(e,a)}}),t.__destrObj;if(!t.writable)throw new TypeError("attempted to set read only private field");return t}(e,n(e,t,"set"))}function o(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,n(e,t,"set"),a),a}function n(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}a.d(t,{Z:()=>d});var h=new WeakMap,p=new WeakMap,l=new WeakMap;class d{constructor(e,t){s(this,h,{writable:!0,value:void 0}),s(this,p,{writable:!0,value:void 0}),s(this,l,{writable:!0,value:void 0}),o(this,h,e.replace(/ /g,"")),o(this,p,t),[r(this,l).value]=t}set(e){(document.querySelector(`#${i(this,h)}-${e}`)??{}).checked=!0}get(){let{value:e}=document.querySelector(`input[name="${i(this,h)}"]:checked`)??{};return void 0!==e&&i(this,p).includes(e)||(e=i(this,l),this.set(e)),e}}},29:(e,t,a)=>{a.d(t,{Z:()=>m});a(1936);var s=a(3838),i=a(5311);function r(e,t,a){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}function o(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,h(e,t,"get"))}function n(e,t,a){return function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}(e,h(e,t,"set"),a),a}function h(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}var p=new WeakMap,l=new WeakMap,d=new WeakMap,c=new WeakMap,u=new WeakMap;class m{constructor(e,t,a,i,o=!1){r(this,p,{writable:!0,value:{}}),r(this,l,{writable:!0,value:void 0}),r(this,d,{writable:!0,value:void 0}),r(this,c,{writable:!0,value:void 0}),r(this,u,{writable:!0,value:void 0}),n(this,d,`${e}-select`),n(this,u,t?(0,s.Z)(`#${t}`):void 0),n(this,l,a),n(this,c,o),this._init(i)}static getSelectValueAsNumberArray(e){return Array.isArray(e)?e.map((e=>Number(e))):e?[Number(e)]:[]}static getSelectValueAsStringArray(e){return Array.isArray(e)?e.map((e=>String(e))):e?[String(e)]:[]}get select$(){return o(this,p)}getValues(){return o(this,p).val()}setSelectValues(e){const t=m.getSelectValueAsStringArray(e);t.length>0&&o(this,p).val(t),this.refresh()}disable(){o(this,p).prop("disabled",!0),this.refresh()}enable(){o(this,p).removeAttr("disabled").selectpicker("refresh"),this.refresh()}render(){o(this,p).selectpicker("render")}refresh(){o(this,p).selectpicker("refresh")}reset(e="default"){o(this,p).val(e).selectpicker("refresh")}setOptions(e){this.select$.empty(),this.select$.append(e)}_injectSelects(){const e=o(this,u).append("div").attr("class","mb-1");e.append("select").attr("name",o(this,d)).attr("id",o(this,d)).property("multiple",o(this,c)).attr("class","selectpicker"),e.append("label").attr("for",o(this,d))}_construct(){o(this,p).selectpicker(o(this,l))}_init(e){o(this,u)&&this._injectSelects(),n(this,p,i(`#${o(this,d)}`)),this.setOptions(e),this._construct(),this.reset()}}},9022:(e,t,a)=>{a.d(t,{FB:()=>m,DJ:()=>g,xw:()=>f,f4:()=>v,fy:()=>w,Q0:()=>b,gc:()=>D,L$:()=>y,vU:()=>S,Om:()=>C,f7:()=>_,P:()=>$,ZE:()=>M,er:()=>k,q4:()=>x,ye:()=>I,gY:()=>T,EZ:()=>A,qP:()=>P,dM:()=>W,V4:()=>R,kU:()=>N,eM:()=>H,Uy:()=>V,mx:()=>Z,MF:()=>z,eA:()=>j,Db:()=>Y});var s=a(9872),i=a.n(s),r=a(7484),o=a.n(r),n=(a(9517),a(178)),h=a.n(n),p=a(5619),l=a(6400),d=a(393),c=a(2157);o().extend(h()),o().locale("en-gb");const u=p.Z.bind(l.h),m="Yet another map with in-game map, resources, ship and wood comparisons. Port battle data is updated constantly from twitter and all data daily after maintenance.",g="na-map",f="Naval Action map",v="13.3.18",w="#163627",b="#f3f1ef",D="#4a1c21",y="#f1efe9",S="images/icons/android-chrome-48x48.png",C="#b5aca1",_=24,$=2*Math.PI/_,M=5,k=d.QF/2935,x=["#f23d3d","#806060","#8c3f23","#f2c6b6","#bf7c30","#ffd580","#403a30","#73621d","#9da67c","#ace639","#165916","#b6f2be","#39e67e","#30bfb6","#0d3330","#5395a6","#3db6f2","#397ee6","#334766","#404080","#c6b6f2","#7033cc","#39134d","#e63df2","#40303d","#f279ca","#802053","#d93662","#330d12","#f2b6be"],I=e=>{const t="has-child-dropdown-show",a=document.querySelector(`#${e}`);var s;i().prototype.toggle=(s=i().prototype.toggle,function(){for(const e of document.querySelectorAll(`.${t}`))e.classList.remove(t);let e=this._element.closest(".dropdown").parentNode.closest(".dropdown");for(;e&&e!==document;e=e.parentNode.closest(".dropdown"))e.classList.add(t);s.call(this)});for(const e of a.querySelectorAll(".dropdown"))e.addEventListener("hide.bs.dropdown",(function(e){var a;this.classList.contains(t)&&(this.classList.remove(t),e.preventDefault()),null!==(a=e.clickEvent)&&void 0!==a&&a.composedPath().some((e=>{var t;return null===(t=e.classList)||void 0===t?void 0:t.contains("dropdown-toggle")}))&&e.preventDefault(),e.stopPropagation()}))},T=(e,t)=>`${e} ${t+(1===e?"":"s")}`,A=async(e,t)=>{W();for await(const a of e)t[a.name]=await P(a.fileName);R()};class B extends Error{constructor(e){var t,a,s;super(`${e.url} ${e.statusText} (status ${e.status})`),s=void 0,(a="response")in(t=this)?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,this.name="Fetch error",this.response=e}}const P=async e=>{const t=await fetch(`data/${e}`);if(!t.ok)throw new B(t);return t.json()},W=()=>{document.body.style.cursor="wait"},R=()=>{document.body.style.cursor="default"},N=e=>{const t=e.getContext("2d");if(null===t)throw new Error("This browser does not support 2-dimensional canvas rendering contexts.");return t},H=(e=>{const t={};for(const a of e.keys())t[a.replace("./","").replace(".svg","")]=e(a);return Object.fromEntries(Object.entries(t).sort((([e],[t])=>(0,c.$i)(e).id-(0,c.$i)(t).id)))})(a(1801)),V=e=>{const{height:t}=e.getBoundingClientRect();return Math.floor(t)},Z=e=>{const{width:t}=e.getBoundingClientRect();return Math.floor(t)},z=e=>e.toLocaleLowerCase().replace("of ","").replaceAll(" ","-").replaceAll("’",""),E=e=>Number(o().utc().hour(e).local().format("H")),L=(e,t)=>u`<span style="white-space: nowrap;">${String(e)} ‒ ${String(t)}</span>`,O=(e,t)=>{const a=E(e),s=E(t);return u`${L(e,t)} (${L(a,s)})`},j=e=>e?O((e+10)%24,(e+13)%24):O(11,8),F=(e,t)=>`${String(e)} ‒ ${String(t)}`,X=(e,t)=>{const a=E(e),s=E(t);return`${F(e,t)} (${F(a,s)})`},Y=e=>e?X((e+10)%24,(e+13)%24):X(11,8)},7015:(e,t,a)=>{a.d(t,{$1:()=>u,LQ:()=>m,QM:()=>g,Hu:()=>f,yI:()=>v,IH:()=>w,nM:()=>b,Dw:()=>D,RK:()=>y,Pj:()=>S,ub:()=>C,sR:()=>_,me:()=>$,QO:()=>M});var s=a(28),i=a(5619),r=a(6400);const o=i.Z.bind(r.h),n='<span class="caps">m</span>',h='<tspan class="caps">m</tspan>',p='<span class="caps">%</span>',l='<tspan class="caps">%</tspan>',d=(0,s.Z)({decimal:".",thousands:" ",grouping:[3],currency:[""," reales"],percent:" %",minus:"− "}),c=d.formatPrefix(",.0",1e3),u=(e,t=2)=>d.format(`,.${t}~r`)(e),m=(e,t=2)=>d.format(`+,.${t}~r`)(e).replace("+","+ "),g=(e,t=2)=>d.format(`.${t}f`)(e).replace(".00",'<span class="hidden">.00</span>').replace(/\.(\d)0/g,'.$1<span class="hidden">0</span>'),f=e=>c(-1*e).replace("k"," k"),v=(e,t=2)=>d.format(`,.${t}d`)(e),w=e=>d.format("+,d")(e),b=(e,t=0)=>d.format(`,.${t}%`)(e).replace("%","pp"),D=(e,t=!1)=>d.format(",.2s")(e).replace(".0","").replace("k"," k").replace("m"," m").replace("M",` ${t?h:n}`),y=e=>{const t=D(e);return t.endsWith(n)?o`${t.replace(n,"")}<span class="caps">m</span>`:o`${t}`},S=(e,t=!1)=>d.format("$,.2s")(e).replace(".0","").replace("M",` ${t?h:n}`).replace("k"," k"),C=(e,t=1,a=!1)=>d.format(`.${t}%`)(e).replace(".0","").replace("%",`${a?l:p}`),_=(e,t=1)=>{const a=C(e,t);return a.endsWith(p)?o`${a.replace(p,"")}<span class="caps">%</span>`:o`${a}`},$=(e,t=1)=>d.format(`.${t}p`)(e),M=(e,t=!1)=>d.format("+.1%")(e).replace(".0","").replace("%",`${t?l:p}`)},5923:(e,t,a)=>{a.d(t,{ZT:()=>l,q4:()=>d,OI:()=>c,i6:()=>u,l9:()=>m,C4:()=>v,XI:()=>w,PD:()=>b,WP:()=>y,td:()=>S,Y8:()=>C,PK:()=>_,IF:()=>M,HL:()=>k});var s=a(4447),i=a(4195),r=a(5619),o=a(6400),n=a(9022),h=a(7015);const p=r.Z.bind(o.h),l=Number(.2),d=Number(300),c=Number(90),u=Number(.25),m=Number(300),g=Number(.25),f=Number(1),v=Number(g)/Number(f),w=5,b=new i.Z("My salt: Yet another Naval Action map"),D=" (i)",y=e=>e.includes(D),S=e=>e.replace(D,""),C=e=>S(e)+(y(e)?' <span class="caps small condensed">imported</span>':""),_=e=>`${(0,h.yI)(Number(e))} real${Number(e)>1?"es":""}`,$=e=>{const{r:t,g:a,b:i}=(0,s.B8)(e);return(299*t+587*a+114*i)/1e3},M=e=>{var t;return $(e)>=128?(null===(t=(0,s.ZP)(n.L$))||void 0===t?void 0:t.darker(5).toString())??"#111":n.L$},k=e=>p`<span class="caps">${e}</span>`},393:(e,t,a)=>{a.d(t,{L9:()=>s,nX:()=>i,jo:()=>r,w7:()=>o,QF:()=>n,tz:()=>h,bT:()=>p,_i:()=>w,UY:()=>b,IK:()=>D,pw:()=>y,vi:()=>S,UI:()=>C,Ht:()=>_,qY:()=>$,Sp:()=>M,hi:()=>k,hg:()=>x,Tm:()=>I,Ri:()=>T,tT:()=>A,vX:()=>B,XH:()=>P});const s=(1+Math.sqrt(5))/2,i=390,r=16,o=16,n=360,h=180,p=90,l=-.00499866779363828,d=-2.1464254980645e-7,c=4096.88635151897,u=4096.90282787469,m=-200.053302087577,g=-.00859027897636011,f=819630.836437126,v=-819563.745651571,w=(e,t)=>l*e+d*t+c,b=(e,t)=>d*e-l*t+u,D=(e,t)=>m*e+g*t+f,y=(e,t)=>g*e-m*t+v,S=e=>e*h/Math.PI,C=(e,t)=>Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2),_=e=>Math.PI/h*(e-p),$=e=>((e,t=0)=>Number(Math.round(e*10**t)/10**t))(e,3),M=(e,t)=>{const a={x:D(e.x,e.y),y:y(e.x,e.y)},s={x:D(t.x,t.y),y:y(t.x,t.y)};return C(a,s)/(2.63*i)};function k(e,t=!0){const a=t?["th","st","nd","rd"]:["ᵗʰ","ˢᵗ","ⁿᵈ","ʳᵈ"],s=e%100,i=a[(s-20)%10]||a[s]||a[0];return String(e)+i}function x(e,t=!0){const a=["th","st","nd","rd"],s=e%100,i=a[(s-20)%10]||a[s]||a[0];return String(e)+(t?`<tspan class="super">${i}</tspan>`:`${i}`)}const I=["N","N⅓NE","N⅔NE","NE","E⅔NE","E⅓NE","E","E⅓SE","E⅔SE","SE","S⅔SE","S⅓SE","S","S⅓SW","S⅔SW","SW","W⅔SW","W⅓SW","W","W⅓NW","W⅔NW","NW","N⅔NW","N⅓NW"],T=e=>{const t=n/I.length;return I.indexOf(e)*t},A=e=>{const t=n/I.length,a=Math.floor(e/t+.5);return I[a%I.length]},B=(e,t,a,s)=>{const i=Math.min.apply(Math,[t,a]),r=Math.max.apply(Math,[t,a]);return s?e>=i&&e<=r:e>i&&e<r},P=e=>2**Math.floor(Math.log(e)/Math.log(2))},9949:(e,t,a)=>{a.d(t,{vt:()=>s,WF:()=>i,zb:()=>r});const s="UA-109520372-1",i=(new Set(["eu1"]),10),r=8192},2157:(e,t,a)=>{a.d(t,{qg:()=>l,kK:()=>d,nU:()=>c,mP:()=>m,xb:()=>g,fm:()=>f,$i:()=>v,dx:()=>w,y0:()=>b,_v:()=>D,Vk:()=>C,MR:()=>$,I4:()=>M});var s=a(7484),i=a.n(s),r=a(285),o=a.n(r),n=a(178),h=a.n(n),p=a(9949);i().extend(o()),i().extend(h());const l=["medium","long","carronade"],d={medium:["regular","congreve","defense","edinorog"],long:["regular","navy","blomefield"],carronade:["regular","obusiers"]},c=[{id:0,short:"NT",name:"Neutral",sortName:"Neutral",colours:["#cec1c1"]},{id:1,short:"PR",name:"Pirates",sortName:"Pirates",colours:["#352828","#cec1c1"]},{id:2,short:"ES",name:"España",sortName:"España",colours:["#9b3438","#c5a528"]},{id:3,short:"FR",name:"France",sortName:"France",colours:["#284e98","#b5423a","#cec1c1"]},{id:4,short:"GB",name:"Great Britain",sortName:"Great Britain",colours:["#284180","#cec1c1","#b13443"]},{id:5,short:"VP",name:"Verenigde Provinciën",sortName:"Verenigde Provinciën",colours:["#9d3841","#3b5688","#cec1c1"]},{id:6,short:"DK",name:"Danmark-Norge",sortName:"Danmark-Norge",colours:["#9c294b","#cec1c1"]},{id:7,short:"SE",name:"Sverige",sortName:"Sverige",colours:["#287099","#cdad28"]},{id:8,short:"US",name:"United States",sortName:"United States",colours:["#282873","#cec1c1","#a72e47"]},{id:9,short:"FT",name:"Free Town",sortName:"Free Town",colours:["#cec1c1"]},{id:10,short:"RU",name:"Russian Empire",sortName:"Russian Empire",colours:["#284e98","#cec1c1"]},{id:11,short:"DE",name:"Kingdom of Prussia",sortName:"Prussia",colours:["#352828","#cec1c1"]},{id:12,short:"PL",name:"Commonwealth of Poland",sortName:"Poland",colours:["#c22839","#cec1c1"]},{id:13,short:"CN",name:"China",sortName:"China",colours:["#cdad3b","#ce2828"]}],u=new Map(c.map((e=>[e.id,e]))),m=(new Map([["Arenas","Cayos del Golfo"],["Ays","Costa del Fuego"],["Baracoa","Baracoa"],["Basse-Terre","Basse-Terre"],["Belize","Belize"],["Black River","North Mosquito"],["Bluefields","South Mosquito"],["Brangman’s Bluff","Royal Mosquito"],["Bridgetown","Windward Isles"],["Calobelo","Portobelo"],["Campeche","Campeche"],["Cap-Français","Cap-Français"],["Caracas","Caracas"],["Cartagena de Indias","Cartagena"],["Castries","Sainte-Lucie"],["Caymans","George Town"],["Charleston","South Carolina"],["Christiansted","Vestindiske Øer"],["Cumaná","Cumaná"],["Fort-Royal","Martinique"],["Gasparilla","Costa de los Calos"],["George Town","Caymans"],["George’s Town","Exuma"],["Gibraltar","Lago de Maracaibo"],["Grand Turk","Turks and Caicos"],["Gustavia","Gustavia"],["Islamorada","Los Martires"],["Kidd’s Harbour","Kidd’s Island"],["Kingston / Port Royal","Surrey"],["La Bahía","Texas"],["La Habana","La Habana"],["Les Cayes","Les Cayes"],["Maracaibo","Golfo de Maracaibo"],["Marsh Harbour","Abaco"],["Matina","Costa Rica"],["Morgan’s Bluff","Andros"],["Mortimer Town","Inagua"],["Nassau","New Providence"],["Nouvelle-Orléans","Louisiane"],["Nuevitas","Nuevitas del Principe"],["Old Providence","Providencia"],["Omoa","Comayaqua"],["Oranjestad","Bovenwinds"],["Pampatar","Margarita"],["Pedro Cay","South Cays"],["Penzacola","Florida Occidental"],["Pinar del Río","Filipina"],["Pitt’s Town","Crooked"],["Pointe-à-Pitre","Grande-Terre"],["Ponce","Ponce"],["Port-au-Prince","Port-au-Prince"],["Portobelo","Portobelo"],["Puerto de España","Trinidad"],["Puerto Plata","La Vega"],["Remedios","Los Llanos"],["Roseau","Dominica"],["Saint George’s Town","Bermuda"],["Saint John’s","Leeward Islands"],["Salamanca","Bacalar"],["San Agustín","Timucua"],["San Juan","San Juan"],["San Marcos","Apalache"],["Santa Fe","Isla de Pinos"],["Santa Marta","Santa Marta"],["Santiago de Cuba","Ciudad de Cuba"],["Santo Domingo","Santo Domingo"],["Santo Tomé de Guayana","Orinoco"],["Savanna la Mar","Cornwall"],["Savannah","Georgia"],["Sisal","Mérida"],["Soto La Marina","Nuevo Santander"],["Spanish Town","Virgin Islands"],["Trinidad","Quatro Villas"],["Vera Cruz","Vera Cruz"],["West End","Grand Bahama"],["Willemstad","Benedenwinds"],["Wilmington","North Carolina"]]),e=>c.some((t=>t.short===e))),g=e=>void 0!==e&&0===Object.getOwnPropertyNames(e).length,f=e=>e.charAt(0).toUpperCase()+e.slice(1),v=e=>c.find((t=>t.short===e)),w=e=>u.get(e);class b extends Map{constructor(...e){var t,a,s;super(...e),t=this,a="map",s=new Map,a in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s}set(e,t){return this.map.set(JSON.stringify(e),t),this}get(e){return this.map.get(JSON.stringify(e))}clear(){this.map.clear()}delete(e){return this.map.delete(JSON.stringify(e))}has(e){return this.map.has(JSON.stringify(e))}get size(){return this.map.size}forEach(e,t){for(const[a,s]of this.map.entries())e.call(t,s,JSON.parse(a),this)}}const D=async e=>new Promise((t=>setTimeout(t,e))),y=e=>{let t=i()().utc().hour(p.WF).minute(0).second(0);const a=i()().utc();return(e<0&&a.isBefore(t)||e>0&&a.isAfter(t))&&(t=i().utc(t).add(e,"day")),t},S=()=>y(-1),C=()=>y(1),_=(S().format("YYYY-MM-DD HH:mm"),S().format("YYYY-MM-DD")),$=(String(i()(_).year()),String(i()(_).month()+1).padStart(2,"0"),e=>(t,a)=>{let s=0;return e.some((e=>{let i=1;return String(e).startsWith("-")&&(i=-1,e=String(e).slice(1)),s=Number.isNaN(Number(t[e]))&&Number.isNaN(Number(a[e]))?String(t[e]).localeCompare(String(a[e]))*i:(Number(t[e])-Number(a[e]))*i,0!==s})),s}),M=(e,t)=>e&&t?e.localeCompare(t):0},1460:(e,t,a)=>{a.d(t,{NH:()=>s,Oy:()=>r});const s=["eu1","eu2"],i=[{id:"eu1",name:"War",type:"PVP",icon:"war"},{id:"eu2",name:"Peace",type:"PVE",icon:"peace"}],r=e=>i.find((t=>t.id===e)).type},4332:(e,t,a)=>{a.d(t,{tJ:()=>s,y7:()=>i,pe:()=>r,Kf:()=>o});const s=["item","loot","chest","fish"],i=["crew","gunnery","hull","mast","sailing"],r=["regular","seasoned","exceptional"],o=["frame","trim"]},1801:(e,t,a)=>{var s={"./CN.svg":3889,"./DE.svg":1253,"./DK.svg":9951,"./ES.svg":1838,"./FR.svg":3508,"./FT.svg":791,"./GB.svg":5298,"./NT.svg":5802,"./PL.svg":2617,"./PR.svg":9315,"./RU.svg":6317,"./SE.svg":1933,"./US.svg":1952,"./VP.svg":6715};function i(e){var t=r(e);return a(t)}function r(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=r,e.exports=i,i.id=1801},1273:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 146.5 386.1'%3e%3cpath fill='%23666542' d='m73.5 382.8 25 .1 25 .1c19.6-73.9 24.6-165.2 15.9-239.9S108.4 10.4 73.5 3H73C38.1 10.4 15.8 68.5 7.1 143.2S3.4 309.1 23 383l25-.1 25-.1'/%3e%3c/svg%3e"},3889:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' height='480' width='640' viewBox='0 0 640 480'%3e%3cpath fill='%23cdad3b' d='M0 0h640v480H0z'/%3e%3ccircle cx='30%25' cy='40%25' fill='%23ce2828' r='100'/%3e%3c/svg%3e"},1253:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='640' height='480' viewBox='0 0 640 480'%3e%3cpath fill='%23cec1c1' d='M0 240h640v240H0z'/%3e%3cpath fill='%23352828' d='M0 0h640v240H0z'/%3e%3c/svg%3e"},9951:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' height='480' width='640' viewBox='0 0 640 480'%3e%3cpath fill='%239c294b' d='M0 0h640v480H0z'/%3e%3cpath fill='%23cec1c1' d='M207.57 0h69.19v480h-69.19z'/%3e%3cpath fill='%23cec1c1' d='M0 207.57h640v68.57H0z'/%3e%3c/svg%3e"},1838:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='640' height='480' viewBox='0 0 640 480'%3e%3cpath d='M0 0h640v480H0V0Z' fill='%239b3438'/%3e%3cpath d='M0 120h640v240H0V120Z' fill='%23c5a528'/%3e%3c/svg%3e"},3508:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' height='480' width='640' viewBox='0 0 640 480'%3e%3cpath fill='%23cec1c1' d='M0 0h640v480H0z'/%3e%3cpath fill='%23284e98' d='M0 0h213.337v480H0z'/%3e%3cpath fill='%23b5423a' d='M426.662 0H640v480H426.662z'/%3e%3c/svg%3e"},791:e=>{e.exports="data:image/svg+xml,%3csvg width='1em' height='1em' viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='%23cec1c1' d='M8 0a1 1 0 0 1 1 1v5.268l4.562-2.634a1 1 0 1 1 1 1.732L10 8l4.562 2.634a1 1 0 1 1-1 1.732L9 9.732V15a1 1 0 1 1-2 0V9.732l-4.562 2.634a1 1 0 1 1-1-1.732L6 8 1.438 5.366a1 1 0 0 1 1-1.732L7 6.268V1a1 1 0 0 1 1-1z'/%3e%3c/svg%3e"},5298:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='640' height='480' viewBox='0 0 640 480'%3e%3cpath fill='%23cec1c1' d='M0 0h640v480H0z'/%3e%3cpath d='M0 0v210h290V0z' fill='%23284180'/%3e%3cpath d='m0 0 290 210m0-210L0 210' stroke='%23cec1c1' stroke-width='28'/%3e%3cpath d='M145 0v210M0 105h290' stroke='%23cec1c1' stroke-width='68'/%3e%3cpath d='M145 0v210M0 105h290' stroke='%23b13443' stroke-width='40'/%3e%3cpath d='M0 240h640M320 0v480' stroke='%23b13443' stroke-width='60'/%3e%3c/svg%3e"},5802:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' height='480' width='640' viewBox='0 0 640 480'%3e%3cpath fill='%23cec1c1' d='M0 0h640v480H0z'/%3e%3c/svg%3e"},2617:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' height='480' width='640' viewBox='0 0 640 480'%3e%3cpath fill='%23c22839' d='M0 0h640v160H0z'/%3e%3cpath fill='%23cec1c1' d='M0 160h640v160H0z'/%3e%3cpath fill='%23c22839' d='M0 320h640v160H0z'/%3e%3c/svg%3e"},9315:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='640' height='480' viewBox='0 0 640 480'%3e%3cpath fill='%23352828' d='M0 0h640v480H0z'/%3e%3cpath d='M256.68 174.49c3-9 0-25 1-35 1-6 5-12 8-18 2-6 5-14 12-16-2 6-3 6-5 11l-3 11c-2 5-5 7-6 12-2 7-1 24-1 32 0 2 0 5-2 7-3 4-12 1-11 11 0 1 0 3 1 4 4 9 20 12 28 16 8 5 6 10 14 15 8 6 29 6 39 5 3-1 8-1 11-3 8-3 9-11 17-16 6-3 19-5 25-14a7.58 7.58 0 0 0 2-4c3-11-10-7-13-14-2-5 1-21 2-26l3 3v9l1 10c11-2 10-15 11-24 2-24 2-39-15-58-10-10-23-18-37-20h-9l-7-1-8 1c-13 1-22 1-33 7-8 4-13 9-19 16-15 16-18 36-15 57 1 8 3 17 9 22Zm33-30c14-1 24 9 19 23-4 9-13 16-23 18-9 1-13-5-13-13 0-13 2-24 17-28Zm56 0c12 0 18 10 19 21 0 3 1 6 1 8-1 7-8 12-15 13-11 0-24-17-23-27 2-9 10-13 18-15Zm-18 61-11-2-9 3c-1-7 2-17 5-24 1-2 3-6 5-7 4-1 5 4 5 6 2 8 5 16 5 24Z' fill='%23cec1c1'/%3e%3cpath d='M366.68 221.49c-3 1-7 1-10 3-10 7-5 24-14 35-4 5-13 7-20 7-13 0-29-1-35-14-5-9 2-18-9-29-2-1-5-4-7-4-3 0-2 4-2 6l1 20c0 15 4 15 11 24 4 6 7 12 14 15 9 3 19 3 28 2 7 0 11 1 18-3s19-20 21-28l1-14c2-10 3-8 3-20Zm183-104c-15 21-31.27 38.79-49 60l-24 27c-20 19-70 56-93 71-13 9-27 16-41 22l-18.26 8.84c3 3 8.58 4.64 13.63 7 3 0 13.63-5.84 16.63-7.84l32-18c6-4 12-9 19-10-3 7-10 11-17 15l-19 11s-20 11.37-22.68 13.26c5.47 2.16 13.68 4.64 18.89 6.74 5 0 11.79-5 15.79-7a361.13 361.13 0 0 0 36-23l18-12a459.22 459.22 0 0 0 41-36c10-9 20-18 28-29 11-13 18-28 26-43 9-14 12-23 17-38 1-5 4-13 2-18Z' fill='%23cec1c1'/%3e%3cpath d='M90.68 112.49c-3 11 1 24 5 34 9 24 24 45 39 65 9 13 24 29 35 40l12 10 26 23c21 16 60 40 84 51l32 14 13 5a241.71 241.71 0 0 0 46 13c9 2 19 5 28 5-3-11-9-10-18-13l-33-13c-46-19-97-38-133-74 7 0 12 6 17 10 7 5 16 11 24 16 22 13 72 36 97 45 10 4 27 11 37 11 8 1 19-4 25-8-4-4-8-3-14-4l-31-9a369.65 369.65 0 0 1-78-30l-14-6-19-12-23-15-24-19-41-32-38-39-19-22-20-22-15-24Z' fill='%23cec1c1'/%3e%3cpath d='M411.68 359.49c2 4 6 10 6 15 0 11-13 21-23 20-4-1-13-6-16 0-1 2-1 4 0 5 0 4 5 6 9 8 11 3 23-1 32-7a30.22 30.22 0 0 0 14-19l2-13c1-4 5-5 10-12 6-8 12-22 20-28a30 30 0 0 1 10-4c-2-3-4-5-6-8-2-1-4-3-6-3a11.83 11.83 0 0 0-10 1c-14 7-11 20-19 30-6 8-13 12-23 15Z' fill='%23cec1c1'/%3e%3cpath d='M443.68 372.49c7 3 13 2 20 2l15 1c7 0 9-4 12-10 1-2 2-6 0-8s-6-2-9-2l-17 1c-3 0-8 0-11 1-5 3-9 10-10 15Zm54 14c-5-2-8-4-11-8-1 1-2 1-3 2-1 5 12 17 14 6Z' fill='%23cec1c1'/%3e%3cpath d='m490.68 352.49 8 5c-2 4-7 12-6 17 1 10 15 10 21 4 7-8 7-20-3-26-6-3-13-2-20 0Zm-359 28 1 1c8-2 13-5 14-13-6 1-12 7-15 12Zm7-37a16.89 16.89 0 0 0-10-3 27.69 27.69 0 0 0-9 1c-10 4-11 20-3 27 4 4 14 6 18 1 4-4 3-9 1-14-1-3-3-7-1-9 1-2 3-2 4-3Z' fill='%23cec1c1'/%3e%3cpath d='M137.68 347.49c1 3 6 15 8 17 3 2 6 2 9 2l18-1h13c0-3 0-6-1-8-3-8-14-12-22-12l-9 1c-6 0-11-1-16 1Z' fill='%23cec1c1'/%3e%3cpath d='M156.68 315.49c19 5 19 21 27 32 3 4 11 10 12 14 1 3 0 4 1 11a37.65 37.65 0 0 0 16 23c9 6 17 10 28 7 6-2 12-6 9-13s-14 0-21-2c-7-3-15-13-15-21l4-14c-11-4-24-13-29-24-3-7-3-17-8-22-9-7-21-1-24 9Z' fill='%23cec1c1'/%3e%3cpath d='M204.68 338.49c3 4 5 5 9 7 14 8 23 2 37-1l29-9c-3.84-2.58-12.42-8-16-10l-19 5Zm14 29c26 0 50-8 75-14 0 0 11-5.21 14.68-5.21-3.47-2.53-17.62-7.64-19.84-9.63-3 .89-14.84 4.84-18.84 5.84l-25 7-12 3c-7 3-12 4-14 13Zm77-115c0 2.5.25 5.54 1.25 7s4.76 1.64 5.75 1c.81-.82-.75-4.75-1.62-5.87s-2.38-1.65-5.38-2.13Zm8 1 1 5a7.58 7.58 0 0 0 2 4c4 2 6-8 3-9-2-1-4 0-6 0Zm12 1a5.87 5.87 0 0 0-2 7.6c1.13 1.88 3.46 1.9 5 1.4 1-.5 2.5-3 2.63-5.25s-1.13-4.27-5.63-3.75Zm-11-13c2.7 1.4 7.17-.09 7.17-.09l-.17-5.91c-1-4-4-5-6-3-1 2-1 7-1 9Zm15-10c-1 0-4.13-.52-5.13.48-2 2-2.87 8.52.13 10.52 1.87.48 5 .91 6-3.09v-2.91a13.49 13.49 0 0 0-1-5Zm10 32c.91.39 2-1 3-2 7-7-7.56-12.61-5-2 0 0 .96 3.83 2 4Zm-28.26-33c-1-.35-2.74 0-3.74 0-7.78 3.52 2 17 5 8v-3s-.56-4.65-1.26-5Zm22.26 1s-1.7 10.13-1 11c1.31.7 5.34.52 6.83-.52 0-3 .18-6.5-.42-8.33s-1.91-1.64-5.41-2.14Zm9.57-1.17-.56 5.17c0 3 .65 8.83 4.65 5.83.5-.5 1.85-6.45 1.3-9.16-1.04-1.46-2.92-1.6-5.39-1.84Z' fill='%23cec1c1'/%3e%3c/svg%3e"},6317:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='640' height='480' viewBox='0 0 640 480'%3e%3cpath fill='%23cec1c1' d='M0 0h640v480H0z'/%3e%3cpath style='stroke:%23284e98%3bstroke-miterlimit:10%3bstroke-width:60px' d='m0 0 640 480M0 480 640 0'/%3e%3c/svg%3e"},1933:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' height='480' width='640' viewBox='0 0 640 480'%3e%3cpath fill='%23287099' d='M0 0h640v480H0z'/%3e%3cpath fill='%23cdad28' d='M207.57 0h69.19v480h-69.19z'/%3e%3cpath fill='%23cdad28' d='M0 207.57h640v68.57H0z'/%3e%3c/svg%3e"},1952:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='640' height='480' viewBox='0 0 640 480'%3e%3cpath fill='%23a72e47' d='M0 384h640v32H0zm0-64h640v32H0zm0-64h640v32H0zm0-64h640v32H0zm0-64h640v32H0zm0-64h640v32H0zm0 384h640v32H0zM0 0h640v32H0z'/%3e%3cpath fill='%23cec1c1' d='M0 416h640v32H0zm0-64h640v32H0zm0-64h640v32H0zm0-64h640v32H0zm0-64h640v32H0zm0-64h640v32H0zm0-64h640v32H0z'/%3e%3cpath fill='%23282873' d='M0 0h256v256H0z'/%3e%3cpath d='m76.41 69.32-4 8.11 4.13 8-7.64-2.1-5.05 7.22-.7-9.41-7.28-3.54 7.21-3.71.57-9.42 5.17 7.12Zm0 85.91-4 8.11 4.13 8-7.64-2.1-5.05 7.22-.7-9.41-7.26-3.6 7.21-3.71.57-9.42 5.17 7.12Zm71.74-85.91-4 8.11 4.13 8-7.64-2.1-5.05 7.22-.7-9.41-7.26-3.57 7.21-3.71.57-9.42 5.17 7.12Zm0 85.91-4 8.11 4.13 8-7.64-2.1-5.05 7.22-.7-9.41-7.26-3.6 7.21-3.71.57-9.42 5.17 7.12Zm71.74-85.91-4 8.11 4.13 8-7.64-2.1-5.05 7.22-.7-9.41-7.26-3.57 7.21-3.71.57-9.42 5.17 7.12Zm0 85.91-4 8.11 4.13 8-7.64-2.1-5.05 7.22-.7-9.41-7.26-3.6 7.21-3.71.57-9.42 5.17 7.12ZM20.13 42.08l4-8.11-4.14-8L27.64 28l5.05-7.22.7 9.41 7.26 3.57-7.21 3.71-.57 9.42-5.17-7.12Zm0 85.92 4-8.11-4.14-8 7.64 2.1 5.05-7.22.7 9.41 7.26 3.57-7.21 3.71-.57 9.42-5.17-7.12Zm0 87.05 4-8.11-4.15-8 7.64 2.1 5.05-7.22.71 9.4 7.26 3.57-7.21 3.71-.57 9.42-5.17-7.12ZM91.87 42l4-8.11-4.15-8 7.64 2.1 5.05-7.22.7 9.41 7.26 3.57-7.21 3.71-.57 9.42-5.17-7.12Zm0 85.86 4-8.11-4.13-8 7.64 2.1 5.05-7.22.7 9.41 7.26 3.57-7.21 3.71-.57 9.42-5.17-7.12Zm0 87.07 4-8.11-4.13-8 7.64 2.1 5.05-7.22.7 9.41 7.26 3.57-7.21 3.71-.57 9.42-5.17-7.12ZM163.6 41.15l4-8.11-4.15-8 7.64 2.1 5.05-7.22.7 9.41 7.26 3.57-7.21 3.68-.53 9.42-5.17-7.12Zm0 85.9 4-8.11-4.15-8 7.64 2.1 5.05-7.22.71 9.4 7.26 3.57-7.21 3.71-.57 9.42-5.17-7.12Zm0 87.04 4-8.11-4.13-8 7.64 2.1 5.05-7.22.7 9.41 7.26 3.57-7.21 3.71-.53 9.45-5.17-7.12Z' fill='%23cec1c1'/%3e%3c/svg%3e"},6715:e=>{e.exports="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' height='480' width='640' viewBox='0 0 640 480'%3e%3cpath fill='%239d3841' d='M0 0h640v160H0z'/%3e%3cpath fill='%23cec1c1' d='M0 160h640v160H0z'/%3e%3cpath fill='%233b5688' d='M0 320h640v160H0z'/%3e%3c/svg%3e"},5311:e=>{e.exports=jQuery}},e=>{e.O(0,[496],(()=>{return t=4941,e(e.s=t);var t}));e.O()}]);