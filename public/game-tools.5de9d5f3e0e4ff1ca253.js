/*! For license information please see game-tools.5de9d5f3e0e4ff1ca253.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{159:function(t,e,s){s.r(e),s.d(e,"init",(function(){return v}));var i=s(340),a=s.n(i),n=s(37),o=s(20),r=s(207),d=s(273),c=s(365),l=s(366),h=s(368),u=s(369),b=s(370),_=s(371),p=s(376),m=s(377),f=s(378),g=s(379);const v=(t,e)=>{const s=new r.a("ship-compare");(()=>{if(e.has("cmp")&&e.has("v")){const t=e.get("v");t&&a.a.lte(t,o.d)&&(Object(n.b)("Menu","Paste ship compare"),s.initFromClipboard(e))}})();new d.a("wood"),new g.a,new c.a,new l.a,new h.a,new u.a,new b.a,new _.a,new p.a(t),new m.a,new f.a}},365:function(t,e,s){(function(t){s.d(e,"a",(function(){return l}));s(98),s(25),s(160),s(163);var i=s(155),a=(s(171),s(37)),n=s(20),o=s(38),r=s(162),d=s(169);function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class l{constructor(){c(this,"_baseName",void 0),c(this,"_baseId",void 0),c(this,"_buttonId",void 0),c(this,"_modalId",void 0),c(this,"_buildingData",void 0),this._baseName="List buildings",this._baseId="building-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._buildingData=[],this._setupListener()}async _loadAndSetupData(){try{this._buildingData=(await s.e(2).then(s.t.bind(null,381,3))).default}catch(t){Object(o.e)(t)}}_setupListener(){let t=!0;document.querySelector("#"+this._buttonId).addEventListener("click",async e=>{t&&(t=!1,await this._loadAndSetupData()),Object(a.b)("Tools",this._baseName),e.stopPropagation(),this._buildingListSelected()})}_injectModal(){Object(n.u)({id:this._modalId,title:this._baseName});const t=this._baseId+"-select",e=Object(i.a)("#"+this._modalId+" .modal-body");e.append("label").attr("for",t),e.append("select").attr("name",t).attr("id",t),e.append("div").attr("id",""+this._baseId).attr("class","container-fluid")}_getOptions(){return""+this._buildingData.sort(Object(d.c)(["name"])).map(t=>'<option value="'+t.name+'">'+t.name+"</option>;").join("")}_setupSelect(){const e=t("#"+this._baseId+"-select"),s=this._getOptions();e.append(s)}_setupSelectListener(){const e=t("#"+this._baseId+"-select");e.addClass("selectpicker").on("change",t=>this._buildingSelected(t)).selectpicker({noneSelectedText:"Select building"}),e.val("default").selectpicker("refresh")}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_buildingListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getBuildingData(t){return this._buildingData.filter(e=>e.name===t)[0]}_getProductText(t){let e="";return t.result&&(t.result.length>1?(e+='<table class="table table-sm"><tbody>',e+="<tr><td>"+t.result.map(t=>t.name).join("</td></tr><tr><td>")+"</td></tr>",e+="</tbody></table>"):(e+='<h5 class="card-title">'+t.result[0].name+"</h5>",t.result[0].price&&(e+='<table class="table table-sm card-table"><tbody>',e+="<tr><td>"+Object(n.n)(t.result[0].price)+" per unit</td></tr>",t.batch&&(e+="<tr><td>"+t.batch.labour+" labour hour"+(t.batch.labour>1?"s":"")+" per unit</td></tr>"),e+="</tbody></table>"))),e}_getRequirementText(t){let e="";if(e+='<table class="table table-sm card-table"><thead>',t.levels[0].materials.length>0){e+="<tr><th>Level</th><th>Level build materials</th><th>Build price (reals)</th></tr>",e+="</thead><tbody>";for(const s of t.levels){e+="<tr><td>"+(t.levels.indexOf(s)+1)+'</td><td class="text-left">',e+=s.materials.map(t=>Object(r.e)(t.amount)+" "+t.item).join("<br>"),e+="</td>",e+="<td>"+Object(r.e)(s.price)+"</td>",e+="</tr>"}}else{e+="<tr><th>Level</th><th>Production</th><th>Labour cost (%)</th><th>Storage</th><th>Build price (reals)</th></tr>",e+="</thead><tbody>";for(const s of t.levels){e+="<tr><td>"+(t.levels.indexOf(s)+1)+"</td><td>"+Object(r.e)(s.production)+"</td><td>"+Object(r.e)(-100*s.labourDiscount)+"</td><td>"+Object(r.e)(s.maxStorage)+"</td><td>"+Object(r.e)(s.price)+"</td></tr>"}}return e+="</tbody></table>",e}_getText(t){const e=this._getBuildingData(t);let s='<div class="row no-gutters card-deck">';return s+='<div class="card col-5"><div class="card-header">Product</div>',s+='<div class="card-body product">',s+=this._getProductText(e),s+="</div></div>",s+='<div class="card col-7"><div class="card-header">Requirements</div>',s+='<div class="card-body px-0 requirements">',s+=this._getRequirementText(e),s+="</div></div>",s+="</div>",s}_buildingSelected(e){const s=String(t(e.currentTarget).find(":selected").val());Object(i.a)("#"+this._baseId+" div").remove(),Object(i.a)("#"+this._baseId).append("div").classed("buildings mt-4",!0),Object(i.a)("#"+this._baseId+" div").html(this._getText(s))}}}).call(this,s(51))},366:function(t,e,s){(function(t){s.d(e,"a",(function(){return M}));s(99),s(98),s(97),s(53),s(185),s(100),s(101),s(102),s(103),s(104),s(105),s(106),s(107),s(108),s(109),s(110),s(111),s(112),s(25),s(160),s(367),s(163);var i=s(56),a=s(276),n=s(58),o=s.n(n),r=s(37),d=s(38),c=s(20),l=s(162);function h(){const t=w(['\n            <button type="button" class="btn btn-secondary" data-dismiss="modal">\n                Close\n            </button>\n        ']);return h=function(){return t},t}function u(){const t=w(['\n                            <div\n                                class="tab-pane fade','"\n                                id="tab-content-',"-",'"\n                                role="tabpanel"\n                                aria-labelledby="tab-',"-",'"\n                            >\n                                <div id="','-list" class="modules">\n                                    ',"\n                                </div>\n                            </div>\n                        "]);return u=function(){return t},t}function b(){const t=w(['\n                            <li class="nav-item">\n                                <a\n                                    class="nav-link','"\n                                    id="tab-',"-",'"\n                                    data-toggle="tab"\n                                    href="#tab-content-',"-",'"\n                                    role="tab"\n                                    aria-controls="home"\n                                    aria-selected="true"\n                                    >',"</a\n                                >\n                            </li>\n                        "]);return b=function(){return t},t}function _(){const t=w(['\n            <ul class="nav nav-pills" role="tablist">\n                ','\n            </ul>\n            <div class="tab-content pt-2">\n                ',"\n            </div>\n        "]);return _=function(){return t},t}function p(){const t=w(["\n                                <tr>\n                                    ","","\n                                </tr>\n                            "]);return p=function(){return t},t}function m(){const t=w(['\n            <table id="table-','-list" class="table table-sm small tablesort">\n                <thead>\n                    <tr>\n                        <th scope="col" class="border-bottom-0"></th>\n                        ','\n                    </tr>\n                    <tr data-sort-method="thead">\n                        <th scope="col" class="text-right border-top-0" data-sort-default>Lb</th>\n                        ',"\n                    </tr>\n                </thead>\n                <tbody>\n                    ","\n                </tbody>\n            </table>\n        "]);return m=function(){return t},t}function f(){const t=w(['\n                            <td class="text-right" data-sort="','">\n                                ',"\n                            </td>\n                        "]);return f=function(){return t},t}function g(){const t=w([""]);return g=function(){return t},t}function v(){const t=w(["\n            ","\n        "]);return v=function(){return t},t}function j(){const t=w(['\n                <th scope="row" class="text-right" data-sort="','">\n                    ',"\n                </th>\n            "]);return j=function(){return t},t}function y(){const t=w(["","<br /><em>","</em>"]);return y=function(){return t},t}function O(){const t=w(['<th class="text-right">',"</th>"]);return O=function(){return t},t}function S(){const t=w(["\n            ","\n        "]);return S=function(){return t},t}function I(){const t=w(['\n            <th scope="col" class="text-center" colspan="','">\n                ',"\n            </th>\n        "]);return I=function(){return t},t}function w(t,e){return e||(e=t.slice(0)),t.raw=e,t}function x(t){return function(t){if(Array.isArray(t))return L(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return L(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(s);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return L(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}function D(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class M{constructor(){D(this,"_cannonData",{}),D(this,"_baseName",void 0),D(this,"_baseId",void 0),D(this,"_buttonId",void 0),D(this,"_modalId",void 0),D(this,"_groups",void 0),this._groups=new Map,this._baseName="List cannons",this._baseId="cannon-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{const t=(await s.e(3).then(s.t.bind(null,382,3))).default;this._setupData(t)}catch(t){Object(d.e)(t)}}_setupData(t){for(const e of t.long)for(const[t,s]of Object.entries(e))"name"!==t&&this._groups.set(t,{values:s,count:Object.entries(s).length});const e=["name","damage","penetration","dispersion","traverse","generic"];for(const s of d.a)this._cannonData[s]=t[s].map(t=>Object.keys(t).sort((t,s)=>e.indexOf(t)-e.indexOf(s)).reduce((e,s)=>(e[s]=t[s],e),{}));this._groups=new Map(x(this._groups.entries()).sort((t,s)=>e.indexOf(t[0])-e.indexOf(s[0])))}_setupListener(){var t;let e=!0;null==(t=document.querySelector("#"+this._buttonId))||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(r.b)("Tools",this._baseName),t.stopPropagation(),this._cannonListSelected()})}_getList(t){return Object(i.d)(m(),t,Object(a.a)(this._groups,(t,e)=>e,t=>(t=>Object(i.d)(I(),t[1].count,Object(d.b)(t[0])))(t)),Object(a.a)(this._groups,(t,e)=>e,t=>(t=>Object(i.d)(S(),Object.entries(t[1].values).map(t=>Object(i.d)(O(),Object(d.b)(t[0])))))(t)),Object(a.a)(this._cannonData[t],t=>t.name,t=>Object(i.d)(p(),(t=>{let e=t;const s=t.split(" (");return s.length>1&&(e=Object(i.d)(y(),s[0],s[1].replace(")",""))),Object(i.d)(j(),Number.parseInt(t,10),e)})(t.name),(t=>Object(i.d)(v(),Object.entries(t).map(t=>"name"===t[0]?Object(i.d)(g()):Object.entries(t[1]).map(t=>{var e;return Object(i.d)(f(),null!==(e=t[1].value)&&void 0!==e?e:0,t[1]?Object(l.d)(t[1].value,t[1].digits):"")}))))(t))))}_getModalBody(){return Object(i.d)(_(),Object(a.a)(Object.keys(this._cannonData),t=>t,(t,e)=>Object(i.d)(b(),0===e?" active":"",this._baseId,t,this._baseId,t,Object(d.b)(t))),Object(a.a)(Object.keys(this._cannonData),t=>t,(t,e)=>Object(i.d)(u(),0===e?" show active":"",this._baseId,t,this._baseId,t,t,this._getList(t))))}_getModalFooter(){return Object(i.d)(h())}_injectModal(){Object(i.f)(Object(c.v)({id:this._modalId,title:this._baseName,body:this._getModalBody.bind(this),footer:this._getModalFooter}),document.querySelector("#modal-section"));for(const t of Object.keys(this._cannonData)){const e=document.querySelector("#table-"+t+"-list");if(e){new o.a(e)}}}_initModal(){Object(c.t)(),this._injectModal()}_cannonListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}}}).call(this,s(51))},368:function(t,e,s){(function(t){s.d(e,"a",(function(){return b}));s(99),s(98),s(97),s(25),s(160),s(163),s(215);var i=s(155),a=s(37),n=s(38),o=s(20),r=s(162),d=s(169),c=s(168);function l(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(s);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return h(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}function u(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class b{constructor(){u(this,"_baseName",void 0),u(this,"_baseId",void 0),u(this,"_buttonId",void 0),u(this,"_modalId",void 0),u(this,"_moduleData",{}),u(this,"_ingredientData",{}),this._baseName="List recipe ingredients",this._baseId="ingredient-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{this._moduleData=(await s.e(5).then(s.t.bind(null,224,3))).default,this._ingredientData=(await s.e(10).then(s.t.bind(null,281,3))).default.ingredient}catch(t){Object(n.e)(t)}}_setupListener(){var t;let e=!0;null==(t=document.querySelector("#"+this._buttonId))||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(a.b)("Tools",this._baseName),t.stopPropagation(),this._ingredientListSelected()})}_injectModal(){Object(o.u)({id:this._modalId,title:this._baseName}),Object(i.a)("#"+this._modalId+" .modal-body").append("div").attr("id",""+this._baseId).attr("class","container-fluid")}_initModal(){this._injectModal(),this._injectList()}_ingredientListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getProperties(t){let e="",s="",i="";for(const e of this._moduleData){const a=e[1].sort(Object(d.c)(["name"])).filter(e=>e.name===t);for(const t of a)s=e[0],i="<tr><td>"+t.properties.map(t=>{const e=t.isPercentage?Object(r.m)(t.amount/100):Object(r.l)(t.amount);return t.modifier+" "+e}).join("</td></tr><tr><td>")+"</td></tr>"}return e="<h6 class='text-muted text-left'>"+s+"</h6>",e+="<table class='table table-sm'><tbody>"+i+"</tbody></table>",i?e:""}_getRows(){return this._ingredientData.map(t=>"<tr><td>"+t.name+"</td><td>"+t.recipeNames.map(t=>{const e=this._getProperties(t);return e?'<a data-toggle="tooltip" title="'+e+'">'+t+"</a>":t}).join("<br>")+"</td></tr>")}_getText(){const t=this._getRows(),e=Object(c.a)(t,2);let s="";for(const t of l(new Array(e.length).keys()))s+='<div class="col-md-'+Math.floor(12/e.length)+'">',s+='<table class="table table-sm"><thead>',s+="<tr><th>Ingredient</th><th>Recipes</th></tr></thead><tbody>",s+=e[t].join(""),s+="</tbody></table></div>";return s}_injectList(){Object(i.a)("#"+this._baseId+" div").remove(),Object(i.a)("#"+this._baseId).append("div").classed("row ingredients",!0),Object(i.a)("#"+this._baseId+" div").html(this._getText()),t('[data-toggle="tooltip"]').tooltip({html:!0,placement:"auto",sanitize:!1})}}}).call(this,s(51))},369:function(t,e,s){(function(t){s.d(e,"a",(function(){return L}));s(99),s(98),s(97),s(100),s(101),s(102),s(103),s(104),s(105),s(106),s(107),s(108),s(109),s(110),s(111),s(112),s(25),s(160),s(163),s(171);var i=s(56),a=s(276),n=s(37),o=s(162),r=s(20),d=s(38),c=s(169);function l(){const t=w(['\n            <div class="modules mt-4">\n                ',"\n            </div>\n        "]);return l=function(){return t},t}function h(){const t=w(["",""]);return h=function(){return t},t}function u(){const t=w(["\n            <p>Weight "," tons<br />Lifetime "," hours</p>\n            ","\n        "]);return u=function(){return t},t}function b(){const t=w(["",""]);return b=function(){return t},t}function _(){const t=w(["\n                                <tr>\n                                    <td>",'</td>\n                                    <td class="text-right">\n                                        ','\n                                    </td>\n                                    <td class="text-right">\n                                        ',"\n                                    </td>\n                                </tr>\n                            "]);return _=function(){return t},t}function p(){const t=w(['\n            <table class="table table-sm small">\n                <thead>\n                    <tr>\n                        <th scope="col">Item</th>\n                        <th scope="col" class="text-right">Chance (0 − 100)</th>\n                        <th scope="col" class="text-right">Amount</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ',"\n                </tbody>\n            </table>\n        "]);return p=function(){return t},t}function m(){const t=w(['\n            <button type="button" class="btn btn-secondary" data-dismiss="modal">\n                Close\n            </button>\n        ']);return m=function(){return t},t}function f(){const t=w(['\n                        <label>\n                            <select id="','" class="selectpicker">\n                                ',"\n                            </select>\n                        </label>\n                    "]);return f=function(){return t},t}function g(){const t=w(["\n            ",'\n            <div id="','"></div>\n        ']);return g=function(){return t},t}function v(){const t=w(['<option value="','">',"</option>"]);return v=function(){return t},t}function j(){const t=w(["\n            ",";\n        "]);return j=function(){return t},t}function y(t){return function(t){if(Array.isArray(t))return O(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(s);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return O(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}function S(){const t=w(['<option value="','">',"</option>"]);return S=function(){return t},t}function I(){const t=w(["\n                ","\n            "]);return I=function(){return t},t}function w(t,e){return e||(e=t.slice(0)),t.raw=e,t}function x(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class L{constructor(){x(this,"_baseName",void 0),x(this,"_baseId",void 0),x(this,"_buttonId",void 0),x(this,"_modalId",void 0),x(this,"_types",["loot","chests","items"]),x(this,"_sourceData",{}),x(this,"_selectedType",void 0),x(this,"_selectId",{}),x(this,"_select$",{}),x(this,"_selectedItemId",0),x(this,"_mainDiv",void 0),x(this,"_items",void 0),this._baseName="List loot and chests",this._baseId="loot-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId;for(const t of this._types)this._selectId[t]=this._baseId+"-"+t+"-select";this._selectedType="",this._setupListener()}static _getAmount(t){return t.min===t.max?Object(o.e)(t.min):Object(o.e)(t.min)+" to "+Object(o.e)(t.max)}static _getChance(t){return Object(o.e)(100*(1-t))}async _loadAndSetupData(){try{this._sourceData=(await s.e(4).then(s.t.bind(null,383,3))).default}catch(t){Object(d.e)(t)}}_setupListener(){var t;let e=!0;null==(t=document.querySelector("#"+this._buttonId))||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(n.b)("Tools",this._baseName),t.stopPropagation(),this._sourceListSelected()})}_getOptions(t){if("items"!==t)return Object(i.d)(I(),Object(a.a)(this._sourceData[t].sort(Object(c.c)(["name"])),t=>t.id,t=>Object(i.d)(S(),t.id,t.name)));const e=new Map,s=this._types.filter(t=>"items"!==t);for(const t of s)for(const s of this._sourceData[t])for(const t of s.items){const i=new Map([[s.id,{id:s.id,name:s.name,chance:t.chance,amount:t.amount}]]);e.set(t.id,{name:t.name,sources:e.has(t.id)?new Map([].concat(y(e.get(t.id).sources),y(i))):i})}return this._items=new Map(y(e.entries()).sort((t,e)=>t[1].name.localeCompare(e[1].name))),Object(i.d)(j(),Object(a.a)(this._items,(t,e)=>e,t=>Object(i.d)(v(),t[0],t[1].name)))}_getModalBody(){return Object(i.d)(g(),Object(a.a)(this._types,t=>t,t=>Object(i.d)(f(),this._selectId[t],this._getOptions(t))),this._baseId)}_getModalFooter(){return Object(i.d)(m())}_injectModal(){Object(i.f)(Object(r.v)({id:this._modalId,title:this._baseName,size:"md",body:this._getModalBody.bind(this),footer:this._getModalFooter}),document.querySelector("#modal-section"))}_setupSelectListeners(){for(const t of this._types)this._select$[t].on("change",()=>{this._selectedType=t,this._itemSelected()}).selectpicker({dropupAuto:!1,liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",title:"Select "+t,virtualScroll:!0})}_initModal(){this._injectModal(),this._mainDiv=document.querySelector("#"+this._baseId);for(const e of this._types)this._select$[e]=t("#"+this._selectId[e]);this._setupSelectListeners()}_sourceListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getItemData(t){return this._sourceData[this._selectedType].find(e=>e.id===t)}_getItemsText(t){return Object(i.d)(p(),Object(a.a)(t,t=>t.id,t=>Object(i.d)(_(),t.name,L._getChance(t.chance),L._getAmount(t.amount))))}_getLootText(t){return Object(i.d)(b(),this._getItemsText(t.items))}_getChestText(t){return Object(i.d)(u(),Object(o.e)(t.weight),Object(o.e)(t.lifetime),this._getItemsText(t.items))}_getSourceText(){const t=y(this._items.get(this._selectedItemId).sources).map(t=>t[1]).sort(Object(c.c)(["chance","name"]));return Object(i.d)(h(),this._getItemsText(t))}_resetOtherSelects(){const t=this._types.filter(t=>t!==this._selectedType);for(const e of t)this._select$[e].val("default").selectpicker("refresh")}_getText(){if("items"===this._selectedType)return this._getSourceText();const t=this._getItemData(this._selectedItemId);return t.items=t.items.sort(Object(c.c)(["chance","name"])),"loot"===this._selectedType?this._getLootText(t):this._getChestText(t)}_getTable(){return Object(i.d)(l(),this._getText())}_itemSelected(){const t=this._select$[this._selectedType].find(":selected");this._selectedItemId=Number(t.val()),this._resetOtherSelects(),Object(i.f)(this._getTable(),this._mainDiv)}}}).call(this,s(51))},370:function(t,e,s){(function(t){s.d(e,"a",(function(){return _}));s(99),s(98),s(97),s(100),s(101),s(102),s(103),s(104),s(105),s(106),s(107),s(108),s(109),s(110),s(111),s(112),s(25),s(160),s(163),s(171);var i=s(155),a=s(37),n=s(38),o=s(20),r=s(162),d=s(52),c=s(169),l=s(168);function h(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(s);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}function b(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class _{constructor(){b(this,"_baseName",void 0),b(this,"_baseId",void 0),b(this,"_buttonId",void 0),b(this,"_modalId",void 0),b(this,"_moduleData",{}),this._baseName="List modules",this._baseId="module-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{this._moduleData=(await s.e(5).then(s.t.bind(null,224,3))).default}catch(t){Object(n.e)(t)}}_setupListener(){var t;let e=!0;null==(t=document.querySelector("#"+this._buttonId))||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(a.b)("Tools",this._baseName),t.stopPropagation(),this._moduleListSelected()})}_injectModal(){Object(o.u)({id:this._modalId,title:this._baseName});const t=this._baseId+"-select",e=Object(i.a)("#"+this._modalId+" .modal-body");e.append("label").attr("for",t),e.append("select").attr("name",t).attr("id",t),e.append("div").attr("id",""+this._baseId).attr("class","container-fluid")}_getOptions(){return""+this._moduleData.map(t=>'<option value="'+t[0]+'"">'+t[0]+"</option>;").join("")}_setupSelect(){const e=t("#"+this._baseId+"-select"),s=this._getOptions();e.append(s)}_setupSelectListener(){t("#"+this._baseId+"-select").addClass("selectpicker").on("change",t=>this._moduleSelected(t)).selectpicker({noneSelectedText:"Select module category"}).val("default").selectpicker("refresh")}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_moduleListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getRows(t){const e=new Map([["L",Object(d.p)(1)+" – "+Object(d.p)(3)],["M",Object(d.p)(4)+" – "+Object(d.p)(5)],["S",Object(d.p)(6)+" – "+Object(d.p)(7)]]),s=t=>"U"===t?"":""+e.get(t);let i="";const a=[];for(const e of this._moduleData)e[0]===t&&e[1].sort(Object(c.c)(["name"])).forEach((t,n)=>{const o=s=>s<e[1].length&&t.name===e[1][s].name&&JSON.stringify(t.properties)===JSON.stringify(e[1][s].properties);i=s(t.moduleLevel),o(n+1)&&(e[1][n+1].hasSamePropertiesAsPrevious=!0,i+="<br>"+s(e[1][n+1].moduleLevel)),o(n+2)&&(e[1][n+2].hasSamePropertiesAsPrevious=!0,i=""),void 0!==t.hasSamePropertiesAsPrevious&&t.hasSamePropertiesAsPrevious||a.push('<tr><td><span class="name">'+t.name+"<br>"+i+"</span></td><td>"+t.properties.map(t=>{let e;return e=t.isPercentage?Object(r.m)(t.amount/100):t.amount<1&&t.amount>0?Object(r.g)(t.amount):Object(r.l)(t.amount),t.modifier+" "+e}).join("<br>")+"</td></tr>")});return a}_getText(t){const e=this._getRows(t),s=Object(l.a)(e,3);let i="";for(const t of h(new Array(s.length).keys()))i+='<div class="col-md-'+Math.floor(12/s.length)+'">',i+='<table class="table table-sm small"><thead>',i+="<tr><th>Module</th><th>Modifier</th></tr></thead><tbody>",i+=s[t].join(""),i+="</tbody></table></div>";return i}_moduleSelected(e){const s=t(e.currentTarget).find(":selected").val();Object(i.a)("#"+this._baseId+" div").remove(),Object(i.a)("#"+this._baseId).append("div").classed("row modules mt-4",!0),Object(i.a)("#"+this._baseId+" div").html(this._getText(s))}}}).call(this,s(51))},371:function(t,e,s){(function(t){s.d(e,"a",(function(){return y}));s(98),s(100),s(101),s(102),s(103),s(104),s(105),s(106),s(107),s(108),s(109),s(110),s(111),s(112),s(25),s(160),s(163),s(171);var i=s(372),a=s(238),n=s(216),o=s(235),r=s(253),d=s(213),c=s(251),l=s(174),h=s(155),u=s(425),b=s(375),_=s(419),p=s(420),m=s(389),f=s(37),g=s(38),v=s(20);function j(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class y{constructor(){j(this,"_baseName",void 0),j(this,"_baseId",void 0),j(this,"_buttonId",void 0),j(this,"_modalId",void 0),j(this,"_ownershipData",{}),j(this,"_nationData",{}),j(this,"_colourScale",void 0),j(this,"_mainDiv",void 0),j(this,"_div",void 0),j(this,"_svg",void 0),this._baseName="Port ownership",this._baseId="ownership-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._colourScale=Object(d.a)().range(v.h),this._setupListener()}static getHeight(){return Math.floor(.75*top.innerHeight)}_getWidth(){var t;return null!==(t=Math.floor(this._mainDiv.node().offsetWidth))&&void 0!==t?t:0}async _loadAndSetupData(){try{this._nationData=(await s.e(6).then(s.t.bind(null,384,3))).default,this._ownershipData=(await s.e(7).then(s.t.bind(null,385,3))).default}catch(t){Object(g.e)(t)}}_setupListener(){var t;let e=!0;null==(t=document.querySelector("#"+this._buttonId))||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(f.b)("Tools",this._baseName),t.stopPropagation(),this._ownershipListSelected()})}_injectModal(){Object(v.u)({id:this._modalId,title:this._baseName});const t=this._baseId+"-select",e=Object(h.a)("#"+this._modalId+" .modal-body");e.append("label").append("select").attr("name",t).attr("id",t),this._mainDiv=e.append("div").attr("id",""+this._baseId),this._div=this._mainDiv.append("div"),this._svg=this._mainDiv.append("svg").attr("class","area")}_getOptions(){return""+this._ownershipData.map(t=>'<option value="'+t.region+'">'+t.region+"</option>;").join("")}_setupSelect(){const e=t("#"+this._baseId+"-select"),s=this._getOptions();e.append(s)}_setupSelectListener(){t("#"+this._baseId+"-select").addClass("selectpicker").on("change",t=>this._regionSelected(t)).selectpicker({noneSelectedText:"Select region"}).val("default").selectpicker("refresh")}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_ownershipListSelected(){let e=!1;document.querySelector("#"+this._modalId)||(e=!0,this._initModal()),t("#"+this._modalId).on("shown.bs.modal",()=>{e&&(this._injectArea(),e=!1)}).modal("show")}_injectArea(){const t=this._getWidth(),e=Math.min(1e3,y.getHeight()),s=32,d=32,h=32,m=g.d.filter(t=>9!==t.id).map(t=>t.short),f=this._nationData;f.keys=m;const v=Object(u.a)().offset(b.a).keys(m)(f);this._svg.attr("width",t).attr("height",e),(()=>{const r=(()=>{const i=Object(l.a)().domain(Object(a.a)(f,t=>new Date(t.date))).range([h,t-s]),r=Object(l.a)().domain([Object(n.a)(v[0],t=>t[0]),Object(o.a)(v[v.length-1],t=>t[1])]).range([e-d,0]);return Object(_.a)().x(t=>i(new Date(t.data.date))).y0(t=>r(t[0])).y1(t=>r(t[1])).curve(p.a)})(),c=new Map(g.d.map(t=>[t.short,t.name]));this._colourScale.domain(m),this._svg.selectAll("path").data(v).join(t=>t.append("path").attr("fill",t=>this._colourScale(t.key)).attr("stroke",t=>this._colourScale(t.key)).attr("d",r)),this._svg.selectAll(".area-label").data(v).join(t=>t.append("text").attr("class","area-label").text(t=>c.get(t.key)).attr("transform",Object(i.areaLabel)(r)))})(),this._svg.append("g").call(i=>{const n=Object(c.b)().domain(Object(a.a)(f,t=>new Date(t.date))).range([h,t-s]);i.attr("transform","translate(0,"+(e-d)+")").call(Object(r.a)(n).ticks(t/80).tickSizeOuter(0)),i.attr("font-size",".8rem").attr("font-family","")})}_injectChart(t){Object(m.a)().data(t).enableAnimations(!1).timeFormat("%-d %B %Y").zQualitative(!0).zColorScale(this._colourScale).width(this._getWidth())(this._div.node())}_regionSelected(e){const s=t(e.currentTarget).find(":selected").val();this._div.selectAll("*").remove();const i=this._ownershipData.filter(t=>t.region===s).map(t=>t.data)[0];this._injectChart(i)}}}).call(this,s(51))},376:function(t,e,s){(function(t){s.d(e,"a",(function(){return p}));s(98),s(53),s(25),s(160),s(163),s(171);var i=s(155),a=s(225),n=s(175),o=s(37),r=s(162),d=s(52),c=s(38),l=s(20),h=s(169);function u(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const b=s(122),_=(t,e,s)=>Object(d.p)(e)+" – "+Object(d.p)(s);class p{constructor(t){u(this,"_serverType",void 0),u(this,"_baseName",void 0),u(this,"_baseId",void 0),u(this,"_buttonId",void 0),u(this,"_modalId",void 0),u(this,"_moduleData",{}),u(this,"_recipeData",{}),this._serverType=b.find(e=>e.id===t).type,this._baseName="List admiralty items and recipes",this._baseId="recipe-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{this._moduleData=(await s.e(5).then(s.t.bind(null,224,3))).default,this._recipeData=(await s.e(10).then(s.t.bind(null,281,3))).default.recipe}catch(t){Object(c.e)(t)}}_setupListener(){var t;let e=!0;null==(t=document.querySelector("#"+this._buttonId))||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(o.b)("Tools",this._baseName),t.stopPropagation(),this._recipeListSelected()})}_injectModal(){Object(l.u)({id:this._modalId,title:this._baseName});const t=this._baseId+"-select",e=Object(i.a)("#"+this._modalId+" .modal-body");e.append("select").attr("name",t).attr("id",t),e.append("label").attr("for",t).attr("class","text-muted pl-2").text("Items listed here may not be available in the game (yet)."),e.append("div").attr("id",""+this._baseId).attr("class","container-fluid")}_getOptions(){return Object(a.b)().key(t=>t.craftGroup).sortKeys(n.a).sortValues(Object(h.c)(["name"])).entries(this._recipeData.filter(t=>"Any"===t.serverType||t.serverType===this._serverType)).map(t=>'<optgroup label="'+t.key+'">'+t.values.map(t=>'<option value="'+t.id+'">'+t.name.replace(/(\d)-(\d)(st|rd|th)/,_)).join("</option>")).join("</optgroup>")}_setupSelect(){const e=t("#"+this._baseId+"-select"),s=this._getOptions();e.append(s)}_setupSelectListener(){t("#"+this._baseId+"-select").addClass("selectpicker").on("change",t=>this._recipeSelected(t)).selectpicker({dropupAuto:!1,liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",title:"Select item",virtualScroll:!0})}_initModal(){this._injectModal(),this._setupSelect(),this._setupSelectListener()}_recipeListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_getRecipeData(t){return this._recipeData.find(e=>e.id===t)}_getRequirementText(t){let e='<table class="table table-sm card-table"><tbody>';return t.labourPrice&&(e+="<tr><td>"+t.labourPrice+" labour hours</td></tr>"),t.goldPrice&&(e+="<tr><td>"+Object(l.n)(t.goldPrice)+"</td></tr>"),t.itemRequirements.length>0&&(e+="<tr><td>"+t.itemRequirements.map(t=>t.amount+" "+t.name).join("</td></tr><tr><td>")+"</td></tr>"),e+="</tbody></table>",e}_getPropertiesText(t){let e="",s="",i="";for(const e of this._moduleData){const a=e[1].filter(e=>e.id===t.result.id);for(const t of a)[s]=e,i="<tr><td>"+t.properties.map(t=>{const e=t.isPercentage?Object(r.m)(t.amount/100):t.amount;return t.modifier+" "+e}).join("</td></tr><tr><td>")+"</td></tr>"}return i?(e+='<h6 class="card-subtitle mb-2 text-muted">'+s+"</h6>",e+='<table class="table table-sm card-table"><tbody>'+i+"</tbody></table>"):e+="<p>"+Object(r.e)(t.result.amount)+" "+t.result.name+"</p>",e}_getText(t){const e=this._getRecipeData(t);let s='<div class="row no-gutters card-deck">';return s+='<div class="card col-6"><div class="card-header">Item</div>',s+='<div class="card-body">',s+=this._getRequirementText(e),s+="</div></div>",s+='<div class="card col-6"><div class="card-header">Result</div>',s+='<div class="card-body">',s+=this._getPropertiesText(e),s+="</div></div>",s+="</div></div>",s}_recipeSelected(e){const s=Number(t(e.currentTarget).find(":selected").val());Object(i.a)("#"+this._baseId+" div").remove(),Object(i.a)("#"+this._baseId).append("div").classed("recipes mt-4",!0),Object(i.a)("#"+this._baseId+" div").html(this._getText(s))}}}).call(this,s(51))},377:function(t,e,s){(function(t){s.d(e,"a",(function(){return u}));s(98),s(234),s(25),s(160),s(163);var i=s(155),a=s(58),n=s.n(a),o=s(37),r=s(38),d=s(20),c=s(162),l=s(169);function h(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class u{constructor(){h(this,"_baseName",void 0),h(this,"_baseId",void 0),h(this,"_buttonId",void 0),h(this,"_modalId",void 0),h(this,"_shipData",{}),this._baseName="List ships",this._baseId="ship-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{this._shipData=(await s.e(12).then(s.t.bind(null,280,3))).default}catch(t){Object(r.e)(t)}}_setupListener(){var t;let e=!0;null==(t=document.querySelector("#"+this._buttonId))||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(o.b)("Tools",this._baseName),t.stopPropagation(),this._shipListSelected()})}_injectModal(){Object(d.u)({id:this._modalId,title:this._baseName,size:"lg"}),Object(i.a)("#"+this._modalId+" .modal-body").append("div").attr("id",""+this._baseId).attr("class","container-fluid")}_initModal(){Object(d.t)(),this._injectModal(),this._injectList()}_shipListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_injectList(){Object(i.a)("#"+this._baseId+" div").remove(),Object(i.a)("#"+this._baseId).append("div").classed("row ingredients",!0),Object(i.a)("#"+this._baseId+" div").html(this._getList());const t=document.querySelector("#table-"+this._baseId);new n.a(t)}_getList(){let t="";t+='<table id="table-'+this._baseId+'" class="table table-sm small tablesort"><thead>',t+="<tr>",t+='<th scope="col" class="border-bottom-0"></th>',t+='<th scope="col" class="border-bottom-0"></th>',t+='<th scope="col" class="text-right border-bottom-0"></th>',t+='<th scope="col" class="text-right border-bottom-0"></th>',t+='<th scope="col" class="text-right border-bottom-0"></th>',t+='<th scope="col" class="text-center" colspan="2">Speed</th>',t+='<th scope="col" class="text-right border-bottom-0"></th>',t+='<th scope="col" class="text-center" colspan="2">Chasers</th>',t+='<th scope="col" class="text-right border-bottom-0"></th>',t+="</tr>",t+='<tr data-sort-method="thead">',t+='<th scope="col" class="text-right border-top-0">Class</th>',t+='<th scope="col" class="border-top-0">Name</th>',t+='<th scope="col" class="text-right border-top-0">Guns</th>',t+='<th scope="col" class="text-right border-top-0">Battle rating</th>',t+='<th scope="col" class="text-right border-top-0">Crew</th>',t+='<th scope="col" class="text-right">Maximum</th>',t+='<th scope="col" class="text-right">Turn</th>',t+='<th scope="col" class="text-right border-top-0">Broadside</th>',t+='<th scope="col" class="text-right border-top-0">Bow</th>',t+='<th scope="col" class="text-right">Stern</th>',t+='<th scope="col" class="text-right border-top-0">Sides</th>',t+="</tr></thead><tbody>";const e=this._shipData.filter(t=>!t.name.startsWith("Rookie ")).sort(Object(l.c)(["class","-battleRating","name"]));for(const s of e)t+="<tr>",t+='<td class="text-right">'+s.class+"</td>",t+="<td>"+s.name+"</td>",t+='<td class="text-right">'+s.guns+"</td>",t+='<td class="text-right">'+s.battleRating+"</td>",t+='<td class="text-right">'+Object(c.e)(s.crew.max)+"</td>",t+='<td class="text-right">'+Object(c.c)(s.ship.maxSpeed)+"</td>",t+='<td class="text-right">'+Object(c.c)(s.rudder.turnSpeed)+"</td>",t+='<td class="text-right">'+Object(c.e)(s.broadside.cannons)+"</td>",t+='<td class="text-right">'+(s.gunsPerDeck[4]?s.gunsPerDeck[4]:"")+"</td>",t+='<td class="text-right">'+(s.gunsPerDeck[5]?s.gunsPerDeck[5]:"")+"</td>",t+='<td class="text-right" data-sort="'+s.sides.armour+'">'+Object(c.e)(s.sides.armour)+" ("+s.sides.thickness+")</td>",t+="</tr>";return t+="</tbody></table>",t}}}).call(this,s(51))},378:function(t,e,s){(function(t){s.d(e,"a",(function(){return h}));s(98),s(100),s(101),s(102),s(103),s(104),s(105),s(106),s(107),s(108),s(109),s(110),s(111),s(112),s(25),s(160),s(163),s(171);var i=s(155),a=s(37),n=s(162),o=s(20),r=s(38),d=s(169);function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const l=["Resources","Extra","Materials"];class h{constructor(){c(this,"_baseName",void 0),c(this,"_baseId",void 0),c(this,"_buttonId",void 0),c(this,"_modalId",void 0),c(this,"_init",!0),c(this,"_blueprintData",{}),c(this,"_woodData",{}),c(this,"_extractionCosts",{}),c(this,"_craftingCosts",{}),c(this,"_blueprint",void 0),c(this,"_woodOptions",{}),c(this,"_defaultWood",void 0),c(this,"_woodsSelected",{}),c(this,"_blueprintList",void 0),c(this,"_currentBlueprint",{}),c(this,"_tables",{}),this._baseName="List ship blueprint",this._baseId="ship-blueprint-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._defaultWood={frame:"Fir",trim:"Crew Space"},this._setupListener()}async _loadAndSetupData(){try{this._blueprintData=(await s.e(11).then(s.t.bind(null,386,3))).default,this._woodData=(await s.e(13).then(s.t.bind(null,252,3))).default;const t=(await s.e(11).then(s.t.bind(null,387,3))).default;this._extractionCosts=new Map(t.standard.map(t=>[t.name,{real:t.real,labour:t.labour}])),this._craftingCosts=new Map(t.seasoned.map(t=>[t.name,{real:t.real,labour:t.labour,doubloon:t.doubloon,tool:t.tool}]))}catch(t){Object(r.e)(t)}}_setupListener(){var t;let e=!0;null==(t=document.querySelector("#"+this._buttonId))||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(a.b)("Tools",this._baseName),t.stopPropagation(),this._listSelected()})}_injectModal(){Object(o.u)({id:this._modalId,title:this._baseName,size:"lg"});const t=this._baseId+"-ship-select",e=Object(i.a)("#"+this._modalId+" .modal-body");let s=e.append("div").classed("row no-gutters mb-2",!0);s.append("label").attr("for",t),s.append("select").attr("name",t).attr("id",t),s=e.append("div").classed("row no-gutters",!0);for(const t of["frame","trim"]){const e=this._baseId+"-"+t+"-select";s.append("label").attr("for",e),s.append("select").attr("name",e).attr("id",e).classed("pr-2",!0)}this._blueprintList=e.append("div").attr("id",""+this._baseId).classed("blueprint mt-4",!0)}_getShipOptions(){return""+this._blueprintData.sort(Object(d.c)(["name"])).map(t=>'<option value="'+t.name+'">'+t.name+"</option>;").join("")}_setupShipSelect(){const e=t("#"+this._baseId+"-ship-select"),s=this._getShipOptions();e.append(s)}_setupWoodOptions(){const t=this._woodData.frame.sort(Object(d.c)(["name"])),e=this._woodData.trim.filter(t=>"Light"!==t.name).sort(Object(d.c)(["name"]));this._woodOptions={frame:t.map(t=>'<option value="'+t.name+'">'+t.name+"</option>").join(""),trim:e.map(t=>'<option value="'+t.name+'">'+t.name+"</option>").join("")}}_setupWoodSelect(t,e){this._setupWoodOptions(),this._woodsSelected[t]=this._defaultWood[t],e.append(this._woodOptions[t]),e.attr("disabled","disabled")}_setupSelects(){this._setupShipSelect();for(const e of r.h){const s=t("#"+this._baseId+"-"+e+"-select");this._setupWoodSelect(e,s)}}_setupShipSelectListener(){t("#"+this._baseId+"-ship-select").addClass("selectpicker").on("change",t=>this._blueprintSelected(t)).selectpicker({noneSelectedText:"Select blueprint",width:"fit"}).val("default").selectpicker("refresh")}_setupWoodSelectListener(t,e){e.addClass("selectpicker").on("change",()=>this._woodSelected(t,e)).selectpicker({noneSelectedText:"Select "+t,width:"fit"}).val("default").selectpicker("refresh")}_setupSelectListener(){this._setupShipSelectListener();for(const e of r.h){const s=t("#"+this._baseId+"-"+e+"-select");this._setupWoodSelectListener(e,s)}}_initModal(){this._injectModal(),this._setupSelects(),this._setupSelectListener()}_setWoodSelect(e){t("#"+this._baseId+"-"+e+"-select").removeAttr("disabled").val(this._defaultWood[e]).selectpicker("refresh")}_woodSelected(t,e){this._woodsSelected[t]=e.val(),this._updateText()}_listSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_updateTable(t,e){t.select("tbody").selectAll("tr").data(e).join(t=>t.append("tr")).selectAll("td").data(t=>t).join(t=>t.append("td")).html(t=>t)}_updateText(){let t=this._currentBlueprint.resources.map(t=>[t.name,t.amount]),e=!1,s=!1,i=0,a=0;if("Crew Space"===this._woodsSelected.trim){const e=this._currentBlueprint.wood.find(t=>"Crew Space"===t.name).amount,s=t.findIndex(t=>"Hemp"===t[0]);t[s][1]=t[s][1]+e}else if(a=this._currentBlueprint.wood.find(t=>"Planking"===t.name).amount,this._woodsSelected.trim===this._woodsSelected.frame)i+=a;else{const e=t.findIndex(t=>t[0]===this._woodsSelected.trim);e>=0?t[e][1]=t[e][1]+a:(s=!0,t.push([this._woodsSelected.trim,a]))}i+=this._currentBlueprint.wood.find(t=>"Frame"===t.name).amount;const o=t.findIndex(t=>t[0]===this._woodsSelected.frame);if(o>=0?t[o][1]=t[o][1]+i:(e=!0,t.push([this._woodsSelected.frame,i])),e&&s){const e=t.length-1;[t[e],t[e-1]]=[t[e-1],t[e]]}let r=[];this._currentBlueprint.doubloons&&r.push(["Doubloons",this._currentBlueprint.doubloons]),r.push(["Provisions",this._currentBlueprint.provisions]),this._currentBlueprint.permit&&r.push(["Permit",this._currentBlueprint.permit]),r.push(["Craft level",this._currentBlueprint.craftLevel],["Shipyard level",this._currentBlueprint.shipyardLevel],["Labour hours",this._currentBlueprint.labourHours],["Craft experience",this._currentBlueprint.craftXP]);const d=[];let c=0,l=0;const h=t=>this._extractionCosts.get(t[0]).real*t[1],u=t=>this._extractionCosts.get(t[0]).labour*t[1],b=t=>{for(const e of t.filter(t=>this._extractionCosts.has(t[0])))c+=h(e),l+=u(e)};b(t),b(r),c&&d.push(["Reals",Object(n.e)(c)],["Labour hours",Object(n.e)(l)]);let _=0,p=0,m=0,f=0;this._craftingCosts.has(this._woodsSelected.trim)&&(_+=this._craftingCosts.get(this._woodsSelected.trim).real*a,p+=this._craftingCosts.get(this._woodsSelected.trim).labour*a,m+=this._craftingCosts.get(this._woodsSelected.trim).doubloon*a,f+=this._craftingCosts.get(this._woodsSelected.trim).tool*a),this._craftingCosts.has(this._woodsSelected.frame)&&(_+=this._craftingCosts.get(this._woodsSelected.frame).real*i,p+=this._craftingCosts.get(this._woodsSelected.frame).labour*i,m+=this._craftingCosts.get(this._woodsSelected.frame).doubloon*i,f+=this._craftingCosts.get(this._woodsSelected.frame).tool*i),_&&d.push(["(S) reals",Object(n.e)(_)],["(S) labour hours",Object(n.e)(p)],["(S) doubloons",Object(n.e)(m)],["(S) tools",Object(n.e)(f)]),t=t.map(t=>[t[0],Object(n.e)(t[1])]),r=r.map(t=>[t[0],Object(n.e)(t[1])]),this._updateTable(this._tables.Resources,t),this._updateTable(this._tables.Extra,r),this._updateTable(this._tables.Materials,d)}_blueprintSelected(e){if(this._init){this._init=!1;for(const t of r.h)this._setWoodSelect(t);const t=this._blueprintList.append("div").classed("card-deck",!0),e=e=>{const s=t.append("div").classed("card",!0);s.append("div").classed("card-header",!0).text(e);const i=s.append("div").classed("card-body",!0);this._tables[e]=i.append("table").classed("table table-sm card-table",!0),this._tables[e].append("thead"),this._tables[e].append("tbody")};for(const t of l)e(t)}this._blueprint=t(e.currentTarget).find(":selected").val(),this._currentBlueprint=this._getBlueprintData(this._blueprint),this._updateText()}_getBlueprintData(t){return this._blueprintData.find(e=>e.name===t)}}}).call(this,s(51))},379:function(t,e,s){(function(t){s.d(e,"a",(function(){return _}));s(99),s(98),s(97),s(189),s(190),s(191),s(192),s(193),s(194),s(195),s(196),s(197),s(198),s(199),s(200),s(201),s(202),s(203),s(204),s(25),s(160),s(163);var i=s(155),a=s(58),n=s.n(a),o=s(37),r=s(38),d=s(20),c=s(162),l=s(169);function h(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(s);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}function b(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class _{constructor(){b(this,"_baseName",void 0),b(this,"_baseId",void 0),b(this,"_buttonId",void 0),b(this,"_modalId",void 0),b(this,"_woodData",{}),this._baseName="List woods",this._baseId="wood-list",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._setupListener()}async _loadAndSetupData(){try{this._woodData=(await s.e(13).then(s.t.bind(null,252,3))).default}catch(t){Object(r.e)(t)}}_setupListener(){var t;let e=!0;null==(t=document.querySelector("#"+this._buttonId))||t.addEventListener("click",async t=>{e&&(e=!1,await this._loadAndSetupData()),Object(o.b)("Tools",this._baseName),t.stopPropagation(),this._woodListSelected()})}_injectModal(){Object(d.u)({id:this._modalId,title:this._baseName});const t=Object(i.a)("#"+this._modalId+" .modal-body");t.append("h5").text("Frames"),t.append("div").attr("id","frame-list").attr("class","modules"),t.append("h5").text("Trims"),t.append("div").attr("id","trim-list").attr("class","modules")}_initModal(){Object(d.t)(),this._injectModal(),this._injectList("frame"),this._injectList("trim")}_woodListSelected(){document.querySelector("#"+this._modalId)||this._initModal(),t("#"+this._modalId).modal("show")}_injectList(e){t("#"+e+"-list").append(this._getList(e));const s=document.querySelector("#table-"+e+"-list");new n.a(s)}_getModifiers(t){const e=new Set;return this._woodData[t].forEach(t=>{t.properties.forEach(t=>{"Ship material"!==t.modifier&&"Boarding morale"!==t.modifier&&e.add(t.modifier)})}),h(e).sort(l.b)}_getList(t){const e=this._getModifiers(t);let s="";return s+='<table id="table-'+t+'-list" class="table table-sm small tablesort"><thead><tr><th data-sort-default>Wood</th>',e.forEach(t=>{s+='<th class="text-right">'+t+"</th>"}),s+="</tr></thead><tbody>",this._woodData[t].forEach(t=>{s+="<tr><td>"+t.name+"</td>",e.forEach(e=>{const i=t.properties.filter(t=>t.modifier===e).map(t=>t.amount)[0];s+='<td class="text-right" data-sort="'+(null!=i?i:0)+'">'+(i?Object(c.c)(i):"")+"</td>"}),s+="</tr>"}),s+="</tbody></table>",s}}}).call(this,s(51))}}]);