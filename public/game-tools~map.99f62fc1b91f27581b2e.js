/*! For license information please see game-tools~map.99f62fc1b91f27581b2e.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{iSiJ:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return y}));a("iPZ8"),a("kypl"),a("pCzD"),a("hi3g"),a("C4nn"),a("lYjL"),a("IlJM"),a("SJSz"),a("4owi"),a("IvQZ"),a("/YXa"),a("8cZI"),a("lmye"),a("WB5j"),a("aOEW"),a("RsBt"),a("D/wG"),a("1Qwx"),a("fp7Y"),a("ZEAQ"),a("JBxO"),a("FdtR"),a("9UJh"),a("RsMT"),a("WoWj"),a("y89P"),a("aZFp"),a("MTDe"),a("3dw1"),a("U00V"),a("9DLp"),a("wcNg"),a("3XUK"),a("Peo2"),a("/1Gu");var s=a("ED/D"),i=a("qKAC"),r=a("SYoz"),o=a("BfWa"),n=a("yw3p"),p=a("OQCi"),c=a("nUlG"),h=a("aBO9"),u=a("f4w0"),d=a("Av7d"),l=a("0lY5"),m=a("pFgi");function f(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _(e,t,a,s,i,r,o){try{var n=e[r](o),p=n.value}catch(e){return void a(e)}n.done?t(p):Promise.resolve(p).then(s,i)}function b(e){return function(){var t=this,a=arguments;return new Promise((function(s,i){var r=e.apply(t,a);function o(e){_(r,s,i,o,n,"next",e)}function n(e){_(r,s,i,o,n,"throw",e)}o(void 0)}))}}function g(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function D(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function v(e,t,a){return t&&D(e.prototype,t),a&&D(e,a),e}var w=2*Math.PI/24,C=d.H/d.I,S=function(){function e(e,t){this._id=e,this._shipData=t,this._ticksSpeed=[12,8,4,0],this._ticksSpeedLabels=["12 knots","8 knots","4 knots","0 knots"],this._select="#ship-compare-"+this._id,this._setupSvg(),this._g=Object(c.f)(this._select).select("g"),this._setCompass()}var t=e.prototype;return t._setupSvg=function(){var e=Object(c.f)(this.select);Object(c.f)(this.select+" svg").remove(),e.append("svg").attr("width",this.shipData.svgWidth).attr("height",this.shipData.svgHeight).attr("data-ui-component","sailing-profile").attr("fill","none").append("g").attr("transform","translate("+this.shipData.svgWidth/2+", "+this.shipData.svgHeight/2+")"),Object(c.f)(this.select+" div").remove(),e.append("div").attr("class","block-small")},t._setCompass=function(){var e=this,t=new Array(12);t.fill(1,0);var a=Object(h.f)().sort(null).value(1)(t),s=Object(h.a)().outerRadius(this.shipData.radiusScaleAbsolute(12)).innerRadius(this.shipData.innerRadius);this.g.selectAll(".compass-arc").data(a).join((function(e){return e.append("path").attr("class","compass-arc").attr("d",s)})),this.g.selectAll(".speed-circle").data(this._ticksSpeed).join((function(t){return t.append("circle").attr("class","speed-circle").attr("r",(function(t){return e.shipData.radiusScaleAbsolute(t)}))})),this.g.append("line").attr("x1",0).attr("y1",-160).attr("x2",0).attr("y2",-79).attr("class","wind-arrow").attr("marker-end","url(#course-arrow)")},e.pd=function(e){var t='<span class="badge badge-white">'+e[0]+" / ";return e[1]?t+=""+e[1]:t+="–",t+=" lb</span>"},e.getCannonsPerDeck=function(t,a){for(var s=a[0]+" "+e.pd(t[0]),i="",r=1;r<4;r+=1)a[r]?s=a[r]+" "+e.pd(t[r])+" <br>"+s:i+="<br>";return[s,i]},e.getText=function(e){var t=0;function a(e){return'<div class="row row-small '+((t+=1)%2?"row-light":"")+'"><div class="col-3">'+e+"</div>"}function s(t,a,s){void 0===s&&(s=6);var i="",r="";if("cannonsPerDeck"===t){var o=e[t];i=o[0],r="<br>"+(r=o[1])}else i=""===t?"":e[t];return'<div class="col-'+s+'">'+i+'<br><span class="des">'+a+"</span>"+r+"</div>"}var i="";return i+=a(e.shipRating),i+='<div class="col-9"><div class="row no-gutters">',i+=s("battleRating","Battle rating"),i+=s("guns","Cannons"),i+=s("upgradeXP","Knowledge XP"),i+=s("waterlineHeight","Water line"),i+="</div></div></div>",i+=a(e.decks),i+='<div class="col-9"><div class="row no-gutters">',i+=s("cannonsPerDeck","Gun decks"),i+=s("firezoneHorizontalWidth","Firezone horizontal width"),i+="</div></div></div>",i+=a("Broadside (lb)"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("cannonBroadside","Cannons"),i+=s("carroBroadside","Carronades"),i+="</div></div></div>",i+=a("Chasers"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("gunsFront","Bow"),i+=s("gunsBack","Stern"),i+="</div></div></div>",i+=a("Speed"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("maxSpeed","Maximum"),i+=s("",""),i+=s("acceleration","Acceleration"),i+=s("deceleration","Deceleration"),i+=s("maxTurningSpeed","Turn speed"),i+=s("halfturnTime","Rudder half time"),i+="</div></div></div>",i+=a('Hit points <span class="badge badge-white">Thickness</span>'),i+='<div class="col-9"><div class="row no-gutters">',i+=s("sideArmor","Sides"),i+=s("structure","Hull"),i+=s("frontArmor","Bow"),i+=s("backArmor","Stern"),i+=s("pump","Pump"),i+=s("rudder","Rudder"),i+="</div></div></div>",i+=a('Masts <span class="badge badge-white">Thickness</span>'),i+='<div class="col-9"><div class="row no-gutters">',i+=s("sails","Sails"),i+=s("mastBottomArmor","Bottom"),i+=s("mastMiddleArmor","Middle"),i+=s("mastTopArmor","Top"),i+="</div></div></div>",i+=a("Crew"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("minCrew","Minimum",4),i+=s("sailingCrew","Sailing",4),i+=s("maxCrew","Maximum",4),i+="</div></div></div>",i+=a("Resistance"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("fireResistance","Fire",4),i+=s("leakResistance","Leak",4),i+=s("splinterResistance","Splinter",4),i+="</div></div></div>",i+=a('Repairs needed <span class="badge badge-white">Set of 5</span>'),i+='<div class="col-9"><div class="row no-gutters">',i+=s("hullRepairsNeeded","Hull",4),i+=s("rigRepairsNeeded","Rig",4),i+=s("rumRepairsNeeded","Rum",4),i+="</div></div></div>",i+=a("Repair"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("hullRepairAmount","Hull %",4),i+=s("rigRepairAmount","Rig %",4),i+=s("repairTime","Time (sec)",4),i+="</div></div></div>",i+=a("Hold"),i+='<div class="col-9"><div class="row no-gutters">',i+=s("maxWeight","Tons"),i+=s("holdSize","Cargo slots"),i+="</div></div></div>",i+="</div>"},v(e,[{key:"id",get:function(){return this._id}},{key:"shipData",get:function(){return this._shipData}},{key:"select",get:function(){return this._select}},{key:"g",get:function(){return this._g}}]),e}(),k=function(t){function a(e,a,s){var i;return(i=t.call(this,e,s)||this)._shipData=a,i._shipCompareData=s,i._setBackground(),i._drawProfile(),i._printText(),i}g(a,t);var s=a.prototype;return s._setBackground=function(){var e=this,t=Object(h.a)().outerRadius((function(t){return e.shipCompareData.radiusScaleAbsolute(t)+2})).innerRadius((function(t){return e.shipCompareData.radiusScaleAbsolute(t)+1})).startAngle(-Math.PI/2).endAngle(Math.PI/2);this.g.selectAll(".speed-textpath").data(this._ticksSpeed).join((function(e){return e.append("path").attr("class","speed-textpath").attr("d",t).attr("id",(function(e,t){return"tick"+t}))})),this.g.selectAll(".speed-text").data(this._ticksSpeed).join((function(t){return t.append("text").attr("class","speed-text").append("textPath").attr("href",(function(e,t){return"#tick"+t})).text((function(t,a){return e._ticksSpeedLabels[a]})).attr("startOffset","10%")}))},s._drawProfile=function(){var e=this,t=Object(h.f)().sort(null).value(1)(this.shipData.speedDegrees),a=h.d,s=Object(h.g)().angle((function(e,t){return t*w})).radius((function(t){return e.shipCompareData.radiusScaleAbsolute(t.data)})).curve(a);this.g.append("path").attr("class","base-profile").attr("d",s(t)),this.g.selectAll(".speed-markers").data(t).join((function(t){return t.append("circle").attr("class","speed-markers").attr("r",5).attr("cy",(function(t,a){return Math.cos(a*w)*-e.shipCompareData.radiusScaleAbsolute(t.data)})).attr("cx",(function(t,a){return Math.sin(a*w)*e.shipCompareData.radiusScaleAbsolute(t.data)})).attr("fill",(function(t){return e.shipCompareData.colorScale(t.data)})).append("title").text((function(e){return Math.round(10*e.data)/10+" knots"}))}))},s._printText=function(){var t=S.getCannonsPerDeck(this.shipData.deckClassLimit,this.shipData.gunsPerDeck),a=Math.round(this.shipData.sides.armour*this.shipData.repairAmount.armour/d.x),s=Math.round(this.shipData.sails.armour*this.shipData.repairAmount.sails/d.G),i=Math.round(this.shipData.crew.max*C),r={shipRating:Object(l.A)(this.shipData.class)+" rate",battleRating:this.shipData.battleRating,guns:this.shipData.guns,decks:this.shipData.decks+" deck"+(this.shipData.decks>1?"s":""),additionalRow:this.shipData.decks<4?"<br> ":"",cannonsPerDeck:t,cannonBroadside:Object(l.r)(this.shipData.broadside.cannons),carroBroadside:Object(l.r)(this.shipData.broadside.carronades),gunsFront:this.shipData.gunsPerDeck[4],limitFront:this.shipData.deckClassLimit[4],gunsBack:this.shipData.gunsPerDeck[5],limitBack:this.shipData.deckClassLimit[5],firezoneHorizontalWidth:this.shipData.ship.firezoneHorizontalWidth,waterlineHeight:Object(l.o)(this.shipData.ship.waterlineHeight),maxSpeed:Object(l.o)(this.shipData.speed.max,3),acceleration:Object(l.o)(this.shipData.ship.acceleration),deceleration:Object(l.o)(this.shipData.ship.deceleration),maxTurningSpeed:Object(l.o)(this.shipData.rudder.turnSpeed),halfturnTime:Object(l.o)(this.shipData.rudder.halfturnTime),sideArmor:Object(l.r)(this.shipData.sides.armour)+' <span class="badge badge-white">'+Object(l.r)(this.shipData.sides.thickness)+"</span>",frontArmor:Object(l.r)(this.shipData.bow.armour)+' <span class="badge badge-white">'+Object(l.r)(this.shipData.bow.thickness)+"</span>",pump:Object(l.r)(this.shipData.pump.armour),sails:Object(l.r)(this.shipData.sails.armour),structure:Object(l.r)(this.shipData.structure.armour),backArmor:Object(l.r)(this.shipData.stern.armour)+' <span class="badge badge-white">'+Object(l.r)(this.shipData.stern.thickness)+"</span>",rudder:Object(l.r)(this.shipData.rudder.armour)+' <span class="badge badge-white">'+Object(l.r)(this.shipData.rudder.thickness)+"</span>",minCrew:Object(l.r)(this.shipData.crew.min),maxCrew:Object(l.r)(this.shipData.crew.max),sailingCrew:Object(l.r)(this.shipData.crew.sailing||0),maxWeight:Object(l.r)(this.shipData.maxWeight),holdSize:Object(l.r)(this.shipData.holdSize),upgradeXP:Object(l.r)(this.shipData.upgradeXP),sternRepair:""+Object(l.r)(this.shipData.repairTime.stern),bowRepair:""+Object(l.r)(this.shipData.repairTime.bow),hullRepairAmount:""+Object(l.r)(100*(this.shipData.repairAmount.armour+this.shipData.repairAmount.armourPerk)),rigRepairAmount:""+Object(l.r)(100*(this.shipData.repairAmount.sails+this.shipData.repairAmount.sailsPerk)),repairTime:""+Object(l.r)(this.shipData.repairTime.sides),hullRepairsNeeded:Object(l.r)(a)+' <span class="badge badge-white">'+Object(l.r)(5*a)+"</span>",rigRepairsNeeded:Object(l.r)(s)+' <span class="badge badge-white">'+Object(l.r)(5*s)+"</span>",rumRepairsNeeded:Object(l.r)(i)+' <span class="badge badge-white">'+Object(l.r)(5*i)+"</span>",fireResistance:Object(l.u)(this.shipData.resistance.fire,0),leakResistance:Object(l.u)(this.shipData.resistance.leaks,0),splinterResistance:Object(l.u)(this.shipData.resistance.splinter,0),mastBottomArmor:Object(l.r)(this.shipData.mast.bottomArmour)+' <span class="badge badge-white">'+Object(l.r)(this.shipData.mast.bottomThickness)+"</span>",mastMiddleArmor:Object(l.r)(this.shipData.mast.middleArmour)+' <span class="badge badge-white">'+Object(l.r)(this.shipData.mast.middleThickness)+"</span>",mastTopArmor:Object(l.r)(this.shipData.mast.topArmour)+' <span class="badge badge-white">'+Object(l.r)(this.shipData.mast.topThickness)+"</span>"};r.gunsFront?r.gunsFront+=" "+S.pd(r.limitFront):r.gunsFront="–",r.gunsBack?r.gunsBack+=" "+S.pd(r.limitBack):r.gunsBack="–",e(""+this.select).find("div").append(S.getText(r))},v(a,[{key:"shipData",get:function(){return this._shipData}},{key:"shipCompareData",get:function(){return this._shipCompareData}}]),a}(S),A=function(t){function a(e,a,r,o){var n;(n=t.call(this,e,o)||this)._shipBaseData=a,n._shipCompareData=r,n._shipCompare=o,n._pie=Object(h.f)().sort(null).value(1);var p=h.d;return n._line=Object(h.g)().angle((function(e,t){return t*w})).radius((function(e){return n.shipCompare.radiusScaleAbsolute(e.data)})).curve(p),n._arcsBase=n._pie(n.shipBaseData.speedDegrees),n._arcsComp=n._pie(n.shipCompareData.speedDegrees),n._speedDiff=n.shipCompareData.speedDegrees.map((function(e,t){return Object(l.I)(e-n.shipBaseData.speedDegrees[t])})),n._minSpeedDiff=Object(s.a)(n._speedDiff),n._maxSpeedDiff=Object(i.a)(n._speedDiff),n._drawDifferenceProfile(),n._injectTextComparison(),n}g(a,t);var r=a.prototype;return r._setColourScale=function(e,t){var a=Math.min(e,this._shipCompare.colourScaleSpeedDiff.domain()[0]),s=Math.max(t,this._shipCompare.colourScaleSpeedDiff.domain()[this._shipCompare.colourScaleSpeedDiff.domain().length-1]);this._shipCompare.colourScaleSpeedDiff.domain([a,0,s])},r._drawDifferenceProfile=function(){this.g.append("path").attr("class","base-profile").attr("d",this._line(this._arcsBase)),this.g.append("path").attr("class","comp-profile").attr("d",this._line(this._arcsComp))},r.updateDifferenceProfile=function(){var e=this;this._setColourScale(this._minSpeedDiff,this._maxSpeedDiff),this.g.selectAll("g.speed-markers").data(this._arcsComp).join((function(t){var a=t.append("g").attr("class","speed-markers");a.append("circle").attr("r",5).attr("cy",(function(t,a){return Math.cos(a*w)*-e.shipCompare.radiusScaleAbsolute(t.data)})).attr("cx",(function(t,a){return Math.sin(a*w)*e.shipCompare.radiusScaleAbsolute(t.data)})).attr("fill",(function(t,a){return e._shipCompare.colourScaleSpeedDiff(e._speedDiff[a])})),a.append("title").text((function(t,a){return Math.round(10*t.data)/10+" ("+Object(l.x)(e._speedDiff[a],1)+") knots"}))})).select("circle").attr("fill",(function(t,a){return e._shipCompare.colourScaleSpeedDiff(e._speedDiff[a])}))},r._injectTextComparison=function(){function t(e,t,a,s){void 0===a&&(a=0),void 0===s&&(s=!1);var i=parseFloat((e-t).toFixed(a));return s&&(i*=100),i<0?'<span class="badge badge-danger">'+Object(l.o)(Math.abs(i))+"</span>":i>0?'<span class="badge badge-success">'+Object(l.o)(i)+"</span>":""}var a=Math.round(this.shipBaseData.sides.armour*this.shipBaseData.repairAmount.armour/d.x),s=Math.round(this.shipBaseData.sails.armour*this.shipBaseData.repairAmount.sails/d.G),i=Math.round(this.shipBaseData.crew.max*C),r=Math.round(this.shipCompareData.sides.armour*this.shipCompareData.repairAmount.armour/d.x),o=Math.round(this.shipCompareData.sails.armour*this.shipCompareData.repairAmount.sails/d.G),n=Math.round(this.shipCompareData.crew.max*C),p={shipRating:Object(l.A)(this.shipCompareData.class)+" rate",battleRating:this.shipCompareData.battleRating+" "+t(this.shipCompareData.battleRating,this.shipBaseData.battleRating),guns:this.shipCompareData.guns+" "+t(this.shipCompareData.guns,this.shipBaseData.guns),decks:this.shipCompareData.decks+" deck"+(this.shipCompareData.decks>1?"s":"")+" "+t(this.shipCompareData.decks,this.shipBaseData.decks),additionalRow:this.shipCompareData.decks<4?"<br> ":"",cannonsPerDeck:S.getCannonsPerDeck(this.shipCompareData.deckClassLimit,this.shipCompareData.gunsPerDeck),cannonBroadside:this.shipCompareData.broadside.cannons+" "+t(this.shipCompareData.broadside.cannons,this.shipBaseData.broadside.cannons),carroBroadside:this.shipCompareData.broadside.carronades+" "+t(this.shipCompareData.broadside.carronades,this.shipBaseData.broadside.carronades),gunsFront:this.shipCompareData.gunsPerDeck[4],limitFront:this.shipCompareData.deckClassLimit[4],gunsBack:this.shipCompareData.gunsPerDeck[5],limitBack:this.shipCompareData.deckClassLimit[5],minSpeed:Object(l.o)(this.shipCompareData.speed.min)+" "+t(this.shipCompareData.speed.min,this.shipBaseData.speed.min,2),maxSpeed:Object(l.o)(this.shipCompareData.speed.max,3)+" "+t(this.shipCompareData.speed.max,this.shipBaseData.speed.max,2),maxTurningSpeed:Object(l.o)(this.shipCompareData.rudder.turnSpeed)+" "+t(this.shipCompareData.rudder.turnSpeed,this.shipBaseData.rudder.turnSpeed,2),firezoneHorizontalWidth:this.shipCompareData.ship.firezoneHorizontalWidth+" "+t(this.shipCompareData.ship.firezoneHorizontalWidth,this.shipBaseData.ship.firezoneHorizontalWidth),waterlineHeight:Object(l.o)(this.shipCompareData.ship.waterlineHeight)+" "+t(this.shipCompareData.ship.waterlineHeight,this.shipBaseData.ship.waterlineHeight,2),acceleration:Object(l.o)(this.shipCompareData.ship.acceleration)+" "+t(this.shipCompareData.ship.acceleration,this.shipBaseData.ship.acceleration,2),deceleration:Object(l.o)(this.shipCompareData.ship.deceleration)+" "+t(this.shipCompareData.ship.deceleration,this.shipBaseData.ship.deceleration,2),halfturnTime:Object(l.o)(this.shipCompareData.rudder.halfturnTime)+" "+t(this.shipCompareData.rudder.halfturnTime,this.shipBaseData.rudder.halfturnTime),sideArmor:Object(l.s)(this.shipCompareData.sides.armour)+" "+t(this.shipCompareData.sides.armour,this.shipBaseData.sides.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.sides.thickness)+"</span>"+t(this.shipCompareData.sides.thickness,this.shipBaseData.sides.thickness),frontArmor:Object(l.s)(this.shipCompareData.bow.armour)+" "+t(this.shipCompareData.bow.armour,this.shipBaseData.bow.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.bow.thickness)+"</span>"+t(this.shipCompareData.bow.thickness,this.shipBaseData.bow.thickness),backArmor:Object(l.s)(this.shipCompareData.stern.armour)+" "+t(this.shipCompareData.stern.armour,this.shipBaseData.stern.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.stern.thickness)+"</span>"+t(this.shipCompareData.stern.thickness,this.shipBaseData.stern.thickness),pump:Object(l.s)(this.shipCompareData.pump.armour)+" "+t(this.shipCompareData.pump.armour,this.shipBaseData.pump.armour),sails:Object(l.s)(this.shipCompareData.sails.armour)+" "+t(this.shipCompareData.sails.armour,this.shipBaseData.sails.armour),structure:Object(l.s)(this.shipCompareData.structure.armour)+" "+t(this.shipCompareData.structure.armour,this.shipBaseData.structure.armour),rudder:Object(l.s)(this.shipCompareData.rudder.armour)+" "+t(this.shipCompareData.rudder.armour,this.shipBaseData.rudder.armour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.rudder.thickness)+"</span>"+t(this.shipCompareData.rudder.thickness,this.shipBaseData.rudder.thickness),minCrew:Object(l.s)(this.shipCompareData.crew.min)+" "+t(this.shipCompareData.crew.min,this.shipBaseData.crew.min),maxCrew:Object(l.s)(this.shipCompareData.crew.max)+" "+t(this.shipCompareData.crew.max,this.shipBaseData.crew.max),sailingCrew:Object(l.s)(this.shipCompareData.crew.sailing)+" "+t(this.shipCompareData.crew.sailing,this.shipBaseData.crew.sailing),maxWeight:Object(l.s)(this.shipCompareData.maxWeight)+" "+t(this.shipCompareData.maxWeight,this.shipBaseData.maxWeight),holdSize:Object(l.s)(this.shipCompareData.holdSize)+" "+t(this.shipCompareData.holdSize,this.shipBaseData.holdSize),upgradeXP:Object(l.s)(this.shipCompareData.upgradeXP)+" "+t(this.shipCompareData.upgradeXP,this.shipBaseData.upgradeXP),hullRepairAmount:Object(l.s)(100*(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk))+" "+t(this.shipCompareData.repairAmount.armour+this.shipCompareData.repairAmount.armourPerk,this.shipBaseData.repairAmount.armour+this.shipBaseData.repairAmount.armourPerk,3,!0),rigRepairAmount:Object(l.s)(100*(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk))+" "+t(this.shipCompareData.repairAmount.sails+this.shipCompareData.repairAmount.sailsPerk,this.shipBaseData.repairAmount.sails+this.shipBaseData.repairAmount.sailsPerk,3,!0),repairTime:Object(l.s)(this.shipCompareData.repairTime.sides)+" "+t(this.shipBaseData.repairTime.sides,this.shipCompareData.repairTime.sides),hullRepairsNeeded:Object(l.s)(r)+" "+t(r,a)+' <span class="badge badge-white">'+Object(l.s)(5*r)+"</span>",rigRepairsNeeded:Object(l.s)(o)+" "+t(o,s)+' <span class="badge badge-white">'+Object(l.s)(5*o)+"</span>",rumRepairsNeeded:Object(l.s)(n)+" "+t(n,i)+' <span class="badge badge-white">'+Object(l.s)(5*n)+"</span>",fireResistance:Object(l.u)(this.shipCompareData.resistance.fire,0)+" "+t(this.shipCompareData.resistance.fire,this.shipBaseData.resistance.fire,2,!0),leakResistance:Object(l.u)(this.shipCompareData.resistance.leaks,0)+" "+t(this.shipCompareData.resistance.leaks,this.shipBaseData.resistance.leaks,2,!0),splinterResistance:Object(l.u)(this.shipCompareData.resistance.splinter,0)+" "+t(this.shipCompareData.resistance.splinter,this.shipBaseData.resistance.splinter,2,!0),mastBottomArmor:Object(l.s)(this.shipCompareData.mast.bottomArmour)+" "+t(this.shipCompareData.mast.bottomArmour,this.shipBaseData.mast.bottomArmour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.mast.bottomThickness)+"</span>"+t(this.shipCompareData.mast.bottomThickness,this.shipBaseData.mast.bottomThickness),mastMiddleArmor:Object(l.s)(this.shipCompareData.mast.middleArmour)+" "+t(this.shipCompareData.mast.middleArmour,this.shipBaseData.mast.middleArmour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.mast.middleThickness)+"</span>"+t(this.shipCompareData.mast.middleThickness,this.shipBaseData.mast.middleThickness),mastTopArmor:Object(l.s)(this.shipCompareData.mast.topArmour)+" "+t(this.shipCompareData.mast.topArmour,this.shipBaseData.mast.topArmour)+' <span class="badge badge-white">'+Object(l.s)(this.shipCompareData.mast.topThickness)+"</span>"+t(this.shipCompareData.mast.topThickness,this.shipBaseData.mast.topThickness)};p.gunsFront?p.gunsFront+=" "+S.pd(p.limitFront):p.gunsFront="–",p.gunsBack?p.gunsBack+=" "+S.pd(p.limitBack):p.gunsBack="–",e(""+this.select).find("div").append(S.getText(p))},v(a,[{key:"shipBaseData",get:function(){return this._shipBaseData}},{key:"shipCompareData",get:function(){return this._shipCompareData}},{key:"shipCompare",get:function(){return this._shipCompare}}]),a}(S),y=function(){function t(e){void 0===e&&(e="ship-compare"),this._baseId=e,this._baseName="Compare ships",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._moduleId=this._baseId+"-module",this._copyButtonId="button-copy-"+this._baseId,this.colourScaleSpeedDiff=Object(p.a)().range([d.i,d.k,d.f]).interpolate(n.b),this._shipIds=[],this._selectedUpgradeIdsPerType=[],this._selectedUpgradeIdsList=[],this._selectShip$={},this._selectWood$={},this._selectModule$={},this._modal$=null,this._modifierAmount=new Map,"ship-compare"===this._baseId?this._columnsCompare=["C1","C2"]:this._columnsCompare=[],this._columns=this._columnsCompare.slice(),this._columns.unshift("Base"),this._selectedShips={Base:{},C1:{},C2:{}},"ship-journey"===this._baseId?this._woodId="wood-journey":this._woodId="wood-ship","ship-journey"!==this._baseId&&this._setupListener()}var i=t.prototype;return i.shipJourneyInit=function(){var e=b(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadAndSetupData();case 2:this._initData(),this._initSelects();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._setupData=function(){this._woodChanges=new Map([["Acceleration",{properties:["ship.acceleration"],isBaseValueAbsolute:!0}],["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],isBaseValueAbsolute:!0}],["Armour hit points",{properties:["bow.armour","sides.armour","stern.armour"],isBaseValueAbsolute:!0}],["Splinter resistance",{properties:["resistance.splinter"],isBaseValueAbsolute:!1}],["Crew",{properties:["crew.max"],isBaseValueAbsolute:!0}],["Fire resistance",{properties:["resistance.fire"],isBaseValueAbsolute:!1}],["Hull hit points",{properties:["structure.armour"],isBaseValueAbsolute:!0}],["Leak resistance",{properties:["resistance.leaks"],isBaseValueAbsolute:!1}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],isBaseValueAbsolute:!0}],["Rudder speed",{properties:["rudder.halfturnTime"],isBaseValueAbsolute:!0}],["Max speed",{properties:["speed.max"],isBaseValueAbsolute:!0}],["Turn rate",{properties:["rudder.turnSpeed"],isBaseValueAbsolute:!0}]]),this._moduleChanges=new Map([["Acceleration",{properties:["ship.acceleration"],isBaseValueAbsolute:!0}],["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],isBaseValueAbsolute:!0}],["Armour repair amount (perk)",{properties:["repairAmount.armourPerk"],isBaseValueAbsolute:!0}],["Armour repair amount",{properties:["repairAmount.armour"],isBaseValueAbsolute:!0}],["Armour hit points",{properties:["bow.armour","sides.armour","stern.armour"],isBaseValueAbsolute:!0}],["Back armour thickness",{properties:["stern.thickness"],isBaseValueAbsolute:!0}],["Splinter resistance",{properties:["resistance.splinter"],isBaseValueAbsolute:!1}],["Crew",{properties:["crew.max"],isBaseValueAbsolute:!0}],["Fire resistance",{properties:["resistance.fire"],isBaseValueAbsolute:!1}],["Front armour thickness",{properties:["bow.thickness"],isBaseValueAbsolute:!0}],["Hold weight",{properties:["maxWeight"],isBaseValueAbsolute:!0}],["Hull hit points",{properties:["structure.armour"],isBaseValueAbsolute:!0}],["Leak resistance",{properties:["resistance.leaks"],isBaseValueAbsolute:!1}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],isBaseValueAbsolute:!0}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],isBaseValueAbsolute:!0}],["Rudder health",{properties:["rudder.armour"],isBaseValueAbsolute:!0}],["Rudder repair time",{properties:["repairTime.rudder"],isBaseValueAbsolute:!0}],["Rudder speed",{properties:["rudder.halfturnTime"],isBaseValueAbsolute:!0}],["Sail repair amount (perk)",{properties:["repairAmount.sailsPerk"],isBaseValueAbsolute:!0}],["Sail repair amount",{properties:["repairAmount.sails"],isBaseValueAbsolute:!0}],["Sail repair time",{properties:["repairTime.sails"],isBaseValueAbsolute:!0}],["Sailing crew",{properties:["crew.sailing"],isBaseValueAbsolute:!0}],["Max speed",{properties:["speed.max"],isBaseValueAbsolute:!0}],["Side armour repair time",{properties:["repairTime.sides"],isBaseValueAbsolute:!0}],["Speed decrease",{properties:["ship.deceleration"],isBaseValueAbsolute:!0}],["Turn rate",{properties:["rudder.turnSpeed"],isBaseValueAbsolute:!0}],["Water pump health",{properties:["pump.armour"],isBaseValueAbsolute:!0}],["Water repair time",{properties:["repairTime.pump"],isBaseValueAbsolute:!0}]]),this._moduleCaps=new Map([["Armor thickness",{properties:["sides.thickness","bow.thickness","stern.thickness"],cap:{amount:.3,isPercentage:!0}}],["Armour hit points",{properties:["bow.armour","sides.armour","stern.armour"],cap:{amount:.3,isPercentage:!0}}],["Structure hit points",{properties:["structure.armour"],cap:{amount:.3,isPercentage:!0}}],["Mast health",{properties:["mast.bottomArmour","mast.middleArmour","mast.topArmour"],cap:{amount:.3,isPercentage:!0}}],["Mast thickness",{properties:["mast.bottomThickness","mast.middleThickness","mast.topThickness"],cap:{amount:.3,isPercentage:!0}}],["Max speed",{properties:["speed.max"],cap:{amount:15.5,isPercentage:!1}}],["Turn rate",{properties:["rudder.turnSpeed"],cap:{amount:.25,isPercentage:!0}}]]);var e=1.2*Object(s.a)(this._shipData,(function(e){return e.speed.min})),t=this._moduleCaps.get("Max speed").cap.amount;this._minSpeed=e,this._maxSpeed=t,this._colorScale=Object(p.a)().domain([this._minSpeed,0,this._maxSpeed]).range([d.i,d.k,d.f]).interpolate(n.b)},i._loadAndSetupData=function(){var e=b(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.e(5).then(a.t.bind(null,"3KT9",3)).then((function(e){return e.default}));case 3:return this._moduleDataDefault=e.sent,e.next=6,a.e(12).then(a.t.bind(null,"wtJ6",3)).then((function(e){return e.default}));case 6:this._shipData=e.sent,this._setupData(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),Object(l.G)(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),i._setupListener=function(){var e=this,t=!0;document.getElementById(this._buttonId).addEventListener("click",function(){var a=b(regeneratorRuntime.mark((function a(s){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=4;break}return t=!1,a.next=4,e._loadAndSetupData();case 4:Object(u.b)("Tools",e._baseName),s.stopPropagation(),e._shipCompareSelected();case 7:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},i._setGraphicsParameters=function(){this.svgWidth=parseInt(e("#"+this._modalId+" .column-base").width(),10),this.svgHeight=this.svgWidth,this.outerRadius=Math.floor(Math.min(this.svgWidth,this.svgHeight)/2),this.innerRadius=Math.floor(.3*this.outerRadius),this.radiusScaleAbsolute=Object(p.a)().domain([this.minSpeed,0,this.maxSpeed]).range([10,this.innerRadius,this.outerRadius])},i._shipCompareSelected=function(){var t=this;this._modal$||(this._initModal(),this._modal$=e("#"+this._modalId),this._modal$.on("keydown",(function(e){"KeyC"===e.code&&e.ctrlKey&&t._copyDataClicked(e)})),document.getElementById(this._copyButtonId).addEventListener("click",(function(e){t._copyDataClicked(e)}))),this._modal$.modal("show"),this._setGraphicsParameters()},i._getShipAndWoodIds=function(){var e=this,t=[];return this._columns.forEach((function(a){void 0!==e._shipIds[a]&&(t.push(e._shipIds[a]),["frame","trim"].forEach((function(s){t.push(Number(e._selectWood$[a][s].val()))})))})),t},i._copyDataClicked=function(e){var t=this;Object(u.b)("Menu","Copy ship compare"),e.preventDefault();var a=this._getShipAndWoodIds();if(a.length){var s=new URL(window.location);s.searchParams.set("v",encodeURIComponent(d.d)),s.searchParams.set("cmp",d.v.encode(a)),this._columns.forEach((function(e,a){t._selectedUpgradeIdsPerType[e]&&f(t._moduleTypes).forEach((function(i,r){var o=t._selectedUpgradeIdsPerType[e][i];if(o&&o.length){var n=""+a+r;s.searchParams.set(n,d.v.encode(o))}}))})),Object(l.g)(s.href)}},i._setupShipData=function(){this.shipSelectData=Object(o.b)().key((function(e){return e.class})).sortKeys(r.a).entries(this._shipData.map((function(e){return{id:e.id,name:e.name,class:e.class,battleRating:e.battleRating,guns:e.guns}})).sort(Object(l.J)(["name"])))},i._setupModuleData=function(){var e=this;this._moduleProperties=new Map(this._moduleDataDefault.flatMap((function(t){return t[1].filter((function(t){return t.properties.some((function(t){return e._moduleChanges.has(t.modifier)}))})).map((function(e){return[e.id,e]}))}))),this._moduleTypes=new Set(f(this._moduleProperties).map((function(e){return e[1].type.replace(/\s\u2013\s[a-zA-Z/\u25CB\s]+/,"")})))},i._injectModal=function(){var e=this;Object(d.B)(this._modalId,this._baseName);var t=Object(c.f)("#"+this._modalId+" .modal-body").append("div").attr("class","container-fluid").append("div").attr("class","row");this._columns.forEach((function(a){var s=t.append("div").attr("class","col-md-4 ml-auto pt-2 "+("Base"===a?"column-base":"column-comp")),i=e._getShipSelectId(a);s.append("label").append("select").attr("name",i).attr("id",i).attr("class","selectpicker"),["frame","trim"].forEach((function(t){var i=e._getWoodSelectId(t,a);s.append("label").append("select").attr("name",i).attr("id",i).attr("class","selectpicker")})),e._moduleTypes.forEach((function(t){var i=e._getModuleSelectId(t,a);s.append("label").append("select").attr("name",i).attr("id",i).property("multiple",!0).attr("class","selectpicker")})),s.append("div").attr("id",e._baseId+"-"+a).attr("class","Base"===a?"ship-base":"ship-compare")})),Object(c.f)("#"+this._modalId+" .modal-footer").insert("button","button").classed("btn btn-outline-secondary icon-outline-button",!0).attr("id",this._copyButtonId).attr("title","Copy to clipboard (ctrl-c)").attr("type","button").append("i").classed("icon icon-copy",!0)},i._initData=function(){this._setupShipData(),this._setupModuleData()},i._initSelects=function(){var t=this;this.woodCompare=new m.a(this._woodId),this.woodCompare.woodInit().then((function(){t._columns.forEach((function(a){t._selectWood$[a]={},t._setupShipSelect(a),["frame","trim"].forEach((function(s){t._selectWood$[a][s]=e("#"+t._getWoodSelectId(s,a)),t.woodCompare._setupWoodSelects(a,s,t._selectWood$[a][s])})),t._setupSelectListener(a)}))}))},i._initModal=function(){this._initData(),this._injectModal(),this._initSelects()},i._getShipOptions=function(){return this.shipSelectData.map((function(e){return'<optgroup label="'+Object(l.A)(e.key,!1)+' rate">'+e.values.map((function(e){return'<option data-subtext="'+e.battleRating+'" value="'+e.id+'">'+e.name+" ("+e.guns+")"})).join("</option>")})).join("</optgroup>")},i._setupShipSelect=function(t){this._selectShip$[t]=e("#"+this._getShipSelectId(t));var a=this._getShipOptions();this._selectShip$[t].append(a),"Base"!==t&&this._selectShip$[t].attr("disabled","disabled")},i._getUpgradesOptions=function(e,t){var a=Object(o.b)().key((function(e){return e[1].type.replace(/[a-zA-Z\s]+\s–\s/,"")})).sortKeys(r.a).entries(f(this._moduleProperties).filter((function(a){return a[1].type.replace(/\s–\s[a-zA-Z/\u25CB\s]+/,"")===e&&("U"===a[1].moduleLevel||a[1].moduleLevel===((s=t)<=3?"L":s<=5?"M":"S"));var s}))),s=["Permanent","Ship trim"];return a.length>1?a.map((function(t){return'<optgroup label="'+t.key+'" data-max-options="'+(s.includes(e.replace(/[a-zA-Z\s]+\s–\s/,""))?1:5)+'">'+t.values.map((function(e){return'<option value="'+e[0]+'">'+e[1].name})).join("</option>")})).join("</optgroup>"):a.map((function(e){return""+e.values.map((function(e){return'<option value="'+e[0]+'">'+e[1].name})).join("</option>")}))},i._fillModuleSelect=function(e,t){var a=this,s=this._getUpgradesOptions(t,a._shipData.find((function(t){return t.id===a._shipIds[e]})).class);this._selectModule$[e][t].find("option").remove(),this._selectModule$[e][t].append(s)},i._resetModuleSelects=function(e){var t=this;this._moduleTypes.forEach((function(a){t._fillModuleSelect(e,a),t._selectModule$[e][a].selectpicker("refresh")}))},i._getModuleFromName=function(e){var t={};return this._moduleDataDefault.some((function(a){return t=a[1].find((function(t){return t.name===e})),Boolean(t)})),t},i._getModifierFromModule=function(e){return'<p class="mb-0">'+e.map((function(e){var t=e.isPercentage?Object(l.z)(e.amount/100):e.amount<1&&e.amount>0?Object(l.t)(e.amount):Object(l.y)(e.amount);return e.modifier+" "+t})).join("<br>")+"</p>"},i._setupModulesSelect=function(t){var a=this;this._selectModule$[t]||(this._selectModule$[t]={},this._moduleTypes.forEach((function(s){a._selectModule$[t][s]=e("#"+a._getModuleSelectId(s,t)),a._selectModule$[t][s].on("changed.bs.select",(function(){a._modulesSelected(t),a._refreshShips(t)})).on("show.bs.select",(function(t){e(t.currentTarget).parent().find("button.bs-select-all").remove()})).on("show.bs.select",(function(t){e(t.currentTarget).data("selectpicker").selectpicker.current.elements.forEach((function(t){if(!t.classList.contains("dropdown-divider")&&!t.classList.contains("dropdown-header")){var s=a._getModuleFromName(t.innerText);e(t).attr("data-original-title",a._getModifierFromModule(s.properties)).tooltip({boundary:"viewport",html:!0})}}))})).selectpicker({actionsBox:!0,countSelectedText:function(e){return e+" "+s.toLowerCase()+"s selected"},deselectAllText:"Clear",liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Search ...",maxOptions:s.startsWith("Ship trim")?6:5,selectedTextFormat:"count > 1",title:""+s,width:"150px"})}))),this._resetModuleSelects(t)},i._getShipData=function(e){var t=this,a=this._shipData.find((function(a){return a.id===t._shipIds[e]})),s=a;return s.repairAmount={armour:d.w,armourPerk:0,sails:d.F,sailsPerk:0},s.repairTime.sides=d.E,s.repairTime.default=d.E,s=this._addWoodData(a,e),s=this._addModulesData(a,s,e)},i._adjustValue=function(e,t,a){var s,i,r=e;if(this._modifierAmount.get(t).absolute){var o=this._modifierAmount.get(t).absolute;i=o,r=(s=r)?s+i:i}this._modifierAmount.get(t).percentage&&(r=function(e,t){return e?a?e*(1+t):e+t:t}(r,this._modifierAmount.get(t).percentage/100));return r},i._setModifier=function(e){var t=e.isPercentage?0:e.amount,a=e.isPercentage?e.amount:0;this._modifierAmount.has(e.modifier)&&(t+=this._modifierAmount.get(e.modifier).absolute,a+=this._modifierAmount.get(e.modifier).percentage),this._modifierAmount.set(e.modifier,{absolute:t,percentage:a})},i._addWoodData=function(e,t){var a=this,s=JSON.parse(JSON.stringify(e));if(s.resistance={fire:0,leaks:0,splinter:0},void 0!==this.woodCompare._instances[t]){var i="_woodData";"Base"!==t&&(i="_compareData"),this._modifierAmount=new Map,["frame","trim"].forEach((function(e){a.woodCompare._instances[t][i][e].properties.forEach((function(e){a._woodChanges.has(e.modifier)&&a._setModifier(e)}))})),this._modifierAmount.forEach((function(e,t){a._woodChanges.get(t).properties.forEach((function(e){var i=e.split(".");i.length>1?s[i[0]][i[1]]=a._adjustValue(s[i[0]][i[1]],t,a._woodChanges.get(t).isBaseValueAbsolute):s[i[0]]=a._adjustValue(s[i[0]],t,a._woodChanges.get(t).isBaseValueAbsolute)}))})),s.speedDegrees=s.speedDegrees.map((function(e){var t=1+a._modifierAmount.get("Max speed").percentage/100;return Math.max(Math.min(e*t,a._maxSpeed),a._minSpeed)}))}return s},i._showCappingAdvice=function(e){var t=this._baseId+"-"+e+"-capping";if(!document.getElementById(t)){var a=document.createElement("p");a.id=t,a.className="alert alert-warning",a.innerHTML="Values capped",document.getElementById(this._baseId+"-"+e).firstChild.after(a)}},i._removeCappingAdvice=function(e){var t=this._baseId+"-"+e+"-capping",a=document.getElementById(t);a&&a.remove()},i._addModulesData=function(e,t,a){var s=this,i=JSON.parse(JSON.stringify(t));this._modifierAmount=new Map;var r,o;return this._selectedUpgradeIdsList[a]?(s._selectedUpgradeIdsList[a].forEach((function(e){s._moduleProperties.get(e).properties.forEach((function(e){s._moduleChanges.has(e.modifier)&&s._setModifier(e)}))})),s._modifierAmount.forEach((function(e,t){s._moduleChanges.get(t).properties&&s._moduleChanges.get(t).properties.forEach((function(e){var a=e.split(".");a.length>1?i[a[0]][a[1]]=s._adjustValue(i[a[0]][a[1]],t,s._moduleChanges.get(t).isBaseValueAbsolute):i[a[0]]=s._adjustValue(i[a[0]],t,s._moduleChanges.get(t).isBaseValueAbsolute)}))})),r=!1,o=function(e,t,a,s){var i=Math.min(e,s?t*(1+a):a);return e!==i&&(r=!0),i},s._modifierAmount.forEach((function(t,a){if(s._moduleCaps.has(a)){var r=s._moduleCaps.get(a).cap;s._moduleCaps.get(a).properties.forEach((function(t){var a=t.split(".");a.length>1?i[a[0]][a[1]]&&(i[a[0]][a[1]]=o(i[a[0]][a[1]],e[a[0]][a[1]],r.amount,r.isPercentage)):i[a[0]]&&(i[a[0]]=o(i[a[0]],e[a[0]],r.amount,r.isPercentage))}))}})),r?s._showCappingAdvice(a):s._removeCappingAdvice(a),this._modifierAmount.has("Max speed")&&(i.speedDegrees=i.speedDegrees.map((function(e){var t=1+s._modifierAmount.get("Max speed").percentage/100,a=e>0?e*t:e/t;return Math.max(Math.min(a,s._maxSpeed),s._minSpeed)}))),i):i},i._updateSailingProfile=function(e){var t=this,a=function(e){"Base"===e||Object(l.C)(t._selectedShips[e])||t._selectedShips[e].updateDifferenceProfile()};a(e),this._columnsCompare.filter((function(t){return t!==e})).forEach((function(e){a(e)}))},i._refreshShips=function(e){var t=this;"ship-journey"!==this._baseId&&this._modulesSelected(e);var a=this._getShipData(e);"ship-journey"===this._baseId?this._singleShipData=a:"Base"===e?(this._setSelectedShip(e,new k(e,a,this)),this._columnsCompare.forEach((function(e){t._selectShip$[e].removeAttr("disabled").selectpicker("refresh"),Object(l.C)(t.selectedShips[e])||t._setSelectedShip(e,new A(e,a,t.selectedShips[e]._shipCompareData,t))}))):this._setSelectedShip(e,new A(e,this.selectedShips.Base._shipData,a,this)),this._updateSailingProfile(e)},i._enableCompareSelects=function(){var e=this;this._columnsCompare.forEach((function(t){e._selectShip$[t].removeAttr("disabled").selectpicker("refresh")}))},i._modulesSelected=function(e){var t=this;this._selectedUpgradeIdsList[e]=[],this._selectedUpgradeIdsPerType[e]={},this._moduleTypes.forEach((function(a){t._selectedUpgradeIdsPerType[e][a]=t._selectModule$[e][a].val(),Array.isArray(t._selectedUpgradeIdsPerType[e][a])?t._selectedUpgradeIdsPerType[e][a]=t._selectedUpgradeIdsPerType[e][a].map(Number):t._selectedUpgradeIdsPerType[e][a]=""===t._selectedUpgradeIdsPerType[e][a]?[]:[Number(t._selectedUpgradeIdsPerType[e][a])],t._selectedUpgradeIdsPerType[e][a].length&&(t._selectedUpgradeIdsList[e]=t._selectedUpgradeIdsList[e].concat(t._selectedUpgradeIdsPerType[e][a]))}))},i._setupSelectListener=function(e){var t=this;this._selectShip$[e].selectpicker({title:"Ship"}).on("changed.bs.select",(function(){t._shipIds[e]=Number(t._selectShip$[e].val()),"ship-journey"!==t._baseId&&t._setupModulesSelect(e),t._refreshShips(e),"Base"===e&&"ship-journey"!==t._baseId&&t._enableCompareSelects(),t.woodCompare.enableSelects(e)})),["frame","trim"].forEach((function(a){t._selectWood$[e][a].on("changed.bs.select",(function(){t.woodCompare._woodSelected(e,a,t._selectWood$[e][a]),t._refreshShips(e)})).selectpicker({title:"Wood "+a,width:"150px"})}))},i.initFromClipboard=function(e){var t,a,s=this,i=function(e,t){t&&e.val(t),e.selectpicker("render")},r=d.v.decode(e.get("cmp"));r.length&&(this._shipCompareSelected(),r.length>3&&this._enableCompareSelects(),t=r,a=0,s._columns.some((function(e){return!!s._shipData.find((function(e){return e.id===t[a]}))&&(s._shipIds[e]=t[a],a+=1,i(s._selectShip$[e],s._shipIds[e]),"Base"===e&&"ship-journey"!==s._baseId&&s._enableCompareSelects(),s.woodCompare.enableSelects(e),s._setupModulesSelect(e),t[a]?["frame","trim"].forEach((function(r){i(s._selectWood$[e][r],t[a]),a+=1,s.woodCompare._woodSelected(e,r,s._selectWood$[e][r])})):a+=2,s._refreshShips(e),a>=t.length)})),s._columns.forEach((function(t,a){var r=!1;f(s._moduleTypes).forEach((function(o,n){if(e.has(""+a+n)){var p=d.v.decode(e.get(""+a+n));s._selectedUpgradeIdsPerType[t]||(s._selectedUpgradeIdsPerType[t]={}),s._selectedUpgradeIdsList[t]||(s._selectedUpgradeIdsList[t]=[]),s._selectedUpgradeIdsPerType[t][o]=p.map(Number),i(s._selectModule$[t][o],s._selectedUpgradeIdsPerType[t][o]),s._selectedUpgradeIdsList[t]=s._selectedUpgradeIdsList[t].concat(s._selectedUpgradeIdsPerType[t][o]),r=!0}})),r&&s._refreshShips(t)})))},i._getShipSelectId=function(e){return this._baseId+"-"+e+"-select"},i._getWoodSelectId=function(e,t){return this._woodId+"-"+e+"-"+t+"-select"},i._getModuleSelectId=function(e,t){return this._moduleId+"-"+e.replace(/\s/,"")+"-"+t+"-select"},i._setSelectedShip=function(e,t){this._selectedShips[e]=t},v(t,[{key:"woodCompare",set:function(e){this._woodCompare=e},get:function(){return this._woodCompare}},{key:"selectedShips",get:function(){return this._selectedShips}},{key:"minSpeed",get:function(){return this._minSpeed}},{key:"maxSpeed",get:function(){return this._maxSpeed}},{key:"colorScale",get:function(){return this._colorScale}},{key:"svgWidth",set:function(e){this._svgWidth=e},get:function(){return this._svgWidth}},{key:"svgHeight",set:function(e){this._svgHeight=e},get:function(){return this._svgHeight}},{key:"outerRadius",set:function(e){this._outerRadius=e},get:function(){return this._outerRadius}},{key:"innerRadius",set:function(e){this._innerRadius=e},get:function(){return this._innerRadius}},{key:"radiusScaleAbsolute",set:function(e){this._radiusScaleAbsolute=e},get:function(){return this._radiusScaleAbsolute}}]),t}()}).call(this,a("xeH2"))},pFgi:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return _}));a("iPZ8"),a("kypl"),a("pCzD"),a("hi3g"),a("lYjL"),a("IlJM"),a("SJSz"),a("4owi"),a("/YXa"),a("lmye"),a("WB5j"),a("aOEW"),a("RsBt"),a("D/wG"),a("1Qwx"),a("fp7Y"),a("ZEAQ"),a("JBxO"),a("FdtR"),a("9UJh"),a("RsMT"),a("WoWj"),a("SgDD"),a("3dw1"),a("U00V"),a("wcNg"),a("3XUK"),a("Peo2");var s=a("ED/D"),i=a("qKAC"),r=a("nUlG"),o=a("f4w0"),n=a("Av7d"),p=a("0lY5");function c(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function h(e,t,a,s,i,r,o){try{var n=e[r](o),p=n.value}catch(e){return void a(e)}n.done?t(p):Promise.resolve(p).then(s,i)}function u(e){return function(){var t=this,a=arguments;return new Promise((function(s,i){var r=e.apply(t,a);function o(e){h(r,s,i,o,n,"next",e)}function n(e){h(r,s,i,o,n,"throw",e)}o(void 0)}))}}function d(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var l=function(){function e(e,t){this._id=e,this._woodCompare=t,this._select="#"+this._woodCompare._baseFunction+"-"+this._id,this._setupMainDiv(),this._g=Object(r.f)(this._select).select("g")}return e.prototype._setupMainDiv=function(){Object(r.f)(this._select+" div").remove(),Object(r.f)(this._select).append("div")},e}(),m=function(t){function a(e,a,s){var i;return(i=t.call(this,e,s)||this)._woodData=a,i._woodCompare=s,i._printText(),i}d(a,t);var s=a.prototype;return s._getProperty=function(e,t){var a=this._woodData[t].properties.find((function(t){return t.modifier===e})),s=0,i=!1;return a&&a.amount&&(s=a.amount,i=a.isPercentage),{amount:s,isPercentage:i}},s._getPropertySum=function(e){var t=this._getProperty(e,"frame"),a=this._getProperty(e,"trim");return{amount:t.amount+a.amount,isPercentage:a.isPercentage}},s._getText=function(e){var t=this,a='<table class="table table-sm table-striped small mt-4"><thead>';return a+="<tr>",a+="<tr><th><em>Property</em></th><th><em>Change</em></th></tr></thead><tbody>",e.properties.forEach((function(e,s){if(a+="<tr><td>"+s+"</td><td>"+(e.isPercentage?Object(p.u)(e.amount/100):Object(p.o)(e.amount)),a+='<span class="rate">',e.amount>0){var i=e.amount/t._woodCompare._minMaxProperty.get(s).max*50;a+='<span class="bar neutral" style="width:50%;"></span>',a+='<span class="bar pos diff" style="width:'+i+'%;"></span>'}else if(e.amount<0){var r=e.amount/t._woodCompare._minMaxProperty.get(s).min*50;a+='<span class="bar neutral" style="width:'+(50-r)+'%;"></span>',a+='<span class="bar neg diff" style="width:'+r+'%;"></span>'}else a+='<span class="bar neutral"></span>';a+="</span></td></tr>"})),a+="</tbody></table>"},s._printText=function(){var t=this,a={frame:this._woodData.frame.id,trim:this._woodData.trim.id};a.properties=new Map,this._woodCompare.propertyNames.forEach((function(e){var s=t._getPropertySum(e);a.properties.set(e,{amount:s.amount,isPercentage:s.isPercentage})})),e(""+this._select).find("div").append(this._getText(a))},a}(l),f=function(t){function a(e,a,s,i){var r;return(r=t.call(this,e,i)||this)._baseData=a,r._compareData=s,r._woodCompare=i,r._printTextComparison(),r}d(a,t);var s=a.prototype;return s._getBaseProperty=function(e,t){var a=this._baseData[t].properties.find((function(t){return t.modifier===e})),s=0,i=!1;return a&&a.amount&&(s=a.amount,i=a.isPercentage),{amount:s,isPercentage:i}},s._getBasePropertySum=function(e){var t=this._getBaseProperty(e,"frame"),a=this._getBaseProperty(e,"trim");return{amount:t.amount+a.amount,isPercentage:a.isPercentage}},s._getCompareProperty=function(e,t){var a=this._compareData[t].properties.find((function(t){return t.modifier===e})),s=0,i=!1;return a&&a.amount&&(s=a.amount,i=a.isPercentage),{amount:s,isPercentage:i}},s._getComparePropertySum=function(e){var t=this._getCompareProperty(e,"frame"),a=this._getCompareProperty(e,"trim");return{amount:t.amount+a.amount,isPercentage:t.isPercentage&&a.isPercentage}},s._getText=function(e){var t=this;var a=0,s=0,i=0,r="",o='<table class="table table-sm table-striped small wood mt-4"><thead>';return o+="<tr>",o+="<tr><th><em>Property</em></th><th><em>Change</em></th></tr></thead><tbody>",e.properties.forEach((function(e,n){o+="<tr><td>"+n+"</td><td>"+function(e,t,a,s){void 0===s&&(s=1);var i=parseFloat((e-t).toFixed(s));return(a?Object(p.u)(e/100,s):Object(p.o)(e))+' <span class="badge badge-white">'+Object(p.x)(i)+"</span>"}(e.compare,e.base,e.isPercentage),o+='<span class="rate">',e.compare>=0?(e.base>=0?e.compare>e.base?(a=e.base,s=e.compare-e.base,r="pos"):(a=e.compare,s=e.base-e.compare,r="neg"):(a=0,s=e.compare,r="pos"),o+='<span class="bar neutral" style="width:50%;"></span>',o+='<span class="bar pos diff" style="width:'+a/t._woodCompare._minMaxProperty.get(n).max*50+'%;"></span>',o+='<span class="bar '+r+'" style="width:'+s/t._woodCompare._minMaxProperty.get(n).max*50+'%;"></span>'):e.compare<0?(e.base<0?e.compare>=e.base?(a=e.compare,s=e.base-e.compare,i=-e.base,r="pos"):(a=e.base,s=e.compare-e.base,i=-e.compare,r="neg"):(a=0,s=e.compare,i=-e.compare,r="neg"),o+='<span class="bar neutral" style="width:'+(50+i/t._woodCompare._minMaxProperty.get(n).min*50)+'%;"></span>',o+='<span class="bar '+r+'" style="width:'+s/t._woodCompare._minMaxProperty.get(n).min*50+'%;"></span>',o+='<span class="bar neg diff" style="width:'+a/t._woodCompare._minMaxProperty.get(n).min*50+'%;"></span>'):o+='<span class="bar neutral"></span>',o+="</span></td></tr>"})),o+="</tbody></table>"},s._printTextComparison=function(){var t=this,a={frame:this._compareData.frame.name,trim:this._compareData.trim.name};a.properties=new Map,this._woodCompare.propertyNames.forEach((function(e){var s=t._getBasePropertySum(e),i=t._getComparePropertySum(e);a.properties.set(e,{base:s.amount,compare:i.amount,isPercentage:s.isPercentage})})),e(""+this._select).find("div").append(this._getText(a))},a}(l),_=function(){function t(e){this._baseFunction=e,this._baseName="Compare woods",this._baseId=this._baseFunction+"-compare",this._buttonId="button-"+this._baseId,this._modalId="modal-"+this._baseId,this._woodsSelected=[],this._instances=[],this._options={},this._minMaxProperty=new Map,"wood"===this._baseFunction&&this._setupListener()}var h=t.prototype;return h.woodInit=function(){var e=u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadAndSetupData();case 2:this._initData();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),h._setupData=function(){var e=this,t=function(t,a){return e._woodData[t].find((function(e){return e.name===a})).id};this.propertyNames=new Set([].concat(c(this._woodData.frame.flatMap((function(e){return e.properties.map((function(e){return e.modifier}))}))),c(this._woodData.trim.flatMap((function(e){return e.properties.map((function(e){return e.modifier}))})))).sort()),"wood"===this._baseFunction?(this._defaultWood={frame:t("frame","Fir"),trim:t("trim","Crew Space")},this._columnsCompare=["C1","C2","C3"]):"wood-journey"===this._baseFunction?(this._defaultWood={frame:t("frame","Oak"),trim:t("trim","Oak")},this._columnsCompare=[]):(this._defaultWood={frame:t("frame","Oak"),trim:t("trim","Oak")},this._columnsCompare=["C1","C2"]),this._columns=this._columnsCompare.slice(),this._columns.unshift("Base")},h._loadAndSetupData=function(){var e=u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.e(13).then(a.t.bind(null,"c8Sa",3)).then((function(e){return e.default}));case 3:this._woodData=e.sent,this._setupData(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Object(p.G)(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),h._setupListener=function(){var e=this,t=!0;document.getElementById(this._buttonId).addEventListener("click",function(){var a=u(regeneratorRuntime.mark((function a(s){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=4;break}return t=!1,a.next=4,e._loadAndSetupData();case 4:Object(o.b)("Tools",e._baseName),s.stopPropagation(),e._woodCompareSelected();case 7:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},h._woodCompareSelected=function(){document.getElementById(this._modalId)||this._initModal(),e("#"+this._modalId).modal("show")},h._initData=function(){var e=this;this._frameSelectData=this._woodData.frame.sort(Object(p.J)(["name"])),this._trimSelectData=this._woodData.trim.sort(Object(p.J)(["name"])),this._setOption(this._frameSelectData.map((function(e){return'<option value="'+e.id+'">'+e.name+"</option>"})),this._trimSelectData.map((function(e){return'<option value="'+e.id+'">'+e.name+"</option>"}))),this.propertyNames.forEach((function(t){var a=c(e._woodData.frame.map((function(e){return e.properties.filter((function(e){return e.modifier===t})).map((function(e){return e.amount}))[0]}))),r=c(e._woodData.trim.map((function(e){return e.properties.filter((function(e){return e.modifier===t})).map((function(e){return e.amount}))[0]}))),o=Object(s.a)(a)||0,n=Object(i.a)(a)||0,p=Object(s.a)(r)||0,h=Object(i.a)(r)||0;e._addMinMaxProperty(t,{min:o+p>=0?0:o+p,max:n+h})}))},h._injectModal=function(){var e=this;Object(n.B)(this._modalId,this._baseName);var t=Object(r.f)("#"+this._modalId+" .modal-body").append("div").attr("class","container-fluid").append("div").attr("class","row wood");this._columns.forEach((function(a){var s=t.append("div").attr("class","col-md-3 ml-auto pt-2 "+("Base"===a?"column-base":"column-comp"));["frame","trim"].forEach((function(t){var i=e._baseFunction+"-"+t+"-"+a+"-select";s.append("label").attr("for",i),s.append("select").attr("name",i).attr("id",i).attr("class","selectpicker")})),s.append("div").attr("id",e._baseFunction+"-"+a)}))},h._initModal=function(){var t=this;this._initData(),this._injectModal(),this._columns.forEach((function(a){["frame","trim"].forEach((function(s){var i=e("#"+t._baseFunction+"-"+s+"-"+a+"-select");t._setupWoodSelects(a,s,i),t._setupSelectListener(a,s,i)}))}))},h._setWoodsSelected=function(e,t,a){this._woodsSelected[e]||(this._woodsSelected[e]={}),this._woodsSelected[e][t]=a},h._setupWoodSelects=function(e,t,a){this._setWoodsSelected(e,t,this._defaultWood[t]),a.append(this._options[t]),("wood"!==this._baseFunction||"Base"!==e&&"wood"===this._baseFunction)&&a.attr("disabled","disabled")},h._setOtherSelect=function(t,a){var s="frame"===a?"trim":"frame";this._woodsSelected[t][s]===this._defaultWood[s]&&e("#"+this._baseFunction+"-"+s+"-"+t+"-select").val(this._defaultWood[s]).selectpicker("refresh")},h.enableSelects=function(t){var a=this;["frame","trim"].forEach((function(s){e("#"+a._baseFunction+"-"+s+"-"+t+"-select").removeAttr("disabled").selectpicker("refresh")}))},h._woodSelected=function(e,t,a){var s=this,i=Number(a.val());this._setWoodsSelected(e,t,i),this._setOtherSelect(e,t),"Base"===e?(this._addInstance(e,new m("Base",this._getWoodData("Base"),this)),this._columnsCompare.forEach((function(e){"wood"===s._baseFunction&&s.enableSelects(e),s._instances[e]&&s._addInstance(e,new f(e,s._getWoodData("Base"),s._getWoodData(e),s))}))):this._addInstance(e,new f(e,this._getWoodData("Base"),this._getWoodData(e),this))},h._setupSelectListener=function(e,t,a){var s=this;a.on("change",(function(){return s._woodSelected(e,t,a)})).selectpicker({title:"Select "+t})},h._getWoodData=function(e){return{frame:this.getWoodTypeData("frame",this._woodsSelected[e].frame),trim:this.getWoodTypeData("trim",this._woodsSelected[e].trim)}},h._addMinMaxProperty=function(e,t){this._minMaxProperty.set(e,t)},h._setOption=function(e,t){this._options.frame=e,this._options.trim=t},h._addInstance=function(e,t){this._instances[e]=t},h.getWoodTypeData=function(e,t){return this._woodData[e].find((function(e){return e.id===t}))},t}()}).call(this,a("xeH2"))}}]);